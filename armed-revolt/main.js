!function(n){var r={};function i(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=n,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=18)}([function(t,e,n){"use strict";var E=n(12),P=n(14);function x(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=i,e.resolve=function(t,e){return i(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?i(t,!1,!0).resolveObject(e):e},e.format=function(t){P.isString(t)&&(t=i(t));return t instanceof x?t.format():x.prototype.format.call(t)},e.Url=x;var k=/^([a-z0-9.+-]+:)/i,r=/:[0-9]*$/,R=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,e=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),A=["'"].concat(e),C=["%","/","?",";","#"].concat(A),I=["/","?","#"],M=/^[+a-z0-9A-Z_-]{0,63}$/,j=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,D={javascript:!0,"javascript:":!0},L={javascript:!0,"javascript:":!0},N={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},F=n(15);function i(t,e,n){if(t&&P.isObject(t)&&t instanceof x)return t;var r=new x;return r.parse(t,e,n),r}x.prototype.parse=function(t,e,n){if(!P.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),i=-1!==r&&r<t.indexOf("#")?"?":"#",r=t.split(i);r[0]=r[0].replace(/\\/g,"/");var o=(o=t=r.join(i)).trim();if(!n&&1===t.split("#").length){var a=R.exec(o);if(a)return this.path=o,this.href=o,this.pathname=a[1],a[2]?(this.search=a[2],this.query=e?F.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var s,a=k.exec(o);if(a&&(S=(a=a[0]).toLowerCase(),this.protocol=S,o=o.substr(a.length)),(n||a||o.match(/^\/\/[^@\/]+@[^@\/]+/))&&(!(s="//"===o.substr(0,2))||a&&L[a]||(o=o.substr(2),this.slashes=!0)),!L[a]&&(s||a&&!N[a])){for(var u=-1,c=0;c<I.length;c++)-1!==(l=o.indexOf(I[c]))&&(-1===u||l<u)&&(u=l);-1!==(x=-1===u?o.lastIndexOf("@"):o.lastIndexOf("@",u))&&(w=o.slice(0,x),o=o.slice(x+1),this.auth=decodeURIComponent(w));for(var l,u=-1,c=0;c<C.length;c++)-1!==(l=o.indexOf(C[c]))&&(-1===u||l<u)&&(u=l);-1===u&&(u=o.length),this.host=o.slice(0,u),o=o.slice(u),this.parseHost(),this.hostname=this.hostname||"";var h="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!h)for(var f=this.hostname.split(/\./),c=0,p=f.length;c<p;c++){var d=f[c];if(d&&!d.match(M)){for(var y="",m=0,v=d.length;m<v;m++)127<d.charCodeAt(m)?y+="x":y+=d[m];if(!y.match(M)){var g=f.slice(0,c),b=f.slice(c+1),_=d.match(j);_&&(g.push(_[1]),b.unshift(_[2])),b.length&&(o="/"+b.join(".")+o),this.hostname=g.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),h||(this.hostname=E.toASCII(this.hostname));var x=this.port?":"+this.port:"",w=this.hostname||"";this.host=w+x,this.href+=this.host,h&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0]&&(o="/"+o))}if(!D[S])for(c=0,p=A.length;c<p;c++){var T,O=A[c];-1!==o.indexOf(O)&&((T=encodeURIComponent(O))===O&&(T=escape(O)),o=o.split(O).join(T))}h=o.indexOf("#");-1!==h&&(this.hash=o.substr(h),o=o.slice(0,h));var S,h=o.indexOf("?");return-1!==h?(this.search=o.substr(h),this.query=o.substr(h+1),e&&(this.query=F.parse(this.query)),o=o.slice(0,h)):e&&(this.search="",this.query={}),o&&(this.pathname=o),N[S]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(x=this.pathname||"",S=this.search||"",this.path=x+S),this.href=this.format(),this},x.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,o="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&P.isObject(this.query)&&Object.keys(this.query).length&&(o=F.stringify(this.query));o=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||N[e])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i=i||"",r&&"#"!==r.charAt(0)&&(r="#"+r),o&&"?"!==o.charAt(0)&&(o="?"+o),e+i+(n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(o=o.replace("#","%23"))+r},x.prototype.resolve=function(t){return this.resolveObject(i(t,!1,!0)).format()},x.prototype.resolveObject=function(t){P.isString(t)&&((p=new x).parse(t,!1,!0),t=p);for(var e=new x,n=Object.keys(this),r=0;r<n.length;r++){var i=n[r];e[i]=this[i]}if(e.hash=t.hash,""===t.href)return e.href=e.format(),e;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),a=0;a<o.length;a++){var s=o[a];"protocol"!==s&&(e[s]=t[s])}return N[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(t.protocol&&t.protocol!==e.protocol){if(!N[t.protocol]){for(var u=Object.keys(t),c=0;c<u.length;c++){var l=u[c];e[l]=t[l]}return e.href=e.format(),e}if(e.protocol=t.protocol,t.host||L[t.protocol])e.pathname=t.pathname;else{for(var h=(t.pathname||"").split("/");h.length&&!(t.host=h.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),e.pathname=h.join("/")}return e.search=t.search,e.query=t.query,e.host=t.host||"",e.auth=t.auth,e.hostname=t.hostname||t.host,e.port=t.port,(e.pathname||e.search)&&(d=e.pathname||"",y=e.search||"",e.path=d+y),e.slashes=e.slashes||t.slashes,e.href=e.format(),e}var f=e.pathname&&"/"===e.pathname.charAt(0),p=t.host||t.pathname&&"/"===t.pathname.charAt(0),d=p||f||e.host&&t.pathname,y=d,m=e.pathname&&e.pathname.split("/")||[],h=t.pathname&&t.pathname.split("/")||[],f=e.protocol&&!N[e.protocol];if(f&&(e.hostname="",e.port=null,e.host&&(""===m[0]?m[0]=e.host:m.unshift(e.host)),e.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===h[0]?h[0]=t.host:h.unshift(t.host)),t.host=null),d=d&&(""===h[0]||""===m[0])),p)e.host=(t.host||""===t.host?t:e).host,e.hostname=(t.hostname||""===t.hostname?t:e).hostname,e.search=t.search,e.query=t.query,m=h;else if(h.length)(m=m||[]).pop(),m=m.concat(h),e.search=t.search,e.query=t.query;else if(!P.isNullOrUndefined(t.search))return f&&(e.hostname=e.host=m.shift(),(_=!!(e.host&&0<e.host.indexOf("@"))&&e.host.split("@"))&&(e.auth=_.shift(),e.host=e.hostname=_.shift())),e.search=t.search,e.query=t.query,P.isNull(e.pathname)&&P.isNull(e.search)||(e.path=(e.pathname||"")+(e.search||"")),e.href=e.format(),e;if(!m.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var v=m.slice(-1)[0],p=(e.host||t.host||1<m.length)&&("."===v||".."===v)||""===v,g=0,b=m.length;0<=b;b--)"."===(v=m[b])?m.splice(b,1):".."===v?(m.splice(b,1),g++):g&&(m.splice(b,1),g--);if(!d&&!y)for(;g--;)m.unshift("..");!d||""===m[0]||m[0]&&"/"===m[0].charAt(0)||m.unshift(""),p&&"/"!==m.join("/").substr(-1)&&m.push("");var _,p=""===m[0]||m[0]&&"/"===m[0].charAt(0);return f&&(e.hostname=e.host=!p&&m.length?m.shift():"",(_=!!(e.host&&0<e.host.indexOf("@"))&&e.host.split("@"))&&(e.auth=_.shift(),e.host=e.hostname=_.shift())),(d=d||e.host&&m.length)&&!p&&m.unshift(""),m.length?e.pathname=m.join("/"):(e.pathname=null,e.path=null),P.isNull(e.pathname)&&P.isNull(e.search)||(e.path=(e.pathname||"")+(e.search||"")),e.auth=t.auth||e.auth,e.slashes=e.slashes||t.slashes,e.href=e.format(),e},x.prototype.parseHost=function(){var t=this.host,e=r.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e){var n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,p="~";function i(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function a(t,e,n,r,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");i=new o(n,r||t,i),e=p?p+e:e;return t._events[e]?t._events[e].fn?t._events[e]=[t._events[e],i]:t._events[e].push(i):(t._events[e]=i,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(p=!1)),s.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)r.call(t,e)&&n.push(p?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},s.prototype.listeners=function(t){var t=p?p+t:t,e=this._events[t];if(!e)return[];if(e.fn)return[e.fn];for(var n=0,r=e.length,i=new Array(r);n<r;n++)i[n]=e[n].fn;return i},s.prototype.listenerCount=function(t){t=p?p+t:t,t=this._events[t];return t?t.fn?1:t.length:0},s.prototype.emit=function(t,e,n,r,i,o){var a=p?p+t:t;if(!this._events[a])return!1;var s,u=this._events[a],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,n),!0;case 4:return u.fn.call(u.context,e,n,r),!0;case 5:return u.fn.call(u.context,e,n,r,i),!0;case 6:return u.fn.call(u.context,e,n,r,i,o),!0}for(f=1,s=new Array(c-1);f<c;f++)s[f-1]=arguments[f];u.fn.apply(u.context,s)}else for(var l,h=u.length,f=0;f<h;f++)switch(u[f].once&&this.removeListener(t,u[f].fn,void 0,!0),c){case 1:u[f].fn.call(u[f].context);break;case 2:u[f].fn.call(u[f].context,e);break;case 3:u[f].fn.call(u[f].context,e,n);break;case 4:u[f].fn.call(u[f].context,e,n,r);break;default:if(!s)for(l=1,s=new Array(c-1);l<c;l++)s[l-1]=arguments[l];u[f].fn.apply(u[f].context,s)}return!0},s.prototype.on=function(t,e,n){return a(this,t,e,n,!1)},s.prototype.once=function(t,e,n){return a(this,t,e,n,!0)},s.prototype.removeListener=function(t,e,n,r){t=p?p+t:t;if(!this._events[t])return this;if(!e)return u(this,t),this;var i=this._events[t];if(i.fn)i.fn!==e||r&&!i.once||n&&i.context!==n||u(this,t);else{for(var o=0,a=[],s=i.length;o<s;o++)(i[o].fn!==e||r&&!i[o].once||n&&i[o].context!==n)&&a.push(i[o]);a.length?this._events[t]=1===a.length?a[0]:a:u(this,t)}return this},s.prototype.removeAllListeners=function(t){return t?(t=p?p+t:t,this._events[t]&&u(this,t)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=p,t.exports=s.EventEmitter=s},function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,i,o,a,s,u=e&&e.length,c=u?e[0]*n:t.length,l=y(t,0,c,n,!0),h=[];if(!l||l.next===l.prev)return h;if(u&&(l=function(t,e,n,r){var i,o,a,s,u=[];for(i=0,o=e.length;i<o;i++)a=e[i]*r,s=i<o-1?e[i+1]*r:t.length,(s=y(t,a,s,r,!1))===s.next&&(s.steiner=!0),u.push(function(t){var e=t,n=t;for(;(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next,e!==t;);return n}(s));for(u.sort(g),i=0;i<u.length;i++)n=function(t,e){var n=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&a<s){if((a=s)===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}}while(r=r.next,r!==e);if(!n)return null;if(i===a)return n;var u,c=n,l=n.x,h=n.y,f=1/0;r=n;for(;i>=r.x&&r.x>=l&&i!==r.x&&_(o<h?i:a,o,l,h,o<h?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),w(r,t)&&(u<f||u===f&&(r.x>n.x||r.x===n.x&&function(t,e){return x(t.prev,t,e.prev)<0&&x(e.next,t,t.next)<0}(n,r)))&&(n=r,f=u)),r=r.next,r!==c;);return n}(t,e);if(!n)return e;var r=T(n,t),t=m(n,n.next);return m(r,r.next),e===n?t:e}(u[i],n),n=m(n,n.next);return n}(t,e,l,n)),t.length>80*n){for(var f=r=t[0],p=i=t[1],d=n;d<c;d+=n)(o=t[d])<f&&(f=o),(a=t[d+1])<p&&(p=a),r<o&&(r=o),i<a&&(i=a);s=0!==(s=Math.max(r-f,i-p))?1/s:0}return v(l,h,n,f,p,s),h}function y(t,e,n,r,i){var o,a;if(i===0<O(t,e,n,r))for(o=e;o<n;o+=r)a=s(o,t[o],t[o+1],a);else for(o=n-r;e<=o;o-=r)a=s(o,t[o],t[o+1],a);return a&&l(a,a.next)&&(f(a),a=a.next),a}function m(t,e){if(!t)return t;e=e||t;var n,r=t;do{if(n=!1,r.steiner||!l(r,r.next)&&0!==x(r.prev,r,r.next))r=r.next;else{if(f(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function v(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;for(;null===i.z&&(i.z=b(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next,i!==t;);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,c=1;do{for(n=t,o=t=null,a=0;n;){for(a++,r=n,e=s=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;0<s||0<u&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(n=(i=n).nextZ,s--):(r=(i=r).nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}}while(o.nextZ=null,c*=2,1<a)}(i)}(t,r,i,o);for(var s,u,c=t;t.prev!==t.next;)if(s=t.prev,u=t.next,o?function(t,e,n,r){var i=t.prev,o=t,a=t.next;if(0<=x(i,o,a))return!1;var s=(i.x<o.x?i.x<a.x?i:a:o.x<a.x?o:a).x,u=(i.y<o.y?i.y<a.y?i:a:o.y<a.y?o:a).y,c=(i.x>o.x?i.x>a.x?i:a:o.x>a.x?o:a).x,l=(i.y>o.y?i.y>a.y?i:a:o.y>a.y?o:a).y,h=b(s,u,e,n,r),f=b(c,l,e,n,r),p=t.prevZ,d=t.nextZ;for(;p&&p.z>=h&&d&&d.z<=f;){if(p!==t.prev&&p!==t.next&&_(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=x(p.prev,p,p.next))return!1;if(p=p.prevZ,d!==t.prev&&d!==t.next&&_(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&0<=x(d.prev,d,d.next))return!1;d=d.nextZ}for(;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&_(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=x(p.prev,p,p.next))return!1;p=p.prevZ}for(;d&&d.z<=f;){if(d!==t.prev&&d!==t.next&&_(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&0<=x(d.prev,d,d.next))return!1;d=d.nextZ}return!0}(t,r,i,o):function(t){var e=t.prev,n=t,r=t.next;if(0<=x(e,n,r))return!1;var i=t.next.next;for(;i!==t.prev;){if(_(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&0<=x(i.prev,i,i.next))return!1;i=i.next}return!0}(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),f(t),t=u.next,c=u.next;else if((t=u)===c){a?1===a?v(t=function(t,e,n){var r=t;do{var i=r.prev,o=r.next.next}while(!l(i,o)&&h(i,r,r.next,o)&&w(i,o)&&w(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),f(r),f(r.next),r=t=o),r=r.next,r!==t);return m(r)}(m(t),e,n),e,n,r,i,o,2):2===a&&function(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&h(n,n.next,t,e))return!0}while(n=n.next,n!==t);return!1}(t,e)&&(w(t,e)&&w(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;for(;n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next,n!==t;);return r}(t,e)&&(x(t.prev,t,e.prev)||x(t,e.prev,e))||l(t,e)&&0<x(t.prev,t,t.next)&&0<x(e.prev,e,e.next))}(a,s)){var u=T(a,s);return a=m(a,a.next),u=m(u,u.next),v(a,e,n,r,i,o),v(u,e,n,r,i,o)}s=s.next}}while(a=a.next,a!==t)}(t,e,n,r,i,o):v(m(t),e,n,r,i,o,1);break}}}function g(t,e){return t.x-e.x}function b(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function _(t,e,n,r,i,o,a,s){return 0<=(i-a)*(e-s)-(t-a)*(o-s)&&0<=(t-a)*(r-s)-(n-a)*(e-s)&&0<=(n-a)*(o-s)-(i-a)*(r-s)}function x(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function l(t,e){return t.x===e.x&&t.y===e.y}function h(t,e,n,r){var i=c(x(t,e,n)),o=c(x(t,e,r)),a=c(x(n,r,t)),s=c(x(n,r,e));return i!==o&&a!==s||(0===i&&u(t,n,e)||(0===o&&u(t,r,e)||(0===a&&u(n,t,r)||!(0!==s||!u(n,e,r)))))}function u(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function c(t){return 0<t?1:t<0?-1:0}function w(t,e){return x(t.prev,t,t.next)<0?0<=x(t,e,t.next)&&0<=x(t,t.prev,e):x(t,e,t.prev)<0||x(t,t.next,e)<0}function T(t,e){var n=new a(t.i,t.x,t.y),r=new a(e.i,e.x,e.y),i=t.next,o=e.prev;return(t.next=e).prev=t,(n.next=i).prev=n,(r.next=n).prev=r,(o.next=r).prev=o,r}function s(t,e,n,r){n=new a(t,e,n);return r?(n.next=r.next,(n.prev=r).next.prev=n,r.next=n):(n.prev=n).next=n,n}function f(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function a(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function O(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}t.exports=r,(t.exports.default=r).deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(O(t,0,o,n));if(i)for(var s=0,u=e.length;s<u;s++){var c=e[s]*n,l=s<u-1?e[s+1]*n:t.length;a-=Math.abs(O(t,c,l,n))}for(var h=0,s=0;s<r.length;s+=3){var f=r[s]*n,p=r[s+1]*n,d=r[s+2]*n;h+=Math.abs((t[f]-t[d])*(t[1+p]-t[1+f])-(t[f]-t[p])*(t[1+d]-t[1+f]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);0<i&&(r+=t[i-1].length,n.holes.push(r))}return n}},function(e,t,n){e=function(a){"use strict";var u,t=Object.prototype,c=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",i=e.toStringTag||"@@toStringTag";function o(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{o({},"")}catch(t){o=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var i,o,a,s,e=e&&e.prototype instanceof m?e:m,e=Object.create(e.prototype),r=new S(r||[]);return e._invoke=(i=t,o=n,a=r,s=h,function(t,e){if(s===p)throw new Error("Generator is already running");if(s===d){if("throw"===t)throw e;return P()}for(a.method=t,a.arg=e;;){var n=a.delegate;if(n){var r=function t(e,n){var r=e.iterator[n.method];if(r===u){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=u,t(e,n),"throw"===n.method))return y;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var r=l(r,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,y;r=r.arg;if(!r)return n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y;{if(!r.done)return r;n[e.resultName]=r.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=u)}n.delegate=null;return y}(n,a);if(r){if(r===y)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(s===h)throw s=d,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s=p;r=l(i,o,a);if("normal"===r.type){if(s=a.done?d:f,r.arg!==y)return{value:r.arg,done:a.done}}else"throw"===r.type&&(s=d,a.method="throw",a.arg=r.arg)}}),e}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}a.wrap=s;var h="suspendedStart",f="suspendedYield",p="executing",d="completed",y={};function m(){}function v(){}function g(){}var b={};o(b,r,function(){return this});e=Object.getPrototypeOf,e=e&&e(e(E([])));e&&e!==t&&c.call(e,r)&&(b=e);var _=g.prototype=m.prototype=Object.create(b);function x(t){["next","throw","return"].forEach(function(e){o(t,e,function(t){return this._invoke(e,t)})})}function w(a,s){var e;this._invoke=function(n,r){function t(){return new s(function(t,e){!function e(t,n,r,i){t=l(a[t],a,n);if("throw"!==t.type){var o=t.arg;return(n=o.value)&&"object"==typeof n&&c.call(n,"__await")?s.resolve(n.__await).then(function(t){e("next",t,r,i)},function(t){e("throw",t,r,i)}):s.resolve(n).then(function(t){o.value=t,r(o)},function(t){return e("throw",t,r,i)})}i(t.arg)}(n,r,t,e)})}return e=e?e.then(t,t):t()}}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function E(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,t=function t(){for(;++n<e.length;)if(c.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=u,t.done=!0,t};return t.next=t}}return{next:P}}function P(){return{value:u,done:!0}}return o(_,"constructor",v.prototype=g),o(g,"constructor",v),v.displayName=o(g,i,"GeneratorFunction"),a.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,o(t,i,"GeneratorFunction")),t.prototype=Object.create(_),t},a.awrap=function(t){return{__await:t}},x(w.prototype),o(w.prototype,n,function(){return this}),a.AsyncIterator=w,a.async=function(t,e,n,r,i){void 0===i&&(i=Promise);var o=new w(s(t,e,n,r),i);return a.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},x(_),o(_,i,"Generator"),o(_,r,function(){return this}),o(_,"toString",function(){return"[object Generator]"}),a.keys=function(n){var t,r=[];for(t in n)r.push(t);return r.reverse(),function t(){for(;r.length;){var e=r.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},a.values=E,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&c.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function t(t,e){return o.type="throw",o.arg=n,r.next=t,e&&(r.method="next",r.arg=u),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var a=c.call(i,"catchLoc"),s=c.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&c.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}var o=(i=i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc?null:i)?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r,i=n.completion;return"throw"===i.type&&(r=i.arg,O(n)),r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:E(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=u),y}},a}(e.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}},function(t,p,d){"use strict";!function(e){var t=d(6),n=d(7),r=setTimeout;function u(t){return Boolean(t&&void 0!==t.length)}function i(){}function o(t){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(t,this)}function a(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,o._immediateFn(function(){var t,e=1===n._state?r.onFulfilled:r.onRejected;if(null!==e){try{t=e(n._value)}catch(t){return void c(r.promise,t)}s(r.promise,t)}else(1===n._state?s:c)(r.promise,n._value)})):n._deferreds.push(r)}function s(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return void f((r=n,i=t,function(){r.apply(i,arguments)}),e)}e._state=1,e._value=t,l(e)}catch(t){c(e,t)}var r,i}function c(t,e){t._state=2,t._value=e,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&o._immediateFn(function(){t._handled||o._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function h(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function f(t,e){var n=!1;try{t(function(t){n||(n=!0,s(e,t))},function(t){n||(n=!0,c(e,t))})}catch(t){if(n)return;n=!0,c(e,t)}}o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var n=new this.constructor(i);return a(this,new h(t,e,n)),n},o.prototype.finally=t.a,o.all=function(e){return new o(function(i,o){if(!u(e))return o(new TypeError("Promise.all accepts an array"));var a=Array.prototype.slice.call(e);if(0===a.length)return i([]);var s=a.length;for(var t=0;t<a.length;t++)!function e(n,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if("function"==typeof r)return void r.call(t,function(t){e(n,t)},o)}a[n]=t,0==--s&&i(a)}catch(t){o(t)}}(t,a[t])})},o.allSettled=n.a,o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===o?e:new o(function(t){t(e)})},o.reject=function(n){return new o(function(t,e){e(n)})},o.race=function(i){return new o(function(t,e){if(!u(i))return e(new TypeError("Promise.race accepts an array"));for(var n=0,r=i.length;n<r;n++)o.resolve(i[n]).then(t,e)})},o._immediateFn="function"==typeof e?function(t){e(t)}:function(t){r(t,0)},o._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},p.a=o}.call(this,d(9).setImmediate)},function(t,e,n){"use strict";e.a=function(e){var n=this.constructor;return this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){return n.reject(t)})})}},function(t,e,n){"use strict";e.a=function(n){return new this(function(i,t){if(!n||void 0===n.length)return t(new TypeError(typeof n+" "+n+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var o=Array.prototype.slice.call(n);if(0===o.length)return i([]);var a=o.length;for(var e=0;e<o.length;e++)!function e(n,t){if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if("function"==typeof r)return void r.call(t,function(t){e(n,t)},function(t){o[n]={status:"rejected",reason:t},0==--a&&i(o)})}o[n]={status:"fulfilled",value:t},0==--a&&i(o)}(e,o[e])})}},function(t,e,n){"use strict";var u=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},r)).join("")?void 0:1}catch(t){return}}()?Object.assign:function(t,e){for(var n,r=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),i=1;i<arguments.length;i++){for(var o in n=Object(arguments[i]))c.call(n,o)&&(r[o]=n[o]);if(u)for(var a=u(n),s=0;s<a.length;s++)l.call(n,a[s])&&(r[a[s]]=n[a[s]])}return r}},function(t,i,o){!function(t){var e=void 0!==t&&t||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function r(t,e){this._id=t,this._clearFn=e}i.setTimeout=function(){return new r(n.call(setTimeout,e,arguments),clearTimeout)},i.setInterval=function(){return new r(n.call(setInterval,e,arguments),clearInterval)},i.clearTimeout=i.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(e,this._id)},i.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},i.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},i._unrefActive=i.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},o(10),i.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,i.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}.call(this,o(1))},function(t,e,n){!function(t,p){!function(n,r){"use strict";var i,o,a,s,u,c,e,t;function l(t){delete o[t]}function h(t){if(a)setTimeout(h,0,t);else{var e=o[t];if(e){a=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(r,n)}}(e)}finally{l(t),a=!1}}}}function f(){function t(t){t.source===n&&"string"==typeof t.data&&0===t.data.indexOf(e)&&h(+t.data.slice(e.length))}var e="setImmediate$"+Math.random()+"$";n.addEventListener?n.addEventListener("message",t,!1):n.attachEvent("onmessage",t),u=function(t){n.postMessage(e+t,"*")}}n.setImmediate||(i=1,a=!(o={}),s=n.document,t=(t=Object.getPrototypeOf&&Object.getPrototypeOf(n))&&t.setTimeout?t:n,"[object process]"==={}.toString.call(n.process)?u=function(t){p.nextTick(function(){h(t)})}:!function(){if(n.postMessage&&!n.importScripts){var t=!0,e=n.onmessage;return n.onmessage=function(){t=!1},n.postMessage("","*"),n.onmessage=e,t}}()?u=n.MessageChannel?((e=new MessageChannel).port1.onmessage=function(t){h(t.data)},function(t){e.port2.postMessage(t)}):s&&"onreadystatechange"in s.createElement("script")?(c=s.documentElement,function(t){var e=s.createElement("script");e.onreadystatechange=function(){h(t),e.onreadystatechange=null,c.removeChild(e),e=null},c.appendChild(e)}):function(t){setTimeout(h,0,t)}:f(),t.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];return o[i]={callback:t,args:e},u(i),i++},t.clearImmediate=l)}("undefined"==typeof self?void 0===t?this:t:self)}.call(this,n(1),n(11))},function(t,e){var n,r,t=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var s,u=[],c=!1,l=-1;function h(){c&&s&&(c=!1,s.length?u=s.concat(u):l=-1,u.length&&f())}function f(){if(!c){var t=a(h);c=!0;for(var e=u.length;e;){for(s=u,u=[];++l<e;)s&&s[l].run();l=-1,e=u.length}s=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function d(){}t.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new p(t,e)),1!==u.length||c||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=d,t.addListener=d,t.once=d,t.off=d,t.removeListener=d,t.removeAllListeners=d,t.emit=d,t.prependListener=d,t.prependOnceListener=d,t.listeners=function(t){return[]},t.binding=function(t){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(t){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},function(t,E,P){!function(p,y){var S;!function(){E&&E.nodeType,p&&p.nodeType;var t="object"==typeof y&&y;t.global!==t&&t.window!==t&&t.self;var e,m=2147483647,v=36,g=26,i=38,o=700,n=/^xn--/,r=/[^\x20-\x7E]/,a=/[\x2E\u3002\uFF0E\uFF61]/g,s={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},u=v-1,b=Math.floor,_=String.fromCharCode;function x(t){throw new RangeError(s[t])}function c(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function l(t,e){var n=t.split("@"),r="";return 1<n.length&&(r=n[0]+"@",t=n[1]),r+c((t=t.replace(a,".")).split("."),e).join(".")}function w(t){for(var e,n,r=[],i=0,o=t.length;i<o;)55296<=(e=t.charCodeAt(i++))&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function d(t){return c(t,function(t){var e="";return 65535<t&&(e+=_((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=_(t)}).join("")}function T(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function O(t,e,n){var r=0;for(t=n?b(t/o):t>>1,t+=b(t/e);u*g>>1<t;r+=v)t=b(t/u);return b(r+(u+1)*t/(t+i))}function h(t){var e,n,r,i,o,a,s,u=[],c=t.length,l=0,h=128,f=72,p=t.lastIndexOf("-");for(p<0&&(p=0),n=0;n<p;++n)128<=t.charCodeAt(n)&&x("not-basic"),u.push(t.charCodeAt(n));for(r=0<p?p+1:0;r<c;){for(i=l,o=1,a=v;c<=r&&x("invalid-input"),s=t.charCodeAt(r++),(v<=(s=s-48<10?s-22:s-65<26?s-65:s-97<26?s-97:v)||s>b((m-l)/o))&&x("overflow"),l+=s*o,!(s<(s=a<=f?1:f+g<=a?g:a-f));a+=v)o>b(m/(s=v-s))&&x("overflow"),o*=s;f=O(l-i,e=u.length+1,0==i),b(l/e)>m-h&&x("overflow"),h+=b(l/e),l%=e,u.splice(l++,0,h)}return d(u)}function f(t){for(var e,n,r,i,o,a,s,u,c,l,h=[],f=(t=w(t)).length,p=128,d=72,y=e=0;y<f;++y)(s=t[y])<128&&h.push(_(s));for(n=r=h.length,r&&h.push("-");n<f;){for(i=m,y=0;y<f;++y)p<=(s=t[y])&&s<i&&(i=s);for(i-p>b((m-e)/(u=n+1))&&x("overflow"),e+=(i-p)*u,p=i,y=0;y<f;++y)if((s=t[y])<p&&++e>m&&x("overflow"),s==p){for(o=e,a=v;!(o<(c=a<=d?1:d+g<=a?g:a-d));a+=v)h.push(_(T(c+(l=o-c)%(c=v-c),0))),o=b(l/c);h.push(_(T(o,0))),d=O(e,u,n==r),e=0,++n}++e,++p}return h.join("")}e={version:"1.4.1",ucs2:{decode:w,encode:d},decode:h,encode:f,toASCII:function(t){return l(t,function(t){return r.test(t)?"xn--"+f(t):t})},toUnicode:function(t){return l(t,function(t){return n.test(t)?h(t.slice(4).toLowerCase()):t})}},void 0===(S=function(){return e}.call(E,P,E,p))||(p.exports=S)}()}.call(this,P(13)(t),P(1))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,n){"use strict";e.decode=e.parse=n(16),e.encode=e.stringify=n(17)},function(t,e,n){"use strict";t.exports=function(t,e,n,r){n=n||"=";var i={};if("string"!=typeof t||0===t.length)return i;var o=/\+/g;t=t.split(e=e||"&");e=1e3;r&&"number"==typeof r.maxKeys&&(e=r.maxKeys);var a=t.length;0<e&&e<a&&(a=e);for(var s=0;s<a;++s){var u,c=t[s].replace(o,"%20"),l=c.indexOf(n),l=0<=l?(u=c.substr(0,l),c.substr(l+1)):(u=c,""),c=decodeURIComponent(u),l=decodeURIComponent(l);Object.prototype.hasOwnProperty.call(i,c)?h(i[c])?i[c].push(l):i[c]=[i[c],l]:i[c]=l}return i};var h=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";function o(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}t.exports=function(n,r,i,t){return r=r||"&",i=i||"=","object"==typeof(n=null===n?void 0:n)?s(u(n),function(t){var e=encodeURIComponent(o(t))+i;return a(n[t])?s(n[t],function(t){return e+encodeURIComponent(o(t))}).join(r):e+encodeURIComponent(o(n[t]))}).join(r):t?encodeURIComponent(o(t))+i+encodeURIComponent(o(n)):""};var a=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function s(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var u=Object.keys||function(t){var e,n=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(e);return n}},function(t,e,n){"use strict";n.r(e),n.d(e,"Game",function(){return zI});var r={};n.r(r),n.d(r,"isMobile",function(){return V}),n.d(r,"EventEmitter",function(){return mt.a}),n.d(r,"earcut",function(){return gt.a}),n.d(r,"BaseTextureCache",function(){return $t}),n.d(r,"CanvasRenderTarget",function(){return ee}),n.d(r,"DATA_URI",function(){return oe}),n.d(r,"ProgramCache",function(){return Zt}),n.d(r,"TextureCache",function(){return Qt}),n.d(r,"clearTextureCache",function(){return te}),n.d(r,"correctBlendMode",function(){return Mt}),n.d(r,"createIndicesForQuads",function(){return Nt}),n.d(r,"decomposeDataUri",function(){return ae}),n.d(r,"deprecation",function(){return Kt}),n.d(r,"destroyTextureCache",function(){return Jt}),n.d(r,"determineCrossOrigin",function(){return se}),n.d(r,"getBufferType",function(){return Ft}),n.d(r,"getResolutionOfUrl",function(){return ue}),n.d(r,"hex2rgb",function(){return kt}),n.d(r,"hex2string",function(){return Rt}),n.d(r,"interleaveTypedArrays",function(){return Ut}),n.d(r,"isPow2",function(){return Xt}),n.d(r,"isWebGLSupported",function(){return Et}),n.d(r,"log2",function(){return Ht}),n.d(r,"nextPow2",function(){return Gt}),n.d(r,"premultiplyBlendMode",function(){return It}),n.d(r,"premultiplyRgba",function(){return jt}),n.d(r,"premultiplyTint",function(){return Dt}),n.d(r,"premultiplyTintToRgba",function(){return Lt}),n.d(r,"removeItems",function(){return zt}),n.d(r,"rgb2hex",function(){return Ct}),n.d(r,"sayHello",function(){return St}),n.d(r,"sign",function(){return Vt}),n.d(r,"skipHello",function(){return Ot}),n.d(r,"string2hex",function(){return At}),n.d(r,"trimCanvas",function(){return re}),n.d(r,"uid",function(){return Yt}),n.d(r,"url",function(){return _t});var T={};n.r(T),n.d(T,"utils",function(){return r}),n.d(T,"AccessibilityManager",function(){return en}),n.d(T,"accessibleTarget",function(){return Je}),n.d(T,"InteractionData",function(){return ln}),n.d(T,"InteractionEvent",function(){return pn}),n.d(T,"InteractionManager",function(){return On}),n.d(T,"InteractionTrackingData",function(){return yn}),n.d(T,"interactiveTarget",function(){return bn}),n.d(T,"Application",function(){return ka}),n.d(T,"AbstractBatchRenderer",function(){return pa}),n.d(T,"AbstractMultiResource",function(){return zn}),n.d(T,"AbstractRenderer",function(){return qo}),n.d(T,"ArrayResource",function(){return Yn}),n.d(T,"Attribute",function(){return Nr}),n.d(T,"BaseImageResource",function(){return Zn}),n.d(T,"BaseRenderTexture",function(){return Tr}),n.d(T,"BaseTexture",function(){return Gn}),n.d(T,"BatchDrawCall",function(){return sa}),n.d(T,"BatchGeometry",function(){return ga}),n.d(T,"BatchPluginFactory",function(){return wa}),n.d(T,"BatchRenderer",function(){return Oa}),n.d(T,"BatchShaderGenerator",function(){return ya}),n.d(T,"BatchSystem",function(){return hi}),n.d(T,"BatchTextureArray",function(){return ua}),n.d(T,"Buffer",function(){return Ur}),n.d(T,"BufferResource",function(){return Nn}),n.d(T,"CanvasResource",function(){return Jn}),n.d(T,"ContextSystem",function(){return di}),n.d(T,"CubeResource",function(){return nr}),n.d(T,"Filter",function(){return to}),n.d(T,"FilterState",function(){return ri}),n.d(T,"FilterSystem",function(){return si}),n.d(T,"Framebuffer",function(){return _r}),n.d(T,"FramebufferSystem",function(){return gi}),n.d(T,"GLFramebuffer",function(){return mi}),n.d(T,"GLProgram",function(){return Co}),n.d(T,"GLTexture",function(){return Xo}),n.d(T,"Geometry",function(){return Wr}),n.d(T,"GeometrySystem",function(){return xi}),n.d(T,"IGLUniformData",function(){return Ao}),n.d(T,"INSTALLED",function(){return Rn}),n.d(T,"ImageBitmapResource",function(){return dr}),n.d(T,"ImageResource",function(){return or}),n.d(T,"MaskData",function(){return Ti}),n.d(T,"MaskSystem",function(){return uo}),n.d(T,"ObjectRenderer",function(){return ci}),n.d(T,"Program",function(){return Yi}),n.d(T,"ProjectionSystem",function(){return go}),n.d(T,"Quad",function(){return Kr}),n.d(T,"QuadUv",function(){return $r}),n.d(T,"RenderTexture",function(){return Mr}),n.d(T,"RenderTexturePool",function(){return Dr}),n.d(T,"RenderTextureSystem",function(){return wo}),n.d(T,"Renderer",function(){return ta}),n.d(T,"Resource",function(){return jn}),n.d(T,"SVGResource",function(){return ur}),n.d(T,"ScissorSystem",function(){return fo}),n.d(T,"Shader",function(){return Ki}),n.d(T,"ShaderSystem",function(){return Lo}),n.d(T,"SpriteMaskFilter",function(){return ao}),n.d(T,"State",function(){return Qi}),n.d(T,"StateSystem",function(){return Fo}),n.d(T,"StencilSystem",function(){return mo}),n.d(T,"System",function(){return oa}),n.d(T,"Texture",function(){return Rr}),n.d(T,"TextureGCSystem",function(){return Uo}),n.d(T,"TextureMatrix",function(){return ro}),n.d(T,"TextureSystem",function(){return Ho}),n.d(T,"TextureUvs",function(){return Sr}),n.d(T,"UniformGroup",function(){return ei}),n.d(T,"VideoResource",function(){return hr}),n.d(T,"ViewableBuffer",function(){return la}),n.d(T,"autoDetectRenderer",function(){return na}),n.d(T,"autoDetectResource",function(){return An}),n.d(T,"checkMaxIfStatementsInShader",function(){return zi}),n.d(T,"createUBOElements",function(){return Po}),n.d(T,"defaultFilterVertex",function(){return ia}),n.d(T,"defaultVertex",function(){return ra}),n.d(T,"generateProgram",function(){return Mo}),n.d(T,"generateUniformBufferSync",function(){return Ro}),n.d(T,"getTestContext",function(){return Ii}),n.d(T,"getUBOData",function(){return ko}),n.d(T,"resources",function(){return Sa}),n.d(T,"systems",function(){return Pa}),n.d(T,"uniformParsers",function(){return Bi}),n.d(T,"Extract",function(){return Ia}),n.d(T,"AppLoaderPlugin",function(){return ts}),n.d(T,"Loader",function(){return $a}),n.d(T,"LoaderResource",function(){return Va}),n.d(T,"TextureLoader",function(){return ns}),n.d(T,"BlobResource",function(){return fs}),n.d(T,"CompressedTextureLoader",function(){return vs}),n.d(T,"CompressedTextureResource",function(){return ys}),n.d(T,"DDSLoader",function(){return Is}),n.d(T,"FORMATS_TO_COMPONENTS",function(){return Ys}),n.d(T,"INTERNAL_FORMATS",function(){return os}),n.d(T,"INTERNAL_FORMAT_TO_BYTES_PER_PIXEL",function(){return ss}),n.d(T,"KTXLoader",function(){return Ks}),n.d(T,"TYPES_TO_BYTES_PER_COMPONENT",function(){return Ws}),n.d(T,"TYPES_TO_BYTES_PER_PIXEL",function(){return qs}),n.d(T,"ParticleContainer",function(){return tu}),n.d(T,"ParticleRenderer",function(){return su}),n.d(T,"BasePrepare",function(){return Cc}),n.d(T,"CountLimiter",function(){return wc}),n.d(T,"Prepare",function(){return Bc}),n.d(T,"TimeLimiter",function(){return Xc}),n.d(T,"Spritesheet",function(){return zc}),n.d(T,"SpritesheetLoader",function(){return Wc}),n.d(T,"TilingSprite",function(){return $c}),n.d(T,"TilingSpriteRenderer",function(){return rl}),n.d(T,"BitmapFont",function(){return Rl}),n.d(T,"BitmapFontData",function(){return xl}),n.d(T,"BitmapFontLoader",function(){return Bl}),n.d(T,"BitmapText",function(){return Ll}),n.d(T,"Ticker",function(){return an}),n.d(T,"TickerPlugin",function(){return un}),n.d(T,"UPDATE_PRIORITY",function(){return tn}),n.d(T,"ALPHA_MODES",function(){return st}),n.d(T,"BLEND_MODES",function(){return $}),n.d(T,"BUFFER_BITS",function(){return Q}),n.d(T,"BUFFER_TYPE",function(){return pt}),n.d(T,"CLEAR_MODES",function(){return ut}),n.d(T,"DRAW_MODES",function(){return J}),n.d(T,"ENV",function(){return K}),n.d(T,"FORMATS",function(){return tt}),n.d(T,"GC_MODES",function(){return ct}),n.d(T,"MASK_TYPES",function(){return ht}),n.d(T,"MIPMAP_MODES",function(){return at}),n.d(T,"MSAA_QUALITY",function(){return ft}),n.d(T,"PRECISION",function(){return lt}),n.d(T,"RENDERER_TYPE",function(){return Z}),n.d(T,"SAMPLER_TYPES",function(){return rt}),n.d(T,"SCALE_MODES",function(){return it}),n.d(T,"TARGETS",function(){return et}),n.d(T,"TYPES",function(){return nt}),n.d(T,"WRAP_MODES",function(){return ot}),n.d(T,"Bounds",function(){return Be}),n.d(T,"Container",function(){return Qe}),n.d(T,"DisplayObject",function(){return ze}),n.d(T,"TemporaryDisplayObject",function(){return Ye}),n.d(T,"FillStyle",function(){return lu}),n.d(T,"GRAPHICS_CURVES",function(){return cu}),n.d(T,"Graphics",function(){return Vu}),n.d(T,"GraphicsData",function(){return Iu}),n.d(T,"GraphicsGeometry",function(){return Nu}),n.d(T,"LINE_CAP",function(){return au}),n.d(T,"LINE_JOIN",function(){return ou}),n.d(T,"LineStyle",function(){return Uu}),n.d(T,"graphicsUtils",function(){return Yu}),n.d(T,"Circle",function(){return ye}),n.d(T,"DEG_TO_RAD",function(){return fe}),n.d(T,"Ellipse",function(){return ve}),n.d(T,"Matrix",function(){return Pe}),n.d(T,"ObservablePoint",function(){return Se}),n.d(T,"PI_2",function(){return le}),n.d(T,"Point",function(){return Te}),n.d(T,"Polygon",function(){return be}),n.d(T,"RAD_TO_DEG",function(){return he}),n.d(T,"Rectangle",function(){return pe}),n.d(T,"RoundedRectangle",function(){return xe}),n.d(T,"SHAPES",function(){return ce}),n.d(T,"Transform",function(){return Ne}),n.d(T,"groupD8",function(){return Le}),n.d(T,"Mesh",function(){return fl}),n.d(T,"MeshBatchUvs",function(){return sl}),n.d(T,"MeshGeometry",function(){return gl}),n.d(T,"MeshMaterial",function(){return yl}),n.d(T,"NineSlicePlane",function(){return Mf}),n.d(T,"PlaneGeometry",function(){return gf}),n.d(T,"RopeGeometry",function(){return xf}),n.d(T,"SimpleMesh",function(){return Af}),n.d(T,"SimplePlane",function(){return Pf}),n.d(T,"SimpleRope",function(){return Of}),n.d(T,"Runner",function(){return Pn}),n.d(T,"Sprite",function(){return tc}),n.d(T,"AnimatedSprite",function(){return Bf}),n.d(T,"TEXT_GRADIENT",function(){return rc}),n.d(T,"Text",function(){return gc}),n.d(T,"TextMetrics",function(){return fc}),n.d(T,"TextStyle",function(){return sc}),n.d(T,"isMobile",function(){return V}),n.d(T,"settings",function(){return dt}),n.d(T,"VERSION",function(){return Xf}),n.d(T,"filters",function(){return Hf});var f={};n.r(f),n.d(f,"AdjustmentFilter",function(){return qf}),n.d(f,"AdvancedBloomFilter",function(){return hp}),n.d(f,"AsciiFilter",function(){return vp}),n.d(f,"BevelFilter",function(){return Op}),n.d(f,"BloomFilter",function(){return Cp}),n.d(f,"BulgePinchFilter",function(){return Fp}),n.d(f,"ColorMapFilter",function(){return Vp}),n.d(f,"ColorOverlayFilter",function(){return $p}),n.d(f,"ColorReplaceFilter",function(){return od}),n.d(f,"ConvolutionFilter",function(){return fd}),n.d(f,"CrossHatchFilter",function(){return bd}),n.d(f,"CRTFilter",function(){return Ed}),n.d(f,"DotFilter",function(){return Md}),n.d(f,"DropShadowFilter",function(){return Gd}),n.d(f,"EmbossFilter",function(){return qd}),n.d(f,"GlitchFilter",function(){return ey}),n.d(f,"GlowFilter",function(){return uy}),n.d(f,"GodrayFilter",function(){return yy}),n.d(f,"KawaseBlurFilter",function(){return ep}),n.d(f,"MotionBlurFilter",function(){return wy}),n.d(f,"MultiColorReplaceFilter",function(){return Ry}),n.d(f,"OldFilmFilter",function(){return Ly}),n.d(f,"OutlineFilter",function(){return Hy}),n.d(f,"PixelateFilter",function(){return Zy}),n.d(f,"RadialBlurFilter",function(){return r0}),n.d(f,"ReflectionFilter",function(){return l0}),n.d(f,"RGBSplitFilter",function(){return v0}),n.d(f,"ShockwaveFilter",function(){return O0}),n.d(f,"SimpleLightmapFilter",function(){return C0}),n.d(f,"TiltShiftAxisFilter",function(){return N0}),n.d(f,"TiltShiftFilter",function(){return W0}),n.d(f,"TiltShiftXFilter",function(){return U0}),n.d(f,"TiltShiftYFilter",function(){return H0}),n.d(f,"TwistFilter",function(){return $0}),n.d(f,"ZoomBlurFilter",function(){return o1});var i={};n.r(i),n.d(i,"BurnAway",function(){return Xv}),n.d(i,"LightnessGate",function(){return zv}),n.d(i,"TileSpotlight",function(){return qv}),n.d(i,"Whitemask",function(){return Uv});var o=n(5),e=n(8),e=n.n(e);self.Promise||(self.Promise=o.a),Object.assign||(Object.assign=e.a);var a;Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),self.performance&&self.performance.now||(a=Date.now(),self.performance||(self.performance={}),self.performance.now=function(){return Date.now()-a});for(var s=Date.now(),u=["ms","moz","webkit","o"],c=0;c<u.length&&!self.requestAnimationFrame;++c){var l=u[c];self.requestAnimationFrame=self[l+"RequestAnimationFrame"],self.cancelAnimationFrame=self[l+"CancelAnimationFrame"]||self[l+"CancelRequestAnimationFrame"]}self.requestAnimationFrame||(self.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),n=16+s-e;return n<0&&(n=0),s=e,self.setTimeout(function(){s=Date.now(),t(performance.now())},n)}),self.cancelAnimationFrame||(self.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:0<t?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),self.ArrayBuffer||(self.ArrayBuffer=Array),self.Float32Array||(self.Float32Array=Array),self.Uint32Array||(self.Uint32Array=Array),self.Uint16Array||(self.Uint16Array=Array),self.Uint8Array||(self.Uint8Array=Array),self.Int32Array||(self.Int32Array=Array);function h(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&1<t.maxTouchPoints&&"undefined"==typeof MSStream}var p=/iPhone/i,d=/iPod/i,y=/iPad/i,m=/\biOS-universal(?:.+)Mac\b/i,v=/\bAndroid(?:.+)Mobile\b/i,g=/Android/i,b=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,_=/Silk/i,x=/Windows Phone/i,w=/\bWindows(?:.+)ARM\b/i,O=/BlackBerry/i,S=/BB10/i,E=/Opera Mini/i,P=/\b(CriOS|Chrome)(?:.+)Mobile/i,k=/Mobile(?:.+)Firefox\b/i;var R,A,C,I,M,j,D,L,N,F,B,U,G,X,H,z,V=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n,r=e.userAgent;return void 0!==(t=(r=void 0!==(t=r.split("[FBAN"))[1]?t[0]:r).split("Twitter"))[1]&&(r=t[0]),(r={apple:{phone:(r=(n=r,function(t){return t.test(n)}))(p)&&!r(x),ipod:r(d),tablet:!r(p)&&(r(y)||h(e))&&!r(x),universal:r(m),device:(r(p)||r(d)||r(y)||r(m)||h(e))&&!r(x)},amazon:{phone:r(b),tablet:!r(b)&&r(_),device:r(b)||r(_)},android:{phone:!r(x)&&r(b)||!r(x)&&r(v),tablet:!r(x)&&!r(b)&&!r(v)&&(r(_)||r(g)),device:!r(x)&&(r(b)||r(_)||r(v)||r(g))||r(/\bokhttp\b/i)},windows:{phone:r(x),tablet:r(w),device:r(x)||r(w)},other:{blackberry:r(O),blackberry10:r(S),opera:r(E),firefox:r(k),chrome:r(P),device:r(O)||r(S)||r(E)||r(k)||r(P)},any:!1,phone:!1,tablet:!1}).any=r.apple.device||r.android.device||r.windows.device||r.other.device,r.phone=r.apple.phone||r.android.phone||r.windows.phone,r.tablet=r.apple.tablet||r.android.tablet||r.windows.tablet,r}(self.navigator);(R=R=R||{})[R.WEBGL_LEGACY=0]="WEBGL_LEGACY",R[R.WEBGL=1]="WEBGL",R[R.WEBGL2=2]="WEBGL2",(A=A=A||{})[A.UNKNOWN=0]="UNKNOWN",A[A.WEBGL=1]="WEBGL",A[A.CANVAS=2]="CANVAS",(C=C=C||{})[C.COLOR=16384]="COLOR",C[C.DEPTH=256]="DEPTH",C[C.STENCIL=1024]="STENCIL",(I=I=I||{})[I.NORMAL=0]="NORMAL",I[I.ADD=1]="ADD",I[I.MULTIPLY=2]="MULTIPLY",I[I.SCREEN=3]="SCREEN",I[I.OVERLAY=4]="OVERLAY",I[I.DARKEN=5]="DARKEN",I[I.LIGHTEN=6]="LIGHTEN",I[I.COLOR_DODGE=7]="COLOR_DODGE",I[I.COLOR_BURN=8]="COLOR_BURN",I[I.HARD_LIGHT=9]="HARD_LIGHT",I[I.SOFT_LIGHT=10]="SOFT_LIGHT",I[I.DIFFERENCE=11]="DIFFERENCE",I[I.EXCLUSION=12]="EXCLUSION",I[I.HUE=13]="HUE",I[I.SATURATION=14]="SATURATION",I[I.COLOR=15]="COLOR",I[I.LUMINOSITY=16]="LUMINOSITY",I[I.NORMAL_NPM=17]="NORMAL_NPM",I[I.ADD_NPM=18]="ADD_NPM",I[I.SCREEN_NPM=19]="SCREEN_NPM",I[I.NONE=20]="NONE",I[I.SRC_OVER=0]="SRC_OVER",I[I.SRC_IN=21]="SRC_IN",I[I.SRC_OUT=22]="SRC_OUT",I[I.SRC_ATOP=23]="SRC_ATOP",I[I.DST_OVER=24]="DST_OVER",I[I.DST_IN=25]="DST_IN",I[I.DST_OUT=26]="DST_OUT",I[I.DST_ATOP=27]="DST_ATOP",I[I.ERASE=26]="ERASE",I[I.SUBTRACT=28]="SUBTRACT",I[I.XOR=29]="XOR",(M=M=M||{})[M.POINTS=0]="POINTS",M[M.LINES=1]="LINES",M[M.LINE_LOOP=2]="LINE_LOOP",M[M.LINE_STRIP=3]="LINE_STRIP",M[M.TRIANGLES=4]="TRIANGLES",M[M.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",M[M.TRIANGLE_FAN=6]="TRIANGLE_FAN",(j=j=j||{})[j.RGBA=6408]="RGBA",j[j.RGB=6407]="RGB",j[j.RG=33319]="RG",j[j.RED=6403]="RED",j[j.RGBA_INTEGER=36249]="RGBA_INTEGER",j[j.RGB_INTEGER=36248]="RGB_INTEGER",j[j.RG_INTEGER=33320]="RG_INTEGER",j[j.RED_INTEGER=36244]="RED_INTEGER",j[j.ALPHA=6406]="ALPHA",j[j.LUMINANCE=6409]="LUMINANCE",j[j.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",j[j.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",j[j.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(D=D=D||{})[D.TEXTURE_2D=3553]="TEXTURE_2D",D[D.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",D[D.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",D[D.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",D[D.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",D[D.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",D[D.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",D[D.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",D[D.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(L=L=L||{})[L.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",L[L.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",L[L.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",L[L.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",L[L.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",L[L.UNSIGNED_INT=5125]="UNSIGNED_INT",L[L.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",L[L.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",L[L.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",L[L.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",L[L.BYTE=5120]="BYTE",L[L.SHORT=5122]="SHORT",L[L.INT=5124]="INT",L[L.FLOAT=5126]="FLOAT",L[L.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",L[L.HALF_FLOAT=36193]="HALF_FLOAT",(F=F=F||{})[F.FLOAT=0]="FLOAT",F[F.INT=1]="INT",F[F.UINT=2]="UINT",(F=vt=vt||{})[F.NEAREST=0]="NEAREST",F[F.LINEAR=1]="LINEAR",(F=yt=yt||{})[F.CLAMP=33071]="CLAMP",F[F.REPEAT=10497]="REPEAT",F[F.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(F=N=N||{})[F.OFF=0]="OFF",F[F.POW2=1]="POW2",F[F.ON=2]="ON",F[F.ON_MANUAL=3]="ON_MANUAL",(B=B=B||{})[B.NPM=0]="NPM",B[B.UNPACK=1]="UNPACK",B[B.PMA=2]="PMA",B[B.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",B[B.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",B[B.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(G=G=G||{})[G.NO=0]="NO",G[G.YES=1]="YES",G[G.AUTO=2]="AUTO",G[G.BLEND=0]="BLEND",G[G.CLEAR=1]="CLEAR",G[G.BLIT=2]="BLIT",(G=U=U||{})[G.AUTO=0]="AUTO",G[G.MANUAL=1]="MANUAL",(G=bt=bt||{}).LOW="lowp",G.MEDIUM="mediump",G.HIGH="highp",(H=H=H||{})[H.NONE=0]="NONE",H[H.SCISSOR=1]="SCISSOR",H[H.STENCIL=2]="STENCIL",H[H.SPRITE=3]="SPRITE",(H=X=X||{})[H.NONE=0]="NONE",H[H.LOW=2]="LOW",H[H.MEDIUM=4]="MEDIUM",H[H.HIGH=8]="HIGH",(z=z=z||{})[z.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",z[z.ARRAY_BUFFER=34962]="ARRAY_BUFFER",z[z.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER";var W,Y,q,K,Z,Q,$,J,tt,et,nt,rt,it,ot,at,st,ut,ct,lt,ht,ft,pt,dt={MIPMAP_TEXTURES:N.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:X.NONE,SPRITE_MAX_TEXTURES:(W=32,q=!0,(V.tablet||V.phone)&&(V.apple.device&&(Y=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(Y[1],10)<11&&(q=!1),V.android.device&&(Y=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(Y[1],10)<7&&(q=!1)),q?W:4),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:U.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:yt.CLAMP,SCALE_MODE:vt.LINEAR,PRECISION_VERTEX:bt.HIGH,PRECISION_FRAGMENT:V.apple.device?bt.HIGH:bt.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!V.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},yt=n(2),mt=n.n(yt),vt=n(3),gt=n.n(vt),bt=n(0);(yt=K=K||{})[yt.WEBGL_LEGACY=0]="WEBGL_LEGACY",yt[yt.WEBGL=1]="WEBGL",yt[yt.WEBGL2=2]="WEBGL2",(vt=Z=Z||{})[vt.UNKNOWN=0]="UNKNOWN",vt[vt.WEBGL=1]="WEBGL",vt[vt.CANVAS=2]="CANVAS",(yt=Q=Q||{})[yt.COLOR=16384]="COLOR",yt[yt.DEPTH=256]="DEPTH",yt[yt.STENCIL=1024]="STENCIL",(vt=$=$||{})[vt.NORMAL=0]="NORMAL",vt[vt.ADD=1]="ADD",vt[vt.MULTIPLY=2]="MULTIPLY",vt[vt.SCREEN=3]="SCREEN",vt[vt.OVERLAY=4]="OVERLAY",vt[vt.DARKEN=5]="DARKEN",vt[vt.LIGHTEN=6]="LIGHTEN",vt[vt.COLOR_DODGE=7]="COLOR_DODGE",vt[vt.COLOR_BURN=8]="COLOR_BURN",vt[vt.HARD_LIGHT=9]="HARD_LIGHT",vt[vt.SOFT_LIGHT=10]="SOFT_LIGHT",vt[vt.DIFFERENCE=11]="DIFFERENCE",vt[vt.EXCLUSION=12]="EXCLUSION",vt[vt.HUE=13]="HUE",vt[vt.SATURATION=14]="SATURATION",vt[vt.COLOR=15]="COLOR",vt[vt.LUMINOSITY=16]="LUMINOSITY",vt[vt.NORMAL_NPM=17]="NORMAL_NPM",vt[vt.ADD_NPM=18]="ADD_NPM",vt[vt.SCREEN_NPM=19]="SCREEN_NPM",vt[vt.NONE=20]="NONE",vt[vt.SRC_OVER=0]="SRC_OVER",vt[vt.SRC_IN=21]="SRC_IN",vt[vt.SRC_OUT=22]="SRC_OUT",vt[vt.SRC_ATOP=23]="SRC_ATOP",vt[vt.DST_OVER=24]="DST_OVER",vt[vt.DST_IN=25]="DST_IN",vt[vt.DST_OUT=26]="DST_OUT",vt[vt.DST_ATOP=27]="DST_ATOP",vt[vt.ERASE=26]="ERASE",vt[vt.SUBTRACT=28]="SUBTRACT",vt[vt.XOR=29]="XOR",(yt=J=J||{})[yt.POINTS=0]="POINTS",yt[yt.LINES=1]="LINES",yt[yt.LINE_LOOP=2]="LINE_LOOP",yt[yt.LINE_STRIP=3]="LINE_STRIP",yt[yt.TRIANGLES=4]="TRIANGLES",yt[yt.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",yt[yt.TRIANGLE_FAN=6]="TRIANGLE_FAN",(vt=tt=tt||{})[vt.RGBA=6408]="RGBA",vt[vt.RGB=6407]="RGB",vt[vt.RG=33319]="RG",vt[vt.RED=6403]="RED",vt[vt.RGBA_INTEGER=36249]="RGBA_INTEGER",vt[vt.RGB_INTEGER=36248]="RGB_INTEGER",vt[vt.RG_INTEGER=33320]="RG_INTEGER",vt[vt.RED_INTEGER=36244]="RED_INTEGER",vt[vt.ALPHA=6406]="ALPHA",vt[vt.LUMINANCE=6409]="LUMINANCE",vt[vt.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",vt[vt.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",vt[vt.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(yt=et=et||{})[yt.TEXTURE_2D=3553]="TEXTURE_2D",yt[yt.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",yt[yt.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",yt[yt.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",yt[yt.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",yt[yt.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",yt[yt.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",yt[yt.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",yt[yt.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(vt=nt=nt||{})[vt.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",vt[vt.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",vt[vt.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",vt[vt.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",vt[vt.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",vt[vt.UNSIGNED_INT=5125]="UNSIGNED_INT",vt[vt.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",vt[vt.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",vt[vt.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",vt[vt.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",vt[vt.BYTE=5120]="BYTE",vt[vt.SHORT=5122]="SHORT",vt[vt.INT=5124]="INT",vt[vt.FLOAT=5126]="FLOAT",vt[vt.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",vt[vt.HALF_FLOAT=36193]="HALF_FLOAT",(yt=rt=rt||{})[yt.FLOAT=0]="FLOAT",yt[yt.INT=1]="INT",yt[yt.UINT=2]="UINT",(vt=it=it||{})[vt.NEAREST=0]="NEAREST",vt[vt.LINEAR=1]="LINEAR",(yt=ot=ot||{})[yt.CLAMP=33071]="CLAMP",yt[yt.REPEAT=10497]="REPEAT",yt[yt.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(vt=at=at||{})[vt.OFF=0]="OFF",vt[vt.POW2=1]="POW2",vt[vt.ON=2]="ON",vt[vt.ON_MANUAL=3]="ON_MANUAL",(yt=st=st||{})[yt.NPM=0]="NPM",yt[yt.UNPACK=1]="UNPACK",yt[yt.PMA=2]="PMA",yt[yt.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",yt[yt.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",yt[yt.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(vt=ut=ut||{})[vt.NO=0]="NO",vt[vt.YES=1]="YES",vt[vt.AUTO=2]="AUTO",vt[vt.BLEND=0]="BLEND",vt[vt.CLEAR=1]="CLEAR",vt[vt.BLIT=2]="BLIT",(yt=ct=ct||{})[yt.AUTO=0]="AUTO",yt[yt.MANUAL=1]="MANUAL",(vt=lt=lt||{}).LOW="lowp",vt.MEDIUM="mediump",vt.HIGH="highp",(yt=ht=ht||{})[yt.NONE=0]="NONE",yt[yt.SCISSOR=1]="SCISSOR",yt[yt.STENCIL=2]="STENCIL",yt[yt.SPRITE=3]="SPRITE",(vt=ft=ft||{})[vt.NONE=0]="NONE",vt[vt.LOW=2]="LOW",vt[vt.MEDIUM=4]="MEDIUM",vt[vt.HIGH=8]="HIGH",(yt=pt=pt||{})[yt.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",yt[yt.ARRAY_BUFFER=34962]="ARRAY_BUFFER",yt[yt.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER";var _t={parse:bt.parse,format:bt.format,resolve:bt.resolve};dt.RETINA_PREFIX=/@([0-9\.]+)x/;var xt,wt=dt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1,Tt="6.1.3";function Ot(){wt=!0}function St(t){var e;wt||(-1<navigator.userAgent.toLowerCase().indexOf("chrome")?(e=self.console).log.apply(e,["\n %c %c %c PixiJS "+Tt+" -  "+t+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"]):self.console&&self.console.log("PixiJS "+Tt+" - "+t+" - http://www.pixijs.com/"),wt=!0)}function Et(){return xt=void 0===xt?function(){var t={stencil:!0,failIfMajorPerformanceCaveat:dt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!self.WebGLRenderingContext)return!1;var e,n=document.createElement("canvas"),r=n.getContext("webgl",t)||n.getContext("experimental-webgl",t),i=!(!r||!r.getContextAttributes().stencil);return!r||(e=r.getExtension("WEBGL_lose_context"))&&e.loseContext(),r=null,i}catch(t){return!1}}():xt}var Pt={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function kt(t,e){return(e=void 0===e?[]:e)[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function Rt(t){t=t.toString(16);return"#"+(t="000000".substr(0,6-t.length)+t)}function At(t){return"string"==typeof t&&"#"===(t=Pt[t.toLowerCase()]||t)[0]&&(t=t.substr(1)),parseInt(t,16)}function Ct(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)}var It=function(){for(var t=[],e=[],n=0;n<32;n++)e[t[n]=n]=n;t[$.NORMAL_NPM]=$.NORMAL,t[$.ADD_NPM]=$.ADD,t[$.SCREEN_NPM]=$.SCREEN,e[$.NORMAL]=$.NORMAL_NPM,e[$.ADD]=$.ADD_NPM,e[$.SCREEN]=$.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function Mt(t,e){return It[e?1:0][t]}function jt(t,e,n,r){return n=n||new Float32Array(4),r||void 0===r?(n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e):(n[0]=t[0],n[1]=t[1],n[2]=t[2]),n[3]=e,n}function Dt(t,e){return 1===e?(255*e<<24)+t:0===e?0:(255*e<<24)+(((t>>16&255)*e+.5|0)<<16)+(((t>>8&255)*e+.5|0)<<8)+((255&t)*e+.5|0)}function Lt(t,e,n,r){return(n=n||new Float32Array(4))[0]=(t>>16&255)/255,n[1]=(t>>8&255)/255,n[2]=(255&t)/255,!r&&void 0!==r||(n[0]*=e,n[1]*=e,n[2]*=e),n[3]=e,n}function Nt(t,e){var n=6*t;if((e=(e=void 0===e?null:e)||new Uint16Array(n)).length!==n)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+n);for(var r=0,i=0;r<n;r+=6,i+=4)e[r+0]=i+0,e[r+1]=i+1,e[r+2]=i+2,e[r+3]=i+0,e[r+4]=i+2,e[r+5]=i+3;return e}function Ft(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}var Bt={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Ut(t,e){for(var n=0,r=0,i={},o=0;o<t.length;o++)r+=e[o],n+=t[o].length;for(var a=new ArrayBuffer(4*n),s=null,u=0,o=0;o<t.length;o++){var c=e[o],l=t[o],h=Ft(l);i[h]||(i[h]=new Bt[h](a));for(var s=i[h],f=0;f<l.length;f++)s[(f/c|0)*r+u+f%c]=l[f];u+=c}return new Float32Array(a)}function Gt(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function Xt(t){return!(t&t-1||!t)}function Ht(t){var e=(65535<t?1:0)<<4,n=(255<(t>>>=e)?1:0)<<3;return e|=n,e|=n=(15<(t>>>=n)?1:0)<<2,(e|=n=(3<(t>>>=n)?1:0)<<1)|(t>>>=n)>>1}function zt(t,e,n){var r=t.length;if(!(r<=e||0===n)){for(var i=r-(n=r<e+n?r-e:n),o=e;o<i;++o)t[o]=t[o+n];t.length=i}}function Vt(t){return 0===t?0:t<0?-1:1}var Wt=0;function Yt(){return++Wt}var qt={};function Kt(t,e,n){var r;void 0===n&&(n=3),qt[e]||(void 0===(r=(new Error).stack)?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(r=r.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(r))),qt[e]=!0)}var Zt={},Qt=Object.create(null),$t=Object.create(null);function Jt(){for(var t in Qt)Qt[t].destroy();for(t in $t)$t[t].destroy()}function te(){for(var t in Qt)delete Qt[t];for(t in $t)delete $t[t]}var ee=(ne.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},ne.prototype.resize=function(t,e){this.canvas.width=Math.round(t*this.resolution),this.canvas.height=Math.round(e*this.resolution)},ne.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(ne.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=Math.round(t)},enumerable:!1,configurable:!0}),Object.defineProperty(ne.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=Math.round(t)},enumerable:!1,configurable:!0}),ne);function ne(t,e,n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=n||dt.RESOLUTION,this.resize(t,e)}function re(t){for(var e,n,r=t.width,i=t.height,o=t.getContext("2d"),a=o.getImageData(0,0,r,i).data,s=a.length,u={top:null,left:null,right:null,bottom:null},t=null,c=0;c<s;c+=4)0!==a[c+3]&&(e=c/4%r,n=~~(c/4/r),null===u.top&&(u.top=n),(null===u.left||e<u.left)&&(u.left=e),(null===u.right||u.right<e)&&(u.right=1+e),(null===u.bottom||u.bottom<n)&&(u.bottom=n));return null!==u.top&&(r=u.right-u.left,i=u.bottom-u.top+1,t=o.getImageData(u.left,u.top,r,i)),{height:i,width:r,data:t}}var ie,oe=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function ae(t){t=oe.exec(t);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}function se(t,e){if(void 0===e&&(e=self.location),0===t.indexOf("data:"))return"";e=e||self.location,(ie=ie||document.createElement("a")).href=t;var n=_t.parse(ie.href),t=!n.port&&""===e.port||n.port===e.port;return n.hostname===e.hostname&&t&&n.protocol===e.protocol?"":"anonymous"}function ue(t,e){t=dt.RETINA_PREFIX.exec(t);return t?parseFloat(t[1]):void 0!==e?e:1}var ce,le=2*Math.PI,he=180/Math.PI,fe=Math.PI/180;(vt=ce=ce||{})[vt.POLY=0]="POLY",vt[vt.RECT=1]="RECT",vt[vt.CIRC=2]="CIRC",vt[vt.ELIP=3]="ELIP",vt[vt.RREC=4]="RREC";var pe=(Object.defineProperty(de.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(de.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(de.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(de.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(de,"EMPTY",{get:function(){return new de(0,0,0,0)},enumerable:!1,configurable:!0}),de.prototype.clone=function(){return new de(this.x,this.y,this.width,this.height)},de.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},de.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},de.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},de.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},de.prototype.fit=function(t){var e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),t=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=r,this.height=Math.max(t-r,0),this},de.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var n=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=r-this.y,this},de.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),t=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=r,this.height=t-r,this},de.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},de);function de(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(r),this.type=ce.RECT}var ye=(me.prototype.clone=function(){return new me(this.x,this.y,this.radius)},me.prototype.contains=function(t,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,t=this.x-t,e=this.y-e;return(t*=t)+(e*=e)<=n},me.prototype.getBounds=function(){return new pe(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},me.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},me);function me(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0),this.x=t=void 0===t?0:t,this.y=e,this.radius=n,this.type=ce.CIRC}var ve=(ge.prototype.clone=function(){return new ge(this.x,this.y,this.width,this.height)},ge.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;t=(t-this.x)/this.width,e=(e-this.y)/this.height;return(t*=t)+(e*=e)<=1},ge.prototype.getBounds=function(){return new pe(this.x-this.width,this.y-this.height,this.width,this.height)},ge.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},ge);function ge(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.x=t=void 0===t?0:t,this.y=e,this.width=n,this.height=r,this.type=ce.ELIP}var be=(_e.prototype.clone=function(){var t=new _e(this.points.slice());return t.closeStroke=this.closeStroke,t},_e.prototype.contains=function(t,e){for(var n=!1,r=this.points.length/2,i=0,o=r-1;i<r;o=i++){var a=this.points[2*i],s=this.points[2*i+1],u=this.points[2*o],c=this.points[2*o+1];e<s!=e<c&&t<(e-s)/(c-s)*(u-a)+a&&(n=!n)}return n},_e.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce(function(t,e){return t+", "+e},"")+"]"},_e);function _e(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var r=Array.isArray(e[0])?e[0]:e;if("number"!=typeof r[0]){for(var i=[],o=0,a=r.length;o<a;o++)i.push(r[o].x,r[o].y);r=i}this.points=r,this.type=ce.POLY,this.closeStroke=!0}var xe=(we.prototype.clone=function(){return new we(this.x,this.y,this.width,this.height,this.radius)},we.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var n=t-(this.x+this.radius),r=e-(this.y+this.radius),i=this.radius*this.radius;if(n*n+r*r<=i)return!0;if((n=t-(this.x+this.width-this.radius))*n+r*r<=i)return!0;if(n*n+(r=e-(this.y+this.height-this.radius))*r<=i)return!0;if((n=t-(this.x+this.radius))*n+r*r<=i)return!0}return!1},we.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},we);function we(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=20),this.x=t=void 0===t?0:t,this.y=e,this.width=n,this.height=r,this.radius=i,this.type=ce.RREC}var Te=(Oe.prototype.clone=function(){return new Oe(this.x,this.y)},Oe.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},Oe.prototype.copyTo=function(t){return t.set(this.x,this.y),t},Oe.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},Oe.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},Oe.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},Oe);function Oe(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}var Se=(Ee.prototype.clone=function(t,e){return new Ee(t=void 0===t?this.cb:t,e=void 0===e?this.scope:e,this._x,this._y)},Ee.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},Ee.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},Ee.prototype.copyTo=function(t){return t.set(this._x,this._y),t},Ee.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Ee.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(Ee.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(Ee.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Ee);function Ee(t,e,n,r){void 0===r&&(r=0),this._x=n=void 0===n?0:n,this._y=r,this.cb=t,this.scope=e}var Pe=(ke.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},ke.prototype.set=function(t,e,n,r,i,o){return this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=o,this},ke.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));e=e||this.array;return t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.tx,e[7]=this.ty):(e[0]=this.a,e[1]=this.c,e[2]=this.tx,e[3]=this.b,e[4]=this.d,e[5]=this.ty,e[6]=0,e[7]=0),e[8]=1,e},ke.prototype.apply=function(t,e){e=e||new Te;var n=t.x,t=t.y;return e.x=this.a*n+this.c*t+this.tx,e.y=this.b*n+this.d*t+this.ty,e},ke.prototype.applyInverse=function(t,e){e=e||new Te;var n=1/(this.a*this.d+this.c*-this.b),r=t.x,t=t.y;return e.x=this.d*n*r+-this.c*n*t+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*t+-this.b*n*r+(-this.ty*this.a+this.tx*this.b)*n,e},ke.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},ke.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},ke.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),r=this.a,i=this.c,t=this.tx;return this.a=r*e-this.b*n,this.b=r*n+this.b*e,this.c=i*e-this.d*n,this.d=i*n+this.d*e,this.tx=t*e-this.ty*n,this.ty=t*n+this.ty*e,this},ke.prototype.append=function(t){var e=this.a,n=this.b,r=this.c,i=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*n+t.b*i,this.c=t.c*e+t.d*r,this.d=t.c*n+t.d*i,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*n+t.ty*i+this.ty,this},ke.prototype.setTransform=function(t,e,n,r,i,o,a,s,u){return this.a=Math.cos(a+u)*i,this.b=Math.sin(a+u)*i,this.c=-Math.sin(a-s)*o,this.d=Math.cos(a-s)*o,this.tx=t-(n*this.a+r*this.c),this.ty=e-(n*this.b+r*this.d),this},ke.prototype.prepend=function(t){var e,n,r=this.tx;return 1===t.a&&0===t.b&&0===t.c&&1===t.d||(e=this.a,n=this.c,this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d),this.tx=r*t.a+this.ty*t.c+t.tx,this.ty=r*t.b+this.ty*t.d+t.ty,this},ke.prototype.decompose=function(t){var e=this.a,n=this.b,r=this.c,i=this.d,o=t.pivot,a=-Math.atan2(-r,i),s=Math.atan2(n,e),u=Math.abs(a+s);return u<1e-5||Math.abs(le-u)<1e-5?(t.rotation=s,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=s),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(r*r+i*i),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*n+o.y*i),t},ke.prototype.invert=function(){var t=this.a,e=this.b,n=this.c,r=this.d,i=this.tx,o=t*r-e*n;return this.a=r/o,this.b=-e/o,this.c=-n/o,this.d=t/o,this.tx=(n*this.ty-r*i)/o,this.ty=-(t*this.ty-e*i)/o,this},ke.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},ke.prototype.clone=function(){var t=new ke;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},ke.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},ke.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},ke.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(ke,"IDENTITY",{get:function(){return new ke},enumerable:!1,configurable:!0}),Object.defineProperty(ke,"TEMP_MATRIX",{get:function(){return new ke},enumerable:!1,configurable:!0}),ke);function ke(t,e,n,r,i,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===i&&(i=0),void 0===o&&(o=0),this.array=null,this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=o}var Re=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ae=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ce=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Ie=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Me=[],je=[],De=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Me.push(e);for(var n=0;n<16;n++)for(var r=De(Re[t]*Re[n]+Ce[t]*Ae[n]),i=De(Ae[t]*Re[n]+Ie[t]*Ae[n]),o=De(Re[t]*Ce[n]+Ce[t]*Ie[n]),a=De(Ae[t]*Ce[n]+Ie[t]*Ie[n]),s=0;s<16;s++)if(Re[s]===r&&Ae[s]===i&&Ce[s]===o&&Ie[s]===a){e.push(s);break}}for(t=0;t<16;t++){var u=new Pe;u.set(Re[t],Ae[t],Ce[t],Ie[t],0,0),je.push(u)}}();var Le={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return Re[t]},uY:function(t){return Ae[t]},vX:function(t){return Ce[t]},vY:function(t){return Ie[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return Me[t][e]},sub:function(t,e){return Me[t][Le.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?0<=e?Le.S:Le.N:2*Math.abs(e)<=Math.abs(t)?0<t?Le.E:Le.W:0<e?0<t?Le.SE:Le.SW:0<t?Le.NE:Le.NW},matrixAppendRotationInv:function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0);e=je[Le.inv(e)];e.tx=n,e.ty=r,t.append(e)}},Ne=(Fe.prototype.onChange=function(){this._localID++},Fe.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},Fe.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},Fe.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},Fe.prototype.updateTransform=function(t){var e,n,r=this.localTransform;this._localID!==this._currentLocalID&&(r.a=this._cx*this.scale.x,r.b=this._sx*this.scale.x,r.c=this._cy*this.scale.y,r.d=this._sy*this.scale.y,r.tx=this.position.x-(this.pivot.x*r.a+this.pivot.y*r.c),r.ty=this.position.y-(this.pivot.x*r.b+this.pivot.y*r.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID&&(e=t.worldTransform,(n=this.worldTransform).a=r.a*e.a+r.b*e.c,n.b=r.a*e.b+r.b*e.d,n.c=r.c*e.a+r.d*e.c,n.d=r.c*e.b+r.d*e.d,n.tx=r.tx*e.a+r.ty*e.c+e.tx,n.ty=r.tx*e.b+r.ty*e.d+e.ty,this._parentID=t._worldID,this._worldID++)},Fe.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(Fe.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),Fe.IDENTITY=new Fe,Fe);function Fe(){this.worldTransform=new Pe,this.localTransform=new Pe,this.position=new Se(this.onChange,this,0,0),this.scale=new Se(this.onChange,this,1,1),this.pivot=new Se(this.onChange,this,0,0),this.skew=new Se(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}dt.SORTABLE_CHILDREN=!1;var Be=(Ue.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},Ue.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Ue.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?pe.EMPTY:((t=t||new pe(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},Ue.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},Ue.prototype.addPointMatrix=function(t,e){var n=t.a,r=t.b,i=t.c,o=t.d,a=t.tx,t=t.ty,a=n*e.x+i*e.y+a,t=r*e.x+o*e.y+t;this.minX=Math.min(this.minX,a),this.maxX=Math.max(this.maxX,a),this.minY=Math.min(this.minY,t),this.maxY=Math.max(this.maxY,t)},Ue.prototype.addQuad=function(t){var e=this.minX,n=this.minY,r=this.maxX,i=this.maxY,o=t[0],a=t[1],e=o<e?o:e,n=a<n?a:n,r=r<o?o:r,i=i<a?a:i;e=(o=t[2])<e?o:e,n=(a=t[3])<n?a:n,r=r<o?o:r,i=i<a?a:i,e=(o=t[4])<e?o:e,n=(a=t[5])<n?a:n,r=r<o?o:r,i=i<a?a:i,o=t[6],n=(a=t[7])<n?a:n,r=r<o?o:r,i=i<a?a:i,this.minX=e=o<e?o:e,this.minY=n,this.maxX=r,this.maxY=i},Ue.prototype.addFrame=function(t,e,n,r,i){this.addFrameMatrix(t.worldTransform,e,n,r,i)},Ue.prototype.addFrameMatrix=function(t,e,n,r,i){var o=t.a,a=t.b,s=t.c,u=t.d,c=t.tx,l=t.ty,h=o*e+s*n+c,f=a*e+u*n+l,p=h<(p=this.minX)?h:p,d=f<(d=this.minY)?f:d,y=(y=this.maxX)<h?h:y,t=(t=this.maxY)<f?f:t;p=(h=o*r+s*n+c)<p?h:p,d=(f=a*r+u*n+l)<d?f:d,y=y<h?h:y,t=t<f?f:t,p=(h=o*e+s*i+c)<p?h:p,d=(f=a*e+u*i+l)<d?f:d,t=t<f?f:t,d=(f=a*r+u*i+l)<d?f:d,y=(y=y<h?h:y)<(h=o*r+s*i+c)?h:y,t=t<f?f:t,this.minX=p=h<p?h:p,this.minY=d,this.maxX=y,this.maxY=t},Ue.prototype.addVertexData=function(t,e,n){for(var r=this.minX,i=this.minY,o=this.maxX,a=this.maxY,s=e;s<n;s+=2)var u=t[s],c=t[s+1],r=u<r?u:r,i=c<i?c:i,o=o<u?u:o,a=a<c?c:a;this.minX=r,this.minY=i,this.maxX=o,this.maxY=a},Ue.prototype.addVertices=function(t,e,n,r){this.addVerticesMatrix(t.worldTransform,e,n,r)},Ue.prototype.addVerticesMatrix=function(t,e,n,r,i,o){void 0===i&&(i=0),void 0===o&&(o=i);for(var a=t.a,s=t.b,u=t.c,c=t.d,l=t.tx,h=t.ty,f=this.minX,p=this.minY,d=this.maxX,y=this.maxY,m=n;m<r;m+=2)var v=e[m],g=e[m+1],b=a*v+u*g+l,v=c*g+s*v+h,f=Math.min(f,b-i),d=Math.max(d,b+i),p=Math.min(p,v-o),y=Math.max(y,v+o);this.minX=f,this.minY=p,this.maxX=d,this.maxY=y},Ue.prototype.addBounds=function(t){var e=this.minX,n=this.minY,r=this.maxX,i=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>i?t.maxY:i},Ue.prototype.addBoundsMask=function(t,e){var n,r,i=(t.minX>e.minX?t:e).minX,o=(t.minY>e.minY?t:e).minY,a=(t.maxX<e.maxX?t:e).maxX,s=(t.maxY<e.maxY?t:e).maxY;i<=a&&o<=s&&(n=this.minX,r=this.minY,t=this.maxX,e=this.maxY,this.minX=i<n?i:n,this.minY=o<r?o:r,this.maxX=t<a?a:t,this.maxY=e<s?s:e)},Ue.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},Ue.prototype.addBoundsArea=function(t,e){var n,r,i=t.minX>e.x?t.minX:e.x,o=t.minY>e.y?t.minY:e.y,a=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;i<=a&&o<=s&&(n=this.minX,r=this.minY,t=this.maxX,e=this.maxY,this.minX=i<n?i:n,this.minY=o<r?o:r,this.maxX=t<a?a:t,this.maxY=e<s?s:e)},Ue.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},Ue.prototype.addFramePad=function(t,e,n,r,i,o){e-=o,n+=i,r+=o,this.minX=this.minX<(t-=i)?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r},Ue);function Ue(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}var Ge=function(t,e){return(Ge=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Xe(t,e){function n(){this.constructor=t}Ge(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var He,ze=(Xe(Ve,He=mt.a),Ve.mixin=function(t){for(var e=Object.keys(t),n=0;n<e.length;++n){var r=e[n];Object.defineProperty(Ve.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},Object.defineProperty(Ve.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),Ve.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},Ve.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},Ve.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new pe),e=this._boundsRect),this._bounds.getRectangle(e)},Ve.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new pe),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Be);var e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var r=this._bounds,i=this._boundsID;this._bounds=this._localBounds;t=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=r,this._bounds.updateID+=this._boundsID-i,t},Ve.prototype.toGlobal=function(t,e,n){return(n=void 0===n?!1:n)||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},Ve.prototype.toLocal=function(t,e,n,r){return e&&(t=e.toGlobal(t,n,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)},Ve.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},Ve.prototype.setTransform=function(t,e,n,r,i,o,a,s,u){return void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),this.position.x=t=void 0===t?0:t,this.position.y=e,this.scale.x=n||1,this.scale.y=r||1,this.rotation=i,this.skew.x=o,this.skew.y=a,this.pivot.x=s,this.pivot.y=u,this},Ve.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this.emit("destroyed"),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(Ve.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new Ye),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),Ve.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},Ve.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(Ve.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(Ve.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(Ve.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(Ve.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(Ve.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(Ve.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(Ve.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(Ve.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(Ve.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(Ve.prototype,"angle",{get:function(){return this.transform.rotation*he},set:function(t){this.transform.rotation=t*fe},enumerable:!1,configurable:!0}),Object.defineProperty(Ve.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Ve.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1}while(t=t.parent);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(Ve.prototype,"mask",{get:function(){return this._mask},set:function(t){var e;this._mask&&((e=this._mask.maskObject||this._mask).renderable=!0,e.isMask=!1),this._mask=t,this._mask&&((e=this._mask.maskObject||this._mask).renderable=!1,e.isMask=!0)},enumerable:!1,configurable:!0}),Ve);function Ve(){var t=He.call(this)||this;return t.tempDisplayObjectParent=null,t.transform=new Ne,t.alpha=1,t.visible=!0,t.renderable=!0,t.parent=null,t.worldAlpha=1,t._lastSortedIndex=0,t._zIndex=0,t.filterArea=null,t.filters=null,t._enabledFilters=null,t._bounds=new Be,t._localBounds=null,t._boundsID=0,t._boundsRect=null,t._localBoundsRect=null,t._mask=null,t._destroyed=!1,t.isSprite=!1,t.isMask=!1,t}var We,Ye=(Xe(qe,We=ze),qe);function qe(){var t=null!==We&&We.apply(this,arguments)||this;return t.sortDirty=null,t}function Ke(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}ze.prototype.displayObjectUpdateTransform=ze.prototype.updateTransform;var Ze,Qe=(Xe($e,Ze=ze),$e.prototype.onChildrenChange=function(t){},$e.prototype.addChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(1<e.length)for(var r=0;r<e.length;r++)this.addChild(e[r]);else{var i=e[0];i.parent&&i.parent.removeChild(i),(i.parent=this).sortDirty=!0,i.transform._parentID=-1,this.children.push(i),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",i,this,this.children.length-1),i.emit("added",this)}return e[0]},$e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),(t.parent=this).sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},$e.prototype.swapChildren=function(t,e){var n,r;t!==e&&(n=this.getChildIndex(t),r=this.getChildIndex(e),this.children[n]=e,this.children[r]=t,this.onChildrenChange(n<r?n:r))},$e.prototype.getChildIndex=function(t){t=this.children.indexOf(t);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t},$e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var n=this.getChildIndex(t);zt(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)},$e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},$e.prototype.removeChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(1<e.length)for(var r=0;r<e.length;r++)this.removeChild(e[r]);else{var i=e[0],o=this.children.indexOf(i);if(-1===o)return null;i.parent=null,i.transform._parentID=-1,zt(this.children,o,1),this._boundsID++,this.onChildrenChange(o),i.emit("removed",this),this.emit("childRemoved",i,this,o)}return e[0]},$e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,zt(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},$e.prototype.removeChildren=function(t,e){var n=t=void 0===t?0:t,r=(e=void 0===e?this.children.length:e)-n;if(0<r&&r<=e){for(var i=this.children.splice(n,r),o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(o=0;o<i.length;++o)i[o].emit("removed",this),this.emit("childRemoved",i[o],this,o);return i}if(0==r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},$e.prototype.sortChildren=function(){for(var t=!1,e=0,n=this.children.length;e<n;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&1<this.children.length&&this.children.sort(Ke),this.sortDirty=!1},$e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var n=this.children[t];n.visible&&n.updateTransform()}},$e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e,n=this.children[t];n.visible&&n.renderable&&(n.calculateBounds(),n._mask?((e=n._mask.maskObject||n._mask).calculateBounds(),this._bounds.addBoundsMask(n._bounds,e._bounds)):n.filterArea?this._bounds.addBoundsArea(n._bounds,n.filterArea):this._bounds.addBounds(n._bounds))}this._bounds.updateID=this._boundsID},$e.prototype.getLocalBounds=function(t,e){void 0===e&&(e=!1);t=Ze.prototype.getLocalBounds.call(this,t);if(!e)for(var n=0,r=this.children.length;n<r;++n){var i=this.children[n];i.visible&&i.updateTransform()}return t},$e.prototype._calculateBounds=function(){},$e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}},$e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,n=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]);for(var r=this._enabledFilters.length=0;r<e.length;r++)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}n&&t.mask.push(this,this._mask),this._render(t);for(var r=0,i=this.children.length;r<i;r++)this.children[r].render(t);t.batch.flush(),n&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},$e.prototype._render=function(t){},$e.prototype.destroy=function(t){Ze.prototype.destroy.call(this),this.sortDirty=!1;var e="boolean"==typeof t?t:t&&t.children,n=this.removeChildren(0,this.children.length);if(e)for(var r=0;r<n.length;++r)n[r].destroy(t)},Object.defineProperty($e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},enumerable:!1,configurable:!0}),$e);function $e(){var t=Ze.call(this)||this;return t.children=[],t.sortableChildren=dt.SORTABLE_CHILDREN,t.sortDirty=!1,t}Qe.prototype.containerUpdateTransform=Qe.prototype.updateTransform;var Je={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};ze.mixin(Je);var tn,en=(Object.defineProperty(nn.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(nn.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),nn.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e},nn.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},nn.prototype.activate=function(){var t;this._isActive||(this._isActive=!0,self.document.addEventListener("mousemove",this._onMouseMove,!0),self.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null!==(t=this.renderer.view.parentNode)&&void 0!==t&&t.appendChild(this.div))},nn.prototype.deactivate=function(){var t;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,self.document.removeEventListener("mousemove",this._onMouseMove,!0),self.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null!==(t=this.div.parentNode)&&void 0!==t&&t.removeChild(this.div))},nn.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}},nn.prototype.update=function(){var t=performance.now();if(!(V.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),n=e.left,r=e.top,i=e.width,o=e.height,a=this.renderer,t=a.width,e=a.height,a=a.resolution,s=i/t*a,u=o/e*a;(l=this.div).style.left=n+"px",l.style.top=r+"px",l.style.width=t+"px",l.style.height=e+"px";for(var c=0;c<this.children.length;c++){var l,h,f,p=this.children[c];p.renderId!==this.renderId?(p._accessibleActive=!1,zt(this.children,c,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,c--):(l=p._accessibleDiv,h=p.hitArea,f=p.worldTransform,p.hitArea?(l.style.left=(f.tx+h.x*f.a)*s+"px",l.style.top=(f.ty+h.y*f.d)*u+"px",l.style.width=h.width*f.a*s+"px",l.style.height=h.height*f.d*u+"px"):(h=p.getBounds(),this.capHitArea(h),l.style.left=h.x*s+"px",l.style.top=h.y*u+"px",l.style.width=h.width*s+"px",l.style.height=h.height*u+"px",l.title!==p.accessibleTitle&&null!==p.accessibleTitle&&(l.title=p.accessibleTitle),l.getAttribute("aria-label")!==p.accessibleHint&&null!==p.accessibleHint&&l.setAttribute("aria-label",p.accessibleHint)),p.accessibleTitle===l.title&&p.tabIndex===l.tabIndex||(l.title=p.accessibleTitle,l.tabIndex=p.tabIndex,this.debug&&this.updateDebugHTML(l)))}this.renderId++}},nn.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},nn.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);var e=this.renderer,n=e.width,e=e.height;t.x+t.width>n&&(t.width=n-t.x),t.y+t.height>e&&(t.height=e-t.y)},nn.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",-1<navigator.userAgent.toLowerCase().indexOf("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,(t._accessibleDiv=e).displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},nn.prototype._onClick=function(t){var e=this.renderer.plugins.interaction,n=t.target.displayObject,t=e.eventData;e.dispatchEvent(n,"click",t),e.dispatchEvent(n,"pointertap",t),e.dispatchEvent(n,"tap",t)},nn.prototype._onFocus=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction,n=t.target.displayObject,t=e.eventData;e.dispatchEvent(n,"mouseover",t)},nn.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction,n=t.target.displayObject,t=e.eventData;e.dispatchEvent(n,"mouseout",t)},nn.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},nn.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},nn.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,self.document.removeEventListener("mousemove",this._onMouseMove,!0),self.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},nn);function nn(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(V.tablet||V.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),self.addEventListener("keydown",this._onKeyDown,!1)}dt.TARGET_FPMS=.06,(yt=tn=tn||{})[yt.INTERACTION=50]="INTERACTION",yt[yt.HIGH=25]="HIGH",yt[yt.NORMAL=0]="NORMAL",yt[yt.LOW=-25]="LOW",yt[yt.UTILITY=-50]="UTILITY";var rn=(on.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},on.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t},on.prototype.connect=function(t){(this.previous=t).next&&(t.next.previous=this),this.next=t.next,t.next=this},on.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},on);function on(t,e,n,r){void 0===e&&(e=null),void 0===n&&(n=0),void 0===r&&(r=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=n,this.once=r}var an=(sn.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},sn.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},sn.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},sn.prototype.add=function(t,e,n){return void 0===n&&(n=tn.NORMAL),this._addListener(new rn(t,e,n))},sn.prototype.addOnce=function(t,e,n){return void 0===n&&(n=tn.NORMAL),this._addListener(new rn(t,e,n,!0))},sn.prototype._addListener=function(t){var e=this._head.next,n=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(n);break}e=(n=e).next}t.previous||t.connect(n)}else t.connect(n);return this._startIfPossible(),this},sn.prototype.remove=function(t,e){for(var n=this._head.next;n;)n=n.match(t,e)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(sn.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),sn.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},sn.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},sn.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},sn.prototype.update=function(t){if((t=void 0===t?performance.now():t)>this.lastTime){if((n=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(n=this._maxElapsedMS),n*=this.speed,this._minElapsedMS){var e=t-this._lastFrame|0;if(e<this._minElapsedMS)return;this._lastFrame=t-e%this._minElapsedMS}this.deltaMS=n,this.deltaTime=this.deltaMS*dt.TARGET_FPMS;for(var n=this._head,r=n.next;r;)r=r.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(sn.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(sn.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){t=Math.min(this.maxFPS,t),t=Math.min(Math.max(0,t)/1e3,dt.TARGET_FPMS);this._maxElapsedMS=1/t},enumerable:!1,configurable:!0}),Object.defineProperty(sn.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){0===t?this._minElapsedMS=0:(t=Math.max(this.minFPS,t),this._minElapsedMS=1/(t/1e3))},enumerable:!1,configurable:!0}),Object.defineProperty(sn,"shared",{get:function(){var t;return sn._shared||((t=sn._shared=new sn).autoStart=!0,t._protected=!0),sn._shared},enumerable:!1,configurable:!0}),Object.defineProperty(sn,"system",{get:function(){var t;return sn._system||((t=sn._system=new sn).autoStart=!0,t._protected=!0),sn._system},enumerable:!1,configurable:!0}),sn);function sn(){var e=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new rn(null,null,1/0),this.deltaMS=1/dt.TARGET_FPMS,this.elapsedMS=1/dt.TARGET_FPMS,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}var un=(cn.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=t)&&t.add(this.render,this,tn.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?an.shared:new an,t.autoStart&&this.start()},cn.destroy=function(){var t;this._ticker&&(t=this._ticker,this.ticker=null,t.destroy())},cn);function cn(){}var ln=(Object.defineProperty(hn.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),hn.prototype.getLocalPosition=function(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)},hn.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},hn.prototype.reset=function(){this.isPrimary=!1},hn);function hn(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new Te,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}var fn=function(t,e){return(fn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var pn=(dn.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},dn.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},dn);function dn(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}var yn=(mn.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(mn.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(mn.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(mn.prototype,"none",{get:function(){return this._flags===mn.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(mn.prototype,"over",{get:function(){return 0!=(this._flags&mn.FLAGS.OVER)},set:function(t){this._doSet(mn.FLAGS.OVER,t)},enumerable:!1,configurable:!0}),Object.defineProperty(mn.prototype,"rightDown",{get:function(){return 0!=(this._flags&mn.FLAGS.RIGHT_DOWN)},set:function(t){this._doSet(mn.FLAGS.RIGHT_DOWN,t)},enumerable:!1,configurable:!0}),Object.defineProperty(mn.prototype,"leftDown",{get:function(){return 0!=(this._flags&mn.FLAGS.LEFT_DOWN)},set:function(t){this._doSet(mn.FLAGS.LEFT_DOWN,t)},enumerable:!1,configurable:!0}),mn.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),mn);function mn(t){this._pointerId=t,this._flags=mn.FLAGS.NONE}var vn=(gn.prototype.recursiveFindHit=function(t,e,n,r,i){if(!e||!e.visible)return!1;var o=t.data.global,a=!1,s=i=e.interactive||i,u=!0;if(e.hitArea?(r&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?a=!0:u=r=!1),s=!1):e._mask&&r&&(e._mask.containsPoint&&e._mask.containsPoint(o)||(r=!1)),u&&e.interactiveChildren&&e.children)for(var c=e.children,l=c.length-1;0<=l;l--){var h=c[l],f=this.recursiveFindHit(t,h,n,r,s);f&&h.parent&&(s=!1,f&&(t.target&&(r=!1),a=!0))}return i&&(r&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(a=!0),e.interactive&&(a&&!t.target&&(t.target=e),n&&n(t,e,!!a))),a},gn.prototype.findHit=function(t,e,n,r){this.recursiveFindHit(t,e,n,r,!1)},gn);function gn(){this._tempPoint=new Te}var bn={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};ze.mixin(bn);var _n,xn,wn,Tn={target:null,data:{global:null}},On=(_n=mt.a,fn(xn=En,wn=_n),xn.prototype=null===wn?Object.create(wn):(Sn.prototype=wn.prototype,new Sn),Object.defineProperty(En.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){(this._useSystemTicker=t)?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(En.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),En.prototype.hitTest=function(t,e){return Tn.target=null,Tn.data.global=t,e=e||this.lastObjectRendered,this.processInteractive(Tn,e,null,!0),Tn.target},En.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},En.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(an.system.add(this.tickerUpdate,this,tn.INTERACTION),this.tickerAdded=!0)},En.prototype.removeTickerListener=function(){this.tickerAdded&&(an.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},En.prototype.addEvents=function(){var t;!this.eventsAdded&&this.interactionDOMElement&&(t=this.interactionDOMElement.style,self.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(self.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),self.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),self.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(self.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),self.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0)},En.prototype.removeEvents=function(){var t;this.eventsAdded&&this.interactionDOMElement&&(t=this.interactionDOMElement.style,self.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(self.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),self.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),self.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(self.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),self.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1)},En.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},En.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)!this.activeInteractionData.hasOwnProperty(t)||(t=this.activeInteractionData[t]).originalEvent&&"touch"!==t.pointerType&&(t=this.configureInteractionEventForDOMEvent(this.eventData,t.originalEvent,t),this.processInteractive(t,this.lastObjectRendered,this.processPointerOverOut,!0));this.setCursorMode(this.cursor)}},En.prototype.setCursorMode=function(t){t=t||"default";var e=!0;if(self.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(e=!1),this.currentCursorMode!==t){this.currentCursorMode=t;var n=this.cursorStyles[t];if(n)switch(typeof n){case"string":e&&(this.interactionDOMElement.style.cursor=n);break;case"function":n(t);break;case"object":e&&Object.assign(this.interactionDOMElement.style,n)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t)}},En.prototype.dispatchEvent=function(t,e,n){n.stopPropagationHint&&t!==n.stopsPropagatingAt||(n.currentTarget=t,n.type=e,t.emit(e,n),t[e]&&t[e](n))},En.prototype.delayDispatchEvent=function(t,e,n){this.delayedEvents.push({displayObject:t,eventString:e,eventData:n})},En.prototype.mapPositionToPoint=function(t,e,n){var r=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0},i=1/this.resolution;t.x=(e-r.left)*(this.interactionDOMElement.width/r.width)*i,t.y=(n-r.top)*(this.interactionDOMElement.height/r.height)*i},En.prototype.processInteractive=function(t,e,n,r){var r=this.search.findHit(t,e,n,r),i=this.delayedEvents;if(!i.length)return r;t.stopPropagationHint=!1;var o=i.length;this.delayedEvents=[];for(var a=0;a<o;a++){var s=i[a],u=s.displayObject,c=s.eventString,s=s.eventData;s.stopsPropagatingAt===u&&(s.stopPropagationHint=!0),this.dispatchEvent(u,c,s)}return r},En.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);!this.autoPreventDefault||!e[0].isNormalized||!t.cancelable&&"cancelable"in t||t.preventDefault();for(var n=e.length,r=0;r<n;r++){var i=e[r],o=this.getInteractionDataForPointerId(i),o=this.configureInteractionEventForDOMEvent(this.eventData,i,o);o.data.originalEvent=t,this.processInteractive(o,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",o),"touch"===i.pointerType?this.emit("touchstart",o):"mouse"!==i.pointerType&&"pen"!==i.pointerType||(i=2===i.button,this.emit(i?"rightdown":"mousedown",this.eventData))}}},En.prototype.processPointerDown=function(t,e,n){var r=t.data,i=t.data.identifier;n&&(e.trackedPointers[i]||(e.trackedPointers[i]=new yn(i)),this.dispatchEvent(e,"pointerdown",t),"touch"===r.pointerType?this.dispatchEvent(e,"touchstart",t):"mouse"!==r.pointerType&&"pen"!==r.pointerType||((r=2===r.button)?e.trackedPointers[i].rightDown=!0:e.trackedPointers[i].leftDown=!0,this.dispatchEvent(e,r?"rightdown":"mousedown",t)))},En.prototype.onPointerComplete=function(t,e,n){for(var r=this.normalizeToPointerData(t),i=r.length,o=t.target!==this.interactionDOMElement?"outside":"",a=0;a<i;a++){var s=r[a],u=this.getInteractionDataForPointerId(s),c=this.configureInteractionEventForDOMEvent(this.eventData,s,u);c.data.originalEvent=t,this.processInteractive(c,this.lastObjectRendered,n,e||!o),this.emit(e?"pointercancel":"pointerup"+o,c),"mouse"===s.pointerType||"pen"===s.pointerType?(u=2===s.button,this.emit(u?"rightup"+o:"mouseup"+o,c)):"touch"===s.pointerType&&(this.emit(e?"touchcancel":"touchend"+o,c),this.releaseInteractionDataForPointerId(s.pointerId))}},En.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},En.prototype.processPointerCancel=function(t,e){var n=t.data,r=t.data.identifier;void 0!==e.trackedPointers[r]&&(delete e.trackedPointers[r],this.dispatchEvent(e,"pointercancel",t),"touch"===n.pointerType&&this.dispatchEvent(e,"touchcancel",t))},En.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},En.prototype.processPointerUp=function(t,e,n){var r,i=t.data,o=t.data.identifier,a=e.trackedPointers[o],s="touch"===i.pointerType,u="mouse"===i.pointerType||"pen"===i.pointerType,c=!1;u&&(r=2===i.button,i=yn.FLAGS,i=r?i.RIGHT_DOWN:i.LEFT_DOWN,i=void 0!==a&&a.flags&i,n?(this.dispatchEvent(e,r?"rightup":"mouseup",t),i&&(this.dispatchEvent(e,r?"rightclick":"click",t),c=!0)):i&&this.dispatchEvent(e,r?"rightupoutside":"mouseupoutside",t),a&&(r?a.rightDown=!1:a.leftDown=!1)),n?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),a&&(u&&!c||this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),a.over=!1))):a&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),a&&a.none&&delete e.trackedPointers[o]},En.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this._didMove=!0,this.cursor=null);for(var n=e.length,r=0;r<n;r++){var i=e[r],o=this.getInteractionDataForPointerId(i),o=this.configureInteractionEventForDOMEvent(this.eventData,i,o);o.data.originalEvent=t,this.processInteractive(o,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",o),"touch"===i.pointerType&&this.emit("touchmove",o),"mouse"!==i.pointerType&&"pen"!==i.pointerType||this.emit("mousemove",o)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},En.prototype.processPointerMove=function(t,e,n){var r=t.data,i="touch"===r.pointerType,r="mouse"===r.pointerType||"pen"===r.pointerType;r&&this.processPointerOverOut(t,e,n),this.moveWhenInside&&!n||(this.dispatchEvent(e,"pointermove",t),i&&this.dispatchEvent(e,"touchmove",t),r&&this.dispatchEvent(e,"mousemove",t))},En.prototype.onPointerOut=function(t){var e,n;this.supportsTouchEvents&&"touch"===t.pointerType||("mouse"===(e=this.normalizeToPointerData(t)[0]).pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null)),n=this.getInteractionDataForPointerId(e),(t=this.configureInteractionEventForDOMEvent(this.eventData,e,n)).data.originalEvent=e,this.processInteractive(t,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",t),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",t):this.releaseInteractionDataForPointerId(n.identifier))},En.prototype.processPointerOverOut=function(t,e,n){var r=t.data,i=t.data.identifier,o="mouse"===r.pointerType||"pen"===r.pointerType,r=e.trackedPointers[i];void 0!==(r=n&&!r?e.trackedPointers[i]=new yn(i):r)&&(n&&this.mouseOverRenderer?(r.over||(r.over=!0,this.delayDispatchEvent(e,"pointerover",t),o&&this.delayDispatchEvent(e,"mouseover",t)),o&&null===this.cursor&&(this.cursor=e.cursor)):r.over&&(r.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),o&&this.dispatchEvent(e,"mouseout",t),r.none&&delete e.trackedPointers[i]))},En.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],t=this.getInteractionDataForPointerId(e),t=this.configureInteractionEventForDOMEvent(this.eventData,e,t);"mouse"===(t.data.originalEvent=e).pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",t),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",t)},En.prototype.getInteractionDataForPointerId=function(t){var e,n=t.pointerId;return 1===n||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[n]?e=this.activeInteractionData[n]:((e=this.interactionDataPool.pop()||new ln).identifier=n,this.activeInteractionData[n]=e),e.copyEvent(t),e},En.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},En.prototype.configureInteractionEventForDOMEvent=function(t,e,n){return t.data=n,this.mapPositionToPoint(n.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=n.global.x,e.globalY=n.global.y),n.originalEvent=e,t.reset(),t},En.prototype.normalizeToPointerData=function(t){var e,n=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var r=0,i=t.changedTouches.length;r<i;r++){var o=t.changedTouches[r];void 0===o.button&&(o.button=t.touches.length?1:0),void 0===o.buttons&&(o.buttons=t.touches.length?1:0),void 0===o.isPrimary&&(o.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===o.width&&(o.width=o.radiusX||1),void 0===o.height&&(o.height=o.radiusY||1),void 0===o.tiltX&&(o.tiltX=0),void 0===o.tiltY&&(o.tiltY=0),void 0===o.pointerType&&(o.pointerType="touch"),void 0===o.pointerId&&(o.pointerId=o.identifier||0),void 0===o.pressure&&(o.pressure=o.force||.5),void 0===o.twist&&(o.twist=0),void 0===o.tangentialPressure&&(o.tangentialPressure=0),void 0===o.layerX&&(o.layerX=o.offsetX=o.clientX),void 0===o.layerY&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,n.push(o)}else!self.MouseEvent||t instanceof MouseEvent&&!(this.supportsPointerEvents&&t instanceof self.PointerEvent)?(void 0===(e=t).isPrimary&&(e.isPrimary=!0),void 0===e.width&&(e.width=1),void 0===e.height&&(e.height=1),void 0===e.tiltX&&(e.tiltX=0),void 0===e.tiltY&&(e.tiltY=0),void 0===e.pointerType&&(e.pointerType="mouse"),void 0===e.pointerId&&(e.pointerId=1),void 0===e.pressure&&(e.pressure=.5),void 0===e.twist&&(e.twist=0),void 0===e.tangentialPressure&&(e.tangentialPressure=0),e.isNormalized=!0,n.push(e)):n.push(t);return n},En.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},En);function Sn(){this.constructor=xn}function En(t,e){var n=_n.call(this)||this;return e=e||{},n.renderer=t,n.autoPreventDefault=void 0===e.autoPreventDefault||e.autoPreventDefault,n.interactionFrequency=e.interactionFrequency||10,n.mouse=new ln,n.mouse.identifier=1,n.mouse.global.set(-999999),n.activeInteractionData={},n.activeInteractionData[1]=n.mouse,n.interactionDataPool=[],n.eventData=new pn,n.interactionDOMElement=null,n.moveWhenInside=!1,n.eventsAdded=!1,n.tickerAdded=!1,n.mouseOverRenderer=!("PointerEvent"in self),n.supportsTouchEvents="ontouchstart"in self,n.supportsPointerEvents=!!self.PointerEvent,n.onPointerUp=n.onPointerUp.bind(n),n.processPointerUp=n.processPointerUp.bind(n),n.onPointerCancel=n.onPointerCancel.bind(n),n.processPointerCancel=n.processPointerCancel.bind(n),n.onPointerDown=n.onPointerDown.bind(n),n.processPointerDown=n.processPointerDown.bind(n),n.onPointerMove=n.onPointerMove.bind(n),n.processPointerMove=n.processPointerMove.bind(n),n.onPointerOut=n.onPointerOut.bind(n),n.processPointerOverOut=n.processPointerOverOut.bind(n),n.onPointerOver=n.onPointerOver.bind(n),n.cursorStyles={default:"inherit",pointer:"pointer"},n.currentCursorMode=null,n.cursor=null,n.resolution=1,n.delayedEvents=[],n.search=new vn,n._tempDisplayObject=new Ye,n._eventListenerOptions={capture:!0,passive:!1},n._useSystemTicker=void 0===e.useSystemTicker||e.useSystemTicker,n.setTargetElement(n.renderer.view,n.renderer.resolution),n}var Pn=(kn.prototype.emit=function(t,e,n,r,i,o,a,s){if(8<arguments.length)throw new Error("max arguments reached");var u=this.name,c=this.items;this._aliasCount++;for(var l=0,h=c.length;l<h;l++)c[l][u](t,e,n,r,i,o,a,s);return c===this.items&&this._aliasCount--,this},kn.prototype.ensureNonAliasedItems=function(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))},kn.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},kn.prototype.remove=function(t){t=this.items.indexOf(t);return-1!==t&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this},kn.prototype.contains=function(t){return-1!==this.items.indexOf(t)},kn.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},kn.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(kn.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(kn.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),kn);function kn(t){this.items=[],this._name=t,this._aliasCount=0}Object.defineProperties(Pn.prototype,{dispatch:{value:Pn.prototype.emit},run:{value:Pn.prototype.emit}}),dt.PREFER_ENV=V.any?K.WEBGL:K.WEBGL2,dt.STRICT_TEXTURE_CACHE=!1;var Rn=[];function An(t,e){if(!t)return null;var n,r="";"string"!=typeof t||(n=/\.(\w{3,4})(?:$|\?|#)/i.exec(t))&&(r=n[1].toLowerCase());for(var i=Rn.length-1;0<=i;--i){var o=Rn[i];if(o.test&&o.test(t,r))return new o(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}var Cn=function(t,e){return(Cn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function In(t,e){function n(){this.constructor=t}Cn(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Mn=function(){return(Mn=Object.assign||function(t){for(var e,n=arguments,r=1,i=arguments.length;r<i;r++)for(var o in e=n[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};var jn=(Dn.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},Dn.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},Dn.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(Dn.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),Dn.prototype.update=function(){this.destroyed||this.onUpdate.emit()},Dn.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(Dn.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(Dn.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),Dn.prototype.style=function(t,e,n){return!1},Dn.prototype.dispose=function(){},Dn.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Dn.test=function(t,e){return!1},Dn);function Dn(t,e){void 0===e&&(e=0),this._width=t=void 0===t?0:t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Pn("setRealSize"),this.onUpdate=new Pn("update"),this.onError=new Pn("onError")}var Ln,Nn=(In(Fn,Ln=jn),Fn.prototype.upload=function(t,e,n){var r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===st.UNPACK);var i=e.realWidth,t=e.realHeight;return n.width===i&&n.height===t?r.texSubImage2D(e.target,0,0,0,i,t,e.format,n.type,this.data):(n.width=i,n.height=t,r.texImage2D(e.target,0,n.internalFormat,i,t,0,e.format,n.type,this.data)),!0},Fn.prototype.dispose=function(){this.data=null},Fn.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},Fn);function Fn(t,e){var n=this,r=e||{},e=r.width,r=r.height;if(!e||!r)throw new Error("BufferResource width or height invalid");return(n=Ln.call(this,e,r)||this).data=t,n}var Bn,Un={scaleMode:it.NEAREST,format:tt.RGBA,alphaMode:st.NPM},Gn=(In(Xn,Bn=mt.a),Object.defineProperty(Xn.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(Xn.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(Xn.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(Xn.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(Xn.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Xn.prototype.setStyle=function(t,e){var n;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,n=!0),n&&this.dirtyStyleId++,this},Xn.prototype.setSize=function(t,e,n){return n=n||this.resolution,this.setRealSize(t*n,e*n,n)},Xn.prototype.setRealSize=function(t,e,n){return this.resolution=n||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this},Xn.prototype._refreshPOT=function(){this.isPowerOfTwo=Xt(this.realWidth)&&Xt(this.realHeight)},Xn.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this},Xn.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},Xn.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},Xn.prototype.onError=function(t){this.emit("error",this,t)},Xn.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete $t[this.cacheId],delete Qt[this.cacheId],this.cacheId=null),this.dispose(),Xn.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},Xn.prototype.dispose=function(){this.emit("dispose",this)},Xn.prototype.castToBaseTexture=function(){return this},Xn.from=function(t,e,n){void 0===n&&(n=dt.STRICT_TEXTURE_CACHE);var r="string"==typeof t,i=null,i=r?t:(t._pixiId||(o=e&&e.pixiIdPrefix||"pixiid",t._pixiId=o+"_"+ ++Wt),t._pixiId),o=$t[i];if(r&&n&&!o)throw new Error('The cacheId "'+i+'" does not exist in BaseTextureCache.');return o||((o=new Xn(t,e)).cacheId=i,Xn.addToCache(o,i)),o},Xn.fromBuffer=function(t,e,n,r){t=t||new Float32Array(e*n*4);var i=new Nn(t,{width:e,height:n}),t=t instanceof Float32Array?nt.FLOAT:nt.UNSIGNED_BYTE;return new Xn(i,Object.assign(Un,r||{width:e,height:n,type:t}))},Xn.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),$t[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),$t[e]=t)},Xn.removeFromCache=function(t){if("string"==typeof t){var e=$t[t];if(e){var n=e.textureCacheIds.indexOf(t);return-1<n&&e.textureCacheIds.splice(n,1),delete $t[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete $t[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Xn._globalBatch=0,Xn);function Xn(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var n=Bn.call(this)||this,r=(e=e||{}).alphaMode,i=e.mipmap,o=e.anisotropicLevel,a=e.scaleMode,s=e.width,u=e.height,c=e.wrapMode,l=e.format,h=e.type,f=e.target,p=e.resolution,e=e.resourceOptions;return!t||t instanceof jn||((t=An(t,e)).internal=!0),n.resolution=p||dt.RESOLUTION,n.width=Math.round((s||0)*n.resolution)/n.resolution,n.height=Math.round((u||0)*n.resolution)/n.resolution,n._mipmap=void 0!==i?i:dt.MIPMAP_TEXTURES,n.anisotropicLevel=void 0!==o?o:dt.ANISOTROPIC_LEVEL,n._wrapMode=c||dt.WRAP_MODE,n._scaleMode=void 0!==a?a:dt.SCALE_MODE,n.format=l||tt.RGBA,n.type=h||nt.UNSIGNED_BYTE,n.target=f||et.TEXTURE_2D,n.alphaMode=void 0!==r?r:st.UNPACK,n.uid=++Wt,n.touched=0,n.isPowerOfTwo=!1,n._refreshPOT(),n._glTextures={},n.dirtyId=0,n.dirtyStyleId=0,n.cacheId=null,n.valid=0<s&&0<u,n.textureCacheIds=[],n.destroyed=!1,n.resource=null,n._batchEnabled=0,n._batchLocation=0,n.parentTextureArray=null,n.setResource(t),n}var Hn,zn=(In(Vn,Hn=jn),Vn.prototype.initFromArray=function(t,e){for(var n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof jn?this.addResourceAt(t[n],n):this.addResourceAt(An(t[n],e),n))},Vn.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},Vn.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},Vn.prototype.bind=function(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");Hn.prototype.bind.call(this,t);for(var e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)},Vn.prototype.unbind=function(t){Hn.prototype.unbind.call(this,t);for(var e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)},Vn.prototype.load=function(){var n=this;if(this._load)return this._load;var t=this.items.map(function(t){return t.resource}).filter(function(t){return t}).map(function(t){return t.load()});return this._load=Promise.all(t).then(function(){var t=n.items[0],e=t.realWidth,t=t.realHeight;return n.resize(e,t),Promise.resolve(n)}),this._load},Vn);function Vn(t,e){var n=this,r=e||{},e=r.width,r=r.height;(n=Hn.call(this,e,r)||this).items=[],n.itemDirtyIds=[];for(var i=0;i<t;i++){var o=new Gn;n.items.push(o),n.itemDirtyIds.push(-2)}return n.length=t,n._load=null,n.baseTexture=null,n}var Wn,Yn=(In(qn,Wn=zn),qn.prototype.addBaseTextureAt=function(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this},qn.prototype.bind=function(t){Wn.prototype.bind.call(this,t),t.target=et.TEXTURE_2D_ARRAY},qn.prototype.upload=function(t,e,n){var r=this.length,i=this.itemDirtyIds,o=this.items,a=t.gl;n.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,r,0,e.format,n.type,null);for(var s=0;s<r;s++){var u=o[s];i[s]<u.dirtyId&&(i[s]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,s,u.resource.width,u.resource.height,1,e.format,n.type,u.resource.source))}return!0},qn);function qn(t,e){var n,r=this,i=e||{},o=i.width,i=i.height,t=Array.isArray(t)?(n=t).length:t,r=Wn.call(this,t,{width:o,height:i})||this;return n&&r.initFromArray(n,e),r}var Kn,Zn=(In(Qn,Kn=jn),Qn.crossOrigin=function(t,e,n){void 0===n&&0!==e.indexOf("data:")?t.crossOrigin=se(e):!1!==n&&(t.crossOrigin="string"==typeof n?n:"anonymous")},Qn.prototype.upload=function(t,e,n,r){var i=t.gl,o=e.realWidth,t=e.realHeight;return r=r||this.source,i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===st.UNPACK),this.noSubImage||e.target!==i.TEXTURE_2D||n.width!==o||n.height!==t?(n.width=o,n.height=t,i.texImage2D(e.target,0,n.internalFormat,e.format,n.type,r)):i.texSubImage2D(i.TEXTURE_2D,0,0,0,e.format,n.type,r),!0},Qn.prototype.update=function(){var t,e;this.destroyed||(t=(e=this.source).naturalWidth||e.videoWidth||e.width,e=e.naturalHeight||e.videoHeight||e.height,this.resize(t,e),Kn.prototype.update.call(this))},Qn.prototype.dispose=function(){this.source=null},Qn);function Qn(t){var e=this,n=t.naturalWidth||t.videoWidth||t.width,r=t.naturalHeight||t.videoHeight||t.height;return(e=Kn.call(this,n,r)||this).source=t,e.noSubImage=!1,e}var $n,Jn=(In(tr,$n=Zn),tr.test=function(t){var e=self.OffscreenCanvas;return!!(e&&t instanceof e)||self.HTMLCanvasElement&&t instanceof HTMLCanvasElement},tr);function tr(t){return $n.call(this,t)||this}var er,nr=(In(rr,er=zn),rr.prototype.bind=function(t){er.prototype.bind.call(this,t),t.target=et.TEXTURE_CUBE_MAP},rr.prototype.addBaseTextureAt=function(t,e,n){if(void 0===n&&(n=this.linkBaseTexture),!this.items[e])throw new Error("Index "+e+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||0<Object.keys(t._glTextures).length){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=et.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this},rr.prototype.upload=function(t,e,n){for(var r=this.itemDirtyIds,i=0;i<rr.SIDES;i++){var o=this.items[i];r[i]<o.dirtyId&&(o.valid&&o.resource?(o.resource.upload(t,o,n),r[i]=o.dirtyId):r[i]<-1&&(t.gl.texImage2D(o.target,0,n.internalFormat,e.realWidth,e.realHeight,0,e.format,n.type,null),r[i]=-1))}return!0},rr.test=function(t){return Array.isArray(t)&&t.length===rr.SIDES},rr.SIDES=6,rr);function rr(t,e){var n=this,r=e||{},i=r.width,o=r.height,a=r.autoLoad,r=r.linkBaseTexture;if(t&&t.length!==rr.SIDES)throw new Error("Invalid length. Got "+t.length+", expected 6");for(var n=er.call(this,6,{width:i,height:o})||this,s=0;s<rr.SIDES;s++)n.items[s].target=et.TEXTURE_CUBE_MAP_POSITIVE_X+s;return n.linkBaseTexture=!1!==r,t&&n.initFromArray(t,e),!1!==a&&n.load(),n}var ir,or=(In(ar,ir=Zn),ar.prototype.load=function(t){var i=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise(function(t,e){var n=i.source;i.url=n.src;function r(){i.destroyed||(n.onload=null,n.onerror=null,i.resize(n.width,n.height),i._load=null,i.createBitmap?t(i.process()):t(i))}n.complete&&n.src?r():(n.onload=r,n.onerror=function(t){e(t),i.onError.emit(t)})}),this._load)},ar.prototype.process=function(){var e=this,n=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!self.createImageBitmap)return Promise.resolve(this);var r=self.createImageBitmap,t=!n.crossOrigin||"anonymous"===n.crossOrigin;return this._process=fetch(n.src,{mode:t?"cors":"no-cors"}).then(function(t){return t.blob()}).then(function(t){return r(t,0,0,n.width,n.height,{premultiplyAlpha:e.alphaMode===st.UNPACK?"premultiply":"none"})}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process},ar.prototype.upload=function(t,e,n){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return ir.prototype.upload.call(this,t,e,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(ir.prototype.upload.call(this,t,e,n,this.bitmap),!this.preserveBitmap){var r,i=!0,o=e._glTextures;for(r in o){var a=o[r];if(a!==n&&a.dirtyId!==e.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},ar.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,ir.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},ar.test=function(t){return"string"==typeof t||t instanceof HTMLImageElement},ar);function ar(t,e){var n,r=this;return e=e||{},t instanceof HTMLImageElement||(n=new Image,Zn.crossOrigin(n,t,e.crossorigin),n.src=t,t=n),r=ir.call(this,t)||this,!t.complete&&r._width&&r._height&&(r._width=0,r._height=0),r.url=t.src,r._process=null,r.preserveBitmap=!1,r.createBitmap=(void 0!==e.createBitmap?e.createBitmap:dt.CREATE_IMAGE_BITMAP)&&!!self.createImageBitmap,r.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,r.bitmap=null,r._load=null,!1!==e.autoLoad&&r.load(),r}var sr,ur=(In(cr,sr=Zn),cr.prototype.load=function(){var e=this;return this._load||(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()}),this._load)},cr.prototype._loadSvg=function(){var o=this,a=new Image;Zn.crossOrigin(a,this.svg,this._crossorigin),a.src=this.svg,a.onerror=function(t){o._resolve&&(a.onerror=null,o.onError.emit(t))},a.onload=function(){if(o._resolve){var t=a.width,e=a.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=t*o.scale,r=e*o.scale;(o._overrideWidth||o._overrideHeight)&&(n=o._overrideWidth||o._overrideHeight/e*t,r=o._overrideHeight||o._overrideWidth/t*e);var n=Math.round(n),r=Math.round(r),i=o.source;i.width=n,i.height=r,i._pixiId="canvas_"+ ++Wt,i.getContext("2d").drawImage(a,0,0,t,e,0,0,n,r),o._resolve(),o._resolve=null}}},cr.getSize=function(t){var e=cr.SVG_SIZE.exec(t),t={};return e&&(t[e[1]]=Math.round(parseFloat(e[3])),t[e[5]]=Math.round(parseFloat(e[7]))),t},cr.prototype.dispose=function(){sr.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},cr.test=function(t,e){return"svg"===e||"string"==typeof t&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(t)||"string"==typeof t&&cr.SVG_XML.test(t)},cr.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,cr.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,cr);function cr(t,e){var n=this;return e=e||{},(n=sr.call(this,document.createElement("canvas"))||this)._width=0,n._height=0,n.svg=t,n.scale=e.scale||1,n._overrideWidth=e.width,n._overrideHeight=e.height,n._resolve=null,n._crossorigin=e.crossorigin,n._load=null,!1!==e.autoLoad&&n.load(),n}var lr,hr=(In(fr,lr=Zn),fr.prototype.update=function(t){var e;this.destroyed||(e=an.shared.elapsedMS*this.source.playbackRate,this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(lr.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0))},fr.prototype.load=function(){var e=this;if(this._load)return this._load;var n=this.source;return(n.readyState===n.HAVE_ENOUGH_DATA||n.readyState===n.HAVE_FUTURE_DATA)&&n.width&&n.height&&(n.complete=!0),n.addEventListener("play",this._onPlayStart.bind(this)),n.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(n.addEventListener("canplay",this._onCanPlay),n.addEventListener("canplaythrough",this._onCanPlay),n.addEventListener("error",this._onError,!0)),this._load=new Promise(function(t){e.valid?t(e):(e._resolve=t,n.load())}),this._load},fr.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},fr.prototype._isSourcePlaying=function(){var t=this.source;return 0<t.currentTime&&!1===t.paused&&!1===t.ended&&2<t.readyState},fr.prototype._isSourceReady=function(){var t=this.source;return 3===t.readyState||4===t.readyState},fr.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(an.shared.add(this.update,this),this._isConnectedToTicker=!0)},fr.prototype._onPlayStop=function(){this._isConnectedToTicker&&(an.shared.remove(this.update,this),this._isConnectedToTicker=!1)},fr.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},fr.prototype.dispose=function(){this._isConnectedToTicker&&(an.shared.remove(this.update,this),this._isConnectedToTicker=!1);var t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),lr.prototype.dispose.call(this)},Object.defineProperty(fr.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(an.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(an.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(fr.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),fr.test=function(t,e){return self.HTMLVideoElement&&t instanceof HTMLVideoElement||-1<fr.TYPES.indexOf(e)},fr.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],fr.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},fr);function fr(t,e){var n=this;if(e=e||{},!(t instanceof HTMLVideoElement)){var r=document.createElement("video");r.setAttribute("preload","auto"),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline","");var i=(t="string"==typeof t?[t]:t)[0].src||t[0];Zn.crossOrigin(r,i,e.crossorigin);for(var o=0;o<t.length;++o){var a=document.createElement("source"),s=t[o],u=s.src,c=s.mime,s=(u=u||t[o]).split("?").shift().toLowerCase(),s=s.substr(s.lastIndexOf(".")+1),c=c||fr.MIME_TYPES[s]||"video/"+s;a.src=u,a.type=c,r.appendChild(a)}t=r}return(n=lr.call(this,t)||this).noSubImage=!0,n._autoUpdate=!0,n._isConnectedToTicker=!1,n._updateFPS=e.updateFPS||0,n._msToNextUpdate=0,n.autoPlay=!1!==e.autoPlay,n._load=null,n._resolve=null,n._onCanPlay=n._onCanPlay.bind(n),n._onError=n._onError.bind(n),!1!==e.autoLoad&&n.load(),n}var pr,dr=(In(yr,pr=Zn),yr.test=function(t){return!!self.createImageBitmap&&t instanceof ImageBitmap},yr);function yr(t){return pr.call(this,t)||this}Rn.push(or,dr,Jn,hr,ur,Nn,nr,Yn);var mr,vr={__proto__:null,Resource:jn,BaseImageResource:Zn,INSTALLED:Rn,autoDetectResource:An,AbstractMultiResource:zn,ArrayResource:Yn,BufferResource:Nn,CanvasResource:Jn,CubeResource:nr,ImageResource:or,SVGResource:ur,VideoResource:hr,ImageBitmapResource:dr},gr=(In(br,mr=Nn),br.prototype.upload=function(t,e,n){var r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===st.UNPACK);var i=e.realWidth,t=e.realHeight;return n.width===i&&n.height===t?r.texSubImage2D(e.target,0,0,0,i,t,e.format,n.type,this.data):(n.width=i,n.height=t,r.texImage2D(e.target,0,n.internalFormat,i,t,0,e.format,n.type,this.data)),!0},br);function br(){return null!==mr&&mr.apply(this,arguments)||this}var _r=(Object.defineProperty(xr.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),xr.prototype.addColorTexture=function(t,e){return this.colorTextures[t=void 0===t?0:t]=e||new Gn(null,{scaleMode:it.NEAREST,resolution:1,mipmap:at.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},xr.prototype.addDepthTexture=function(t){return this.depthTexture=t||new Gn(new gr(null,{width:this.width,height:this.height}),{scaleMode:it.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:at.OFF,format:tt.DEPTH_COMPONENT,type:nt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},xr.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},xr.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},xr.prototype.resize=function(t,e){if(t=Math.round(t),e=Math.round(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var n=0;n<this.colorTextures.length;n++){var r=this.colorTextures[n],i=r.resolution;r.setSize(t/i,e/i)}this.depthTexture&&(i=this.depthTexture.resolution,this.depthTexture.setSize(t/i,e/i))}},xr.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},xr.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},xr);function xr(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Pn("disposeFramebuffer"),this.multisample=ft.NONE}var wr,Tr=(In(Or,wr=Gn),Or.prototype.resize=function(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},Or.prototype.dispose=function(){this.framebuffer.dispose(),wr.prototype.dispose.call(this)},Or.prototype.destroy=function(){wr.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},Or);function Or(t){var e=this;return(t="number"==typeof t?{width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}:t).width=t.width||100,t.height=t.height||100,t.multisample=void 0!==t.multisample?t.multisample:ft.NONE,(e=wr.call(this,null,t)||this).mipmap=at.OFF,e.valid=!0,e.clearColor=[0,0,0,0],e.framebuffer=new _r(e.realWidth,e.realHeight).addColorTexture(0,e),e.framebuffer.multisample=t.multisample,e.maskStack=[],e.filterStack=[{}],e}var Sr=(Er.prototype.set=function(t,e,n){var r,i,o,a=e.width,s=e.height;n?(r=t.width/2/a,i=t.height/2/s,o=t.x/a+r,e=t.y/s+i,n=Le.add(n,Le.NW),this.x0=o+r*Le.uX(n),this.y0=e+i*Le.uY(n),n=Le.add(n,2),this.x1=o+r*Le.uX(n),this.y1=e+i*Le.uY(n),n=Le.add(n,2),this.x2=o+r*Le.uX(n),this.y2=e+i*Le.uY(n),n=Le.add(n,2),this.x3=o+r*Le.uX(n),this.y3=e+i*Le.uY(n)):(this.x0=t.x/a,this.y0=t.y/s,this.x1=(t.x+t.width)/a,this.y1=t.y/s,this.x2=(t.x+t.width)/a,this.y2=(t.y+t.height)/s,this.x3=t.x/a,this.y3=(t.y+t.height)/s),this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},Er.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},Er);function Er(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}var Pr,kr=new Sr,Rr=(In(Ar,Pr=mt.a),Ar.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},Ar.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},Ar.prototype.destroy=function(t){this.baseTexture&&(t&&((t=this.baseTexture.resource)&&t.url&&Qt[t.url]&&Ar.removeFromCache(t.url),this.baseTexture.destroy()),this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Ar.removeFromCache(this),this.textureCacheIds=null},Ar.prototype.clone=function(){var t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),e=new Ar(this.baseTexture,!this.noFrame&&t,e,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(e._frame=t),e},Ar.prototype.updateUvs=function(){this._uvs===kr&&(this._uvs=new Sr),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},Ar.from=function(t,e,n){void 0===e&&(e={}),void 0===n&&(n=dt.STRICT_TEXTURE_CACHE);var r="string"==typeof t,i=null,i=r?t:(t._pixiId||(o=e&&e.pixiIdPrefix||"pixiid",t._pixiId=o+"_"+ ++Wt),t._pixiId),o=Qt[i];if(r&&n&&!o)throw new Error('The cacheId "'+i+'" does not exist in TextureCache.');return o||(e.resolution||(e.resolution=ue(t)),(o=new Ar(new Gn(t,e))).baseTexture.cacheId=i,Gn.addToCache(o.baseTexture,i),Ar.addToCache(o,i)),o},Ar.fromURL=function(t,e){var n=Object.assign({autoLoad:!1},null==e?void 0:e.resourceOptions),r=Ar.from(t,Object.assign({resourceOptions:n},e),!1),e=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):e.load().then(function(){return Promise.resolve(r)})},Ar.fromBuffer=function(t,e,n,r){return new Ar(Gn.fromBuffer(t,e,n,r))},Ar.fromLoader=function(t,e,n,r){t=new Gn(t,Object.assign({scaleMode:dt.SCALE_MODE,resolution:ue(e)},r)),r=t.resource;r instanceof or&&(r.url=e);var i=new Ar(t);return Gn.addToCache(i.baseTexture,n=n||e),Ar.addToCache(i,n),n!==e&&(Gn.addToCache(i.baseTexture,e),Ar.addToCache(i,e)),i.baseTexture.valid?Promise.resolve(i):new Promise(function(t){i.baseTexture.once("loaded",function(){return t(i)})})},Ar.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Qt[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Qt[e]=t)},Ar.removeFromCache=function(t){if("string"==typeof t){var e=Qt[t];if(e){var n=e.textureCacheIds.indexOf(t);return-1<n&&e.textureCacheIds.splice(n,1),delete Qt[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)Qt[t.textureCacheIds[r]]===t&&delete Qt[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(Ar.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(Ar.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,n=t.y,r=t.width,i=t.height,o=e+r>this.baseTexture.width,a=n+i>this.baseTexture.height;if(o||a){e="X: "+e+" + "+r+" = "+(e+r)+" > "+this.baseTexture.width,n="Y: "+n+" + "+i+" = "+(n+i)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+e+" "+(o&&a?"and":"or")+" "+n)}this.valid=r&&i&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(Ar.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(Ar.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(Ar.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),Ar.prototype.castToBaseTexture=function(){return this.baseTexture},Ar);function Ar(t,e,n,r,i,o){var a=Pr.call(this)||this;if(a.noFrame=!1,e||(a.noFrame=!0,e=new pe(0,0,1,1)),t instanceof Ar&&(t=t.baseTexture),a.baseTexture=t,a._frame=e,a.trim=r,a.valid=!1,a._uvs=kr,a.uvMatrix=null,a.orig=n||e,a._rotate=Number(i||0),!0===i)a._rotate=2;else if(a._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return a.defaultAnchor=o?new Te(o.x,o.y):new Te(0,0),a._updateID=0,a.textureCacheIds=[],t.valid?a.noFrame?t.valid&&a.onBaseTextureUpdated(t):a.frame=e:t.once("loaded",a.onBaseTextureUpdated,a),a.noFrame&&t.on("update",a.onBaseTextureUpdated,a),a}function Cr(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}Rr.EMPTY=new Rr(new Gn),Cr(Rr.EMPTY),Cr(Rr.EMPTY.baseTexture),Rr.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new Rr(new Gn(new Jn(t)))}(),Cr(Rr.WHITE),Cr(Rr.WHITE.baseTexture);var Ir,Mr=(In(jr,Ir=Rr),Object.defineProperty(jr.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(jr.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(t){this.framebuffer.multisample=t},enumerable:!1,configurable:!0}),jr.prototype.resize=function(t,e,n){void 0===n&&(n=!0);var r=this.baseTexture.resolution,t=Math.round(t*r)/r,r=Math.round(e*r)/r;this.valid=0<t&&0<r,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=r,n&&this.baseTexture.resize(t,r),this.updateUvs()},jr.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},jr.create=function(t){for(var e=arguments,n=[],r=1;r<arguments.length;r++)n[r-1]=e[r];return"number"==typeof t&&(Kt("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),t={width:t,height:n[0],scaleMode:n[1],resolution:n[2]}),new jr(new Tr(t))},jr);function jr(t,e){e=Ir.call(this,t,e)||this;return e.valid=!0,e.filterFrame=null,e.filterPoolKey=null,e.updateUvs(),e}var Dr=(Lr.prototype.createTexture=function(t,e,n){void 0===n&&(n=ft.NONE);n=new Tr(Object.assign({width:t,height:e,resolution:1,multisample:n},this.textureOptions));return new Mr(n)},Lr.prototype.getOptimalTexture=function(t,e,n,r){var i;void 0===n&&(n=1),void 0===r&&(r=ft.NONE),t=Math.ceil(t*n),e=Math.ceil(e*n),this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight?i=1<r?-r:-1:(i=((65535&(t=Gt(t)))<<16|65535&(e=Gt(e)))>>>0,1<r&&(i+=4294967296*r)),this.texturePool[i]||(this.texturePool[i]=[]);var o=this.texturePool[i].pop();return(o=o||this.createTexture(t,e,r)).filterPoolKey=i,o.setResolution(n),o},Lr.prototype.getFilterTexture=function(t,e,n){n=this.getOptimalTexture(t.width,t.height,e||t.resolution,n||ft.NONE);return n.filterFrame=t.filterFrame,n},Lr.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},Lr.prototype.returnFilterTexture=function(t){this.returnTexture(t)},Lr.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var n=this.texturePool[e];if(n)for(var r=0;r<n.length;r++)n[r].destroy(!0)}this.texturePool={}},Lr.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){for(var e in this.enableFullScreen=0<t.width&&0<t.height,this.texturePool)if(Number(e)<0){var n=this.texturePool[e];if(n)for(var r=0;r<n.length;r++)n[r].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}},Lr.SCREEN_KEY=-1,Lr);function Lr(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}var Nr=(Fr.prototype.destroy=function(){this.buffer=null},Fr.from=function(t,e,n,r,i){return new Fr(t,e,n,r,i)},Fr);function Fr(t,e,n,r,i,o,a){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=nt.FLOAT),this.buffer=t,this.size=e,this.normalized=n,this.type=r,this.stride=i,this.start=o,this.instance=a}var Br=0,Ur=(Gr.prototype.update=function(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++},Gr.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},Gr.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(Gr.prototype,"index",{get:function(){return this.type===pt.ELEMENT_ARRAY_BUFFER},set:function(t){this.type=t?pt.ELEMENT_ARRAY_BUFFER:pt.ARRAY_BUFFER},enumerable:!1,configurable:!0}),Gr.from=function(t){return new Gr(t=t instanceof Array?new Float32Array(t):t)},Gr);function Gr(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=Br++,this.disposeRunner=new Pn("disposeBuffer")}var Xr={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var Hr={5126:4,5123:2,5121:1},zr=0,Vr={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},Wr=(Yr.prototype.addAttribute=function(t,e,n,r,i,o,a,s){if(void 0===n&&(n=0),void 0===r&&(r=!1),void 0===s&&(s=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Ur||(e instanceof Array&&(e=new Float32Array(e)),e=new Ur(e));var u=t.split("|");if(1<u.length){for(var c=0;c<u.length;c++)this.addAttribute(u[c],e,n,r,i);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new Nr(l,n,r,i,o,a,s),this.instanced=this.instanced||s,this},Yr.prototype.getAttribute=function(t){return this.attributes[t]},Yr.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},Yr.prototype.addIndex=function(t){return t instanceof Ur||(t instanceof Array&&(t=new Uint16Array(t)),t=new Ur(t)),t.type=pt.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},Yr.prototype.getIndex=function(){return this.indexBuffer},Yr.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],n=[],r=new Ur;for(t in this.attributes){var i=this.attributes[t],o=this.buffers[i.buffer];e.push(o.data),n.push(i.size*Hr[i.type]/4),i.buffer=0}for(r.data=function(t,e){for(var n=0,r=0,i={},o=0;o<t.length;o++)r+=e[o],n+=t[o].length;for(var a=new ArrayBuffer(4*n),s=null,u=0,o=0;o<t.length;o++){var c=e[o],l=t[o],h=Ft(l);i[h]||(i[h]=new Xr[h](a));for(var s=i[h],f=0;f<l.length;f++)s[(f/c|0)*r+u+f%c]=l[f];u+=c}return new Float32Array(a)}(e,n),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},Yr.prototype.getSize=function(){for(var t in this.attributes){t=this.attributes[t];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0},Yr.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},Yr.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},Yr.prototype.clone=function(){for(var t=new Yr,e=0;e<this.buffers.length;e++)t.buffers[e]=new Ur(this.buffers[e].data.slice(0));for(e in this.attributes){var n=this.attributes[e];t.attributes[e]=new Nr(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=pt.ELEMENT_ARRAY_BUFFER),t},Yr.merge=function(t){for(var e=new Yr,n=[],r=[],i=[],o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.buffers.length;s++)r[s]=r[s]||0,r[s]+=a.buffers[s].data.length,i[s]=0;for(o=0;o<a.buffers.length;o++)n[o]=new Vr[Ft(a.buffers[o].data)](r[o]),e.buffers[o]=new Ur(n[o]);for(o=0;o<t.length;o++){a=t[o];for(s=0;s<a.buffers.length;s++)n[s].set(a.buffers[s].data,i[s]),i[s]+=a.buffers[s].data.length}if(e.attributes=a.attributes,a.indexBuffer){e.indexBuffer=e.buffers[a.buffers.indexOf(a.indexBuffer)],e.indexBuffer.type=pt.ELEMENT_ARRAY_BUFFER;for(var u=0,c=0,l=0,h=0,o=0;o<a.buffers.length;o++)if(a.buffers[o]!==a.indexBuffer){h=o;break}for(o in a.attributes){var f=a.attributes[o];(0|f.buffer)===h&&(c+=f.size*Hr[f.type]/4)}for(o=0;o<t.length;o++){for(var p=t[o].indexBuffer.data,s=0;s<p.length;s++)e.indexBuffer.data[s+l]+=u;u+=t[o].buffers[h].data.length/c,l+=p.length}}return e},Yr);function Yr(t,e){void 0===e&&(e={}),this.buffers=t=void 0===t?[]:t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=zr++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Pn("disposeGeometry"),this.refCount=0}var qr,Kr=(In(Zr,qr=Wr),Zr);function Zr(){var t=qr.call(this)||this;return t.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),t}var Qr,$r=(In(Jr,Qr=Wr),Jr.prototype.map=function(t,e){var n,r;return this.uvs[0]=0,this.uvs[1]=0,this.uvs[2]=0+e.width/t.width,this.uvs[3]=0,this.uvs[4]=0+e.width/t.width,this.uvs[5]=0+e.height/t.height,this.uvs[6]=0,this.uvs[7]=0+e.height/t.height,n=e.x,r=e.y,this.vertices[0]=n,this.vertices[1]=r,this.vertices[2]=n+e.width,this.vertices[3]=r,this.vertices[4]=n+e.width,this.vertices[5]=r+e.height,this.vertices[6]=n,this.vertices[7]=r+e.height,this.invalidate(),this},Jr.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},Jr);function Jr(){var t=Qr.call(this)||this;return t.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.vertexBuffer=new Ur(t.vertices),t.uvBuffer=new Ur(t.uvs),t.addAttribute("aVertexPosition",t.vertexBuffer).addAttribute("aTextureCoord",t.uvBuffer).addIndex([0,1,2,0,2,3]),t}var ti=0,ei=(ni.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},ni.prototype.add=function(t,e,n){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[t]=new ni(e,n)},ni.from=function(t,e,n){return new ni(t,e,n)},ni.uboFrom=function(t,e){return new ni(t,null==e||e,!0)},ni);function ni(t,e,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=ti++,this.static=!!e,this.ubo=!!n,t instanceof Ur?(this.buffer=t,this.buffer.type=pt.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Ur(new Float32Array(1)),this.buffer.type=pt.UNIFORM_BUFFER,this.autoManage=!0))}var ri=(ii.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},ii);function ii(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=ft.NONE,this.sourceFrame=new pe,this.destinationFrame=new pe,this.bindingSourceFrame=new pe,this.bindingDestinationFrame=new pe,this.filters=[],this.transform=null}var oi=[new Te,new Te,new Te,new Te],ai=new Pe,si=(ui.prototype.push=function(t,e){for(var n=this.renderer,r=this.defaultFilterStack,i=this.statePool.pop()||new ri,o=this.renderer.renderTexture,a=e[0].resolution,s=e[0].multisample,u=e[0].padding,c=e[0].autoFit,l=e[0].legacy,h=1;h<e.length;h++)var f=e[h],a=Math.min(a,f.resolution),s=Math.min(s,f.multisample),u=this.useMaxPadding?Math.max(u,f.padding):u+f.padding,c=c&&f.autoFit,l=l||f.legacy;1===r.length&&(this.defaultFilterStack[0].renderTexture=o.current),r.push(i),i.resolution=a,i.multisample=s,i.legacy=l,i.target=t,i.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),i.sourceFrame.pad(u),c&&(p=this.tempRect.copyFrom(o.sourceFrame),n.projection.transform&&this.transformAABB(ai.copyFrom(n.projection.transform).invert(),p),i.sourceFrame.fit(p)),this.roundFrame(i.sourceFrame,(o.current||n).resolution,o.sourceFrame,o.destinationFrame,n.projection.transform),i.renderTexture=this.getOptimalFilterTexture(i.sourceFrame.width,i.sourceFrame.height,a,s),i.filters=e,i.destinationFrame.width=i.renderTexture.width,i.destinationFrame.height=i.renderTexture.height;var p=this.tempRect;p.x=0,p.y=0,p.width=i.sourceFrame.width,p.height=i.sourceFrame.height,i.renderTexture.filterFrame=i.sourceFrame,i.bindingSourceFrame.copyFrom(o.sourceFrame),i.bindingDestinationFrame.copyFrom(o.destinationFrame),i.transform=n.projection.transform,n.projection.transform=null,o.bind(i.renderTexture,i.sourceFrame,p),n.framebuffer.clear(0,0,0,0)},ui.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var i=r.inputSize,o=r.inputPixel,a=r.inputClamp;i[0]=e.destinationFrame.width,i[1]=e.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],o[0]=Math.round(i[0]*e.resolution),o[1]=Math.round(i[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=e.sourceFrame.width*i[2]-.5*o[2],a[3]=e.sourceFrame.height*i[3]-.5*o[3],e.legacy&&((o=r.filterArea)[0]=e.destinationFrame.width,o[1]=e.destinationFrame.height,o[2]=e.sourceFrame.x,o[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp),this.globalUniforms.update();t=t[t.length-1];if(this.renderer.framebuffer.blit(),1===n.length)n[0].apply(this,e.renderTexture,t.renderTexture,ut.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var s=e.renderTexture;(l=this.getOptimalFilterTexture(s.width,s.height,e.resolution)).filterFrame=s.filterFrame;for(var u=0,u=0;u<n.length-1;++u){1===u&&1<e.multisample&&((l=this.getOptimalFilterTexture(s.width,s.height,e.resolution)).filterFrame=s.filterFrame),n[u].apply(this,s,l,ut.CLEAR,e);var c=s,s=l,l=c}n[u].apply(this,s,t.renderTexture,ut.BLEND,e),1<u&&1<e.multisample&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(s),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},ui.prototype.bindAndClear=function(t,e){void 0===e&&(e=ut.CLEAR);var n=this.renderer,r=n.renderTexture,i=n.state;t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t&&t.filterFrame?((n=this.tempRect).x=0,n.y=0,n.width=t.filterFrame.width,n.height=t.filterFrame.height,r.bind(t,t.filterFrame,n)):t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);i=1&i.stateId||this.forceClear;(e===ut.CLEAR||e===ut.BLIT&&i)&&this.renderer.framebuffer.clear(0,0,0,0)},ui.prototype.applyFilter=function(t,e,n,r){var i=this.renderer;i.state.set(t.state),this.bindAndClear(n,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,i.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(J.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(J.TRIANGLE_STRIP))},ui.prototype.calculateSpriteMatrix=function(t,e){var n=this.activeState,r=n.sourceFrame,i=n.destinationFrame,n=e._texture.orig,i=t.set(i.width,0,0,i.height,r.x,r.y),r=e.worldTransform.copyTo(Pe.TEMP_MATRIX);return r.invert(),i.prepend(r),i.scale(1/n.width,1/n.height),i.translate(e.anchor.x,e.anchor.y),i},ui.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},ui.prototype.getOptimalFilterTexture=function(t,e,n,r){return void 0===r&&(r=ft.NONE),this.texturePool.getOptimalTexture(t,e,n=void 0===n?1:n,r)},ui.prototype.getFilterTexture=function(t,e,n){var r;"number"==typeof t&&(r=t,t=e,e=r),t=t||this.activeState.renderTexture;n=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,n||ft.NONE);return n.filterFrame=t.filterFrame,n},ui.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},ui.prototype.emptyPool=function(){this.texturePool.clear(!0)},ui.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},ui.prototype.transformAABB=function(t,e){var n=oi[0],r=oi[1],i=oi[2],o=oi[3];n.set(e.left,e.top),r.set(e.left,e.bottom),i.set(e.right,e.top),o.set(e.right,e.bottom),t.apply(n,n),t.apply(r,r),t.apply(i,i),t.apply(o,o);var a=Math.min(n.x,r.x,i.x,o.x),s=Math.min(n.y,r.y,i.y,o.y),t=Math.max(n.x,r.x,i.x,o.x),o=Math.max(n.y,r.y,i.y,o.y);e.x=a,e.y=s,e.width=t-a,e.height=o-s},ui.prototype.roundFrame=function(t,e,n,r,i){if(i){var o=i.a,a=i.b,s=i.c,u=i.d;if((1e-4<Math.abs(a)||1e-4<Math.abs(s))&&(1e-4<Math.abs(o)||1e-4<Math.abs(u)))return}(i=i?ai.copyFrom(i):ai.identity()).translate(-n.x,-n.y).scale(r.width/n.width,r.height/n.height).translate(r.x,r.y),this.transformAABB(i,t),t.ceil(e),this.transformAABB(i.invert(),t)},ui);function ui(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Dr,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new Kr,this.quadUv=new $r,this.tempRect=new pe,this.activeState={},this.globalUniforms=new ei({outputFrame:new pe,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}var ci=(li.prototype.flush=function(){},li.prototype.destroy=function(){this.renderer=null},li.prototype.start=function(){},li.prototype.stop=function(){this.flush()},li.prototype.render=function(t){},li);function li(t){this.renderer=t}var hi=(fi.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},fi.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},fi.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},fi.prototype.copyBoundTextures=function(t,e){for(var n=this.renderer.texture.boundTextures,r=e-1;0<=r;--r)t[r]=n[r]||null,t[r]&&(t[r]._batchLocation=r)},fi.prototype.boundArray=function(t,e,n,r){for(var i=t.elements,o=t.ids,a=t.count,s=0,u=0;u<a;u++){var c=i[u],l=c._batchLocation;if(0<=l&&l<r&&e[l]===c)o[u]=l;else for(;s<r;){var h=e[s];if(!h||h._batchEnabled!==n||h._batchLocation!==s){o[u]=s,e[c._batchLocation=s]=c;break}s++}}},fi.prototype.destroy=function(){this.renderer=null},fi);function fi(t){this.renderer=t,this.emptyRenderer=new ci(t),this.currentRenderer=this.emptyRenderer}var pi=0,di=(Object.defineProperty(yi.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),yi.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=pi++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},yi.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=pi++,this.renderer.runners.contextChange.emit(t)},yi.prototype.initFromOptions=function(t){t=this.createContext(this.renderer.view,t);this.initFromContext(t)},yi.prototype.createContext=function(t,e){var n;if(n=dt.PREFER_ENV>=K.WEBGL2?t.getContext("webgl2",e):n)this.webGLVersion=2;else if(this.webGLVersion=1,!(n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl},yi.prototype.getExtensions=function(){var t=this.gl,e={anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})},yi.prototype.handleContextLost=function(t){t.preventDefault()},yi.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},yi.prototype.destroy=function(){var t=this.renderer.view;this.renderer=null,t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},yi.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},yi.prototype.validateContext=function(t){var e=t.getContextAttributes(),n="WebGL2RenderingContext"in self&&t instanceof self.WebGL2RenderingContext;n&&(this.webGLVersion=2),e.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");t=n||!!t.getExtension("OES_element_index_uint");(this.supports.uint32Indices=t)||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},yi);function yi(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}var mi=function(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=ft.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},vi=new pe,gi=(bi.prototype.contextChange=function(){var e,t,n=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new pe,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion?(e=this.renderer.context.extensions.drawBuffers,t=this.renderer.context.extensions.depthTexture,dt.PREFER_ENV===K.WEBGL_LEGACY&&(t=e=null),e?n.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,n.drawBuffers=function(){}),t||(this.writeDepthTexture=!1)):this.msaaSamples=n.getInternalformatParameter(n.RENDERBUFFER,n.RGBA8,n.SAMPLES)},bi.prototype.bind=function(t,e,n){void 0===n&&(n=0);var r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.mipLevel!==n&&(t.dirtyId++,t.dirtyFormat++,i.mipLevel=n),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,i.dirtySize=t.dirtySize,this.updateFramebuffer(t,n)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var o,a,s=0;s<t.colorTextures.length;s++){var u=t.colorTextures[s];this.renderer.texture.unbind(u.parentTextureArray||u)}t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?(o=e.width>>n,a=e.height>>n,i=o/e.width,this.setViewport(e.x*i,e.y*i,o,a)):(o=t.width>>n,a=t.height>>n,this.setViewport(0,0,o,a))}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},bi.prototype.setViewport=function(t,e,n,r){var i=this.viewport;t=Math.round(t),e=Math.round(e),n=Math.round(n),r=Math.round(r),i.width===n&&i.height===r&&i.x===t&&i.y===e||(i.x=t,i.y=e,i.width=n,i.height=r,this.gl.viewport(t,e,n,r))},Object.defineProperty(bi.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),bi.prototype.clear=function(t,e,n,r,i){void 0===i&&(i=Q.COLOR|Q.DEPTH);var o=this.gl;o.clearColor(t,e,n,r),o.clear(i)},bi.prototype.initFramebuffer=function(t){var e=this.gl,e=new mi(e.createFramebuffer());return e.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},bi.prototype.resizeFramebuffer=function(t){var e=this.gl,n=t.glFramebuffers[this.CONTEXT_UID];n.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.RGBA8,t.width,t.height)),n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),n.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));var r=t.colorTextures,i=r.length;e.drawBuffers||(i=Math.min(i,1));for(var o=0;o<i;o++){var a=r[o],a=a.parentTextureArray||a;this.renderer.texture.bind(a,0)}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)},bi.prototype.updateFramebuffer=function(t,e){var n=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures,o=i.length;n.drawBuffers||(o=Math.min(o,1)),1<r.multisample&&this.canMultisampleFramebuffer(t)?(r.msaaBuffer=r.msaaBuffer||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,r.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,n.RGBA8,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,r.msaaBuffer)):r.msaaBuffer&&(n.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));for(var a,s=[],u=0;u<o;u++){var c=i[u],l=c.parentTextureArray||c;this.renderer.texture.bind(l,0),0===u&&r.msaaBuffer||(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+u,c.target,l._glTextures[this.CONTEXT_UID].texture,e),s.push(n.COLOR_ATTACHMENT0+u))}1<s.length&&n.drawBuffers(s),t.depthTexture&&this.writeDepthTexture&&(a=t.depthTexture,this.renderer.texture.bind(a,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,e)),!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture?r.stencil&&(n.deleteRenderbuffer(r.stencil),r.stencil=null):(r.stencil=r.stencil||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,r.stencil),r.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,n.DEPTH24_STENCIL8,t.width,t.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,r.stencil))},bi.prototype.canMultisampleFramebuffer=function(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture},bi.prototype.detectSamples=function(t){var e=this.msaaSamples,n=ft.NONE;if(t<=1||null===e)return n;for(var r=0;r<e.length;r++)if(e[r]<=t){n=e[r];break}return n=1===n?ft.NONE:n},bi.prototype.blit=function(t,e,n){var r=this.current,i=this.renderer,o=this.gl,a=this.CONTEXT_UID;if(2===i.context.webGLVersion&&r){i=r.glFramebuffers[a];if(i){if(!t){if(!i.msaaBuffer)return;a=r.colorTextures[0];if(!a)return;i.blitFramebuffer||(i.blitFramebuffer=new _r(r.width,r.height),i.blitFramebuffer.addColorTexture(0,a)),(t=i.blitFramebuffer).colorTextures[0]!==a&&(t.colorTextures[0]=a,t.dirtyId++,t.dirtyFormat++),t.width===r.width&&t.height===r.height||(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||((e=vi).width=r.width,e.height=r.height);r=e.width===(n=n||e).width&&e.height===n.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,i.framebuffer),o.blitFramebuffer(e.x,e.y,e.width,e.height,n.x,n.y,n.width,n.height,o.COLOR_BUFFER_BIT,r?o.NEAREST:o.LINEAR)}}},bi.prototype.disposeFramebuffer=function(t,e){var n,r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;r&&(delete t.glFramebuffers[this.CONTEXT_UID],0<=(n=this.managedFramebuffers.indexOf(t))&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&i.deleteRenderbuffer(r.msaaBuffer),r.stencil&&i.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&r.blitFramebuffer.dispose())},bi.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)},bi.prototype.forceStencil=function(){var t,e,n,r,i=this.current;!i||(t=i.glFramebuffers[this.CONTEXT_UID])&&!t.stencil&&(i.stencil=!0,e=i.width,n=i.height,i=(r=this.gl).createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,i),t.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,t.multisample,r.DEPTH24_STENCIL8,e,n):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,e,n),t.stencil=i,r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,i))},bi.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new pe},bi.prototype.destroy=function(){this.renderer=null},bi);function bi(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new _r(10,10),this.msaaSamples=null}var _i={5126:4,5123:2,5121:1},xi=(wi.prototype.contextChange=function(){this.disposeAll(!0);var e,o,t=this.gl=this.renderer.gl,n=this.renderer.context;this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==n.webGLVersion&&(e=this.renderer.context.extensions.vertexArrayObject,(e=dt.PREFER_ENV===K.WEBGL_LEGACY?null:e)?(t.createVertexArray=function(){return e.createVertexArrayOES()},t.bindVertexArray=function(t){return e.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return e.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})),2!==n.webGLVersion&&((o=t.getExtension("ANGLE_instanced_arrays"))?(t.vertexAttribDivisor=function(t,e){return o.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,n,r,i){return o.drawElementsInstancedANGLE(t,e,n,r,i)},t.drawArraysInstanced=function(t,e,n,r){return o.drawArraysInstancedANGLE(t,e,n,r)}):this.hasInstance=!1),this.canUseUInt32ElementIndex=2===n.webGLVersion||!!n.extensions.uint32ElementIndex},wi.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var n=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID],i=!1;r||((this.managedGeometries[t.id]=t).disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},i=!0);i=r[e.program.id]||this.initGeometryVao(t,e,i);this._activeGeometry=t,this._activeVao!==i&&(this._activeVao=i,this.hasVao?n.bindVertexArray(i):this.activateVao(t,e.program)),this.updateBuffers()},wi.prototype.reset=function(){this.unbind()},wi.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.renderer.buffer,n=0;n<t.buffers.length;n++){var r=t.buffers[n];e.update(r)}},wi.prototype.checkCompatibility=function(t,e){var n,r=t.attributes;for(n in e.attributeData)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},wi.prototype.getSignature=function(t,e){var n,r=t.attributes,i=e.attributeData,o=["g",t.id];for(n in r)i[n]&&o.push(n);return o.join("-")},wi.prototype.initGeometryVao=function(t,e,n){void 0===n&&(n=!0);var r=this.gl,i=this.CONTEXT_UID,o=this.renderer.buffer,a=e.program;a.glPrograms[i]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,a);var s=this.getSignature(t,a),u=t.glVertexArrayObjects[this.CONTEXT_UID],e=u[s];if(e)return u[a.id]=e;var c,l=t.buffers,h=t.attributes,f={},p={};for(c in l)f[c]=0,p[c]=0;for(c in h)!h[c].size&&a.attributeData[c]?h[c].size=a.attributeData[c].size:h[c].size||console.warn("PIXI Geometry attribute '"+c+"' size cannot be determined (likely the bound shader does not have the attribute)"),f[h[c].buffer]+=h[c].size*_i[h[c].type];for(c in h){var d=h[c],y=d.size;void 0===d.stride&&(f[d.buffer]===y*_i[d.type]?d.stride=0:d.stride=f[d.buffer]),void 0===d.start&&(d.start=p[d.buffer],p[d.buffer]+=y*_i[d.type])}e=r.createVertexArray(),r.bindVertexArray(e);for(var m=0;m<l.length;m++){var v=l[m];o.bind(v),n&&v._glBuffers[i].refCount++}return this.activateVao(t,a),this._activeVao=e,u[a.id]=e,u[s]=e},wi.prototype.disposeGeometry=function(t,e){var n;if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,o=t.buffers,a=null===(n=this.renderer)||void 0===n?void 0:n.buffer;if(t.disposeRunner.remove(this),r){if(a)for(var s=0;s<o.length;s++){var u=o[s]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,0!==u.refCount||e||a.dispose(o[s],e))}if(!e)for(var c in r)"g"===c[0]&&(c=r[c],this._activeVao===c&&this.unbind(),i.deleteVertexArray(c));delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},wi.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t)},wi.prototype.activateVao=function(t,e){var n=this.gl,r=this.CONTEXT_UID,i=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&i.bind(t.indexBuffer);var s,u=null;for(s in a){var c=a[s],l=o[c.buffer],h=l._glBuffers[r];if(e.attributeData[s]){u!==h&&(i.bind(l),u=h);h=e.attributeData[s].location;if(n.enableVertexAttribArray(h),n.vertexAttribPointer(h,c.size,c.type||n.FLOAT,c.normalized,c.stride,c.start),c.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(h,1)}}}},wi.prototype.draw=function(t,e,n,r){var i,o,a=this.gl,s=this._activeGeometry;return s.indexBuffer?(o=2===(i=s.indexBuffer.data.BYTES_PER_ELEMENT)?a.UNSIGNED_SHORT:a.UNSIGNED_INT,2===i||4===i&&this.canUseUInt32ElementIndex?s.instanced?a.drawElementsInstanced(t,e||s.indexBuffer.data.length,o,(n||0)*i,r||1):a.drawElements(t,e||s.indexBuffer.data.length,o,(n||0)*i):console.warn("unsupported index buffer type: uint32")):s.instanced?a.drawArraysInstanced(t,n,e||s.getSize(),r||1):a.drawArrays(t,n,e||s.getSize()),this},wi.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},wi.prototype.destroy=function(){this.renderer=null},wi);function wi(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}var Ti=(Oi.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=ht.NONE,this.autoDetect=!0),this._target=null},Oi.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},Oi);function Oi(t){void 0===t&&(t=null),this.type=ht.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=dt.FILTER_MULTISAMPLE,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}function Si(t,e,n){e=t.createShader(e);return t.shaderSource(e,n),t.compileShader(e),e}function Ei(t,e){var n=t.getShaderSource(e).split("\n").map(function(t,e){return e+": "+t}),t=t.getShaderInfoLog(e),e=t.split("\n"),r={},e=e.map(function(t){return parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(t){return!(!t||r[t])&&(r[t]=!0)}),i=[""];e.forEach(function(t){n[t-1]="%c"+n[t-1]+"%c",i.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});e=n.join("\n");i[0]=e,console.error(t),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,i),console.groupEnd()}function Pi(t){for(var e=new Array(t),n=0;n<e.length;n++)e[n]=!1;return e}function ki(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return Pi(2*e);case"bvec3":return Pi(3*e);case"bvec4":return Pi(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var Ri,Ai={},Ci=Ai;function Ii(){var t,e;return(Ci===Ai||Ci&&Ci.isContextLost())&&(t=document.createElement("canvas"),e=void 0,(e=dt.PREFER_ENV>=K.WEBGL2?t.getContext("webgl2",{}):e)||((e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),Ci=e),Ci}function Mi(t,e,n){if("precision"===t.substring(0,9))return n!==lt.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;var r=e;return"precision "+(r=e===lt.HIGH&&n!==lt.HIGH?lt.MEDIUM:r)+" float;\n"+t}var ji={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Di(t){return ji[t]}var Li=null,Ni={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Fi(t,e){if(!Li){var n=Object.keys(Ni);Li={};for(var r=0;r<n.length;++r){var i=n[r];Li[t[i]]=Ni[i]}}return Li[e]}var Bi=[{test:function(t){return"float"===t.type&&1===t.size},code:function(t){return'\n            if(uv["'+t+'"] !== ud["'+t+'"].value)\n            {\n                ud["'+t+'"].value = uv["'+t+'"]\n                gl.uniform1f(ud["'+t+'"].location, uv["'+t+'"])\n            }\n            '}},{test:function(t){return("sampler2D"===t.type||"samplerCube"===t.type||"sampler2DArray"===t.type)&&1===t.size&&!t.isArray},code:function(t){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+t+'"], t);\n\n            if(ud["'+t+'"].value !== t)\n            {\n                ud["'+t+'"].value = t;\n                gl.uniform1i(ud["'+t+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(t,e){return"mat3"===t.type&&1===t.size&&void 0!==e.a},code:function(t){return'\n            gl.uniformMatrix3fv(ud["'+t+'"].location, false, uv["'+t+'"].toArray(true));\n            '},codeUbo:function(t){return"\n                var "+t+"_matrix = uv."+t+".toArray(true);\n\n                data[offset] = "+t+"_matrix[0];\n                data[offset+1] = "+t+"_matrix[1];\n                data[offset+2] = "+t+"_matrix[2];\n        \n                data[offset + 4] = "+t+"_matrix[3];\n                data[offset + 5] = "+t+"_matrix[4];\n                data[offset + 6] = "+t+"_matrix[5];\n        \n                data[offset + 8] = "+t+"_matrix[6];\n                data[offset + 9] = "+t+"_matrix[7];\n                data[offset + 10] = "+t+"_matrix[8];\n            "}},{test:function(t,e){return"vec2"===t.type&&1===t.size&&void 0!==e.x},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+t+'"].location, v.x, v.y);\n                }'},codeUbo:function(t){return"\n                v = uv."+t+";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            "}},{test:function(t){return"vec2"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+t+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(t,e){return"vec4"===t.type&&1===t.size&&void 0!==e.width},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+t+'"].location, v.x, v.y, v.width, v.height)\n                }'},codeUbo:function(t){return"\n                    v = uv."+t+";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                "}},{test:function(t){return"vec4"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+t+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],Ui={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",uint:"gl.uniform1ui(location, v)",uvec2:"gl.uniform2ui(location, v[0], v[1])",uvec3:"gl.uniform3ui(location, v[0], v[1], v[2])",uvec4:"gl.uniform4ui(location, v[0], v[1], v[2], v[3])",bool:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1i(location, v)\n    }",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},Gi={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Xi,Hi=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function zi(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var n=e.createShader(e.FRAGMENT_SHADER);;){var r=Hi.replace(/%forloop%/gi,function(t){for(var e="",n=0;n<t;++n)0<n&&(e+="\nelse "),n<t-1&&(e+="if(test == "+n+".0){}");return e}(t));if(e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0}return t}var Vi=0,Wi={},Yi=(Object.defineProperty(qi,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(qi,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),qi.from=function(t,e,n){var r=t+e,i=Zt[r];return i||(Zt[r]=i=new qi(t,e,n)),i},qi);function qi(t,e,n){void 0===n&&(n="pixi-shader"),this.id=Vi++,this.vertexSrc=t||qi.defaultVertexSrc,this.fragmentSrc=e||qi.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(n=n.replace(/\s+/g,"-"),Wi[n]?(Wi[n]++,n+="-"+Wi[n]):Wi[n]=1,this.vertexSrc="#define SHADER_NAME "+n+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+n+"\n"+this.fragmentSrc,this.vertexSrc=Mi(this.vertexSrc,dt.PRECISION_VERTEX,lt.HIGH),this.fragmentSrc=Mi(this.fragmentSrc,dt.PRECISION_FRAGMENT,(Ri||(Ri=lt.MEDIUM,(n=Ii())&&n.getShaderPrecisionFormat&&(n=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT),Ri=n.precision?lt.HIGH:lt.MEDIUM)),Ri))),this.glPrograms={},this.syncUniforms=null}var Ki=(Zi.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var n in e.uniforms){n=e.uniforms[n];if(n.group&&this.checkUniformExists(t,n))return!0}return!1},Zi.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(Zi.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),Zi.from=function(t,e,n){return new Zi(Yi.from(t,e),n)},Zi);function Zi(t,e){this.uniformBindCount=0,this.program=t,this.uniformGroup=e?e instanceof ei?e:new ei(e):new ei({})}var Qi=(Object.defineProperty($i.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(t){!!(1&this.data)!==t&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(t){!!(2&this.data)!==t&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(t){!!(4&this.data)!==t&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(t){!!(8&this.data)!==t&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(t){!!(32&this.data)!==t&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(t){!!(16&this.data)!==t&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){this.blend=t!==$.NONE,this._blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),$i.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},$i.for2d=function(){var t=new $i;return t.depthTest=!1,t.blend=!0,t},$i);function $i(){this.data=0,this.blendMode=$.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}var Ji,to=(In(eo,Ji=Ki),eo.prototype.apply=function(t,e,n,r,i){t.applyFilter(this,e,n,r)},Object.defineProperty(eo.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t},enumerable:!1,configurable:!0}),Object.defineProperty(eo,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(eo,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),eo);function eo(t,e,n){var r=this,e=Yi.from(t||eo.defaultVertexSrc,e||eo.defaultFragmentSrc);return(r=Ji.call(this,e,n)||this).padding=0,r.resolution=dt.FILTER_RESOLUTION,r.multisample=dt.FILTER_MULTISAMPLE,r.enabled=!0,r.autoFit=!0,r.state=new Qi,r}var no=new Pe,ro=(Object.defineProperty(io.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),io.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var n=this.mapCoord,r=0;r<t.length;r+=2){var i=t[r],o=t[r+1];e[r]=i*n.a+o*n.c+n.tx,e[r+1]=i*n.b+o*n.d+n.ty}return e},io.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var r=e.orig,i=e.trim;i&&(no.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(no));t=e.baseTexture,n=this.uClampFrame,r=this.clampMargin/t.resolution,i=this.clampOffset;return n[0]=(e._frame.x+r+i)/t.width,n[1]=(e._frame.y+r+i)/t.height,n[2]=(e._frame.x+e._frame.width-r+i)/t.width,n[3]=(e._frame.y+e._frame.height-r+i)/t.height,this.uClampOffset[0]=i/t.realWidth,this.uClampOffset[1]=i/t.realHeight,this.isSimple=e._frame.width===t.width&&e._frame.height===t.height&&0===e.rotate,!0},io);function io(t,e){this._texture=t,this.mapCoord=new Pe,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}var oo,ao=(In(so,oo=to),so.prototype.apply=function(t,e,n,r){var i=this.maskSprite,o=i._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new ro(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,i).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,n,r))},so);function so(t){var e=this,n=new Pe,e=oo.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n")||this;return t.renderable=!1,e.maskSprite=t,e.maskMatrix=n,e}var uo=(co.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},co.prototype.push=function(t,e){var n,r=e;switch(r.isMaskData||((n=this.maskDataPool.pop()||new Ti).pooled=!0,n.maskObject=e,r=n),r.autoDetect&&this.detect(r),r.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),r._target=t,r.type){case ht.SCISSOR:this.maskStack.push(r),this.renderer.scissor.push(r);break;case ht.STENCIL:this.maskStack.push(r),this.renderer.stencil.push(r);break;case ht.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r),this.maskStack.push(r)}},co.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case ht.SCISSOR:this.renderer.scissor.pop();break;case ht.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case ht.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},co.prototype.detect=function(t){var e,n=t.maskObject;n.isSprite?t.type=ht.SPRITE:(t.type=ht.STENCIL,this.enableScissor&&n.isFastRect&&n.isFastRect()&&(e=n.worldTransform,n=Math.atan2(e.b,e.a),e=Math.atan2(e.d,e.c),n=Math.round(n*(180/Math.PI)*100),e=((e=Math.round(e*(180/Math.PI)*100)-n)%18e3+18e3)%18e3,0==(n=(n%9e3+9e3)%9e3)&&9e3==e&&(t.type=ht.SCISSOR)))},co.prototype.pushSpriteMask=function(t){var e,n,r=t.maskObject,i=t._target,o=(o=this.alphaMaskPool[this.alphaMaskIndex])||(this.alphaMaskPool[this.alphaMaskIndex]=[new ao(r)]),a=this.renderer,s=a.renderTexture;u=s.current?(e=s.current,n=t.resolution||e.resolution,null!==(s=t.multisample)&&void 0!==s?s:e.multisample):(n=t.resolution||a.resolution,null!==(u=t.multisample)&&void 0!==u?u:a.multisample),o[0].resolution=n,o[0].multisample=u,o[0].maskSprite=r;var u=i.filterArea;i.filterArea=r.getBounds(!0),a.filter.push(i,o),i.filterArea=u,this.alphaMaskIndex++},co.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},co.prototype.destroy=function(){this.renderer=null},co);function co(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}lo.prototype.getStackLength=function(){return this.maskStack.length},lo.prototype.setMaskStack=function(t){var e=this.renderer.gl,n=this.getStackLength();this.maskStack=t;t=this.getStackLength();t!==n&&(0===t?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},lo.prototype._useCurrent=function(){},lo.prototype.destroy=function(){this.renderer=null,this.maskStack=null},bt=lo;function lo(t){this.renderer=t,this.maskStack=[],this.glConst=0}var ho,fo=(In(po,ho=bt),po.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},po.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var n=t._scissorRect,r=e.getBounds(!0),i=this.renderer.gl;e.renderable=!1,n?r.fit(n):i.enable(i.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},po.prototype.pop=function(){var t=this.renderer.gl;0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)},po.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,n=this.renderer.projection,r=n.transform,i=n.sourceFrame,o=n.destinationFrame,a=(e||this.renderer).resolution,s=o.width/i.width,u=o.height/i.height,n=((t.x-i.x)*s+o.x)*a,o=((t.y-i.y)*u+o.y)*a,s=t.width*s*a,u=t.height*u*a;r&&(n+=r.tx*a,o+=r.ty*a),e||(o=this.renderer.height-u-o),n=Math.round(n),o=Math.round(o),s=Math.round(s),u=Math.round(u),this.renderer.gl.scissor(n,o,s,u)},po);function po(t){t=ho.call(this,t)||this;return t.glConst=WebGLRenderingContext.SCISSOR_TEST,t}var yo,mo=(In(vo,yo=bt),vo.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},vo.prototype.push=function(t){var e=t.maskObject,n=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),n.enable(n.STENCIL_TEST)),t._stencilCounter++,n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.EQUAL,r,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},vo.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clearStencil(0),e.clear(e.STENCIL_BUFFER_BIT)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},vo.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},vo);function vo(t){t=yo.call(this,t)||this;return t.glConst=WebGLRenderingContext.STENCIL_TEST,t}var go=(bo.prototype.update=function(t,e,n,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,r),this.transform&&this.projectionMatrix.append(this.transform);r=this.renderer;r.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,r.globalUniforms.update(),r.shader.shader&&r.shader.syncUniformGroup(r.shader.shader.uniforms.globals)},bo.prototype.calculateProjection=function(t,e,n,r){var i=this.projectionMatrix,r=r?-1:1;i.identity(),i.a=1/e.width*2,i.d=r*(1/e.height*2),i.tx=-1-e.x*i.a,i.ty=-r-e.y*i.d},bo.prototype.setTransform=function(t){},bo.prototype.destroy=function(){this.renderer=null},bo);function bo(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Pe,this.transform=null}var _o=new pe,xo=new pe,wo=(To.prototype.bind=function(t,e,n){var r,i,o,a=this.renderer;(this.current=t=void 0===t?null:t)?(o=(r=t.baseTexture).resolution,e||(_o.width=t.frame.width,_o.height=t.frame.height,e=_o),n||(xo.x=t.frame.x,xo.y=t.frame.y,xo.width=e.width,xo.height=e.height,n=xo),i=r.framebuffer):(o=a.resolution,e||(_o.width=a.screen.width,_o.height=a.screen.height,e=_o),n||((n=_o).width=e.width,n.height=e.height));var s=this.viewportFrame;s.x=n.x*o,s.y=n.y*o,s.width=n.width*o,s.height=n.height*o,t||(s.y=a.view.height-(s.y+s.height)),s.ceil(),this.renderer.framebuffer.bind(i,s),this.renderer.projection.update(n,e,o,!i),t?this.renderer.mask.setMaskStack(r.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n)},To.prototype.clear=function(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor;var n,r,i=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer.screen,a=i.width!==o.width||i.height!==o.height;a&&(n=(r=this.viewportFrame).x,i=r.y,o=r.width,r=r.height,n=Math.round(n),i=Math.round(i),o=Math.round(o),r=Math.round(r),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(n,i,o,r)),this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),a&&this.renderer.scissor.pop()},To.prototype.resize=function(){this.bind(null)},To.prototype.reset=function(){this.bind(null)},To.prototype.destroy=function(){this.renderer=null},To);function To(t){this.renderer=t,this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new pe,this.destinationFrame=new pe,this.viewportFrame=new pe}function Oo(t,e,n,r,i){n.buffer.update(i)}var So={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},Eo={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function Po(t){for(var e=t.map(function(t){return{data:t,offset:0,dataLen:0,dirty:0}}),n=0,r=0,i=0,o=0;o<e.length;o++){var a,s=e[o],n=Eo[s.data.type];1<s.data.size&&(n=Math.max(n,16)*s.data.size),r%(s.dataLen=n)!=0&&r<16&&(r+=a=r%n%16,i+=a),16<r+n?(i=16*Math.ceil(i/16),s.offset=i,i+=n,r=n):(s.offset=i,r+=n,i+=n)}return{uboElements:e,size:i=16*Math.ceil(i/16)}}function ko(t,e){var n,r=[];for(n in t)e[n]&&r.push(e[n]);return r.sort(function(t,e){return t.index-e.index}),r}function Ro(t,e){if(!t.autoManage)return{size:0,syncFunc:Oo};for(var e=Po(ko(t.uniforms,e)),n=e.uboElements,e=e.size,r=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],i=0;i<n.length;i++){for(var o,a,s=n[i],u=t.uniforms[s.data.name],c=s.data.name,l=!1,h=0;h<Bi.length;h++){var f=Bi[h];if(f.codeUbo&&f.test(s.data,u)){r.push("offset = "+s.offset/4+";",Bi[h].codeUbo(s.data.name,u)),l=!0;break}}l||(1<s.data.size?(o=Di(s.data.type),a=Math.max(Eo[s.data.type]/16,1),r.push("\n                cv = ud."+c+".value;\n                v = uv."+c+";\n                offset = "+s.offset/4+";\n\n                t = 0;\n\n                for(var i=0; i < "+s.data.size*a+"; i++)\n                {\n                    for(var j = 0; j < "+(a=o/a)+"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += "+(4-a%4)%4+";\n                }\n\n                ")):(a=So[s.data.type],r.push("\n                cv = ud."+c+".value;\n                v = uv."+c+";\n                offset = "+s.offset/4+";\n                "+a+";\n                ")))}return r.push("\n       renderer.buffer.update(buffer);\n    "),{size:e,syncFunc:new Function("ud","uv","renderer","syncData","buffer",r.join("\n"))}}var Ao=function(){},Co=(Io.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},Io);function Io(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}function Mo(t,e){var n,r,i,o,a=Si(t,t.VERTEX_SHADER,e.vertexSrc),s=Si(t,t.FRAGMENT_SHADER,e.fragmentSrc),u=t.createProgram();t.attachShader(u,a),t.attachShader(u,s),t.linkProgram(u),t.getProgramParameter(u,t.LINK_STATUS)||(r=u,i=a,o=s,(n=t).getProgramParameter(r,n.LINK_STATUS)||(n.getShaderParameter(i,n.COMPILE_STATUS)||Ei(n,i),n.getShaderParameter(o,n.COMPILE_STATUS)||Ei(n,o),console.error("PixiJS Error: Could not initialize shader."),""!==n.getProgramInfoLog(r)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",n.getProgramInfoLog(r)))),e.attributeData=function(t,e){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var o,a=e.getActiveAttrib(t,i);0!==a.name.indexOf("gl_")&&(o={type:o=Fi(e,a.type),name:a.name,size:Di(o),location:i},n[a.name]=o)}return n}(u,t),e.uniformData=function(t,e){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<r;i++){var o=e.getActiveUniform(t,i),a=o.name.replace(/\[.*?\]$/,""),s=!!o.name.match(/\[.*?\]$/),u=Fi(e,o.type);n[a]={name:a,index:i,type:u,size:o.size,isArray:s,value:ki(u,o.size)}}return n}(u,t);var c=Object.keys(e.attributeData);c.sort(function(t,e){return e<t?1:-1});for(var l=0;l<c.length;l++)e.attributeData[c[l]].location=l,t.bindAttribLocation(u,l,c[l]);t.linkProgram(u),t.deleteShader(a),t.deleteShader(s);var h={};for(l in e.uniformData){var f=e.uniformData[l];h[l]={location:t.getUniformLocation(u,l),value:ki(f.type,f.size)}}return new Co(u,h)}var jo=0,Do={textureCount:0,uboCount:0},Lo=(No.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Xi)return Xi;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Xi=!0===t({a:"b"},"a","b")}catch(t){Xi=!1}return Xi}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},No.prototype.contextChange=function(t){this.gl=t,this.reset()},No.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var n=t.program,r=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(r.program)),e||(Do.textureCount=0,Do.uboCount=0,this.syncUniformGroup(t.uniformGroup,Do)),r},No.prototype.setUniforms=function(t){var e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)},No.prototype.syncUniformGroup=function(t,e){var n=this.getGlProgram();t.static&&t.dirtyId===n.uniformDirtyGroups[t.id]||(n.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))},No.prototype.syncUniforms=function(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)},No.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=function(t,e){var n,r=["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];for(n in t.uniforms){var i=e[n];if(i){for(var o,a=t.uniforms[n],s=!1,u=0;u<Bi.length;u++)if(Bi[u].test(i,a)){r.push(Bi[u].code(n,a)),s=!0;break}s||(o=(1===i.size?Ui:Gi)[i.type].replace("location",'ud["'+n+'"].location'),r.push('\n            cv = ud["'+n+'"].value;\n            v = uv["'+n+'"];\n            '+o+";"))}else t.uniforms[n].group&&(t.uniforms[n].ubo?r.push("\n                        renderer.shader.syncUniformBufferGroup(uv."+n+", '"+n+"');\n                    "):r.push("\n                        renderer.shader.syncUniformGroup(uv."+n+", syncData);\n                    "))}return new Function("ud","uv","renderer","syncData",r.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},No.prototype.syncUniformBufferGroup=function(t,e){var n,r=this.getGlProgram();t.static&&0===t.dirtyId&&r.uniformGroups[t.id]||(t.dirtyId=0,n=r.uniformGroups[t.id]||this.createSyncBufferGroup(t,r,e),t.buffer.update(),n(r.uniformData,t.uniforms,this.renderer,Do,t.buffer)),this.renderer.buffer.bindBufferBase(t.buffer,r.uniformBufferBindings[e])},No.prototype.createSyncBufferGroup=function(t,e,n){var r=this.renderer.gl;this.renderer.buffer.bind(t.buffer);var i=this.gl.getUniformBlockIndex(e.program,n);e.uniformBufferBindings[n]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,i,this.shader.uniformBindCount),this.shader.uniformBindCount++;r=this.getSignature(t,this.shader.program.uniformData,"ubo"),i=(i=this._uboCache[r])||(this._uboCache[r]=Ro(t,this.shader.program.uniformData));return t.autoManage&&(r=new Float32Array(i.size/4),t.buffer.update(r)),e.uniformGroups[t.id]=i.syncFunc,e.uniformGroups[t.id]},No.prototype.getSignature=function(t,e,n){var r,i=[n+"-"];for(r in t.uniforms)i.push(r),e[r]&&i.push(e[r].type);return i.join("-")},No.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},No.prototype.generateProgram=function(t){var e=this.gl,t=t.program,e=Mo(e,t);return t.glPrograms[this.renderer.CONTEXT_UID]=e},No.prototype.reset=function(){this.program=null,this.shader=null},No.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},No);function No(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=jo++}var Fo=(Bo.prototype.contextChange=function(t){var e;this.gl=t,this.blendModes=(t=t,(e=void 0===e?[]:e)[$.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.ADD]=[t.ONE,t.ONE],e[$.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.NONE]=[0,0],e[$.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[$.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[$.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[$.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[$.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[$.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[$.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[$.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[$.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[$.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e),this.set(this.defaultState),this.reset()},Bo.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,n=0;e;)1&e&&this.map[n].call(this,!!(t.data&1<<n)),e>>=1,n++;this.stateId=t.data}for(n=0;n<this.checks.length;n++)this.checks[n](this,t)},Bo.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},Bo.prototype.setBlend=function(t){this.updateCheck(Bo.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},Bo.prototype.setOffset=function(t){this.updateCheck(Bo.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},Bo.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},Bo.prototype.setDepthMask=function(t){this.gl.depthMask(t)},Bo.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},Bo.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},Bo.prototype.setBlendMode=function(t){var e;t!==this.blendMode&&(this.blendMode=t,e=this.blendModes[t],t=this.gl,2===e.length?t.blendFunc(e[0],e[1]):t.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,t.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD)))},Bo.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},Bo.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},Bo.prototype.updateCheck=function(t,e){var n=this.checks.indexOf(t);e&&-1===n?this.checks.push(t):e||-1===n||this.checks.splice(n,1)},Bo.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},Bo.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},Bo.prototype.destroy=function(){this.gl=null},Bo);function Bo(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=$.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Qi,this.defaultState.blend=!0}var Uo=(Go.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==ct.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},Go.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,n=!1,r=0;r<e.length;r++){var i=e[r];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(t.destroyTexture(i,!0),n=!(e[r]=null))}if(n){for(var o=0,r=0;r<e.length;r++)null!==e[r]&&(e[o++]=e[r]);e.length=o}},Go.prototype.unload=function(t){var e=this.renderer.texture,n=t._texture;n&&!n.framebuffer&&e.destroyTexture(n);for(var r=t.children.length-1;0<=r;r--)this.unload(t.children[r])},Go.prototype.destroy=function(){this.renderer=null},Go);function Go(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=dt.GC_MAX_IDLE,this.checkCountMax=dt.GC_MAX_CHECK_COUNT,this.mode=dt.GC_MODE}var Xo=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=nt.UNSIGNED_BYTE,this.internalFormat=tt.RGBA,this.samplerType=0},Ho=(zo.prototype.contextChange=function(){var t,e,n,r=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=(t=r,a="WebGL2RenderingContext"in self&&t instanceof self.WebGL2RenderingContext?((n={})[nt.UNSIGNED_BYTE]=((e={})[tt.RGBA]=t.RGBA8,e[tt.RGB]=t.RGB8,e[tt.RG]=t.RG8,e[tt.RED]=t.R8,e[tt.RGBA_INTEGER]=t.RGBA8UI,e[tt.RGB_INTEGER]=t.RGB8UI,e[tt.RG_INTEGER]=t.RG8UI,e[tt.RED_INTEGER]=t.R8UI,e[tt.ALPHA]=t.ALPHA,e[tt.LUMINANCE]=t.LUMINANCE,e[tt.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,e),n[nt.BYTE]=((e={})[tt.RGBA]=t.RGBA8_SNORM,e[tt.RGB]=t.RGB8_SNORM,e[tt.RG]=t.RG8_SNORM,e[tt.RED]=t.R8_SNORM,e[tt.RGBA_INTEGER]=t.RGBA8I,e[tt.RGB_INTEGER]=t.RGB8I,e[tt.RG_INTEGER]=t.RG8I,e[tt.RED_INTEGER]=t.R8I,e),n[nt.UNSIGNED_SHORT]=((e={})[tt.RGBA_INTEGER]=t.RGBA16UI,e[tt.RGB_INTEGER]=t.RGB16UI,e[tt.RG_INTEGER]=t.RG16UI,e[tt.RED_INTEGER]=t.R16UI,e[tt.DEPTH_COMPONENT]=t.DEPTH_COMPONENT16,e),n[nt.SHORT]=((e={})[tt.RGBA_INTEGER]=t.RGBA16I,e[tt.RGB_INTEGER]=t.RGB16I,e[tt.RG_INTEGER]=t.RG16I,e[tt.RED_INTEGER]=t.R16I,e),n[nt.UNSIGNED_INT]=((e={})[tt.RGBA_INTEGER]=t.RGBA32UI,e[tt.RGB_INTEGER]=t.RGB32UI,e[tt.RG_INTEGER]=t.RG32UI,e[tt.RED_INTEGER]=t.R32UI,e[tt.DEPTH_COMPONENT]=t.DEPTH_COMPONENT24,e),n[nt.INT]=((e={})[tt.RGBA_INTEGER]=t.RGBA32I,e[tt.RGB_INTEGER]=t.RGB32I,e[tt.RG_INTEGER]=t.RG32I,e[tt.RED_INTEGER]=t.R32I,e),n[nt.FLOAT]=((e={})[tt.RGBA]=t.RGBA32F,e[tt.RGB]=t.RGB32F,e[tt.RG]=t.RG32F,e[tt.RED]=t.R32F,e[tt.DEPTH_COMPONENT]=t.DEPTH_COMPONENT32F,e),n[nt.HALF_FLOAT]=((e={})[tt.RGBA]=t.RGBA16F,e[tt.RGB]=t.RGB16F,e[tt.RG]=t.RG16F,e[tt.RED]=t.R16F,e),n[nt.UNSIGNED_SHORT_5_6_5]=((e={})[tt.RGB]=t.RGB565,e),n[nt.UNSIGNED_SHORT_4_4_4_4]=((e={})[tt.RGBA]=t.RGBA4,e),n[nt.UNSIGNED_SHORT_5_5_5_1]=((e={})[tt.RGBA]=t.RGB5_A1,e),n[nt.UNSIGNED_INT_2_10_10_10_REV]=((e={})[tt.RGBA]=t.RGB10_A2,e[tt.RGBA_INTEGER]=t.RGB10_A2UI,e),n[nt.UNSIGNED_INT_10F_11F_11F_REV]=((e={})[tt.RGB]=t.R11F_G11F_B10F,e),n[nt.UNSIGNED_INT_5_9_9_9_REV]=((e={})[tt.RGB]=t.RGB9_E5,e),n[nt.UNSIGNED_INT_24_8]=((e={})[tt.DEPTH_STENCIL]=t.DEPTH24_STENCIL8,e),n[nt.FLOAT_32_UNSIGNED_INT_24_8_REV]=((e={})[tt.DEPTH_STENCIL]=t.DEPTH32F_STENCIL8,e),n):((a={})[nt.UNSIGNED_BYTE]=((n={})[tt.RGBA]=t.RGBA,n[tt.RGB]=t.RGB,n[tt.ALPHA]=t.ALPHA,n[tt.LUMINANCE]=t.LUMINANCE,n[tt.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,n),a[nt.UNSIGNED_SHORT_5_6_5]=((n={})[tt.RGB]=t.RGB,n),a[nt.UNSIGNED_SHORT_4_4_4_4]=((n={})[tt.RGBA]=t.RGBA,n),a[nt.UNSIGNED_SHORT_5_5_5_1]=((n={})[tt.RGBA]=t.RGBA,n),a));var i=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=i;for(var o=0;o<i;o++)this.boundTextures[o]=null;this.emptyTextures={};var a=new Xo(r.createTexture());r.bindTexture(r.TEXTURE_2D,a.texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[r.TEXTURE_2D]=a,this.emptyTextures[r.TEXTURE_CUBE_MAP]=new Xo(r.createTexture()),r.bindTexture(r.TEXTURE_CUBE_MAP,this.emptyTextures[r.TEXTURE_CUBE_MAP].texture);for(o=0;o<6;o++)r.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,null);r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_CUBE_MAP,r.TEXTURE_MIN_FILTER,r.LINEAR);for(o=0;o<this.boundTextures.length;o++)this.bind(null,o)},zo.prototype.bind=function(t,e){void 0===e&&(e=0);var n,r=this.gl;(t=null==t?void 0:t.castToBaseTexture())&&t.valid&&!t.parentTextureArray?(t.touched=this.renderer.textureGC.count,n=t._glTextures[this.CONTEXT_UID]||this.initTexture(t),this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,n.texture)),n.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t):(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null)},zo.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},zo.prototype.unbind=function(t){var e=this.gl,n=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<n.length;r++)n[r]===this.unknownTexture&&this.bind(null,r)}for(r=0;r<n.length;r++)n[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),n[r]=null)},zo.prototype.ensureSamplerType=function(t){var e=this.boundTextures,n=this.hasIntegerTextures,r=this.CONTEXT_UID;if(n)for(var i=t-1;0<=i;--i){var o=e[i];o&&o._glTextures[r].samplerType!==rt.FLOAT&&this.renderer.texture.unbind(o)}},zo.prototype.initTexture=function(t){var e=new Xo(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},zo.prototype.initTextureType=function(t,e){var n;e.internalFormat=null!==(n=null===(n=this.internalFormats[t.type])||void 0===n?void 0:n[t.format])&&void 0!==n?n:t.format,2===this.webGLVersion&&t.type===nt.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type},zo.prototype.updateTexture=function(t){var e,n,r,i=t._glTextures[this.CONTEXT_UID];i&&(r=this.renderer,this.initTextureType(t,i),t.resource&&t.resource.upload(r,t,i)?i.samplerType!==rt.FLOAT&&(this.hasIntegerTextures=!0):(e=t.realWidth,n=t.realHeight,r=r.gl,(i.width!==e||i.height!==n||i.dirtyId<0)&&(i.width=e,i.height=n,r.texImage2D(t.target,0,i.internalFormat,e,n,0,t.format,i.type,null))),t.dirtyStyleId!==i.dirtyStyleId&&this.updateTextureStyle(t),i.dirtyId=t.dirtyId)},zo.prototype.destroyTexture=function(t,e){var n=this.gl;(t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],e||-1!==(t=this.managedTextures.indexOf(t))&&zt(this.managedTextures,t,1))},zo.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==at.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=1<=t.mipmap:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=ot.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},zo.prototype.setStyle=function(t,e){var n,r=this.gl;e.mipmap&&t.mipmap!==at.ON_MANUAL&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap?(r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===it.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST),(n=this.renderer.context.extensions.anisotropicFiltering)&&0<t.anisotropicLevel&&t.scaleMode===it.LINEAR&&(e=Math.min(t.anisotropicLevel,r.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),r.texParameterf(t.target,n.TEXTURE_MAX_ANISOTROPY_EXT,e))):r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===it.LINEAR?r.LINEAR:r.NEAREST),r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===it.LINEAR?r.LINEAR:r.NEAREST)},zo.prototype.destroy=function(){this.renderer=null},zo);function zo(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Gn,this.hasIntegerTextures=!1}var Vo,Wo={__proto__:null,FilterSystem:si,BatchSystem:hi,ContextSystem:di,FramebufferSystem:gi,GeometrySystem:xi,MaskSystem:uo,ScissorSystem:fo,StencilSystem:mo,ProjectionSystem:go,RenderTextureSystem:wo,ShaderSystem:Lo,StateSystem:Fo,TextureGCSystem:Uo,TextureSystem:Ho},Yo=new Pe,qo=(In(Ko,Vo=mt.a),Ko.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},Object.defineProperty(Ko.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(Ko.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),Ko.prototype.resize=function(t,e){this.view.width=Math.round(t*this.resolution),this.view.height=Math.round(e*this.resolution);t=this.view.width/this.resolution,e=this.view.height/this.resolution;this.screen.width=t,this.screen.height=e,this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=e+"px"),this.emit("resize",t,e)},Ko.prototype.generateTexture=function(t,e,n,r){"number"==typeof(e=void 0===e?{}:e)&&(Kt("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),e={scaleMode:e,resolution:n,region:r});n=e.region,e=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&(n[i[r]]=t[i[r]]);return n}(e,["region"]);0===(r=n||t.getLocalBounds(null,!0)).width&&(r.width=1),0===r.height&&(r.height=1);e=Mr.create(Mn({width:r.width,height:r.height},e));return Yo.tx=-r.x,Yo.ty=-r.y,this.render(t,{renderTexture:e,clear:!1,transform:Yo,skipUpdateTransform:!!t.parent}),e},Ko.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);this.plugins=null,this.type=Z.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(Ko.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=Rt(t),kt(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(Ko.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(t){this._backgroundColorRgba[3]=t},enumerable:!1,configurable:!0}),Ko);function Ko(t,e){void 0===t&&(t=Z.UNKNOWN);var n=Vo.call(this)||this;return e=Object.assign({},dt.RENDER_OPTIONS,e),n.options=e,n.type=t,n.screen=new pe(0,0,e.width,e.height),n.view=e.view||document.createElement("canvas"),n.resolution=e.resolution||dt.RESOLUTION,n.useContextAlpha=e.useContextAlpha,n.autoDensity=!!e.autoDensity,n.preserveDrawingBuffer=e.preserveDrawingBuffer,n.clearBeforeRender=e.clearBeforeRender,n._backgroundColor=0,n._backgroundColorRgba=[0,0,0,1],n._backgroundColorString="#000000",n.backgroundColor=e.backgroundColor||n._backgroundColor,n.backgroundAlpha=e.backgroundAlpha,void 0!==e.transparent&&(Kt("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),n.useContextAlpha=e.transparent,n.backgroundAlpha=e.transparent?0:1),n._lastObjectRendered=null,n.plugins={},n}var Zo=function(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},Qo=($o.prototype.destroy=function(){this.renderer=null},$o.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},$o.prototype.bind=function(t){var e=this.gl,n=this.CONTEXT_UID,n=t._glBuffers[n]||this.createGLBuffer(t);e.bindBuffer(t.type,n.buffer)},$o.prototype.bindBufferBase=function(t,e){var n=this.gl,r=this.CONTEXT_UID;this.boundBufferBases[e]!==t&&(r=t._glBuffers[r]||this.createGLBuffer(t),this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,r.buffer))},$o.prototype.bindBufferRange=function(t,e,n){var r=this.gl,i=this.CONTEXT_UID;n=n||0;t=t._glBuffers[i]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,t.buffer,256*n,256)},$o.prototype.update=function(t){var e=this.gl,n=this.CONTEXT_UID,r=t._glBuffers[n];t._updateID!==r.updateID&&(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength?e.bufferSubData(t.type,0,t.data):(n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW,r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)))},$o.prototype.dispose=function(t,e){var n,r;this.managedBuffers[t.id]&&(delete this.managedBuffers[t.id],n=t._glBuffers[this.CONTEXT_UID],r=this.gl,t.disposeRunner.remove(this),n&&(e||r.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID]))},$o.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedBuffers),n=0;n<e.length;n++)this.dispose(this.managedBuffers[e[n]],t)},$o.prototype.createGLBuffer=function(t){var e=this.CONTEXT_UID,n=this.gl;return t._glBuffers[e]=new Zo(n.createBuffer()),(this.managedBuffers[t.id]=t).disposeRunner.add(this),t._glBuffers[e]},$o);function $o(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}var Jo,ta=(In(ea,Jo=qo),ea.create=function(t){if(Et())return new ea(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},ea.prototype.contextChange=function(){var t,e,n=this.gl;1===this.context.webGLVersion?(e=n.getParameter(n.FRAMEBUFFER_BINDING),n.bindFramebuffer(n.FRAMEBUFFER,null),t=n.getParameter(n.SAMPLES),n.bindFramebuffer(n.FRAMEBUFFER,e)):(e=n.getParameter(n.DRAW_FRAMEBUFFER_BINDING),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),t=n.getParameter(n.SAMPLES),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,e)),t>=ft.HIGH?this.multisample=ft.HIGH:t>=ft.MEDIUM?this.multisample=ft.MEDIUM:t>=ft.LOW?this.multisample=ft.LOW:this.multisample=ft.NONE},ea.prototype.addSystem=function(t,e){var n,r=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(n in this[e]=r,this.runners)this.runners[n].add(r);return this},ea.prototype.render=function(t,e){var n,r,i,o;e&&(o=e instanceof Mr?(Kt("6.0.0","Renderer#render arguments changed, use options instead."),n=e,r=arguments[2],i=arguments[3],arguments[4]):(n=e.renderTexture,r=e.clear,i=e.transform,e.skipUpdateTransform)),this.renderingToScreen=!n,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=i,this.context.isLost||(n||(this._lastObjectRendered=t),o||(o=t.enableTempParent(),t.updateTransform(),t.disableTempParent(o)),this.renderTexture.bind(n),this.batch.currentRenderer.start(),(void 0!==r?r:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),n&&n.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender"))},ea.prototype.generateTexture=function(t,e,n,r){r=Jo.prototype.generateTexture.call(this,t,e=void 0===e?{}:e,n,r);return this.framebuffer.blit(),r},ea.prototype.resize=function(t,e){Jo.prototype.resize.call(this,t,e),this.runners.resize.emit(this.screen.height,this.screen.width)},ea.prototype.reset=function(){return this.runners.reset.emit(),this},ea.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},ea.prototype.destroy=function(t){for(var e in this.runners.destroy.emit(),this.runners)this.runners[e].destroy();Jo.prototype.destroy.call(this,t),this.gl=null},Object.defineProperty(ea.prototype,"extract",{get:function(){return Kt("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),ea.registerPlugin=function(t,e){(ea.__plugins=ea.__plugins||{})[t]=e},ea);function ea(t){var e=Jo.call(this,Z.WEBGL,t)||this;return t=e.options,e.gl=null,e.CONTEXT_UID=0,e.runners={destroy:new Pn("destroy"),contextChange:new Pn("contextChange"),reset:new Pn("reset"),update:new Pn("update"),postrender:new Pn("postrender"),prerender:new Pn("prerender"),resize:new Pn("resize")},e.runners.contextChange.add(e),e.globalUniforms=new ei({projectionMatrix:new Pe},!0),e.addSystem(uo,"mask").addSystem(di,"context").addSystem(Fo,"state").addSystem(Lo,"shader").addSystem(Ho,"texture").addSystem(Qo,"buffer").addSystem(xi,"geometry").addSystem(gi,"framebuffer").addSystem(fo,"scissor").addSystem(mo,"stencil").addSystem(go,"projection").addSystem(Uo,"textureGC").addSystem(si,"filter").addSystem(wo,"renderTexture").addSystem(hi,"batch"),e.initPlugins(ea.__plugins),e.multisample=void 0,t.context?e.context.initFromContext(t.context):e.context.initFromOptions({alpha:!!e.useContextAlpha,antialias:t.antialias,premultipliedAlpha:e.useContextAlpha&&"notMultiplied"!==e.useContextAlpha,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:e.options.powerPreference}),e.renderingToScreen=!0,St(2===e.context.webGLVersion?"WebGL 2":"WebGL 1"),e.resize(e.options.width,e.options.height),e}function na(t){return ta.create(t)}var ra="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",ia="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",oa=(aa.prototype.destroy=function(){this.renderer=null},aa);function aa(t){Kt("6.1.0","System class is deprecated, implemement ISystem interface instead."),this.renderer=t}var sa=function(){this.texArray=null,this.blend=0,this.type=J.TRIANGLES,this.start=0,this.size=0,this.data=null},ua=(ca.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},ca);function ca(){this.elements=[],this.ids=[],this.count=0}var la=(Object.defineProperty(ha.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(ha.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(ha.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(ha.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(ha.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),ha.prototype.view=function(t){return this[t+"View"]},ha.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},ha.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},ha);function ha(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}var fa,pa=(In(da,fa=ci),da.prototype.contextChange=function(){var t=this.renderer.gl;dt.PREFER_ENV===K.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),dt.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=zi(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},da.prototype.initFlushBuffers=function(){for(var t=da._drawCallPool,e=da._textureArrayPool,n=this.size/4,r=Math.floor(n/this.MAX_TEXTURES)+1;t.length<n;)t.push(new sa);for(;e.length<r;)e.push(new ua);for(var i=0;i<this.MAX_TEXTURES;i++)this._tempBoundTextures[i]=null},da.prototype.onPrerender=function(){this._flushId=0},da.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},da.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,n=da._textureArrayPool,r=this.renderer.batch,i=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++Gn._globalBatch,s=0,u=n[0],c=0;r.copyBoundTextures(i,e);for(var l=0;l<this._bufferSize;++l){var h=t[l];t[l]=null,h._batchEnabled!==a&&(u.count>=e&&(r.boundArray(u,i,a,e),this.buildDrawCalls(u,c,l),c=l,u=n[++s],++a),h._batchEnabled=a,h.touched=o,u.elements[u.count++]=h)}0<u.count&&(r.boundArray(u,i,a,e),this.buildDrawCalls(u,c,this._bufferSize),++s,++a);for(l=0;l<i.length;l++)i[l]=null;Gn._globalBatch=a},da.prototype.buildDrawCalls=function(t,e,n){var r=this._bufferedElements,i=this._attributeBuffer,o=this._indexBuffer,a=this.vertexSize,s=da._drawCallPool,u=this._dcIndex,c=this._aIndex,l=this._iIndex,h=s[u];h.start=this._iIndex,h.texArray=t;for(var f=e;f<n;++f){var p=r[f],d=p._texture.baseTexture,d=It[d.alphaMode?1:0][p.blendMode];r[f]=null,e<f&&h.blend!==d&&(h.size=l-h.start,e=f,(h=s[++u]).texArray=t,h.start=l),this.packInterleavedGeometry(p,i,o,c,l),c+=p.vertexData.length/2*a,l+=p.indices.length,h.blend=d}e<n&&(h.size=l-h.start,++u),this._dcIndex=u,this._aIndex=c,this._iIndex=l},da.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,n=0;n<t.count;n++)e.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0},da.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,n=this._indexBuffer;dt.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},da.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,n=e.gl,r=e.state,i=da._drawCallPool,o=null,a=0;a<t;a++){var s=i[a],u=s.texArray,c=s.type,l=s.size,h=s.start,s=s.blend;o!==u&&this.bindAndClearTexArray(o=u),this.state.blendMode=s,r.set(this.state),n.drawElements(c,l,n.UNSIGNED_SHORT,2*h)}},da.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},da.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),dt.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},da.prototype.stop=function(){this.flush()},da.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),fa.prototype.destroy.call(this)},da.prototype.getAttributeBuffer=function(t){var e=Gt(Math.ceil(t/8)),t=Ht(e),e=8*e;this._aBuffers.length<=t&&(this._iBuffers.length=t+1);t=this._aBuffers[e];return t||(this._aBuffers[e]=t=new la(e*this.vertexSize*4)),t},da.prototype.getIndexBuffer=function(t){var e=Gt(Math.ceil(t/12)),n=Ht(e),t=12*e;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);e=this._iBuffers[n];return e||(this._iBuffers[n]=e=new Uint16Array(t)),e},da.prototype.packInterleavedGeometry=function(t,e,n,r,i){for(var o=e.uint32View,a=e.float32View,s=r/this.vertexSize,u=t.uvs,c=t.indices,l=t.vertexData,h=t._texture.baseTexture._batchLocation,e=Math.min(t.worldAlpha,1),f=e<1&&t._texture.baseTexture.alphaMode?Dt(t._tintRGB,e):t._tintRGB+(255*e<<24),p=0;p<l.length;p+=2)a[r++]=l[p],a[r++]=l[p+1],a[r++]=u[p],a[r++]=u[p+1],o[r++]=f,a[r++]=h;for(p=0;p<c.length;p++)n[i++]=s+c[p]},da._drawCallPool=[],da._textureArrayPool=[],da);function da(t){var e=fa.call(this,t)||this;return e.shaderGenerator=null,e.geometryClass=null,e.vertexSize=null,e.state=Qi.for2d(),e.size=4*dt.SPRITE_BATCH_SIZE,e._vertexCount=0,e._indexCount=0,e._bufferedElements=[],e._bufferedTextures=[],e._bufferSize=0,e._shader=null,e._packedGeometries=[],e._packedGeometryPoolSize=2,e._flushId=0,e._aBuffers={},e._iBuffers={},e.MAX_TEXTURES=1,e.renderer.on("prerender",e.onPrerender,e),t.runners.contextChange.add(e),e._dcIndex=0,e._aIndex=0,e._iIndex=0,e._attributeBuffer=null,e._indexBuffer=null,e._tempBoundTextures=[],e}var ya=(ma.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),n=0;n<t;n++)e[n]=n;this.defaultGroupCache[t]=ei.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Yi(this.vertexSrc,r)}r={tint:new Float32Array([1,1,1,1]),translationMatrix:new Pe,default:this.defaultGroupCache[t]};return new Ki(this.programCache[t],r)},ma.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var n=0;n<t;n++)0<n&&(e+="\nelse "),n<t-1&&(e+="if(vTextureId < "+n+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+n+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"},ma);function ma(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}var va,ga=(In(ba,va=Wr),ba);function ba(t){void 0===t&&(t=!1);var e=va.call(this)||this;return e._buffer=new Ur(null,t,!1),e._indexBuffer=new Ur(null,t,!0),e.addAttribute("aVertexPosition",e._buffer,2,!1,nt.FLOAT).addAttribute("aTextureCoord",e._buffer,2,!1,nt.FLOAT).addAttribute("aColor",e._buffer,4,!0,nt.UNSIGNED_BYTE).addAttribute("aTextureId",e._buffer,1,!0,nt.FLOAT).addIndex(e._indexBuffer),e}var _a="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",xa="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",wa=(Ta.create=function(t){var e,t=Object.assign({vertex:_a,fragment:xa,geometryClass:ga,vertexSize:6},t),n=t.vertex,r=t.fragment,i=t.vertexSize,o=t.geometryClass;return In(a,e=pa),a;function a(t){t=e.call(this,t)||this;return t.shaderGenerator=new ya(n,r),t.geometryClass=o,t.vertexSize=i,t}},Object.defineProperty(Ta,"defaultVertexSrc",{get:function(){return _a},enumerable:!1,configurable:!0}),Object.defineProperty(Ta,"defaultFragmentTemplate",{get:function(){return xa},enumerable:!1,configurable:!0}),Ta);function Ta(){}var Oa=wa.create(),Sa={};for(Ea in vr)!function(t){Object.defineProperty(Sa,t,{get:function(){return Kt("6.0.0","PIXI.systems."+t+" has moved to PIXI."+t),vr[t]}})}(Ea);var Ea,Pa={};for(Ea in Wo)!function(t){Object.defineProperty(Pa,t,{get:function(){return Kt("6.0.0","PIXI.resources."+t+" has moved to PIXI."+t),Wo[t]}})}(Ea);var ka=(Ra.registerPlugin=function(t){Ra._plugins.push(t)},Ra.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(Ra.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(Ra.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),Ra.prototype.destroy=function(t,e){var n=this,r=Ra._plugins.slice(0);r.reverse(),r.forEach(function(t){t.destroy.call(n)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null},Ra._plugins=[],Ra);function Ra(e){var n=this;this.stage=new Qe,e=Object.assign({forceCanvas:!1},e),this.renderer=na(e),Ra._plugins.forEach(function(t){t.init.call(n,e)})}Aa.init=function(t){var n=this;Object.defineProperty(this,"resizeTo",{set:function(t){self.removeEventListener("resize",this.queueResize),(this._resizeTo=t)&&(self.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){n._resizeTo&&(n.cancelResize(),n._resizeId=requestAnimationFrame(function(){return n.resize()}))},this.cancelResize=function(){n._resizeId&&(cancelAnimationFrame(n._resizeId),n._resizeId=null)},this.resize=function(){var t,e;n._resizeTo&&(n.cancelResize(),e=n._resizeTo===self?(t=self.innerWidth,self.innerHeight):(t=(e=n._resizeTo).clientWidth,e.clientHeight),n.renderer.resize(t,e))},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},Aa.destroy=function(){self.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},vt=Aa;function Aa(){}ka.registerPlugin(vt);var Ca=new pe,Ia=(Ma.prototype.image=function(t,e,n){var r=new Image;return r.src=this.base64(t,e,n),r},Ma.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},Ma.prototype.canvas=function(t){var e,n,r,i=this.renderer,o=!1,a=!1;t&&(t instanceof Mr?r=t:(r=this.renderer.generateTexture(t),a=!0)),r?(e=r.baseTexture.resolution,n=r.frame,o=!1,i.renderTexture.bind(r)):(e=this.renderer.resolution,o=!0,(n=Ca).width=this.renderer.width,n.height=this.renderer.height,i.renderTexture.bind(null));var s=Math.floor(n.width*e+1e-4),u=Math.floor(n.height*e+1e-4),c=new ee(s,u,1),t=new Uint8Array(4*s*u),i=i.gl;i.readPixels(n.x*e,n.y*e,s,u,i.RGBA,i.UNSIGNED_BYTE,t);s=c.context.getImageData(0,0,s,u);return Ma.arrayPostDivide(t,s.data),c.context.putImageData(s,0,0),o&&((o=new ee(c.width,c.height,1)).context.scale(1,-1),o.context.drawImage(c.canvas,0,-u),c.destroy(),c=o),a&&r.destroy(!0),c.canvas},Ma.prototype.pixels=function(t){var e,n,r,i=this.renderer,o=!1;t&&(t instanceof Mr?r=t:(r=this.renderer.generateTexture(t),o=!0)),r?(e=r.baseTexture.resolution,n=r.frame,i.renderTexture.bind(r)):(e=i.resolution,(n=Ca).width=i.width,n.height=i.height,i.renderTexture.bind(null));var a=n.width*e,s=n.height*e,t=new Uint8Array(4*a*s),i=i.gl;return i.readPixels(n.x*e,n.y*e,a,s,i.RGBA,i.UNSIGNED_BYTE,t),o&&r.destroy(!0),Ma.arrayPostDivide(t,t),t},Ma.prototype.destroy=function(){this.renderer=null},Ma.arrayPostDivide=function(t,e){for(var n=0;n<t.length;n+=4){var r=e[n+3]=t[n+3];0!==r?(e[n]=Math.round(Math.min(255*t[n]/r,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/r,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/r,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2])}},Ma);function Ma(t){this.renderer=t}var ja=(Da.prototype.detach=function(){return null!==this._owner&&(this._owner.detach(this),!0)},Da);function Da(t,e,n){void 0===e&&(e=!1),this._fn=t,this._once=e,this._thisArg=n,this._next=this._prev=this._owner=null}function La(t,e){return t._head?(t._tail._next=e)._prev=t._tail:t._head=e,(t._tail=e)._owner=t,e}var Na=(Fa.prototype.handlers=function(t){var e=this._head;if(t=void 0===t?!1:t)return!!e;for(var n=[];e;)n.push(e),e=e._next;return n},Fa.prototype.has=function(t){if(!(t instanceof ja))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return t._owner===this},Fa.prototype.dispatch=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var r=this._head;if(!r)return!1;for(;r;)r._once&&this.detach(r),r._fn.apply(r._thisArg,e),r=r._next;return!0},Fa.prototype.add=function(t,e){if(void 0===e&&(e=null),"function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return La(this,new ja(t,!1,e))},Fa.prototype.once=function(t,e){if(void 0===e&&(e=null),"function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return La(this,new ja(t,!0,e))},Fa.prototype.detach=function(t){if(!(t instanceof ja))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this},Fa.prototype.detachAll=function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this},Fa);function Fa(){this._head=this._tail=void 0}function Ba(t,e){for(var r={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},n=r.parser[(e=e||{}).strictMode?"strict":"loose"].exec(t),i={},o=14;o--;)i[r.key[o]]=n[o]||"";return i[r.q.name]={},i[r.key[12]].replace(r.q.parser,function(t,e,n){e&&(i[r.q.name][e]=n)}),i}var Ua=!(!self.XDomainRequest||"withCredentials"in new XMLHttpRequest),Ga=null;function Xa(){}function Ha(t,e,n){(e=e&&0===e.indexOf(".")?e.substring(1):e)&&(t[e]=n)}function za(t){return t.toString().replace("object ","")}var Va=(Wa.setExtensionLoadType=function(t,e){Ha(Wa._loadTypeMap,t,e)},Wa.setExtensionXhrType=function(t,e){Ha(Wa._xhrTypeMap,t,e)},Object.defineProperty(Wa.prototype,"isDataUrl",{get:function(){return this._hasFlag(Wa.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(Wa.prototype,"isComplete",{get:function(){return this._hasFlag(Wa.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(Wa.prototype,"isLoading",{get:function(){return this._hasFlag(Wa.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),Wa.prototype.complete=function(){this._clearEvents(),this._finish()},Wa.prototype.abort=function(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=Wa.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},Wa.prototype.load=function(t){var e=this;if(!this.isLoading)if(this.isComplete)t&&setTimeout(function(){return t(e)},1);else switch(t&&this.onComplete.once(t),this._setFlag(Wa.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case Wa.LOAD_TYPE.IMAGE:this.type=Wa.TYPE.IMAGE,this._loadElement("image");break;case Wa.LOAD_TYPE.AUDIO:this.type=Wa.TYPE.AUDIO,this._loadSourceElement("audio");break;case Wa.LOAD_TYPE.VIDEO:this.type=Wa.TYPE.VIDEO,this._loadSourceElement("video");break;default:Wa.LOAD_TYPE.XHR;Ua&&this.crossOrigin?this._loadXdr():this._loadXhr()}},Wa.prototype._hasFlag=function(t){return 0!=(this._flags&t)},Wa.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Wa.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},Wa.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(Wa.STATUS_FLAGS.COMPLETE,!0),this._setFlag(Wa.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},Wa.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==self.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},Wa.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==self.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,n=0;n<this.url.length;++n)this.data.appendChild(this._createSource(t,this.url[n],Array.isArray(e)?e[n]:e));else{e=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(e)?e[0]:e))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},Wa.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===Wa.XHR_RESPONSE_TYPE.JSON||this.xhrType===Wa.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=Wa.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},Wa.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new self.XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},Wa.prototype._createSource=function(t,e,n){n=n||t+"/"+this._getExtension(e);t=document.createElement("source");return t.src=e,t.type=n,t},Wa.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},Wa.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},Wa.prototype._onTimeout=function(){this.abort("Load timed out.")},Wa.prototype._xhrOnError=function(){var t=this.xhr;this.abort(za(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},Wa.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(za(t)+" Request timed out.")},Wa.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(za(t)+" Request was aborted by the user.")},Wa.prototype._xhrOnLoad=function(){var t,e,n=this.xhr,r="",i=void 0===n.status?200:n.status;if(""!==n.responseType&&"text"!==n.responseType&&void 0!==n.responseType||(r=n.responseText),0===i&&(0<r.length||n.responseType===Wa.XHR_RESPONSE_TYPE.BUFFER)?i=200:1223===i&&(i=204),2==(i/100|0)){if(this.xhrType===Wa.XHR_RESPONSE_TYPE.TEXT)this.data=r,this.type=Wa.TYPE.TEXT;else if(this.xhrType===Wa.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(r),this.type=Wa.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===Wa.XHR_RESPONSE_TYPE.DOCUMENT)try{self.DOMParser?(t=new DOMParser,this.data=t.parseFromString(r,"text/xml")):((e=document.createElement("div")).innerHTML=r,this.data=e),this.type=Wa.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=n.response||r;this.complete()}else this.abort("["+n.status+"] "+n.statusText+": "+n.responseURL)},Wa.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(self.origin!==self.location.origin)return"anonymous";e=e||self.location,(Ga=Ga||document.createElement("a")).href=t;var n=Ba(Ga.href,{strictMode:!0}),r=!n.port&&""===e.port||n.port===e.port,t=n.protocol?n.protocol+":":"";return n.host===e.hostname&&r&&t===e.protocol?"":"anonymous"},Wa.prototype._determineXhrType=function(){return Wa._xhrTypeMap[this.extension]||Wa.XHR_RESPONSE_TYPE.TEXT},Wa.prototype._determineLoadType=function(){return Wa._loadTypeMap[this.extension]||Wa.LOAD_TYPE.XHR},Wa.prototype._getExtension=function(t){void 0===t&&(t=this.url);var e,n;return(this.isDataUrl?(n=t.indexOf("/"),t.substring(n+1,t.indexOf(";",n))):(e=t.indexOf("?"),n=t.indexOf("#"),n=Math.min(-1<e?e:t.length,-1<n?n:t.length),(t=t.substring(0,n)).substring(t.lastIndexOf(".")+1))).toLowerCase()},Wa.prototype._getMimeFromXhrType=function(t){switch(t){case Wa.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case Wa.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case Wa.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case Wa.XHR_RESPONSE_TYPE.JSON:return"application/json";case Wa.XHR_RESPONSE_TYPE.DEFAULT:case Wa.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},Wa);function Wa(t,e,n){if(this._dequeue=Xa,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,"string"!=typeof t||"string"!=typeof e)throw new Error("Both name and url are required for constructing a resource.");n=n||{},this._flags=0,this._setFlag(Wa.STATUS_FLAGS.DATA_URL,0===e.indexOf("data:")),this.name=t,this.url=e,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===n.crossOrigin?"anonymous":n.crossOrigin,this.timeout=n.timeout||0,this.loadType=n.loadType||this._determineLoadType(),this.xhrType=n.xhrType,this.metadata=n.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=Wa.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=Xa,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Na,this.onProgress=new Na,this.onComplete=new Na,this.onAfterMiddleware=new Na}function Ya(){}yt=Va=Va||{},(bt=yt.STATUS_FLAGS||(yt.STATUS_FLAGS={}))[bt.NONE=0]="NONE",bt[bt.DATA_URL=1]="DATA_URL",bt[bt.COMPLETE=2]="COMPLETE",bt[bt.LOADING=4]="LOADING",(bt=yt.TYPE||(yt.TYPE={}))[bt.UNKNOWN=0]="UNKNOWN",bt[bt.JSON=1]="JSON",bt[bt.XML=2]="XML",bt[bt.IMAGE=3]="IMAGE",bt[bt.AUDIO=4]="AUDIO",bt[bt.VIDEO=5]="VIDEO",bt[bt.TEXT=6]="TEXT",(bt=yt.LOAD_TYPE||(yt.LOAD_TYPE={}))[bt.XHR=1]="XHR",bt[bt.IMAGE=2]="IMAGE",bt[bt.AUDIO=3]="AUDIO",bt[bt.VIDEO=4]="VIDEO",(bt=yt.XHR_RESPONSE_TYPE||(yt.XHR_RESPONSE_TYPE={})).DEFAULT="text",bt.BUFFER="arraybuffer",bt.BLOB="blob",bt.DOCUMENT="document",bt.JSON="json",bt.TEXT="text",yt._loadTypeMap={gif:yt.LOAD_TYPE.IMAGE,png:yt.LOAD_TYPE.IMAGE,bmp:yt.LOAD_TYPE.IMAGE,jpg:yt.LOAD_TYPE.IMAGE,jpeg:yt.LOAD_TYPE.IMAGE,tif:yt.LOAD_TYPE.IMAGE,tiff:yt.LOAD_TYPE.IMAGE,webp:yt.LOAD_TYPE.IMAGE,tga:yt.LOAD_TYPE.IMAGE,svg:yt.LOAD_TYPE.IMAGE,"svg+xml":yt.LOAD_TYPE.IMAGE,mp3:yt.LOAD_TYPE.AUDIO,ogg:yt.LOAD_TYPE.AUDIO,wav:yt.LOAD_TYPE.AUDIO,mp4:yt.LOAD_TYPE.VIDEO,webm:yt.LOAD_TYPE.VIDEO},yt._xhrTypeMap={xhtml:yt.XHR_RESPONSE_TYPE.DOCUMENT,html:yt.XHR_RESPONSE_TYPE.DOCUMENT,htm:yt.XHR_RESPONSE_TYPE.DOCUMENT,xml:yt.XHR_RESPONSE_TYPE.DOCUMENT,tmx:yt.XHR_RESPONSE_TYPE.DOCUMENT,svg:yt.XHR_RESPONSE_TYPE.DOCUMENT,tsx:yt.XHR_RESPONSE_TYPE.DOCUMENT,gif:yt.XHR_RESPONSE_TYPE.BLOB,png:yt.XHR_RESPONSE_TYPE.BLOB,bmp:yt.XHR_RESPONSE_TYPE.BLOB,jpg:yt.XHR_RESPONSE_TYPE.BLOB,jpeg:yt.XHR_RESPONSE_TYPE.BLOB,tif:yt.XHR_RESPONSE_TYPE.BLOB,tiff:yt.XHR_RESPONSE_TYPE.BLOB,webp:yt.XHR_RESPONSE_TYPE.BLOB,tga:yt.XHR_RESPONSE_TYPE.BLOB,json:yt.XHR_RESPONSE_TYPE.JSON,text:yt.XHR_RESPONSE_TYPE.TEXT,txt:yt.XHR_RESPONSE_TYPE.TEXT,ttf:yt.XHR_RESPONSE_TYPE.BUFFER,otf:yt.XHR_RESPONSE_TYPE.BUFFER},yt.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var qa=function(t,e){this.data=t,this.callback=e},Ka=(Za.prototype._next=function(r){var i=this;return function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];--i.workers,r.callback.apply(r,e),null!=e[0]&&i.error(e[0],r.data),i.workers<=i.concurrency-i.buffer&&i.unsaturated(),i.idle()&&i.drain(),i.process()}},Za.prototype.push=function(t,e){this._insert(t,!1,e)},Za.prototype.kill=function(){this.workers=0,this.drain=Ya,this.started=!1,this._tasks=[]},Za.prototype.unshift=function(t,e){this._insert(t,!0,e)},Za.prototype.length=function(){return this._tasks.length},Za.prototype.running=function(){return this.workers},Za.prototype.idle=function(){return this._tasks.length+this.workers===0},Za.prototype.pause=function(){!0!==this.paused&&(this.paused=!0)},Za.prototype.resume=function(){if(!1!==this.paused){this.paused=!1;for(var t=1;t<=this.concurrency;t++)this.process()}},Za.eachSeries=function(n,r,i,o){var a=0,s=n.length;!function t(e){e||a===s?i&&i(e):o?setTimeout(function(){r(n[a++],t)},1):r(n[a++],t)}()},Za.queue=function(t,e){return new Za(t,e)},Za);function Za(t,e){var r=this;if(void 0===e&&(e=1),this.workers=0,this.saturated=Ya,this.unsaturated=Ya,this.empty=Ya,this.drain=Ya,this.error=Ya,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(t,e,n){if(n&&"function"!=typeof n)throw new Error("task callback must be a function");r.started=!0,null==t&&r.idle()?setTimeout(function(){return r.drain()},1):(n=new qa(t,"function"==typeof n?n:Ya),e?r._tasks.unshift(n):r._tasks.push(n),setTimeout(r.process,1))},this.process=function(){for(;!r.paused&&r.workers<r.concurrency&&r._tasks.length;){var t=r._tasks.shift();0===r._tasks.length&&r.empty(),r.workers+=1,r.workers===r.concurrency&&r.saturated(),r._worker(t.data,function(i){return function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(null===i)throw new Error("Callback was already called.");var r=i;i=null,r.apply(this,e)}}(r._next(t)))}},this._worker=t,0===e)throw new Error("Concurrency must not be zero");this.concurrency=e,this.buffer=e/4}var Qa=/(#[\w-]+)?$/,$a=(Ja.prototype._add=function(t,e,n,r){if(this.loading&&(!n||!n.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new Va(t,e,n),"function"==typeof r&&this.resources[t].onAfterMiddleware.once(r),this.loading){for(var i=n.parentResource,o=[],a=0;a<i.children.length;++a)i.children[a].isComplete||o.push(i.children[a]);var s=i.progressChunk*(o.length+1)/(o.length+2);i.children.push(this.resources[t]),i.progressChunk=s;for(a=0;a<o.length;++a)o[a].progressChunk=s;this.resources[t].progressChunk=s}return this._queue.push(this.resources[t]),this},Ja.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},Ja.prototype.use=function(t){return this._afterMiddleware.push(t),this},Ja.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){t=this.resources[t];t._onLoadBinding&&t._onLoadBinding.detach(),t.isLoading&&t.abort("loader reset")}return this.resources={},this},Ja.prototype.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},Object.defineProperty(Ja.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t},enumerable:!1,configurable:!0}),Ja.prototype._prepareUrl=function(t){var e=Ba(t,{strictMode:!0});return e=e.protocol||!e.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString&&(t=Qa.exec(e)[0],-1!==(e=e.substr(0,e.length-t.length)).indexOf("?")?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=t),e},Ja.prototype._loadResource=function(n,t){var r=this;n._dequeue=t,Ka.eachSeries(this._beforeMiddleware,function(t,e){t.call(r,n,function(){e(n.isComplete?{}:null)})},function(){n.isComplete?r._onLoad(n):(n._onLoadBinding=n.onComplete.once(r._onLoad,r),n.load())},!0)},Ja.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},Ja.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},Ja.prototype._onLoad=function(n){var r=this;n._onLoadBinding=null,this._resourcesParsing.push(n),n._dequeue(),Ka.eachSeries(this._afterMiddleware,function(t,e){t.call(r,n,e)},function(){n.onAfterMiddleware.dispatch(n),r.progress=Math.min(100,r.progress+n.progressChunk),r.onProgress.dispatch(r,n),n.error?r.onError.dispatch(n.error,r,n):r.onLoad.dispatch(r,n),r._resourcesParsing.splice(r._resourcesParsing.indexOf(n),1),r._queue.idle()&&0===r._resourcesParsing.length&&r._onComplete()},!0)},Ja.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(Ja,"shared",{get:function(){var t=Ja._shared;return t||((t=new Ja)._protected=!0,Ja._shared=t),t},enumerable:!1,configurable:!0}),Ja.registerPlugin=function(t){return Ja._plugins.push(t),t.add&&t.add(),Ja},Ja._plugins=[],Ja);function Ja(t,e){var n=this;void 0===t&&(t=""),void 0===e&&(e=10),this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return n._loadResource(t,e)},this.resources={},this.baseUrl=t,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return n._loadResource(t,e)},this._queue=Ka.queue(this._boundLoadResource,e),this._queue.pause(),this.resources={},this.onProgress=new Na,this.onError=new Na,this.onLoad=new Na,this.onStart=new Na,this.onComplete=new Na;for(var r=0;r<Ja._plugins.length;++r){var i=Ja._plugins[r],o=i.pre,i=i.use;o&&this.pre(o),i&&this.use(i)}this._protected=!1}$a.prototype.add=function(t,e,n,r){if(Array.isArray(t)){for(var i=0;i<t.length;++i)this.add(t[i]);return this}if("object"==typeof t&&(n=t,r=e||n.callback||n.onComplete,e=n.url,t=n.name||n.key||n.url),"string"!=typeof e&&(r=n,n=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");return"function"==typeof n&&(r=n,n=null),this._add(t,e,n,r)};var ts=(es.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?$a.shared:new $a},es.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},es);function es(){}var ns=(rs.add=function(){Va.setExtensionLoadType("svg",Va.LOAD_TYPE.XHR),Va.setExtensionXhrType("svg",Va.XHR_RESPONSE_TYPE.TEXT)},rs.use=function(e,n){var t,r,i,o;!e.data||e.type!==Va.TYPE.IMAGE&&"svg"!==e.extension?n():(t=e.data,r=e.url,i=e.name,o=e.metadata,Rr.fromLoader(t,r,i,o).then(function(t){e.texture=t,n()}).catch(n))},rs);function rs(){}var is="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var os,as=self.URL||self.webkitURL;$a.registerPlugin({use:function(t,e){if(t.data){if(t.xhr&&t.xhrType===Va.XHR_RESPONSE_TYPE.BLOB)if(self.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var n=as.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=n,t.type=Va.TYPE.IMAGE,void(t.data.onload=function(){as.revokeObjectURL(n),t.data.onload=null,e()})}}else{var r=t.xhr.getResponseHeader("content-type");if(r&&0===r.indexOf("image"))return t.data=new Image,t.data.src="data:"+r+";base64,"+function(t){for(var e="",n=0;n<t.length;){for(var r=[0,0,0],i=[0,0,0,0],o=0;o<r.length;++o)n<t.length?r[o]=255&t.charCodeAt(n++):r[o]=0;switch(i[0]=r[0]>>2,i[1]=(3&r[0])<<4|r[1]>>4,i[2]=(15&r[1])<<2|r[2]>>6,i[3]=63&r[2],n-(t.length-1)){case 2:i[3]=64,i[2]=64;break;case 1:i[3]=64}for(o=0;o<i.length;++o)e+=is.charAt(i[o])}return e}(t.xhr.responseText),t.type=Va.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}}),$a.registerPlugin(ns),(vt=os=os||{})[vt.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",vt[vt.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",vt[vt.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",vt[vt.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",vt[vt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",vt[vt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",vt[vt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",vt[vt.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",vt[vt.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",vt[vt.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",vt[vt.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",vt[vt.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",vt[vt.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",vt[vt.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",vt[vt.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",vt[vt.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",vt[vt.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",vt[vt.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",vt[vt.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",vt[vt.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",vt[vt.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",vt[vt.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",vt[vt.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",vt[vt.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",vt[vt.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",vt[vt.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL";var ss=((bt={})[os.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,bt[os.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,bt[os.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,bt[os.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,bt[os.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,bt[os.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,bt[os.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,bt[os.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,bt[os.COMPRESSED_R11_EAC]=.5,bt[os.COMPRESSED_SIGNED_R11_EAC]=.5,bt[os.COMPRESSED_RG11_EAC]=1,bt[os.COMPRESSED_SIGNED_RG11_EAC]=1,bt[os.COMPRESSED_RGB8_ETC2]=.5,bt[os.COMPRESSED_RGBA8_ETC2_EAC]=1,bt[os.COMPRESSED_SRGB8_ETC2]=.5,bt[os.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,bt[os.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,bt[os.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,bt[os.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,bt[os.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,bt[os.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,bt[os.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,bt[os.COMPRESSED_RGB_ETC1_WEBGL]=.5,bt[os.COMPRESSED_RGB_ATC_WEBGL]=.5,bt[os.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,bt[os.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,bt),us=function(t,e){return(us=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function cs(t,e){function n(){this.constructor=t}us(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function ls(n,r){var i,o,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=2&e[0]?o.return:e[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,e[1])).done)return a;switch(o=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=r.call(n,s)}catch(t){e=[6,t],o=0}finally{i=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}var hs,fs=(cs(ps,hs=Nn),ps.prototype.onBlobLoaded=function(t){},ps.prototype.load=function(){return o=this,a=void 0,s=Promise,u=function(){var e;return ls(this,function(t){switch(t.label){case 0:return[4,fetch(this.origin)];case 1:return[4,t.sent().blob()];case 2:return[4,t.sent().arrayBuffer()];case 3:return e=t.sent(),this.data=new Uint32Array(e),this.buffer=new la(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),[2,this]}})},new(s=s||Promise)(function(t,e){function n(t){try{i(u.next(t))}catch(t){e(t)}}function r(t){try{i(u.throw(t))}catch(t){e(t)}}function i(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(n,r)}i((u=u.apply(o,a||[])).next())});var o,a,s,u},ps);function ps(t,e){void 0===e&&(e={width:1,height:1,autoLoad:!0});var n,r=this,t="string"==typeof t?(n=t,new Uint8Array):(n=null,t);return(r=hs.call(this,t,e)||this).origin=n,r.buffer=t?new la(t):null,r.origin&&!1!==e.autoLoad&&r.load(),t&&t.length&&(r.loaded=!0,r.onBlobLoaded(r.buffer.rawBinaryData)),r}var ds,ys=(cs(ms,ds=fs),ms.prototype.upload=function(t,e,n){var r=t.gl;if(!t.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var i=0,o=this.levels;i<o;i++){var a=this._levelBuffers[i],s=a.levelID,u=a.levelWidth,c=a.levelHeight,a=a.levelBuffer;r.compressedTexImage2D(r.TEXTURE_2D,s,this.format,u,c,0,a)}return!0},ms.prototype.onBlobLoaded=function(){this._levelBuffers=ms._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},ms._formatToExtension=function(t){if(33776<=t&&t<=33779)return"s3tc";if(37488<=t&&t<=37497)return"etc";if(35840<=t&&t<=35843)return"pvrtc";if(36196<=t)return"etc1";if(35986<=t&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},ms._createLevelBuffers=function(t,e,n,r,i,o,a){for(var s=new Array(n),u=t.byteOffset,c=o,l=a,h=c+r-1&~(r-1),f=l+i-1&~(i-1),p=h*f*ss[e],d=0;d<n;d++)s[d]={levelID:d,levelWidth:1<n?c:h,levelHeight:1<n?l:f,levelBuffer:new Uint8Array(t.buffer,u,p)},u+=p,p=(h=(c=c>>1||1)+r-1&~(r-1))*(f=(l=l>>1||1)+i-1&~(i-1))*ss[e];return s},ms);function ms(t,e){var n=ds.call(this,t,e)||this;return n.format=e.format,n.levels=e.levels||1,n._width=e.width,n._height=e.height,n._extension=ms._formatToExtension(n.format),(e.levelBuffers||n.buffer)&&(n._levelBuffers=e.levelBuffers||ms._createLevelBuffers(t instanceof Uint8Array?t:n.buffer.uint8View,n.format,n.levels,4,4,n.width,n.height)),n}var vs=(gs.use=function(n,r){var t=n.data;if(n.type===Va.TYPE.JSON&&t&&t.cacheID&&t.textures){for(var e,i,o=t.textures,a=void 0,s=void 0,u=0,c=o.length;u<c;u++){var l=o[u],h=l.src,l=l.format;if(l||(s=h),gs.textureFormats[l]){a=h;break}}(a=a||s)?a!==n.url?(e={crossOrigin:n.crossOrigin,metadata:n.metadata.imageMetadata,parentResource:n},i=_t.resolve(n.url.replace(this.baseUrl,""),a),t=t.cacheID,this.add(t,i,e,function(t){var e;t.error?r(t.error):(e=t.texture,t=t.textures,Object.assign(n,{texture:void 0===e?null:e,textures:void 0===t?{}:t}),r())})):r(new Error("URL of compressed texture cannot be the same as the manifest's URL")):r(new Error("Cannot load compressed-textures in "+n.url+", make sure you provide a fallback"))}else r()},gs.add=function(){var t=document.createElement("canvas").getContext("webgl");if(t){var e,n={s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};for(e in gs.textureExtensions=n,gs.textureFormats={},n){var r=n[e];r&&Object.assign(gs.textureFormats,Object.getPrototypeOf(r))}}else console.warn("WebGL not available for compressed textures. Silently failing.")},gs);function gs(){}function bs(i,t,e){var o={textures:{},texture:null};return t&&t.map(function(t){return new Rr(new Gn(t,Object.assign({mipmap:at.OFF,alphaMode:st.NO_PREMULTIPLIED_ALPHA},e)))}).forEach(function(t,e){var n=t.baseTexture,r=i+"-"+(e+1);Gn.addToCache(n,r),Rr.addToCache(t,r),0===e&&(Gn.addToCache(n,i),Rr.addToCache(t,i),o.texture=t),o.textures[r]=t}),o}Va.setExtensionXhrType("dds",Va.XHR_RESPONSE_TYPE.BUFFER);var _s,xs=3,ws=4,Ts=7,Os=19,Ss=2,Es=0,Ps=1,ks=2,Rs=3;(yt=yu=yu||{})[yt.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",yt[yt.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",yt[yt.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",yt[yt.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",yt[yt.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",yt[yt.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",yt[yt.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",yt[yt.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",yt[yt.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",yt[yt.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",yt[yt.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",yt[yt.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",yt[yt.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",yt[yt.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",yt[yt.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",yt[yt.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",yt[yt.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",yt[yt.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",yt[yt.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",yt[yt.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",yt[yt.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",yt[yt.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",yt[yt.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",yt[yt.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",yt[yt.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",yt[yt.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",yt[yt.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",yt[yt.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",yt[yt.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",yt[yt.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",yt[yt.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",yt[yt.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",yt[yt.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",yt[yt.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",yt[yt.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",yt[yt.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",yt[yt.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",yt[yt.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",yt[yt.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",yt[yt.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",yt[yt.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",yt[yt.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",yt[yt.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",yt[yt.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",yt[yt.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",yt[yt.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",yt[yt.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",yt[yt.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",yt[yt.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",yt[yt.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",yt[yt.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",yt[yt.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",yt[yt.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",yt[yt.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",yt[yt.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",yt[yt.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",yt[yt.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",yt[yt.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",yt[yt.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",yt[yt.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",yt[yt.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",yt[yt.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",yt[yt.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",yt[yt.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",yt[yt.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",yt[yt.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",yt[yt.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",yt[yt.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",yt[yt.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",yt[yt.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",yt[yt.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",yt[yt.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",yt[yt.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",yt[yt.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",yt[yt.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",yt[yt.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",yt[yt.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",yt[yt.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",yt[yt.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",yt[yt.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",yt[yt.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",yt[yt.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",yt[yt.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",yt[yt.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",yt[yt.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",yt[yt.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",yt[yt.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",yt[yt.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",yt[yt.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",yt[yt.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",yt[yt.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",yt[yt.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",yt[yt.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",yt[yt.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",yt[yt.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",yt[yt.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",yt[yt.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",yt[yt.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",yt[yt.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",yt[yt.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",yt[yt.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",yt[yt.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",yt[yt.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",yt[yt.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",yt[yt.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",yt[yt.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",yt[yt.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",yt[yt.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",yt[yt.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",yt[yt.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",yt[yt.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",yt[yt.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",yt[yt.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",yt[yt.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",yt[yt.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",yt[yt.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",yt[yt.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",yt[yt.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",yt[yt.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",yt[yt.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",yt[yt.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",yt[yt.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT",(vt=_s=_s||{})[vt.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",vt[vt.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",vt[vt.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D";var As=((bt={})[827611204]=os.COMPRESSED_RGBA_S3TC_DXT1_EXT,bt[861165636]=os.COMPRESSED_RGBA_S3TC_DXT3_EXT,bt[894720068]=os.COMPRESSED_RGBA_S3TC_DXT5_EXT,bt),Cs=((yt={})[yu.DXGI_FORMAT_BC1_TYPELESS]=os.COMPRESSED_RGBA_S3TC_DXT1_EXT,yt[yu.DXGI_FORMAT_BC1_UNORM]=os.COMPRESSED_RGBA_S3TC_DXT1_EXT,yt[yu.DXGI_FORMAT_BC2_TYPELESS]=os.COMPRESSED_RGBA_S3TC_DXT3_EXT,yt[yu.DXGI_FORMAT_BC2_UNORM]=os.COMPRESSED_RGBA_S3TC_DXT3_EXT,yt[yu.DXGI_FORMAT_BC3_TYPELESS]=os.COMPRESSED_RGBA_S3TC_DXT5_EXT,yt[yu.DXGI_FORMAT_BC3_UNORM]=os.COMPRESSED_RGBA_S3TC_DXT5_EXT,yt[yu.DXGI_FORMAT_BC1_UNORM_SRGB]=os.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,yt[yu.DXGI_FORMAT_BC2_UNORM_SRGB]=os.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,yt[yu.DXGI_FORMAT_BC3_UNORM_SRGB]=os.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,yt),Is=(Ms.use=function(t,e){if("dds"===t.extension&&t.data)try{Object.assign(t,bs(t.name||t.url,Ms.parse(t.data),t.metadata))}catch(t){return void e(t)}e()},Ms.parse=function(t){var e=new Uint32Array(t);if(542327876!==e[0])throw new Error("Invalid DDS file magic word");var n=new Uint32Array(t,0,124/Uint32Array.BYTES_PER_ELEMENT),r=n[xs],i=n[ws],o=n[Ts],a=new Uint32Array(t,Os*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),n=a[1];if(4&n){a=a[Ss];if(808540228!==a){var s=As[a],u=new Uint8Array(t,128);return[new ys(u,{format:s,width:i,height:r,levels:o})]}var a=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),u=a[Es],s=a[Ps],e=a[ks],c=a[Rs],l=Cs[u];if(void 0===l)throw new Error("DDSLoader cannot parse texture data with DXGI format "+u);if(4===e)throw new Error("DDSLoader does not support cubemap textures");if(s===_s.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSLoader does not supported 3D texture data");var h=new Array;if(1===c)h.push(new Uint8Array(t,148));else{for(var f=ss[l],p=0,d=i,y=r,m=0;m<o;m++)p+=Math.max(1,d+3&-4)*Math.max(1,y+3&-4)*f,d>>>=1,y>>>=1;for(var v=148,m=0;m<c;m++)h.push(new Uint8Array(t,v,p)),v+=p}return h.map(function(t){return new ys(t,{format:l,width:i,height:r,levels:o})})}if(64&n)throw new Error("DDSLoader does not support uncompressed texture data.");if(512&n)throw new Error("DDSLoader does not supported YUV uncompressed texture data.");if(131072&n)throw new Error("DDSLoader does not support single-channel (lumninance) texture data!");if(2&n)throw new Error("DDSLoader does not support single-channel (alpha) texture data!");throw new Error("DDSLoader failed to load a texture file due to an unknown reason!")},Ms);function Ms(){}Va.setExtensionXhrType("ktx",Va.XHR_RESPONSE_TYPE.BUFFER);var js=[171,75,84,88,32,49,49,187,13,10,26,10],Ds=12,Ls=16,Ns=24,Fs=28,Bs=36,Us=40,Gs=44,Xs=48,Hs=52,zs=56,Vs=60,Ws=((vt={})[nt.UNSIGNED_BYTE]=1,vt[nt.UNSIGNED_SHORT]=2,vt[nt.FLOAT]=4,vt[nt.HALF_FLOAT]=8,vt),Ys=((bt={})[tt.RGBA]=4,bt[tt.RGB]=3,bt[tt.LUMINANCE]=1,bt[tt.LUMINANCE_ALPHA]=2,bt[tt.ALPHA]=1,bt),qs=((yu={})[nt.UNSIGNED_SHORT_4_4_4_4]=2,yu[nt.UNSIGNED_SHORT_5_5_5_1]=2,yu[nt.UNSIGNED_SHORT_5_6_5]=2,yu),Ks=(Zs.use=function(t,e){if("ktx"===t.extension&&t.data)try{var n=t.name||t.url;Object.assign(t,bs(n,Zs.parse(n,t.data),t.metadata))}catch(t){return void e(t)}e()},Zs.parse=function(t,e){var n=new DataView(e);if(!Zs.validate(t,n))return null;var r=67305985===n.getUint32(Ds,!0),i=n.getUint32(Ls,r),o=n.getUint32(Ns,r),a=n.getUint32(Fs,r),s=n.getUint32(Bs,r),u=n.getUint32(Us,r)||1,c=n.getUint32(Gs,r)||1,l=n.getUint32(Xs,r)||1,h=n.getUint32(Hs,r),f=n.getUint32(zs,r),p=n.getUint32(Vs,r);if(0===u||1!==c)throw new Error("Only 2D textures are supported");if(1!==h)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==l)throw new Error("WebGL does not support array textures");var t=s+3&-4,c=u+3&-4,d=new Array(l),h=0===i?t*c:s*u,y=0!==i?Ws[i]?Ws[i]*Ys[o]:qs[i]:ss[a];if(void 0===y)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var m=h*y,v=s,g=u,b=t,_=c,x=64+p,w=0;w<f;w++){for(var T=n.getUint32(x,r),O=x+4,S=0;S<l;S++)(d[S]||(d[S]=new Array(f)))[w]={levelID:w,levelWidth:1<f?v:b,levelHeight:1<f?g:_,levelBuffer:new Uint8Array(e,O,m)},O+=m;x=(x+=T+4)%4!=0?x+4-x%4:x,m=(b=(v=v>>1||1)+4-1&-4)*(_=(g=g>>1||1)+4-1&-4)*y}if(0!==i)throw new Error("TODO: Uncompressed");return d.map(function(t){return new ys(null,{format:a,width:s,height:u,levels:f,levelBuffers:t})})},Zs.validate=function(t,e){for(var n=0;n<js.length;n++)if(e.getUint8(n)!==js[n])return console.error(t+" is not a valid *.ktx file!"),!1;return!0},Zs);function Zs(){}var Qs=function(t,e){return(Qs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function $s(t,e){function n(){this.constructor=t}Qs(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Js,tu=($s(eu,Js=Qe),eu.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},eu.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(eu.prototype,"tint",{get:function(){return this._tint},set:function(t){kt(this._tint=t,this.tintRgb)},enumerable:!1,configurable:!0}),eu.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return e.onChildrenChange(0)})),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},eu.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},eu.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},eu.prototype.destroy=function(t){Js.prototype.destroy.call(this,t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},eu);function eu(t,e,n,r){void 0===t&&(t=1500),void 0===n&&(n=16384),void 0===r&&(r=!1);var i=Js.call(this)||this;return 16384<n&&(n=16384),i._properties=[!1,!0,!1,!1,!1],i._maxSize=t,i._batchSize=n,i._buffers=null,i._bufferUpdateIDs=[],i._updateID=0,i.interactiveChildren=!1,i.blendMode=$.NORMAL,i.autoResize=r,i.roundPixels=!0,i.baseTexture=null,i.setProperties(e),i._tint=0,i.tintRgb=new Float32Array(4),i.tint=16777215,i}var nu=(ru.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new Ur(Nt(this.size),!0,!0),t.addIndex(this.indexBuffer);for(var n=this.dynamicStride=0;n<this.dynamicProperties.length;++n)(o=this.dynamicProperties[n]).offset=e,e+=o.size,this.dynamicStride+=o.size;var r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new Ur(this.dynamicData,!1,!1);for(var i=0,n=this.staticStride=0;n<this.staticProperties.length;++n)(o=this.staticProperties[n]).offset=i,i+=o.size,this.staticStride+=o.size;r=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(r),this.staticDataUint32=new Uint32Array(r),this.staticBuffer=new Ur(this.staticData,!0,!1);for(n=0;n<this.dynamicProperties.length;++n){var o=this.dynamicProperties[n];t.addAttribute(o.attributeName,this.dynamicBuffer,0,o.type===nt.UNSIGNED_BYTE,o.type,4*this.dynamicStride,4*o.offset)}for(n=0;n<this.staticProperties.length;++n){o=this.staticProperties[n];t.addAttribute(o.attributeName,this.staticBuffer,0,o.type===nt.UNSIGNED_BYTE,o.type,4*this.staticStride,4*o.offset)}},ru.prototype.uploadDynamic=function(t,e,n){for(var r=0;r<this.dynamicProperties.length;r++){var i=this.dynamicProperties[r];i.uploadFunction(t,e,n,i.type===nt.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer._updateID++},ru.prototype.uploadStatic=function(t,e,n){for(var r=0;r<this.staticProperties.length;r++){var i=this.staticProperties[r];i.uploadFunction(t,e,n,i.type===nt.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer._updateID++},ru.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},ru);function ru(t,e,n){this.geometry=new Wr,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<t.length;++r){var i={attributeName:(i=t[r]).attributeName,size:i.size,uploadFunction:i.uploadFunction,type:i.type||nt.FLOAT,offset:i.offset};(e[r]?this.dynamicProperties:this.staticProperties).push(i)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}var iu,ou,au,su=($s(uu,iu=ci),uu.prototype.render=function(t){var e=t.children,n=t._maxSize,r=t._batchSize,i=this.renderer,o=e.length;if(0!==o){n<o&&!t.autoResize&&(o=n);var a=(a=t._buffers)||(t._buffers=this.generateBuffers(t)),s=e[0]._texture.baseTexture;this.state.blendMode=Mt(t.blendMode,s.alphaMode),i.state.set(this.state);var u=i.gl,n=t.worldTransform.copyTo(this.tempMatrix);n.prepend(i.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=n.toArray(!0),this.shader.uniforms.uColor=jt(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,s.alphaMode),this.shader.uniforms.uSampler=s,this.renderer.shader.bind(this.shader);for(var c=!1,l=0,h=0;l<o;l+=r,h+=1){var f=o-l;r<f&&(f=r),h>=a.length&&a.push(this._generateOneMoreBuffer(t));var p=a[h];p.uploadDynamic(e,l,f);var d=t._bufferUpdateIDs[h]||0;(c=c||p._updateID<d)&&(p._updateID=t._updateID,p.uploadStatic(e,l,f)),i.geometry.bind(p.geometry),u.drawElements(u.TRIANGLES,6*f,u.UNSIGNED_SHORT,0)}}},uu.prototype.generateBuffers=function(t){for(var e=[],n=t._maxSize,r=t._batchSize,i=t._properties,o=0;o<n;o+=r)e.push(new nu(this.properties,i,r));return e},uu.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,t=t._properties;return new nu(this.properties,t,e)},uu.prototype.uploadVertices=function(t,e,n,r,i,o){for(var a=0,s=0,u=0,c=0,l=0;l<n;++l){var h=t[e+l],f=h._texture,p=h.scale.x,d=h.scale.y,y=f.trim,f=f.orig;y?(a=(s=y.x-h.anchor.x*f.width)+y.width,u=(c=y.y-h.anchor.y*f.height)+y.height):(a=f.width*(1-h.anchor.x),s=f.width*-h.anchor.x,u=f.height*(1-h.anchor.y),c=f.height*-h.anchor.y),r[o]=s*p,r[o+1]=c*d,r[o+i]=a*p,r[o+i+1]=c*d,r[o+2*i]=a*p,r[o+2*i+1]=u*d,r[o+3*i]=s*p,r[o+3*i+1]=u*d,o+=4*i}},uu.prototype.uploadPosition=function(t,e,n,r,i,o){for(var a=0;a<n;a++){var s=t[e+a].position;r[o]=s.x,r[o+1]=s.y,r[o+i]=s.x,r[o+i+1]=s.y,r[o+2*i]=s.x,r[o+2*i+1]=s.y,r[o+3*i]=s.x,r[o+3*i+1]=s.y,o+=4*i}},uu.prototype.uploadRotation=function(t,e,n,r,i,o){for(var a=0;a<n;a++){var s=t[e+a].rotation;r[o]=s,r[o+i]=s,r[o+2*i]=s,r[o+3*i]=s,o+=4*i}},uu.prototype.uploadUvs=function(t,e,n,r,i,o){for(var a=0;a<n;++a){var s=t[e+a]._texture._uvs;s?(r[o]=s.x0,r[o+1]=s.y0,r[o+i]=s.x1,r[o+i+1]=s.y1,r[o+2*i]=s.x2,r[o+2*i+1]=s.y2,r[o+3*i]=s.x3,r[o+3*i+1]=s.y3):(r[o]=0,r[o+1]=0,r[o+i]=0,r[o+i+1]=0,r[o+2*i]=0,r[o+2*i+1]=0,r[o+3*i]=0,r[o+3*i+1]=0),o+=4*i}},uu.prototype.uploadTint=function(t,e,n,r,i,o){for(var a=0;a<n;++a){var s=t[e+a],u=0<s._texture.baseTexture.alphaMode,c=s.alpha,c=c<1&&u?Dt(s._tintRGB,c):s._tintRGB+(255*c<<24);r[o]=c,r[o+i]=c,r[o+2*i]=c,r[o+3*i]=c,o+=4*i}},uu.prototype.destroy=function(){iu.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},uu);function uu(t){t=iu.call(this,t)||this;return t.shader=null,t.properties=null,t.tempMatrix=new Pe,t.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:t.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:t.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:t.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:t.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:nt.UNSIGNED_BYTE,uploadFunction:t.uploadTint,offset:0}],t.shader=Ki.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),t.state=Qi.for2d(),t}(yt=ou=ou||{}).MITER="miter",yt.BEVEL="bevel",yt.ROUND="round",(vt=au=au||{}).BUTT="butt",vt.ROUND="round",vt.SQUARE="square";var cu={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;t=Math.ceil(t/this.maxLength);return t<this.minSegments?t=this.minSegments:t>this.maxSegments&&(t=this.maxSegments),t}},lu=(hu.prototype.clone=function(){var t=new hu;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},hu.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Rr.WHITE,this.matrix=null,this.visible=!1},hu.prototype.destroy=function(){this.texture=null,this.matrix=null},hu);function hu(){this.color=16777215,this.alpha=1,this.texture=Rr.WHITE,this.matrix=null,this.visible=!1,this.reset()}var fu=function(t,e){return(fu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function pu(t,e){function n(){this.constructor=t}fu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var du={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var n=t.points,r=t.holes,i=e.points,o=e.indices;if(6<=n.length){for(var a=[],s=0;s<r.length;s++){var u=r[s];a.push(n.length/2),n=n.concat(u.points)}var c=gt()(n,a,2);if(c){for(var l=i.length/2,s=0;s<c.length;s+=3)o.push(c[s]+l),o.push(c[s+1]+l),o.push(c[s+2]+l);for(s=0;s<n.length;s++)i.push(n[s])}}}},bt={build:function(t){var e,n,r=t.shape,i=t.points,o=r.x,a=r.y;if(i.length=0,n=t.type===ce.CIRC?(e=r.radius,r.radius):(e=(t=t.shape).width,t.height),0!==e&&0!==n){var s=Math.floor(30*Math.sqrt(r.radius))||Math.floor(15*Math.sqrt(e+n));s/=2.3;for(var u=2*Math.PI/s,c=0;c<s-.5;c++)i.push(o+Math.sin(-u*c)*e,a+Math.cos(-u*c)*n);i.push(i[0],i[1])}},triangulate:function(t,e){var n=t.points,r=e.points,i=e.indices,o=r.length/2,a=o,s=t.shape,u=t.matrix,e=s.x,s=s.y;r.push(t.matrix?u.a*e+u.c*s+u.tx:e,t.matrix?u.b*e+u.d*s+u.ty:s);for(var c=0;c<n.length;c+=2)r.push(n[c],n[c+1]),i.push(o++,a,o)}},yu={build:function(t){var e=t.shape,n=e.x,r=e.y,i=e.width,e=e.height,t=t.points;t.length=0,t.push(n,r,n+i,r,n+i,r+e,n,r+e)},triangulate:function(t,e){var n=t.points,r=e.points,t=r.length/2;r.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(t,1+t,2+t,1+t,2+t,3+t)}};function mu(t,e,n){return t+(e-t)*n}function vu(t,e,n,r,i,o,a){for(var s,u,c,l,h,f,p,d=a=void 0===a?[]:a,y=0;y<=20;++y)s=mu(t,n,p=y/20),u=mu(e,r,p),c=mu(n,i,p),l=mu(r,o,p),h=mu(s,c,p),f=mu(u,l,p),0===y&&d[d.length-2]===h&&d[d.length-1]===f||d.push(h,f);return d}yt={build:function(t){var e=t.shape,n=t.points,r=e.x,i=e.y,o=e.width,t=e.height,e=Math.max(0,Math.min(e.radius,Math.min(o,t)/2));n.length=0,e?(vu(r,i+e,r,i,r+e,i,n),vu(r+o-e,i,r+o,i,r+o,i+e,n),vu(r+o,i+t-e,r+o,i+t,r+o-e,i+t,n),vu(r+e,i+t,r,i+t,r,i+t-e,n)):n.push(r,i,r+o,i,r+o,i+t,r,i+t)},triangulate:function(t,e){for(var n=t.points,r=e.points,i=e.indices,o=r.length/2,a=gt()(n,null,2),s=0,u=a.length;s<u;s+=3)i.push(a[s]+o),i.push(a[s+1]+o),i.push(a[s+2]+o);for(s=0,u=n.length;s<u;s++)r.push(n[s],n[++s])}};function gu(t,e,n,r,i,o,a,s){var u,c=a?(u=r,-n):(u=-r,n),a=t+n*o+u,o=e+r*o+c;return s.push(t-n*i+u,e-r*i+c),s.push(a,o),2}function bu(t,e,n,r,i,o,a,s){var u=n-t,c=r-e,l=Math.atan2(u,c),h=Math.atan2(i-t,o-e);s&&l<h?l+=2*Math.PI:!s&&h<l&&(h+=2*Math.PI);var f=l,h=h-l,l=Math.abs(h),p=Math.sqrt(u*u+c*c),d=1+(15*l*Math.sqrt(p)/Math.PI>>0),y=h/d;if(f+=y,s){a.push(t,e),a.push(n,r);for(var m=1,v=f;m<d;m++,v+=y)a.push(t,e),a.push(t+Math.sin(v)*p,e+Math.cos(v)*p);a.push(t,e),a.push(i,o)}else{a.push(n,r),a.push(t,e);for(m=1,v=f;m<d;m++,v+=y)a.push(t+Math.sin(v)*p,e+Math.cos(v)*p),a.push(t,e);a.push(i,o),a.push(t,e)}return 2*d}function _u(t,e){(t.lineStyle.native?function(t,e){var n=0,r=t.shape,i=t.points||r.points,r=r.type!==ce.POLY||r.closeStroke;if(0!==i.length){var o=e.points,a=e.indices,s=i.length/2,e=o.length/2,u=e;for(o.push(i[0],i[1]),n=1;n<s;n++)o.push(i[2*n],i[2*n+1]),a.push(u,u+1),u++;r&&a.push(u,e)}}:function(t,e){var n=t.shape,r=t.points||n.points.slice(),i=e.closePointEps;if(0!==r.length){var o=t.lineStyle,a=new Te(r[0],r[1]),t=new Te(r[r.length-2],r[r.length-1]),n=n.type!==ce.POLY||n.closeStroke,i=Math.abs(a.x-t.x)<i&&Math.abs(a.y-t.y)<i;n&&(r=r.slice(),i&&(r.pop(),r.pop(),t.set(r[r.length-2],r[r.length-1])),i=.5*(a.x+t.x),S=.5*(t.y+a.y),r.unshift(i,S),r.push(i,S));var s,u,c=e.points,l=r.length/2,h=r.length,f=c.length/2,p=o.width/2,d=p*p,y=o.miterLimit*o.miterLimit,m=r[0],v=r[1],g=r[2],b=r[3],_=0,x=0,w=-(v-b),T=m-g,O=Math.sqrt(w*w+T*T);w/=O,T/=O,w*=p,T*=p;var S=o.alignment,E=2*(1-S),P=2*S;n||(o.cap===au.ROUND?h+=bu(m-w*(E-P)*.5,v-T*(E-P)*.5,m-w*E,v-T*E,m+w*P,v+T*P,c,!0)+2:o.cap===au.SQUARE&&(h+=gu(m,v,w,T,E,P,!0,c))),c.push(m-w*E,v-T*E),c.push(m+w*P,v+T*P);for(var k=1;k<l-1;++k){m=r[2*(k-1)],v=r[2*(k-1)+1],g=r[2*k],b=r[2*k+1],_=r[2*(k+1)],x=r[2*(k+1)+1],w=-(v-b),T=m-g,w/=O=Math.sqrt(w*w+T*T),T/=O,w*=p,T*=p,s=-(b-x),u=g-_,s/=O=Math.sqrt(s*s+u*u),u/=O,s*=p,u*=p;var R,A,C,I,M,j,D=g-m,L=v-b,N=g-_,F=x-b,B=L*N-F*D,U=B<0;Math.abs(B)<.1?(c.push(g-w*E,b-T*E),c.push(g+w*P,b+T*P)):(C=g+((R=(D*(j=(-s+_)*(-u+b)-(-s+g)*(-u+x))-N*(M=(-w+m)*(-T+b)-(-w+g)*(-T+v)))/B)-g)*E,I=b+((A=(F*M-L*j)/B)-b)*E,M=g-(R-g)*P,j=b-(A-b)*P,B=U?E:P,(A=(R-g)*(R-g)+(A-b)*(A-b))<=Math.min(D*D+L*L,N*N+F*F)+B*B*d?o.join===ou.BEVEL||y<A/d?(U?(c.push(C,I),c.push(g+w*P,b+T*P),c.push(C,I),c.push(g+s*P,b+u*P)):(c.push(g-w*E,b-T*E),c.push(M,j),c.push(g-s*E,b-u*E),c.push(M,j)),h+=2):o.join===ou.ROUND?U?(c.push(C,I),c.push(g+w*P,b+T*P),h+=bu(g,b,g+w*P,b+T*P,g+s*P,b+u*P,c,!0)+4,c.push(C,I),c.push(g+s*P,b+u*P)):(c.push(g-w*E,b-T*E),c.push(M,j),h+=bu(g,b,g-w*E,b-T*E,g-s*E,b-u*E,c,!1)+4,c.push(g-s*E,b-u*E),c.push(M,j)):(c.push(C,I),c.push(M,j)):(c.push(g-w*E,b-T*E),c.push(g+w*P,b+T*P),o.join===ou.BEVEL||y<A/d||(o.join===ou.ROUND?h+=U?bu(g,b,g+w*P,b+T*P,g+s*P,b+u*P,c,!0)+2:bu(g,b,g-w*E,b-T*E,g-s*E,b-u*E,c,!1)+2:(U?(c.push(M,j),c.push(M,j)):(c.push(C,I),c.push(C,I)),h+=2)),c.push(g-s*E,b-u*E),c.push(g+s*P,b+u*P),h+=2))}m=r[2*(l-2)],v=r[2*(l-2)+1],g=r[2*(l-1)],w=-(v-(b=r[2*(l-1)+1])),T=m-g,w/=O=Math.sqrt(w*w+T*T),T/=O,c.push(g-(w*=p)*E,b-(T*=p)*E),c.push(g+w*P,b+T*P),n||(o.cap===au.ROUND?h+=bu(g-w*(E-P)*.5,b-T*(E-P)*.5,g-w*E,b-T*E,g+w*P,b+T*P,c,!1)+2:o.cap===au.SQUARE&&(h+=gu(g,b,w,T,E,P,!1,c)));for(var G=e.indices,X=cu.epsilon*cu.epsilon,k=f;k<h+f-2;++k)m=c[2*k],v=c[2*k+1],g=c[2*(k+1)],b=c[2*(k+1)+1],_=c[2*(k+2)],x=c[2*(k+2)+1],Math.abs(m*(b-x)+g*(x-v)+_*(v-b))<X||G.push(k,k+1,k+2)}})(t,e)}var xu=(wu.curveTo=function(t,e,n,r,i,o){var a=o[o.length-2],s=o[o.length-1]-e,u=a-t,c=r-e,l=n-t,h=Math.abs(s*l-u*c);if(h<1e-8||0===i)return o[o.length-2]===t&&o[o.length-1]===e||o.push(t,e),null;var f=s*s+u*u,p=c*c+l*l,a=s*c+u*l,r=i*Math.sqrt(f)/h,n=i*Math.sqrt(p)/h,o=r*a/f,h=n*a/p,f=r*l+n*u,a=r*c+n*s,p=l*(r+h),h=c*(r+h);return{cx:f+t,cy:a+e,radius:i,startAngle:Math.atan2(s*(n+o)-a,u*(n+o)-f),endAngle:Math.atan2(h-a,p-f),anticlockwise:l*s<u*c}},wu.arc=function(t,e,n,r,i,o,a,s,u){for(var c=a-o,a=cu._segmentsCount(Math.abs(c)*i,40*Math.ceil(Math.abs(c)/le)),l=c/(2*a),h=2*l,f=Math.cos(l),p=Math.sin(l),d=a-1,y=d%1/d,m=0;m<=d;++m){var v=l+o+h*(m+y*m),g=Math.cos(v),v=-Math.sin(v);u.push((f*g+p*v)*i+n,(f*-v+p*g)*i+r)}},wu);function wu(){}var Tu=(Ou.curveLength=function(t,e,n,r,i,o,a,s){for(var u,c,l,h,f,p,d,y,m,v,g=0,b=t,_=e,x=1;x<=10;++x)m=b-(d=(p=(f=(h=1-(u=x/10))*h)*h)*t+3*f*u*n+3*h*(c=u*u)*i+(l=c*u)*a),v=_-(y=p*e+3*f*u*r+3*h*c*o+l*s),b=d,_=y,g+=Math.sqrt(m*m+v*v);return g},Ou.curveTo=function(t,e,n,r,i,o,a){var s=a[a.length-2],u=a[a.length-1];a.length-=2;var c,l,h,f,p,d=cu._segmentsCount(Ou.curveLength(s,u,t,e,n,r,i,o));a.push(s,u);for(var y,m=1;m<=d;++m)a.push((h=(l=(c=1-(y=m/d))*c)*c)*s+3*l*y*t+3*c*(f=y*y)*n+(p=f*y)*i,h*u+3*l*y*e+3*c*f*r+p*o)},Ou);function Ou(){}var Su=(Eu.curveLength=function(t,e,n,r,i,o){var a=t-2*n+i,s=e-2*r+o,i=2*n-2*t,o=2*r-2*e,n=4*(a*a+s*s),t=4*(a*i+s*o),r=i*i+o*o,e=2*Math.sqrt(n+t+r),a=Math.sqrt(n),s=2*n*a,i=2*Math.sqrt(r),o=t/a;return(s*e+a*t*(e-i)+(4*r*n-t*t)*Math.log((2*a+o+e)/(o+i)))/(4*s)},Eu.curveTo=function(t,e,n,r,i){for(var o=i[i.length-2],a=i[i.length-1],s=cu._segmentsCount(Eu.curveLength(o,a,t,e,n,r)),u=0,c=0,l=1;l<=s;++l){var h=l/s;i.push((u=o+(t-o)*h)+(t+(n-t)*h-u)*h,(c=a+(e-a)*h)+(e+(r-e)*h-c)*h)}},Eu);function Eu(){}var Pu=(ku.prototype.begin=function(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n},ku.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},ku.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},ku);function ku(){this.reset()}var Ru=((vt={})[ce.POLY]=du,vt[ce.CIRC]=bt,vt[ce.ELIP]=bt,vt[ce.RECT]=yu,vt[ce.RREC]=yt,vt),Au=[],Cu=[];var Iu=(Mu.prototype.clone=function(){return new Mu(this.shape,this.fillStyle,this.lineStyle,this.matrix)},Mu.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},Mu);function Mu(t,e,n,r){void 0===e&&(e=null),void 0===n&&(n=null),void 0===r&&(r=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=r,this.type=t.type}var ju,Du=new Te,Lu=new Be,Nu=(pu(Fu,ju=ga),Object.defineProperty(Fu.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),Fu.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0;for(var t=this.textureIds.length=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Cu.push(this.drawCalls[t]);for(t=this.drawCalls.length=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),Au.push(e)}this.batches.length=0},Fu.prototype.clear=function(){return 0<this.graphicsData.length&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},Fu.prototype.drawShape=function(t,e,n,r){r=new Iu(t,e=void 0===e?null:e,n=void 0===n?null:n,r=void 0===r?null:r);return this.graphicsData.push(r),this.dirty++,this},Fu.prototype.drawHole=function(t,e){if(!this.graphicsData.length)return null;t=new Iu(t,null,null,e=void 0===e?null:e),e=this.graphicsData[this.graphicsData.length-1];return t.lineStyle=e.lineStyle,e.holes.push(t),this.dirty++,this},Fu.prototype.destroy=function(){ju.prototype.destroy.call(this);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},Fu.prototype.containsPoint=function(t){for(var e=this.graphicsData,n=0;n<e.length;++n){var r=e[n];if(r.fillStyle.visible&&(r.shape&&(r.matrix?r.matrix.applyInverse(t,Du):Du.copyFrom(t),r.shape.contains(Du.x,Du.y)))){var i=!1;if(r.holes)for(var o=0;o<r.holes.length;o++)if(r.holes[o].shape.contains(Du.x,Du.y)){i=!0;break}if(!i)return!0}}return!1},Fu.prototype.updateBatches=function(t){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,n=this.graphicsData,r=null,i=null;0<this.batches.length&&(i=(r=this.batches[this.batches.length-1]).style);for(var o=this.shapeIndex;o<n.length;o++){this.shapeIndex++;var a=n[o],s=a.fillStyle,u=a.lineStyle;Ru[a.type].build(a),a.matrix&&this.transformPoints(a.points,a.matrix);for(var c=0;c<2;c++){var l,h,f,p=0===c?s:u;p.visible&&(f=p.texture.baseTexture,l=this.indices.length,h=this.points.length/2,f.wrapMode=ot.REPEAT,0===c?this.processFill(a):this.processLine(a),0!=(f=this.points.length/2-h)&&(r&&!this._compareStyles(i,p)&&(r.end(l,h),r=null),r||((r=Au.pop()||new Pu).begin(p,l,h),this.batches.push(r),i=p),this.addUvs(this.points,e,p.texture,h,f,p.matrix)))}}var d=this.indices.length,y=this.points.length/2;r&&r.end(d,y),0!==this.batches.length?(this.indicesUint16&&this.indices.length===this.indicesUint16.length?this.indicesUint16.set(this.indices):this.indicesUint16=new(65535<y&&t?Uint32Array:Uint16Array)(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()):this.batchable=!0}}else this.batchable=!0},Fu.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},Fu.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var n=this.graphicsData[t],r=n.fillStyle,n=n.lineStyle;if(r&&!r.texture.baseTexture.valid)return!1;if(n&&!n.texture.baseTexture.valid)return!1}return!0},Fu.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,n=t.length;e<n;e++)for(var r=t[e],i=0;i<r.size;i++){var o=r.start+i;this.indicesUint16[o]=this.indicesUint16[o]-r.attribStart}},Fu.prototype.isBatchable=function(){if(131070<this.points.length)return!1;for(var t=this.batches,e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<2*Fu.BATCHABLE_SIZE},Fu.prototype.buildDrawCalls=function(){for(var t=++Gn._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Cu.push(this.drawCalls[e]);this.drawCalls.length=0;var n=this.colors,r=this.textureIds,i=Cu.pop();i||((i=new sa).texArray=new ua),i.texArray.count=0,i.start=0,i.size=0,i.type=J.TRIANGLES;var o,a=0,s=null,u=!1,c=J.TRIANGLES,l=0;this.drawCalls.push(i);for(e=0;e<this.batches.length;e++){var h=this.batches[e],f=h.style,p=f.texture.baseTexture;u!==!!f.native&&(c=(u=!!f.native)?J.LINES:J.TRIANGLES,s=null,a=8,t++),s!==p&&(s=p)._batchEnabled!==t&&(8===a&&(t++,(a=0)<i.size&&((i=Cu.pop())||((i=new sa).texArray=new ua),this.drawCalls.push(i)),i.start=l,i.size=0,i.texArray.count=0,i.type=c),p.touched=1,p._batchEnabled=t,p._batchLocation=a,p.wrapMode=ot.REPEAT,i.texArray.elements[i.texArray.count++]=p,a++),i.size+=h.size,l+=h.size,o=p._batchLocation,this.addColors(n,f.color,f.alpha,h.attribSize,h.attribStart),this.addTextureIds(r,o,h.attribSize,h.attribStart)}Gn._globalBatch=t,this.packAttributes()},Fu.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,n=this.colors,r=this.textureIds,i=new ArrayBuffer(3*t.length*4),o=new Float32Array(i),a=new Uint32Array(i),s=0,u=0;u<t.length/2;u++)o[s++]=t[2*u],o[s++]=t[2*u+1],o[s++]=e[2*u],o[s++]=e[2*u+1],a[s++]=n[u],o[s++]=r[u];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)},Fu.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),du.triangulate(t,this)):Ru[t.type].triangulate(t,this)},Fu.prototype.processLine=function(t){_u(t,this);for(var e=0;e<t.holes.length;e++)_u(t.holes[e],this)},Fu.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var n=t[e];Ru[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}},Fu.prototype.calculateBounds=function(){var t=this._bounds,e=Lu,n=Pe.IDENTITY;this._bounds.clear(),e.clear();for(var r=0;r<this.graphicsData.length;r++){var i=this.graphicsData[r],o=i.shape,a=i.type,s=i.lineStyle,u=i.matrix||Pe.IDENTITY,c=0;s&&s.visible&&(i=s.alignment,c=s.width,a===ce.POLY?!function(t){for(var e=t.points,n=0,r=0;r<e.length-2;r+=2)n+=(e[r+2]-e[r])*(e[r+3]+e[r+1]);return 0<n}(o)?c*=i:c*=1-i:c*=Math.max(0,i)),n!==u&&(e.isEmpty()||(t.addBoundsMatrix(e,n),e.clear()),n=u),a===ce.RECT||a===ce.RREC?e.addFramePad(o.x,o.y,o.x+o.width,o.y+o.height,c,c):a===ce.CIRC?e.addFramePad(o.x,o.y,o.x,o.y,o.radius+c,o.radius+c):a===ce.ELIP?e.addFramePad(o.x,o.y,o.x,o.y,o.width+c,o.height+c):t.addVerticesMatrix(n,o.points,0,o.points.length,c,c)}e.isEmpty()||t.addBoundsMatrix(e,n),t.pad(this.boundsPadding,this.boundsPadding)},Fu.prototype.transformPoints=function(t,e){for(var n=0;n<t.length/2;n++){var r=t[2*n],i=t[2*n+1];t[2*n]=e.a*r+e.c*i+e.tx,t[2*n+1]=e.b*r+e.d*i+e.ty}},Fu.prototype.addColors=function(t,e,n,r,i){void 0===i&&(i=0);var o=Dt((e>>16)+(65280&e)+((255&e)<<16),n);t.length=Math.max(t.length,i+r);for(var a=0;a<r;a++)t[i+a]=o},Fu.prototype.addTextureIds=function(t,e,n,r){void 0===r&&(r=0),t.length=Math.max(t.length,r+n);for(var i=0;i<n;i++)t[r+i]=e},Fu.prototype.addUvs=function(t,e,n,r,i,o){void 0===o&&(o=null);for(var a=0,s=e.length,u=n.frame;a<i;){var c,l=t[2*(r+a)],h=t[2*(r+a)+1];o&&(c=o.a*l+o.c*h+o.tx,h=o.b*l+o.d*h+o.ty,l=c),a++,e.push(l/u.width,h/u.height)}var f=n.baseTexture;(u.width<f.width||u.height<f.height)&&this.adjustUvs(e,n,s,i)},Fu.prototype.adjustUvs=function(t,e,n,r){for(var i=e.baseTexture,o=n+2*r,e=e.frame,a=e.width/i.width,s=e.height/i.height,u=e.x/e.width,c=e.y/e.height,l=Math.floor(t[n]+1e-6),h=Math.floor(t[n+1]+1e-6),f=n+2;f<o;f+=2)l=Math.min(l,Math.floor(t[f]+1e-6)),h=Math.min(h,Math.floor(t[f+1]+1e-6));u-=l,c-=h;for(f=n;f<o;f+=2)t[f]=(t[f]+u)*a,t[f+1]=(t[f+1]+c)*s},Fu.BATCHABLE_SIZE=100,Fu);function Fu(){var t=ju.call(this)||this;return t.closePointEps=1e-4,t.boundsPadding=0,t.uvsFloat32=null,t.indicesUint16=null,t.batchable=!1,t.points=[],t.colors=[],t.uvs=[],t.indices=[],t.textureIds=[],t.graphicsData=[],t.drawCalls=[],t.batchDirty=-1,t.batches=[],t.dirty=0,t.cacheDirty=-1,t.clearDirty=0,t.shapeIndex=0,t._bounds=new Be,t.boundsDirty=-1,t}var Bu,Uu=(pu(Gu,Bu=lu),Gu.prototype.clone=function(){var t=new Gu;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},Gu.prototype.reset=function(){Bu.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},Gu);function Gu(){var t=null!==Bu&&Bu.apply(this,arguments)||this;return t.width=0,t.alignment=.5,t.native=!1,t.cap=au.BUTT,t.join=ou.MITER,t.miterLimit=10,t}var Xu,Hu=new Float32Array(3),zu={},Vu=(pu(Wu,Xu=Qe),Object.defineProperty(Wu.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),Wu.prototype.clone=function(){return this.finishPoly(),new Wu(this._geometry)},Object.defineProperty(Wu.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(Wu.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(Wu.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(Wu.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),Wu.prototype.lineStyle=function(t,e,n,r,i){return void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r=.5),void 0===i&&(i=!1),this.lineTextureStyle(t="number"==typeof(t=void 0===t?null:t)?{width:t,color:e,alpha:n,alignment:r,native:i}:t)},Wu.prototype.lineTextureStyle=function(t){t=Object.assign({width:0,texture:Rr.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:au.BUTT,join:ou.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var e=0<t.width&&0<t.alpha;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this},Wu.prototype.startPoly=function(){var t,e;this.currentPath?(t=this.currentPath.points,2<(e=this.currentPath.points.length)&&(this.drawShape(this.currentPath),this.currentPath=new be,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))):(this.currentPath=new be,this.currentPath.closeStroke=!1)},Wu.prototype.finishPoly=function(){this.currentPath&&(2<this.currentPath.points.length?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},Wu.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},Wu.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var n=this.currentPath.points,r=n[n.length-2],i=n[n.length-1];return r===t&&i===e||n.push(t,e),this},Wu.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},Wu.prototype.quadraticCurveTo=function(t,e,n,r){this._initCurve();var i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),Su.curveTo(t,e,n,r,i),this},Wu.prototype.bezierCurveTo=function(t,e,n,r,i,o){return this._initCurve(),Tu.curveTo(t,e,n,r,i,o,this.currentPath.points),this},Wu.prototype.arcTo=function(t,e,n,r,i){this._initCurve(t,e);var o=this.currentPath.points,t=xu.curveTo(t,e,n,r,i,o);return t&&(e=t.cx,n=t.cy,r=t.radius,i=t.startAngle,o=t.endAngle,t=t.anticlockwise,this.arc(e,n,r,i,o,t)),this},Wu.prototype.arc=function(t,e,n,r,i,o){if(r===i)return this;if(!(o=void 0===o?!1:o)&&i<=r?i+=le:o&&r<=i&&(r+=le),0==i-r)return this;var a,s,u=t+Math.cos(r)*n,c=e+Math.sin(r)*n,l=this._geometry.closePointEps,h=this.currentPath?this.currentPath.points:null;return h?(a=Math.abs(h[h.length-2]-u),s=Math.abs(h[h.length-1]-c),a<l&&s<l||h.push(u,c)):(this.moveTo(u,c),h=this.currentPath.points),xu.arc(u,c,t,e,n,r,i,o,h),this},Wu.prototype.beginFill=function(t,e){return this.beginTextureFill({texture:Rr.WHITE,color:t=void 0===t?0:t,alpha:e=void 0===e?1:e})},Wu.prototype.beginTextureFill=function(t){t=Object.assign({texture:Rr.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var e=0<t.alpha;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this},Wu.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},Wu.prototype.drawRect=function(t,e,n,r){return this.drawShape(new pe(t,e,n,r))},Wu.prototype.drawRoundedRect=function(t,e,n,r,i){return this.drawShape(new xe(t,e,n,r,i))},Wu.prototype.drawCircle=function(t,e,n){return this.drawShape(new ye(t,e,n))},Wu.prototype.drawEllipse=function(t,e,n,r){return this.drawShape(new ve(t,e,n,r))},Wu.prototype.drawPolygon=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var r=!0,i=e[0],i=i.points?(r=i.closeStroke,i.points):Array.isArray(e[0])?e[0]:e,i=new be(i);return i.closeStroke=r,this.drawShape(i),this},Wu.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},Wu.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},Wu.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==ce.RECT||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)},Wu.prototype._render=function(t){this.finishPoly();var e=this._geometry,n=t.context.supports.uint32Indices;e.updateBatches(n),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},Wu.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(var r=0;r<n;r++){var i=t.batches[r],o=i.style.color,a=new Float32Array(this.vertexData.buffer,4*i.attribStart*2,2*i.attribSize),s=new Float32Array(t.uvsFloat32.buffer,4*i.attribStart*2,2*i.attribSize),i={vertexData:a,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*i.start,i.size),uvs:s,_batchRGB:kt(o),_tintRGB:o,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[r]=i}},Wu.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,n=this.batches.length;e<n;e++){var r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}},Wu.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),n=this._geometry,r=this.tint,i=this.worldAlpha,o=e.uniforms,a=n.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(r>>16&255)/255*i,o.tint[1]=(r>>8&255)/255*i,o.tint[2]=(255&r)/255*i,o.tint[3]=i,t.shader.bind(e),t.geometry.bind(n,e),t.state.set(this.state);for(var s=0,u=a.length;s<u;s++)this._renderDrawCallDirect(t,n.drawCalls[s])},Wu.prototype._renderDrawCallDirect=function(t,e){for(var n=e.texArray,r=e.type,i=e.size,e=e.start,o=n.count,a=0;a<o;a++)t.texture.bind(n.elements[a],a);t.geometry.draw(r,i,e)},Wu.prototype._resolveDirectShader=function(t){var e=this.shader,n=this.pluginName;if(!e){if(!zu[n]){for(var r=t.plugins.batch.MAX_TEXTURES,i=new Int32Array(r),o=0;o<r;o++)i[o]=o;var a={tint:new Float32Array([1,1,1,1]),translationMatrix:new Pe,default:ei.from({uSamplers:i},!0)},t=t.plugins[n]._shader.program;zu[n]=new Ki(t,a)}e=zu[n]}return e},Wu.prototype._calculateBounds=function(){this.finishPoly();var t,e,n,r=this._geometry;r.graphicsData.length&&(t=(n=r.bounds).minX,e=n.minY,r=n.maxX,n=n.maxY,this._bounds.addFrame(this.transform,t,e,r,n))},Wu.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,Wu._TEMP_POINT),this._geometry.containsPoint(Wu._TEMP_POINT)},Wu.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=kt(this.tint,Hu),e=0;e<this.batches.length;e++){var n=this.batches[e],r=n._batchRGB,r=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);n._tintRGB=(r>>16)+(65280&r)+((255&r)<<16)}}},Wu.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var t=this.transform.worldTransform,e=t.a,n=t.b,r=t.c,i=t.d,o=t.tx,a=t.ty,s=this._geometry.points,u=this.vertexData,c=0,l=0;l<s.length;l+=2){var h=s[l],f=s[l+1];u[c++]=e*h+r*f+o,u[c++]=i*f+n*h+a}}},Wu.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this},Wu.prototype.setMatrix=function(t){return this._matrix=t,this},Wu.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},Wu.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},Wu.prototype.destroy=function(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,Xu.prototype.destroy.call(this,t)},Wu._TEMP_POINT=new Te,Wu);function Wu(t){void 0===t&&(t=null);var e=Xu.call(this)||this;return e.shader=null,e.pluginName="batch",e.currentPath=null,e.batches=[],e.batchTint=-1,e.batchDirty=-1,e.vertexData=null,e._fillStyle=new lu,e._lineStyle=new Uu,e._matrix=null,e._holeMode=!1,e.state=Qi.for2d(),e._geometry=t||new Nu,e._geometry.refCount++,e._transformID=-1,e.tint=16777215,e.blendMode=$.NORMAL,e}var Yu={buildPoly:du,buildCircle:bt,buildRectangle:yu,buildRoundedRectangle:yt,buildLine:_u,ArcUtils:xu,BezierUtils:Tu,QuadraticUtils:Su,BatchPart:Pu,FILL_COMMANDS:Ru,BATCH_POOL:Au,DRAW_CALL_POOL:Cu},qu=function(t,e){return(qu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Ku,Zu,Qu,$u=new Te,Ju=new Uint16Array([0,1,2,0,2,3]),tc=(qu(Zu=nc,Qu=Ku=Qe),Zu.prototype=null===Qu?Object.create(Qu):(ec.prototype=Qu.prototype,new ec),nc.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Vt(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Vt(this.scale.y)*this._height/this._texture.orig.height)},nc.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},nc.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,n=e.a,r=e.b,i=e.c,o=e.d,a=e.tx,s=e.ty,u=this.vertexData,c=t.trim,l=t.orig,h=this._anchor,f=0,p=0,e=0,t=0,e=c?(f=(p=c.x-h._x*l.width)+c.width,(t=c.y-h._y*l.height)+c.height):(f=(p=-h._x*l.width)+l.width,(t=-h._y*l.height)+l.height);if(u[0]=n*p+i*t+a,u[1]=o*t+r*p+s,u[2]=n*f+i*t+a,u[3]=o*t+r*f+s,u[4]=n*f+i*e+a,u[5]=o*e+r*f+s,u[6]=n*p+i*e+a,u[7]=o*e+r*p+s,this._roundPixels)for(var d=dt.RESOLUTION,y=0;y<u.length;++y)u[y]=Math.round((u[y]*d|0)/d)}},nc.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,n=t.orig,r=this._anchor,i=this.transform.worldTransform,o=i.a,a=i.b,s=i.c,u=i.d,c=i.tx,l=i.ty,t=-r._x*n.width,i=t+n.width,r=-r._y*n.height,n=r+n.height;e[0]=o*t+s*r+c,e[1]=u*r+a*t+l,e[2]=o*i+s*r+c,e[3]=u*r+a*i+l,e[4]=o*i+s*n+c,e[5]=u*n+a*i+l,e[6]=o*t+s*n+c,e[7]=u*n+a*t+l},nc.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},nc.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},nc.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new pe),t=this._localBoundsRect),this._bounds.getRectangle(t)):Ku.prototype.getLocalBounds.call(this,t)},nc.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,$u);var e=this._texture.orig.width,n=this._texture.orig.height,r=-e*this.anchor.x,t=0;return $u.x>=r&&$u.x<r+e&&(t=-n*this.anchor.y,$u.y>=t&&$u.y<t+n)},nc.prototype.destroy=function(t){Ku.prototype.destroy.call(this,t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,("boolean"==typeof t?t:t&&t.texture)&&(t="boolean"==typeof t?t:t&&t.baseTexture,this._texture.destroy(!!t)),this._texture=null},nc.from=function(t,e){return new nc(t instanceof Rr?t:Rr.from(t,e))},Object.defineProperty(nc.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(nc.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=Vt(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(nc.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=Vt(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(nc.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(nc.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(nc.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||Rr.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),nc);function ec(){this.constructor=Zu}function nc(t){var e=Ku.call(this)||this;return e._anchor=new Se(e._onAnchorUpdate,e,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),e._texture=null,e._width=0,e._height=0,e._tint=null,e._tintRGB=null,e.tint=16777215,e.blendMode=$.NORMAL,e._cachedTint=16777215,e.uvs=null,e.texture=t||Rr.EMPTY,e.vertexData=new Float32Array(8),e.vertexTrimmedData=null,e._transformID=-1,e._textureID=-1,e._transformTrimmedID=-1,e._textureTrimmedID=-1,e.indices=Ju,e.pluginName="batch",e.isSprite=!0,e._roundPixels=dt.ROUND_PIXELS,e}var rc,ic=function(t,e){return(ic=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};(yu=rc=rc||{})[yu.LINEAR_VERTICAL=0]="LINEAR_VERTICAL";var oc={align:"left",breakWords:!(yu[yu.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"),dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:rc.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},ac=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],sc=(uc.prototype.clone=function(){var t={};return hc(t,this,oc),new uc(t)},uc.prototype.reset=function(){hc(this,oc,oc)},Object.defineProperty(uc.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){t=lc(t);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"fill",{get:function(){return this._fill},set:function(t){t=lc(t);this._fill!==t&&(this._fill=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){!function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(this._fillGradientStops,t)&&(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"stroke",{get:function(){return this._stroke},set:function(t){t=lc(t);this._stroke!==t&&(this._stroke=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),uc.prototype.toFontString=function(){for(var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily,n=(e=!Array.isArray(this.fontFamily)?this.fontFamily.split(","):e).length-1;0<=n;n--){var r=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&ac.indexOf(r)<0&&(r='"'+r+'"'),e[n]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},uc);function uc(t){this.styleID=0,this.reset(),hc(this,t,t)}function cc(t){return"number"==typeof t?Rt(t):"string"==typeof t&&0===t.indexOf("0x")?t.replace("0x","#"):t}function lc(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=cc(t[e]);return t}return cc(t)}function hc(t,e,n){for(var r in n)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}var fc=(pc.measureText=function(t,e,n,r){void 0===r&&(r=pc._canvas),n=null==n?e.wordWrap:n;var i=e.toFontString(),o=pc.measureFont(i);0===o.fontSize&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);var a=r.getContext("2d");a.font=i;for(var s=(n?pc.wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),u=new Array(s.length),c=0,l=0;l<s.length;l++){var h=a.measureText(s[l]).width+(s[l].length-1)*e.letterSpacing;u[l]=h,c=Math.max(c,h)}i=c+e.strokeThickness;e.dropShadow&&(i+=e.dropShadowDistance);n=e.lineHeight||o.fontSize+e.strokeThickness,r=Math.max(n,o.fontSize+e.strokeThickness)+(s.length-1)*(n+e.leading);return e.dropShadow&&(r+=e.dropShadowDistance),new pc(t,e,i,r,s,u,n+e.leading,c,o)},pc.wordWrap=function(t,e,n){for(var r=(n=void 0===n?pc._canvas:n).getContext("2d"),i=0,o="",a="",s=Object.create(null),u=e.letterSpacing,n=e.whiteSpace,c=pc.collapseSpaces(n),l=pc.collapseNewlines(n),h=!c,f=e.wordWrapWidth+u,p=pc.tokenize(t),d=0;d<p.length;d++){var y=p[d];if(pc.isNewline(y)){if(!l){a+=pc.addLine(o),h=!c,o="",i=0;continue}y=" "}if(c){var m=pc.isBreakingSpace(y),v=pc.isBreakingSpace(o[o.length-1]);if(m&&v)continue}m=pc.getFromCache(y,u,s,r);if(f<m)if(""!==o&&(a+=pc.addLine(o),o="",i=0),pc.canBreakWords(y,e.breakWords))for(var g=pc.wordWrapSplit(y),b=0;b<g.length;b++){for(var _=g[b],x=1;g[b+x];){var w=g[b+x],T=_[_.length-1];if(pc.canBreakChars(T,w,y,b,e.breakWords))break;_+=w,x++}b+=_.length-1;var O=pc.getFromCache(_,u,s,r);f<O+i&&(a+=pc.addLine(o),h=!1,o="",i=0),o+=_,i+=O}else{0<o.length&&(a+=pc.addLine(o),o="",i=0);v=d===p.length-1;a+=pc.addLine(y,!v),h=!1,o="",i=0}else f<m+i&&(h=!1,a+=pc.addLine(o),o="",i=0),(0<o.length||!pc.isBreakingSpace(y)||h)&&(o+=y,i+=m)}return a+=pc.addLine(o,!1)},pc.addLine=function(t,e){return void 0===e&&(e=!0),t=pc.trimRight(t),t=e?t+"\n":t},pc.getFromCache=function(t,e,n,r){var i=n[t];return"number"!=typeof i&&(e=t.length*e,i=r.measureText(t).width+e,n[t]=i),i},pc.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},pc.collapseNewlines=function(t){return"normal"===t},pc.trimRight=function(t){if("string"!=typeof t)return"";for(var e=t.length-1;0<=e;e--){var n=t[e];if(!pc.isBreakingSpace(n))break;t=t.slice(0,-1)}return t},pc.isNewline=function(t){return"string"==typeof t&&0<=pc._newlines.indexOf(t.charCodeAt(0))},pc.isBreakingSpace=function(t,e){return"string"==typeof t&&0<=pc._breakingSpaces.indexOf(t.charCodeAt(0))},pc.tokenize=function(t){var e=[],n="";if("string"!=typeof t)return e;for(var r=0;r<t.length;r++){var i=t[r],o=t[r+1];pc.isBreakingSpace(i,o)||pc.isNewline(i)?(""!==n&&(e.push(n),n=""),e.push(i)):n+=i}return""!==n&&e.push(n),e},pc.canBreakWords=function(t,e){return e},pc.canBreakChars=function(t,e,n,r,i){return!0},pc.wordWrapSplit=function(t){return t.split("")},pc.measureFont=function(t){if(pc._fonts[t])return pc._fonts[t];var e={ascent:0,descent:0,fontSize:0},n=pc._canvas,r=pc._context;r.font=t;var i=pc.METRICS_STRING+pc.BASELINE_SYMBOL,o=Math.ceil(r.measureText(i).width),a=Math.ceil(r.measureText(pc.BASELINE_SYMBOL).width),s=Math.ceil(pc.HEIGHT_MULTIPLIER*a),a=a*pc.BASELINE_MULTIPLIER|0;n.width=o,n.height=s,r.fillStyle="#f00",r.fillRect(0,0,o,s),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(i,0,a);for(var u=r.getImageData(0,0,o,s).data,r=u.length,c=4*o,l=0,h=0,f=!1,l=0;l<a;++l){for(var p=0;p<c;p+=4)if(255!==u[h+p]){f=!0;break}if(f)break;h+=c}for(e.ascent=a-l,h=r-c,f=!1,l=s;a<l;--l){for(p=0;p<c;p+=4)if(255!==u[h+p]){f=!0;break}if(f)break;h-=c}return e.descent=l-a,e.fontSize=e.ascent+e.descent,pc._fonts[t]=e},pc.clearMetrics=function(t){(t=void 0===t?"":t)?delete pc._fonts[t]:pc._fonts={}},pc);function pc(t,e,n,r,i,o,a,s,u){this.text=t,this.style=e,this.width=n,this.height=r,this.lines=i,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=s,this.fontProperties=u}yt=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(t){return document.createElement("canvas")}}();yt.width=yt.height=10,fc._canvas=yt,fc._context=yt.getContext("2d"),fc._fonts={},fc.METRICS_STRING="|q",fc.BASELINE_SYMBOL="M",fc.BASELINE_MULTIPLIER=1.4,fc.HEIGHT_MULTIPLIER=2,fc._newlines=[10,13];var dc,yc,mc,vc={texture:!0,children:!(fc._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]),baseTexture:!0},gc=(ic(yc=_c,mc=dc=tc),yc.prototype=null===mc?Object.create(mc):(bc.prototype=mc.prototype,new bc),_c.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var n,r,i=this.context,o=fc.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),t=o.width,a=o.height,s=o.lines,u=o.lineHeight,c=o.lineWidths,l=o.maxLineWidth,h=o.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,t)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+2*e.padding)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=e.strokeThickness,i.textBaseline=e.textBaseline,i.lineJoin=e.lineJoin,i.miterLimit=e.miterLimit;for(var f=e.dropShadow?2:1,p=0;p<f;++p){var d=e.dropShadow&&0===p,y=d?Math.ceil(Math.max(1,a)+2*e.padding):0,m=y*this._resolution;d?(i.fillStyle="black",i.strokeStyle="black",d=kt("number"==typeof(d=e.dropShadowColor)?d:At(d)),i.shadowColor="rgba("+255*d[0]+","+255*d[1]+","+255*d[2]+","+e.dropShadowAlpha+")",i.shadowBlur=e.dropShadowBlur,i.shadowOffsetX=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,i.shadowOffsetY=Math.sin(e.dropShadowAngle)*e.dropShadowDistance+m):(i.fillStyle=this._generateFillStyle(e,s,o),i.strokeStyle=e.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0);var v=(u-h.fontSize)/2;(!_c.nextLineHeightBehavior||u-h.fontSize<0)&&(v=0);for(var g=0;g<s.length;g++)n=e.strokeThickness/2,r=e.strokeThickness/2+g*u+h.ascent+v,"right"===e.align?n+=l-c[g]:"center"===e.align&&(n+=(l-c[g])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(s[g],n+e.padding,r+e.padding-y,!0),e.fill&&this.drawLetterSpacing(s[g],n+e.padding,r+e.padding-y)}this.updateTexture()}},_c.prototype.drawLetterSpacing=function(t,e,n,r){void 0===r&&(r=!1);var i=this._style.letterSpacing;if(0!==i)for(var o,a=e,s=Array.from?Array.from(t):t.split(""),u=this.context.measureText(t).width,c=0;c<s.length;++c){var l=s[c];r?this.context.strokeText(l,a,n):this.context.fillText(l,a,n),a+=u-(o=this.context.measureText(t.substring(c+1)).width)+i,u=o}else r?this.context.strokeText(t,e,n):this.context.fillText(t,e,n)},_c.prototype.updateTexture=function(){var t=this.canvas;!this._style.trim||(r=re(t)).data&&(t.width=r.width,t.height=r.height,this.context.putImageData(r.data,0,0));var e=this._texture,n=this._style,r=n.trim?0:n.padding,n=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-r,e.trim.y=-r,e.orig.width=e._frame.width-2*r,e.orig.height=e._frame.height-2*r,this._onTextureUpdate(),n.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this._recursivePostUpdateTransform(),this.dirty=!1},_c.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),dc.prototype._render.call(this,t)},_c.prototype.getLocalBounds=function(t){return this.updateText(!0),dc.prototype.getLocalBounds.call(this,t)},_c.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},_c.prototype._generateFillStyle=function(t,e,n){var r=t.fill;if(!Array.isArray(r))return r;if(1===r.length)return r[0];var i=t.dropShadow?t.dropShadowDistance:0,o=t.padding||0,a=this.canvas.width/this._resolution-i-2*o,s=this.canvas.height/this._resolution-i-2*o,u=r.slice(),c=t.fillGradientStops.slice();if(!c.length)for(var l=u.length+1,h=1;h<l;++h)c.push(h/l);if(u.unshift(r[0]),c.unshift(0),u.push(r[r.length-1]),c.push(1),t.fillGradientType===rc.LINEAR_VERTICAL)for(var f=this.context.createLinearGradient(a/2,o,a/2,s+o),p=n.fontProperties.fontSize+t.strokeThickness,h=0;h<e.length;h++)for(var d=n.lineHeight*(h-1)+p,y=n.lineHeight*h,m=y,v=y+p,g=n.lineHeight*(h+1),b=v,_=((b=h+1<e.length&&g<v?(v+g)/2:b)-(m=0<h&&y<d?(y+d)/2:m))/s,x=0;x<u.length;x++){var w=0,w="number"==typeof c[x]?c[x]:x/u.length,w=Math.min(1,Math.max(0,m/s+w*_)),w=Number(w.toFixed(5));f.addColorStop(w,u[x])}else{f=this.context.createLinearGradient(o,s/2,a+o,s/2);for(var T=u.length+1,O=1,h=0;h<u.length;h++){var S=void 0,S="number"==typeof c[h]?c[h]:O/T;f.addColorStop(S,u[h]),O++}}return f},_c.prototype.destroy=function(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},vc,t),dc.prototype.destroy.call(this,t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(_c.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=Vt(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(_c.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=Vt(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(_c.prototype,"style",{get:function(){return this._style},set:function(t){this._style=(t=t||{})instanceof sc?t:new sc(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(_c.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(_c.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),_c.nextLineHeightBehavior=!1,_c);function bc(){this.constructor=yc}function _c(t,e,n){var r=this,i=!1;n||(n=document.createElement("canvas"),i=!0),n.width=3,n.height=3;var o=Rr.from(n);return o.orig=new pe,o.trim=new pe,(r=dc.call(this,o)||this)._ownCanvas=i,r.canvas=n,r.context=r.canvas.getContext("2d"),r._resolution=dt.RESOLUTION,r._autoResolution=!0,r._text=null,r._style=null,r._styleListener=null,r._font="",r.text=t,r.style=e,r.localStyleID=-1,r}dt.UPLOADS_PER_FRAME=4;var xc=function(t,e){return(xc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var wc=(Tc.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},Tc.prototype.allowedToUpload=function(){return 0<this.itemsLeft--},Tc);function Tc(t){this.maxItemsPerFrame=t,this.itemsLeft=0}function Oc(t,e){var n=!1;if(t&&t._textures&&t._textures.length)for(var r,i=0;i<t._textures.length;i++)t._textures[i]instanceof Rr&&(r=t._textures[i].baseTexture,-1===e.indexOf(r)&&(e.push(r),n=!0));return n}function Sc(t,e){if(t.baseTexture instanceof Gn){t=t.baseTexture;return-1===e.indexOf(t)&&e.push(t),!0}return!1}function Ec(t,e){if(t._texture&&t._texture instanceof Rr){t=t._texture.baseTexture;return-1===e.indexOf(t)&&e.push(t),!0}return!1}function Pc(t,e){return e instanceof gc&&(e.updateText(!0),!0)}function kc(t,e){if(e instanceof sc){e=e.toFontString();return fc.measureFont(e),!0}return!1}function Rc(t,e){if(t instanceof gc){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);t=t._texture.baseTexture;return-1===e.indexOf(t)&&e.push(t),!0}return!1}function Ac(t,e){return t instanceof sc&&(-1===e.indexOf(t)&&e.push(t),!0)}var Cc=(Ic.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,an.system.addOnce(this.tick,this,tn.UTILITY))):e&&e()},Ic.prototype.tick=function(){setTimeout(this.delayedTick,0)},Ic.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var n=0,r=this.uploadHooks.length;n<r;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)an.system.addOnce(this.tick,this,tn.UTILITY);else{this.ticking=!1;for(var i=this.completes.slice(0),n=this.completes.length=0,r=i.length;n<r;n++)i[n]()}},Ic.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},Ic.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},Ic.prototype.add=function(t){for(var e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof Qe)for(e=t.children.length-1;0<=e;e--)this.add(t.children[e]);return this},Ic.prototype.destroy=function(){this.ticking&&an.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},Ic);function Ic(t){var e=this;this.limiter=new wc(dt.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(Rc),this.registerFindHook(Ac),this.registerFindHook(Oc),this.registerFindHook(Sc),this.registerFindHook(Ec),this.registerUploadHook(Pc),this.registerUploadHook(kc)}function Mc(t,e){return e instanceof Gn&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function jc(t,e){if(!(e instanceof Vu))return!1;var n=e.geometry;e.finishPoly(),n.updateBatches();for(var r=n.batches,i=0;i<r.length;i++){var o=r[i].style.texture;o&&Mc(t,o.baseTexture)}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0}function Dc(t,e){return t instanceof Vu&&(e.push(t),!0)}var Lc,Nc,Fc,Bc=(xc(Nc=Gc,Fc=Lc=Cc),Nc.prototype=null===Fc?Object.create(Fc):(Uc.prototype=Fc.prototype,new Uc),Gc);function Uc(){this.constructor=Nc}function Gc(t){t=Lc.call(this,t)||this;return t.uploadHookHelper=t.renderer,t.registerFindHook(Dc),t.registerUploadHook(Mc),t.registerUploadHook(jc),t}var Xc=(Hc.prototype.beginFrame=function(){this.frameStart=Date.now()},Hc.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},Hc);function Hc(t){this.maxMilliseconds=t,this.frameStart=0}var zc=(Vc.prototype._updateResolution=function(t){var e=this.data.meta.scale,t=ue(t=void 0===t?null:t,null);return 1!==(t=null===t?void 0!==e?parseFloat(e):1:t)&&this.baseTexture.setResolution(t),t},Vc.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=Vc.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},Vc.prototype._processFrames=function(t){for(var e=t,n=Vc.BATCH_SIZE;e-t<n&&e<this._frameKeys.length;){var r,i,o,a=this._frameKeys[e],s=this._frames[a],u=s.frame;u&&(r=o=null,i=!1!==s.trimmed&&s.sourceSize?s.sourceSize:s.frame,i=new pe(0,0,Math.floor(i.w)/this.resolution,Math.floor(i.h)/this.resolution),o=s.rotated?new pe(Math.floor(u.x)/this.resolution,Math.floor(u.y)/this.resolution,Math.floor(u.h)/this.resolution,Math.floor(u.w)/this.resolution):new pe(Math.floor(u.x)/this.resolution,Math.floor(u.y)/this.resolution,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution),!1!==s.trimmed&&s.spriteSourceSize&&(r=new pe(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution)),this.textures[a]=new Rr(this.baseTexture,o,i,r,s.rotated?2:0,s.anchor),Rr.addToCache(this.textures[a],a)),e++}},Vc.prototype._processAnimations=function(){var t,e=this.data.animations||{};for(t in e){this.animations[t]=[];for(var n=0;n<e[t].length;n++){var r=e[t][n];this.animations[t].push(this.textures[r])}}},Vc.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},Vc.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*Vc.BATCH_SIZE),this._batchIndex++,setTimeout(function(){t._batchIndex*Vc.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())},0)},Vc.prototype.destroy=function(t){for(var e in void 0===t&&(t=!1),this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null!==(t=this._texture)&&void 0!==t&&t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},Vc.BATCH_SIZE=1e3,Vc);function Vc(t,e,n){void 0===n&&(n=null),this._texture=t instanceof Rr?t:null,this.baseTexture=t instanceof Gn?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;e=this.baseTexture.resource;this.resolution=this._updateResolution(n||(e?e.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}var Wc=(Yc.use=function(r,n){var i=this,t=r.name+"_image";if(r.data&&r.type===Va.TYPE.JSON&&r.data.frames&&!i.resources[t]){var e=null===(s=null===(e=r.data)||void 0===e?void 0:e.meta)||void 0===s?void 0:s.related_multi_packs;if(Array.isArray(e))for(var o=0,a=e;o<a.length;o++)!function(t){if("string"!=typeof t)return;var e=t.replace(".json",""),n=_t.resolve(r.url.replace(i.baseUrl,""),t);if(i.resources[e]||Object.values(i.resources).some(function(t){return _t.format(_t.parse(t.url))===n}))return;t={crossOrigin:r.crossOrigin,loadType:Va.LOAD_TYPE.XHR,xhrType:Va.XHR_RESPONSE_TYPE.JSON,parentResource:r,metadata:r.metadata};i.add(e,n,t)}(a[o]);var s={crossOrigin:r.crossOrigin,metadata:r.metadata.imageMetadata,parentResource:r},e=Yc.getResourcePath(r,i.baseUrl);i.add(t,e,s,function(t){var e;t.error?n(t.error):(e=new zc(t.texture,r.data,r.url)).parse(function(){r.spritesheet=e,r.textures=e.textures,n()})})}else n()},Yc.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:_t.resolve(t.url.replace(e,""),t.data.meta.image)},Yc);function Yc(){}var qc=function(t,e){return(qc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Kc(t,e){function n(){this.constructor=t}qc(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Zc,Qc=new Te,$c=(Kc(Jc,Zc=tc),Object.defineProperty(Jc.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Jc.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(Jc.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Jc.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},Jc.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},Jc.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,n=this._width*(1-this._anchor._x),r=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,n,r)},Jc.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new pe),t=this._localBoundsRect),this._bounds.getRectangle(t)):Zc.prototype.getLocalBounds.call(this,t)},Jc.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Qc);var e=this._width,n=this._height,t=-e*this.anchor._x;if(Qc.x>=t&&Qc.x<t+e){e=-n*this.anchor._y;if(Qc.y>=e&&Qc.y<e+n)return!0}return!1},Jc.prototype.destroy=function(t){Zc.prototype.destroy.call(this,t),this.tileTransform=null,this.uvMatrix=null},Jc.from=function(t,e){return new Jc(t instanceof Rr?t:Rr.from(t,e),e.width,e.height)},Object.defineProperty(Jc.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(Jc.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),Jc);function Jc(t,e,n){void 0===e&&(e=100),void 0===n&&(n=100);var r=Zc.call(this,t)||this;return r.tileTransform=new Ne,r._width=e,r._height=n,r.uvMatrix=r.texture.uvMatrix||new ro(t),r.pluginName="tilingSprite",r.uvRespectAnchor=!1,r}var tl,el="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",nl=new Pe,rl=(Kc(il,tl=ci),il.prototype.render=function(t){var e=this.renderer,n=this.quad,r=n.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y);var i=t.uvRespectAnchor?t.anchor.x:0,o=t.uvRespectAnchor?t.anchor.y:0;(r=n.uvs)[0]=r[6]=-i,r[1]=r[3]=-o,r[2]=r[4]=1-i,r[5]=r[7]=1-o,n.invalidate();var a=t._texture,s=a.baseTexture,u=t.tileTransform.localTransform,c=t.uvMatrix,l=s.isPowerOfTwo&&a.frame.width===s.width&&a.frame.height===s.height;l&&(s._glTextures[e.CONTEXT_UID]?l=s.wrapMode!==ot.CLAMP:s.wrapMode===ot.CLAMP&&(s.wrapMode=ot.REPEAT));var h=l?this.simpleShader:this.shader,f=a.width,i=a.height,r=t._width,o=t._height;nl.set(u.a*f/r,u.b*f/o,u.c*i/r,u.d*i/o,u.tx/r,u.ty/o),nl.invert(),l?nl.prepend(c.mapCoord):(h.uniforms.uMapCoord=c.mapCoord.toArray(!0),h.uniforms.uClampFrame=c.uClampFrame,h.uniforms.uClampOffset=c.uClampOffset),h.uniforms.uTransform=nl.toArray(!0),h.uniforms.uColor=Lt(t.tint,t.worldAlpha,h.uniforms.uColor,s.alphaMode),h.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),h.uniforms.uSampler=a,e.shader.bind(h),e.geometry.bind(n),this.state.blendMode=Mt(t.blendMode,s.alphaMode),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},il);function il(t){var e=tl.call(this,t)||this,t={globals:e.renderer.globalUniforms};return e.shader=Ki.from(el,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture2D(uSampler, coord);\n    gl_FragColor = texSample * uColor;\n}\n",t),e.simpleShader=Ki.from(el,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",t),e.quad=new $r,e.state=Qi.for2d(),e}var ol=function(t,e){return(ol=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function al(t,e){function n(){this.constructor=t}ol(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var sl=(ul.prototype.update=function(t){!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID||(this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID,t=this.uvBuffer.data,this.data&&this.data.length===t.length||(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++)},ul);function ul(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}var cl,ll=new Te,hl=new be,fl=(al(pl,cl=Qe),Object.defineProperty(pl.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(pl.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(pl.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(pl.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(pl.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(pl.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(pl.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),pl.prototype._render=function(t){var e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===J.TRIANGLES&&e.length<2*pl.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},pl.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},pl.prototype._renderToBatch=function(t){var e=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;n=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[n]),t.plugins[n].render(this)},pl.prototype.calculateVertices=function(){var t=this.geometry.buffers[0],e=t.data,n=t._updateID;if(n!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var t=this.transform.worldTransform,r=t.a,i=t.b,o=t.c,a=t.d,s=t.tx,u=t.ty,c=this.vertexData,l=0;l<c.length/2;l++){var h=e[2*l],f=e[2*l+1];c[2*l]=r*h+o*f+s,c[2*l+1]=i*h+a*f+u}if(this._roundPixels)for(var p=dt.RESOLUTION,l=0;l<c.length;++l)c[l]=Math.round((c[l]*p|0)/p);this.vertexDirty=n}},pl.prototype.calculateUvs=function(){var t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new sl(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},pl.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},pl.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,ll);for(var e=this.geometry.getBuffer("aVertexPosition").data,n=hl.points,r=this.geometry.getIndex().data,i=r.length,o=4===this.drawMode?3:1,a=0;a+2<i;a+=o){var s=2*r[a],u=2*r[a+1],c=2*r[a+2];if(n[0]=e[s],n[1]=e[1+s],n[2]=e[u],n[3]=e[1+u],n[4]=e[c],n[5]=e[1+c],hl.contains(ll.x,ll.y))return!0}return!1},pl.prototype.destroy=function(t){cl.prototype.destroy.call(this,t),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},pl.BATCHABLE_SIZE=100,pl);function pl(t,e,n,r){void 0===r&&(r=J.TRIANGLES);var i=cl.call(this)||this;return(i.geometry=t).refCount++,i.shader=e,i.state=n||Qi.for2d(),i.drawMode=r,i.start=0,i.size=0,i.uvs=null,i.indices=null,i.vertexData=new Float32Array(1),i.vertexDirty=-1,i._transformID=-1,i._roundPixels=dt.ROUND_PIXELS,i.batchUvs=null,i}var dl,yl=(al(ml,dl=Ki),Object.defineProperty(ml.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(ml.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(ml.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),ml.prototype.update=function(){var t;this._colorDirty&&(this._colorDirty=!1,t=this.texture.baseTexture,Lt(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)),this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},ml);function ml(t,e){var n=this,r={uSampler:t,alpha:1,uTextureMatrix:Pe.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e)).uniforms&&Object.assign(r,e.uniforms),(n=dl.call(this,e.program||Yi.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),r)||this)._colorDirty=!1,n.uvMatrix=new ro(t),n.batchable=void 0===e.program,n.pluginName=e.pluginName,n.tint=e.tint,n.alpha=e.alpha,n}var vl,gl=(al(bl,vl=Wr),Object.defineProperty(bl.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),bl);function bl(t,e,n){var r=vl.call(this)||this,t=new Ur(t),e=new Ur(e,!0),n=new Ur(n,!0,!0);return r.addAttribute("aVertexPosition",t,2,!1,nt.FLOAT).addAttribute("aTextureCoord",e,2,!1,nt.FLOAT).addIndex(n),r._updateId=-1,r}var _l=function(t,e){return(_l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var xl=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]},yu=(wl.test=function(t){return"string"==typeof t&&0===t.indexOf("info face=")},wl.parse=function(t){var e,n=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[]};for(e in n){var i,o=n[e].match(/^[a-z]+/gm)[0],a=n[e].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),s={};for(i in a){var u=a[i].split("="),c=u[0],l=u[1].replace(/"/gm,""),u=parseFloat(l),u=isNaN(u)?l:u;s[c]=u}r[o].push(s)}var h=new xl;return r.info.forEach(function(t){return h.info.push({face:t.face,size:parseInt(t.size,10)})}),r.common.forEach(function(t){return h.common.push({lineHeight:parseInt(t.lineHeight,10)})}),r.page.forEach(function(t){return h.page.push({id:parseInt(t.id,10),file:t.file})}),r.char.forEach(function(t){return h.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})}),r.kerning.forEach(function(t){return h.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})}),h},wl);function wl(){}var Tl=(Ol.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},Ol.parse=function(t){for(var e=new xl,n=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),i=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),s=0;s<n.length;s++)e.info.push({face:n[s].getAttribute("face"),size:parseInt(n[s].getAttribute("size"),10)});for(s=0;s<r.length;s++)e.common.push({lineHeight:parseInt(r[s].getAttribute("lineHeight"),10)});for(s=0;s<i.length;s++)e.page.push({id:parseInt(i[s].getAttribute("id"),10)||0,file:i[s].getAttribute("file")});for(s=0;s<o.length;s++){var u=o[s];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(s=0;s<a.length;s++)e.kerning.push({first:parseInt(a[s].getAttribute("first"),10),second:parseInt(a[s].getAttribute("second"),10),amount:parseInt(a[s].getAttribute("amount"),10)});return e},Ol);function Ol(){}Sl.test=function(t){if("string"==typeof t&&-1<t.indexOf("<font>")){t=(new self.DOMParser).parseFromString(t,"text/xml");return Tl.test(t)}return!1},Sl.parse=function(t){t=(new self.DOMParser).parseFromString(t,"text/xml");return Tl.parse(t)},yt=Sl;function Sl(){}var El=[yu,Tl,yt];function Pl(t){for(var e=0;e<El.length;e++)if(El[e].test(t))return El[e];return null}function kl(t,e,n,r,i,o,a){var s=n.text,u=n.fontProperties;e.translate(r,i),e.scale(o,o);r=a.strokeThickness/2,i=-a.strokeThickness/2;e.font=a.toFontString(),e.lineWidth=a.strokeThickness,e.textBaseline=a.textBaseline,e.lineJoin=a.lineJoin,e.miterLimit=a.miterLimit,e.fillStyle=function(t,e,n,r,i,o){var a=n.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];var s=n.dropShadow?n.dropShadowDistance:0,u=n.padding||0,c=t.width/r-s-2*u,l=t.height/r-s-2*u,h=a.slice(),f=n.fillGradientStops.slice();if(!f.length)for(var p=h.length+1,d=1;d<p;++d)f.push(d/p);if(h.unshift(a[0]),f.unshift(0),h.push(a[a.length-1]),f.push(1),n.fillGradientType===rc.LINEAR_VERTICAL)for(var y=e.createLinearGradient(c/2,u,c/2,l+u),m=0,v=(o.fontProperties.fontSize+n.strokeThickness)/l,d=0;d<i.length;d++)for(var g=o.lineHeight*d,b=0;b<h.length;b++){var _=0,_="number"==typeof f[b]?f[b]:b/h.length,_=Math.max(m,g/l+_*v),_=Math.min(_,1);y.addColorStop(_,h[b]),m=_}else{y=e.createLinearGradient(u,l/2,c+u,l/2);for(var x=h.length+1,w=1,d=0;d<h.length;d++){var T=void 0,T="number"==typeof f[d]?f[d]:w/x;y.addColorStop(T,h[d]),w++}}return y}(t,e,a,o,[s],n),e.strokeStyle=a.stroke;o=a.dropShadowColor,o=kt("number"==typeof o?o:At(o));a.dropShadow?(e.shadowColor="rgba("+255*o[0]+","+255*o[1]+","+255*o[2]+","+a.dropShadowAlpha+")",e.shadowBlur=a.dropShadowBlur,e.shadowOffsetX=Math.cos(a.dropShadowAngle)*a.dropShadowDistance,e.shadowOffsetY=Math.sin(a.dropShadowAngle)*a.dropShadowDistance):(e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),a.stroke&&a.strokeThickness&&e.strokeText(s,r,i+n.lineHeight-u.descent),a.fill&&e.fillText(s,r,i+n.lineHeight-u.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}var Rl=(Al.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},Al.install=function(t,e,n){var r;if(t instanceof xl)r=t;else{var i=Pl(t);if(!i)throw new Error("Unrecognized data format for font.");r=i.parse(t)}n=new Al(r,e=e instanceof Rr?[e]:e,n);return Al.available[n.font]=n},Al.uninstall=function(t){var e=Al.available[t];if(!e)throw new Error("No font found named '"+t+"'");e.destroy(),delete Al.available[t]},Al.from=function(t,e,n){if(!t)throw new Error("[BitmapFont] Property `name` is required.");var r=Object.assign({},Al.defaultOptions,n),n=r.chars,i=r.padding,o=r.resolution,a=r.textureWidth,s=r.textureHeight,u=function(t){for(var e=[],n=0,r=(t="string"==typeof t?[t]:t).length;n<r;n++){var i=t[n];if(Array.isArray(i)){if(2!==i.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+i.length+".");var o=i[0].charCodeAt(0),a=i[1].charCodeAt(0);if(a<o)throw new Error("[BitmapFont]: Invalid character range.");for(var s=o,u=a;s<=u;s++)e.push(String.fromCharCode(s))}else e.push.apply(e,i.split(""))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(n),c=e instanceof sc?e:new sc(e),l=a,h=new xl;h.info[0]={face:c.fontFamily,size:c.fontSize},h.common[0]={lineHeight:c.fontSize};for(var f,p,d,y=0,m=0,v=0,g=[],b=0;b<u.length;b++){f||((f=document.createElement("canvas")).width=a,f.height=s,p=f.getContext("2d"),d=new Gn(f,{resolution:o}),g.push(new Rr(d)),h.page.push({id:g.length-1,file:""}));var _=fc.measureText(u[b],c,!1,f),x=_.width,w=Math.ceil(_.height),T=Math.ceil(("italic"===c.fontStyle?2:1)*x);if(s-w*o<=m){if(0===m)throw new Error("[BitmapFont] textureHeight "+s+"px is too small for "+c.fontSize+"px fonts");--b,d=p=f=null,v=y=m=0}else{v=Math.max(w+_.fontProperties.descent,v);l<=T*o+y?(--b,m+=v*o,m=Math.ceil(m),v=y=0):(kl(f,p,_,y,m,o,c),_=_.text.charCodeAt(0),h.char.push({id:_,page:g.length-1,x:y/o,y:m/o,width:T,height:w,xoffset:0,yoffset:0,xadvance:Math.ceil(x-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0))}),y+=(T+2*i)*o,y=Math.ceil(y))}}for(var b=0,O=u.length;b<O;b++)for(var S=u[b],E=0;E<O;E++){var P=u[E],k=p.measureText(S).width,R=p.measureText(P).width,R=p.measureText(S+P).width-(k+R);R&&h.kerning.push({first:S.charCodeAt(0),second:P.charCodeAt(0),amount:R})}e=new Al(h,g,!0);return void 0!==Al.available[t]&&Al.uninstall(t),Al.available[t]=e},Al.ALPHA=[["a","z"],["A","Z"]," "],Al.NUMERIC=[["0","9"]],Al.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],Al.ASCII=[[" ","~"]],Al.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Al.ALPHANUMERIC},Al.available={},Al);function Al(t,e,n){var r=t.info[0],i=t.common[0],o=ue(t.page[0].file),a={};this._ownsTextures=n,this.font=r.face,this.size=r.size,this.lineHeight=i.lineHeight/o,this.chars={},this.pageTextures=a;for(var s=0;s<t.page.length;s++){var u=t.page[s],c=u.id,u=u.file;a[c]=e instanceof Array?e[s]:e[u]}for(s=0;s<t.char.length;s++){var l=t.char[s],c=l.id,h=l.page,f=t.char[s],p=f.x,d=f.y,y=f.width,m=f.height,v=f.xoffset,l=f.yoffset,f=f.xadvance;d/=o,y/=o,m/=o,v/=o,l/=o,f/=o;m=new pe((p/=o)+a[h].frame.x/o,d+a[h].frame.y/o,y,m);this.chars[c]={xOffset:v,yOffset:l,xAdvance:f,kerning:{},texture:new Rr(a[h].baseTexture,m),page:h}}for(s=0;s<t.kerning.length;s++){var g=t.kerning[s],b=g.first,_=g.second,g=g.amount;b/=o,_/=o,g/=o,this.chars[_]&&(this.chars[_].kerning[b]=g)}}var Cl,Il,Ml,jl=[],Dl=[],Ll=(_l(Il=Fl,Ml=Cl=Qe),Il.prototype=null===Ml?Object.create(Ml):(Nl.prototype=Ml.prototype,new Nl),Fl.prototype.updateText=function(){for(var t=Rl.available[this._fontName],e=this._fontSize/t.size,n=new Te,r=[],i=[],o=[],a=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",s=a.length,u=this._maxWidth*t.size/this._fontSize,c=null,l=0,h=0,f=0,p=-1,d=0,y=0,m=0,v=0,g=0;g<s;g++){var b,_,x=a.charCodeAt(g),w=a.charAt(g);/(?:\s)/.test(w)&&(p=g,d=l,v++),"\r"!==w&&"\n"!==w?(b=t.chars[x])&&(c&&b.kerning[c]&&(n.x+=b.kerning[c]),(_=Dl.pop()||{texture:Rr.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Te}).texture=b.texture,_.line=f,_.charCode=x,_.position.x=n.x+b.xOffset+this._letterSpacing/2,_.position.y=n.y+b.yOffset,_.prevSpaces=v,r.push(_),l=_.position.x+b.texture.orig.width,n.x+=b.xAdvance+this._letterSpacing,m=Math.max(m,b.yOffset+b.texture.height),c=x,-1!==p&&0<u&&n.x>u&&(zt(r,1+p-++y,1+g-p),g=p,p=-1,i.push(d),o.push(0<r.length?r[r.length-1].prevSpaces:0),h=Math.max(h,d),f++,n.x=0,n.y+=t.lineHeight,c=null,v=0)):(i.push(l),o.push(-1),h=Math.max(h,l),++f,++y,n.x=0,n.y+=t.lineHeight,c=null,v=0)}var T=a.charAt(a.length-1);"\r"!==T&&"\n"!==T&&(/(?:\s)/.test(T)&&(l=d),i.push(l),h=Math.max(h,l),o.push(-1));for(var O=[],g=0;g<=f;g++){var S=0;"right"===this._align?S=h-i[g]:"center"===this._align?S=(h-i[g])/2:"justify"===this._align&&(S=o[g]<0?0:(h-i[g])/o[g]),O.push(S)}for(var E=r.length,P={},k=[],R=this._activePagesMeshData,g=0;g<R.length;g++)jl.push(R[g]);for(g=0;g<E;g++){var A,C,I=(N=r[g].texture).baseTexture.uid;P[I]||((z=jl.pop())||(A=new gl,C=new yl(Rr.EMPTY),z={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new fl(A,C),vertices:null,uvs:null,indices:null}),z.index=0,z.indexCount=0,z.vertexCount=0,z.uvsCount=0,z.total=0,(C=this._textureCache)[I]=C[I]||new Rr(N.baseTexture),z.mesh.texture=C[I],z.mesh.tint=this._tint,k.push(z),P[I]=z),P[I].total++}for(g=0;g<R.length;g++)-1===k.indexOf(R[g])&&this.removeChild(R[g].mesh);for(g=0;g<k.length;g++)k[g].mesh.parent!==this&&this.addChild(k[g].mesh);for(g in this._activePagesMeshData=k,P){var M=(z=P[g]).total;if(!((null===(j=z.indices)||void 0===j?void 0:j.length)>6*M)||z.vertices.length<2*fl.BATCHABLE_SIZE)z.vertices=new Float32Array(8*M),z.uvs=new Float32Array(8*M),z.indices=new Uint16Array(6*M);else for(var j=z.total,D=z.vertices,L=4*j*2;L<D.length;L++)D[L]=0;z.mesh.size=6*M}for(g=0;g<E;g++){var N,F=(w=r[g]).position.x+O[w.line]*("justify"===this._align?w.prevSpaces:1),B=(F=this._roundPixels?Math.round(F):F)*e,U=w.position.y*e,G=P[(N=w.texture).baseTexture.uid],X=N.frame,H=N._uvs,F=G.index++;G.indices[6*F+0]=0+4*F,G.indices[6*F+1]=1+4*F,G.indices[6*F+2]=2+4*F,G.indices[6*F+3]=0+4*F,G.indices[6*F+4]=2+4*F,G.indices[6*F+5]=3+4*F,G.vertices[8*F+0]=B,G.vertices[8*F+1]=U,G.vertices[8*F+2]=B+X.width*e,G.vertices[8*F+3]=U,G.vertices[8*F+4]=B+X.width*e,G.vertices[8*F+5]=U+X.height*e,G.vertices[8*F+6]=B,G.vertices[8*F+7]=U+X.height*e,G.uvs[8*F+0]=H.x0,G.uvs[8*F+1]=H.y0,G.uvs[8*F+2]=H.x1,G.uvs[8*F+3]=H.y1,G.uvs[8*F+4]=H.x2,G.uvs[8*F+5]=H.y2,G.uvs[8*F+6]=H.x3,G.uvs[8*F+7]=H.y3}for(g in this._textWidth=h*e,this._textHeight=(n.y+t.lineHeight)*e,P){var z=P[g];if(0!==this.anchor.x||0!==this.anchor.y)for(var V=0,W=this._textWidth*this.anchor.x,Y=this._textHeight*this.anchor.y,q=0;q<z.total;q++)z.vertices[V++]-=W,z.vertices[V++]-=Y,z.vertices[V++]-=W,z.vertices[V++]-=Y,z.vertices[V++]-=W,z.vertices[V++]-=Y,z.vertices[V++]-=W,z.vertices[V++]-=Y;this._maxLineHeight=m*e;var K=z.mesh.geometry.getBuffer("aVertexPosition"),Z=z.mesh.geometry.getBuffer("aTextureCoord"),Q=z.mesh.geometry.getIndex();K.data=z.vertices,Z.data=z.uvs,Q.data=z.indices,K.update(),Z.update(),Q.update()}for(g=0;g<r.length;g++)Dl.push(r[g])},Fl.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},Fl.prototype.getLocalBounds=function(){return this.validate(),Cl.prototype.getLocalBounds.call(this)},Fl.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(Fl.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(Fl.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Fl.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!Rl.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Fl.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Fl.prototype,"anchor",{get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(Fl.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Fl.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Fl.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(Fl.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(Fl.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Fl.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Fl.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),Fl.prototype.destroy=function(t){var e,n=this._textureCache;for(e in n)n[e].destroy(),delete n[e];this._textureCache=null,Cl.prototype.destroy.call(this,t)},Fl.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},Fl);function Nl(){this.constructor=Il}function Fl(t,e){void 0===e&&(e={});var n=Cl.call(this)||this;n._tint=16777215;var r=Object.assign({},Fl.styleDefaults,e),i=r.align,o=r.tint,a=r.maxWidth,s=r.letterSpacing,e=r.fontName,r=r.fontSize;if(!Rl.available[e])throw new Error('Missing BitmapFont "'+e+'"');return n._activePagesMeshData=[],n._textWidth=0,n._textHeight=0,n._align=i,n._tint=o,n._fontName=e,n._fontSize=r||Rl.available[e].size,n._text=t,n._maxWidth=a,n._maxLineHeight=0,n._letterSpacing=s,n._anchor=new Se(function(){n.dirty=!0},n,0,0),n._roundPixels=dt.ROUND_PIXELS,n.dirty=!0,n._textureCache={},n}var Bl=(Ul.add=function(){Va.setExtensionXhrType("fnt",Va.XHR_RESPONSE_TYPE.TEXT)},Ul.use=function(e,n){var t=Pl(e.data);if(t)for(var r=Ul.getBaseUrl(this,e),i=t.parse(e.data),o={},a=function(t){o[t.metadata.pageFile]=t.texture,Object.keys(o).length===i.page.length&&(e.bitmapFont=Rl.install(i,o,!0),n())},s=0;s<i.page.length;++s){var u,c,l=i.page[s].file,h=r+l,f=!1;for(u in this.resources){var p=this.resources[u];if(p.url===h){p.metadata.pageFile=l,p.texture?a(p):p.onAfterMiddleware.add(a),f=!0;break}}f||(c={crossOrigin:e.crossOrigin,loadType:Va.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:l},e.metadata.imageMetadata),parentResource:e},this.add(h,c,a))}else n()},Ul.getBaseUrl=function(t,e){var n=e.isDataUrl?"":Ul.dirname(e.url);return e.isDataUrl&&("."===n&&(n=""),t.baseUrl&&n&&"/"===t.baseUrl.charAt(t.baseUrl.length-1)&&(n+="/")),(n=n.replace(t.baseUrl,""))&&"/"!==n.charAt(n.length-1)&&(n+="/"),n},Ul.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},Ul);function Ul(){}var Gl=function(t,e){return(Gl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Xl,Hl,zl,Vl=(Gl(Hl=Yl,zl=Xl=to),Hl.prototype=null===zl?Object.create(zl):(Wl.prototype=zl.prototype,new Wl),Object.defineProperty(Yl.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),Yl);function Wl(){this.constructor=Hl}function Yl(t){void 0===t&&(t=1);var e=Xl.call(this,ra,"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1})||this;return e.alpha=t,e}var ql=function(t,e){return(ql=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Kl(t,e){function n(){this.constructor=t}ql(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Zl="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }";var Ql,$l,Jl,th,eh,nh,rh,ih,oh,ah,sh,uh,ch,lh,hh={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},fh=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");(Ql=Ql=Ql||{})[Ql.WEBGL_LEGACY=0]="WEBGL_LEGACY",Ql[Ql.WEBGL=1]="WEBGL",Ql[Ql.WEBGL2=2]="WEBGL2",($l=$l=$l||{})[$l.UNKNOWN=0]="UNKNOWN",$l[$l.WEBGL=1]="WEBGL",$l[$l.CANVAS=2]="CANVAS",(Jl=Jl=Jl||{})[Jl.COLOR=16384]="COLOR",Jl[Jl.DEPTH=256]="DEPTH",Jl[Jl.STENCIL=1024]="STENCIL",(th=th=th||{})[th.NORMAL=0]="NORMAL",th[th.ADD=1]="ADD",th[th.MULTIPLY=2]="MULTIPLY",th[th.SCREEN=3]="SCREEN",th[th.OVERLAY=4]="OVERLAY",th[th.DARKEN=5]="DARKEN",th[th.LIGHTEN=6]="LIGHTEN",th[th.COLOR_DODGE=7]="COLOR_DODGE",th[th.COLOR_BURN=8]="COLOR_BURN",th[th.HARD_LIGHT=9]="HARD_LIGHT",th[th.SOFT_LIGHT=10]="SOFT_LIGHT",th[th.DIFFERENCE=11]="DIFFERENCE",th[th.EXCLUSION=12]="EXCLUSION",th[th.HUE=13]="HUE",th[th.SATURATION=14]="SATURATION",th[th.COLOR=15]="COLOR",th[th.LUMINOSITY=16]="LUMINOSITY",th[th.NORMAL_NPM=17]="NORMAL_NPM",th[th.ADD_NPM=18]="ADD_NPM",th[th.SCREEN_NPM=19]="SCREEN_NPM",th[th.NONE=20]="NONE",th[th.SRC_OVER=0]="SRC_OVER",th[th.SRC_IN=21]="SRC_IN",th[th.SRC_OUT=22]="SRC_OUT",th[th.SRC_ATOP=23]="SRC_ATOP",th[th.DST_OVER=24]="DST_OVER",th[th.DST_IN=25]="DST_IN",th[th.DST_OUT=26]="DST_OUT",th[th.DST_ATOP=27]="DST_ATOP",th[th.ERASE=26]="ERASE",th[th.SUBTRACT=28]="SUBTRACT",th[th.XOR=29]="XOR",(eh=eh=eh||{})[eh.POINTS=0]="POINTS",eh[eh.LINES=1]="LINES",eh[eh.LINE_LOOP=2]="LINE_LOOP",eh[eh.LINE_STRIP=3]="LINE_STRIP",eh[eh.TRIANGLES=4]="TRIANGLES",eh[eh.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",eh[eh.TRIANGLE_FAN=6]="TRIANGLE_FAN",(nh=nh=nh||{})[nh.RGBA=6408]="RGBA",nh[nh.RGB=6407]="RGB",nh[nh.RG=33319]="RG",nh[nh.RED=6403]="RED",nh[nh.RGBA_INTEGER=36249]="RGBA_INTEGER",nh[nh.RGB_INTEGER=36248]="RGB_INTEGER",nh[nh.RG_INTEGER=33320]="RG_INTEGER",nh[nh.RED_INTEGER=36244]="RED_INTEGER",nh[nh.ALPHA=6406]="ALPHA",nh[nh.LUMINANCE=6409]="LUMINANCE",nh[nh.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",nh[nh.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",nh[nh.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(rh=rh=rh||{})[rh.TEXTURE_2D=3553]="TEXTURE_2D",rh[rh.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",rh[rh.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",rh[rh.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",rh[rh.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",rh[rh.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",rh[rh.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",rh[rh.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",rh[rh.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(ih=ih=ih||{})[ih.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",ih[ih.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",ih[ih.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",ih[ih.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",ih[ih.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",ih[ih.UNSIGNED_INT=5125]="UNSIGNED_INT",ih[ih.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",ih[ih.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",ih[ih.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",ih[ih.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",ih[ih.BYTE=5120]="BYTE",ih[ih.SHORT=5122]="SHORT",ih[ih.INT=5124]="INT",ih[ih.FLOAT=5126]="FLOAT",ih[ih.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",ih[ih.HALF_FLOAT=36193]="HALF_FLOAT",(oh=oh=oh||{})[oh.FLOAT=0]="FLOAT",oh[oh.INT=1]="INT",oh[oh.UINT=2]="UINT",(ah=ah=ah||{})[ah.NEAREST=0]="NEAREST",ah[ah.LINEAR=1]="LINEAR",(sh=sh=sh||{})[sh.CLAMP=33071]="CLAMP",sh[sh.REPEAT=10497]="REPEAT",sh[sh.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(uh=uh=uh||{})[uh.OFF=0]="OFF",uh[uh.POW2=1]="POW2",uh[uh.ON=2]="ON",uh[uh.ON_MANUAL=3]="ON_MANUAL",(lh=lh=lh||{})[lh.NPM=0]="NPM",lh[lh.UNPACK=1]="UNPACK",lh[lh.PMA=2]="PMA",lh[lh.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",lh[lh.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",lh[lh.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(lh=ch=ch||{})[lh.NO=0]="NO",lh[lh.YES=1]="YES",lh[lh.AUTO=2]="AUTO",lh[lh.BLEND=0]="BLEND",lh[lh.CLEAR=1]="CLEAR",lh[lh.BLIT=2]="BLIT",(Ah=Ah=Ah||{})[Ah.AUTO=0]="AUTO",Ah[Ah.MANUAL=1]="MANUAL",(Ah=vh=vh||{}).LOW="lowp",Ah.MEDIUM="mediump",Ah.HIGH="highp",(vh=lf=lf||{})[vh.NONE=0]="NONE",vh[vh.SCISSOR=1]="SCISSOR",vh[vh.STENCIL=2]="STENCIL",vh[vh.SPRITE=3]="SPRITE",(Ah=Th=Th||{})[Ah.NONE=0]="NONE",Ah[Ah.LOW=2]="LOW",Ah[Ah.MEDIUM=4]="MEDIUM",Ah[Ah.HIGH=8]="HIGH",(lf=Nh=Nh||{})[lf.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",lf[lf.ARRAY_BUFFER=34962]="ARRAY_BUFFER",lf[lf.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER";var ph,dh=(Kl(yh,ph=to),yh.prototype.apply=function(t,e,n,r){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,n,r);else{var i=t.getFilterTexture(),o=t.renderer,a=e,s=i;this.state.blend=!1,t.applyFilter(this,a,s,ch.CLEAR);for(var u=1;u<this.passes-1;u++){t.bindAndClear(a,ch.BLIT);var c=this.uniforms.uSampler=s,s=a,a=c;o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,s,n,r),t.returnFilterTexture(i)}},Object.defineProperty(yh.prototype,"blur",{get:function(){return this.strength},set:function(t){this.padding=1+2*Math.abs(t),this.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(yh.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t},enumerable:!1,configurable:!0}),yh);function yh(t,e,n,r,i){void 0===e&&(e=8),void 0===n&&(n=4),void 0===r&&(r=dt.FILTER_RESOLUTION);var o=this,a=function(t,e){for(var n=Math.ceil(t/2),r=Zl,i="",o=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);",a=0;a<t;a++)i+=o.replace("%index%",a.toString()).replace("%sampleIndex%",a-(n-1)+".0"),i+="\n";return r=(r=r.replace("%blur%",i)).replace("%size%",t.toString())}(i=void 0===i?5:i,t),i=function(t){for(var e=hh[t],n=e.length,r=fh,i="",o=0;o<t;o++){var a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",o.toString()),s=o;i+=a=a.replace("%value%",e[s=n<=o?t-o-1:s].toString()),i+="\n"}return r=(r=r.replace("%blur%",i)).replace("%size%",t.toString())}(i);return(o=ph.call(this,a,i)||this).horizontal=t,o.resolution=r,o._quality=0,o.quality=n,o.blur=e,o}var mh,vh=(Kl(gh,mh=to),gh.prototype.apply=function(t,e,n,r){var i=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);i&&o?(i=t.getFilterTexture(),this.blurXFilter.apply(t,e,i,ch.CLEAR),this.blurYFilter.apply(t,i,n,r),t.returnFilterTexture(i)):(o?this.blurYFilter:this.blurXFilter).apply(t,e,n,r)},gh.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(gh.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(gh.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(gh.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(gh.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(gh.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(t){this.blurYFilter.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(gh.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(t){this._repeatEdgePixels=t,this.updatePadding()},enumerable:!1,configurable:!0}),gh);function gh(t,e,n,r){void 0===t&&(t=8),void 0===e&&(e=4),void 0===n&&(n=dt.FILTER_RESOLUTION),void 0===r&&(r=5);var i=mh.call(this)||this;return i.blurXFilter=new dh(!0,t,e,n,r),i.blurYFilter=new dh(!1,t,e,n,r),i.resolution=n,i.quality=e,i.blur=t,i.repeatEdgePixels=!1,i}var bh=function(t,e){return(bh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var _h,xh,wh,Th=(bh(xh=Sh,wh=_h=to),xh.prototype=null===wh?Object.create(wh):(Oh.prototype=wh.prototype,new Oh),Sh.prototype._loadMatrix=function(t,e){var n=t;(e=void 0===e?!1:e)&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n},Sh.prototype._multiply=function(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t},Sh.prototype._colorMatrix=function(t){t=new Float32Array(t);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t},Sh.prototype.brightness=function(t,e){this._loadMatrix([t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0],e)},Sh.prototype.tint=function(t,e){this._loadMatrix([(t>>16&255)/255,0,0,0,0,0,(t>>8&255)/255,0,0,0,0,0,(255&t)/255,0,0,0,0,0,1,0],e)},Sh.prototype.greyscale=function(t,e){this._loadMatrix([t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0],e)},Sh.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},Sh.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var n=Math.cos(t),r=Math.sin(t),t=(0,Math.sqrt)(1/3);this._loadMatrix([n+1/3*(1-n),1/3*(1-n)-t*r,1/3*(1-n)+t*r,0,0,1/3*(1-n)+t*r,n+1/3*(1-n),1/3*(1-n)-t*r,0,0,1/3*(1-n)-t*r,1/3*(1-n)+t*r,n+1/3*(1-n),0,0,0,0,0,1,0],e)},Sh.prototype.contrast=function(t,e){var n=(t||0)+1,t=-.5*(n-1);this._loadMatrix([n,0,0,0,t,0,n,0,0,t,0,0,n,0,t,0,0,0,1,0],e)},Sh.prototype.saturate=function(t,e){var n=2*(t=void 0===t?0:t)/3+1,t=-.5*(n-1);this._loadMatrix([n,t,t,0,0,t,n,t,0,0,t,t,n,0,0,0,0,0,1,0],e)},Sh.prototype.desaturate=function(){this.saturate(-1)},Sh.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},Sh.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},Sh.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},Sh.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},Sh.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},Sh.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},Sh.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},Sh.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},Sh.prototype.colorTone=function(t,e,n,r,i){var o=((n=n||16770432)>>16&255)/255,a=(n>>8&255)/255,s=(255&n)/255,u=((r=r||3375104)>>16&255)/255,n=(r>>8&255)/255,r=(255&r)/255;this._loadMatrix([.3,.59,.11,0,0,o,a,s,t=t||.2,0,u,n,r,e=e||.15,0,o-u,a-n,s-r,0,0],i)},Sh.prototype.night=function(t,e){this._loadMatrix([-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0],e)},Sh.prototype.predator=function(t,e){this._loadMatrix([11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0],e)},Sh.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},Sh.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(Sh.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(Sh.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),Sh);function Oh(){this.constructor=xh}function Sh(){var t=this,e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(t=_h.call(this,ia,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",e)||this).alpha=1,t}Th.prototype.grayscale=Th.prototype.greyscale;var Eh=function(t,e){return(Eh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Ph,kh,Rh,Ah=(Eh(kh=Ih,Rh=Ph=to),kh.prototype=null===Rh?Object.create(Rh):(Ch.prototype=Rh.prototype,new Ch),Ih.prototype.apply=function(t,e,n,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var i=this.maskSprite.worldTransform,o=Math.sqrt(i.a*i.a+i.b*i.b),a=Math.sqrt(i.c*i.c+i.d*i.d);0!==o&&0!==a&&(this.uniforms.rotation[0]=i.a/o,this.uniforms.rotation[1]=i.b/o,this.uniforms.rotation[2]=i.c/a,this.uniforms.rotation[3]=i.d/a),t.applyFilter(this,e,n,r)},Object.defineProperty(Ih.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t},enumerable:!1,configurable:!0}),Ih);function Ch(){this.constructor=kh}function Ih(t,e){var n=this,r=new Pe;return t.renderable=!1,(n=Ph.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:t._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=t,n.maskMatrix=r,n.scale=new Te(e=null==e?20:e,e),n}var Mh=function(t,e){return(Mh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var jh,Dh,Lh,Nh=(Mh(Dh=Bh,Lh=jh=to),Dh.prototype=null===Lh?Object.create(Lh):(Fh.prototype=Lh.prototype,new Fh),Bh);function Fh(){this.constructor=Dh}function Bh(){return jh.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')||this}var Uh=function(t,e){return(Uh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Gh,Xh,Hh,zh,Vh,Wh,Yh,qh,Kh,Zh,Qh,$h,Jh,tf,ef,nf,rf,of,af,sf,uf,cf,lf=(Uh(Xh=ff,Hh=Gh=to),Xh.prototype=null===Hh?Object.create(Hh):(hf.prototype=Hh.prototype,new hf),Object.defineProperty(ff.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t},enumerable:!1,configurable:!0}),Object.defineProperty(ff.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t},enumerable:!1,configurable:!0}),ff);function hf(){this.constructor=Xh}function ff(t,e){void 0===t&&(t=.5),void 0===e&&(e=Math.random());var n=Gh.call(this,ia,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0})||this;return n.noise=t,n.seed=e,n}(zh=zh=zh||{})[zh.WEBGL_LEGACY=0]="WEBGL_LEGACY",zh[zh.WEBGL=1]="WEBGL",zh[zh.WEBGL2=2]="WEBGL2",(Vh=Vh=Vh||{})[Vh.UNKNOWN=0]="UNKNOWN",Vh[Vh.WEBGL=1]="WEBGL",Vh[Vh.CANVAS=2]="CANVAS",(Wh=Wh=Wh||{})[Wh.COLOR=16384]="COLOR",Wh[Wh.DEPTH=256]="DEPTH",Wh[Wh.STENCIL=1024]="STENCIL",(Yh=Yh=Yh||{})[Yh.NORMAL=0]="NORMAL",Yh[Yh.ADD=1]="ADD",Yh[Yh.MULTIPLY=2]="MULTIPLY",Yh[Yh.SCREEN=3]="SCREEN",Yh[Yh.OVERLAY=4]="OVERLAY",Yh[Yh.DARKEN=5]="DARKEN",Yh[Yh.LIGHTEN=6]="LIGHTEN",Yh[Yh.COLOR_DODGE=7]="COLOR_DODGE",Yh[Yh.COLOR_BURN=8]="COLOR_BURN",Yh[Yh.HARD_LIGHT=9]="HARD_LIGHT",Yh[Yh.SOFT_LIGHT=10]="SOFT_LIGHT",Yh[Yh.DIFFERENCE=11]="DIFFERENCE",Yh[Yh.EXCLUSION=12]="EXCLUSION",Yh[Yh.HUE=13]="HUE",Yh[Yh.SATURATION=14]="SATURATION",Yh[Yh.COLOR=15]="COLOR",Yh[Yh.LUMINOSITY=16]="LUMINOSITY",Yh[Yh.NORMAL_NPM=17]="NORMAL_NPM",Yh[Yh.ADD_NPM=18]="ADD_NPM",Yh[Yh.SCREEN_NPM=19]="SCREEN_NPM",Yh[Yh.NONE=20]="NONE",Yh[Yh.SRC_OVER=0]="SRC_OVER",Yh[Yh.SRC_IN=21]="SRC_IN",Yh[Yh.SRC_OUT=22]="SRC_OUT",Yh[Yh.SRC_ATOP=23]="SRC_ATOP",Yh[Yh.DST_OVER=24]="DST_OVER",Yh[Yh.DST_IN=25]="DST_IN",Yh[Yh.DST_OUT=26]="DST_OUT",Yh[Yh.DST_ATOP=27]="DST_ATOP",Yh[Yh.ERASE=26]="ERASE",Yh[Yh.SUBTRACT=28]="SUBTRACT",Yh[Yh.XOR=29]="XOR",(qh=qh=qh||{})[qh.POINTS=0]="POINTS",qh[qh.LINES=1]="LINES",qh[qh.LINE_LOOP=2]="LINE_LOOP",qh[qh.LINE_STRIP=3]="LINE_STRIP",qh[qh.TRIANGLES=4]="TRIANGLES",qh[qh.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",qh[qh.TRIANGLE_FAN=6]="TRIANGLE_FAN",(Kh=Kh=Kh||{})[Kh.RGBA=6408]="RGBA",Kh[Kh.RGB=6407]="RGB",Kh[Kh.RG=33319]="RG",Kh[Kh.RED=6403]="RED",Kh[Kh.RGBA_INTEGER=36249]="RGBA_INTEGER",Kh[Kh.RGB_INTEGER=36248]="RGB_INTEGER",Kh[Kh.RG_INTEGER=33320]="RG_INTEGER",Kh[Kh.RED_INTEGER=36244]="RED_INTEGER",Kh[Kh.ALPHA=6406]="ALPHA",Kh[Kh.LUMINANCE=6409]="LUMINANCE",Kh[Kh.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",Kh[Kh.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",Kh[Kh.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(Zh=Zh=Zh||{})[Zh.TEXTURE_2D=3553]="TEXTURE_2D",Zh[Zh.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",Zh[Zh.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",Zh[Zh.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",Zh[Zh.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",Zh[Zh.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",Zh[Zh.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",Zh[Zh.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",Zh[Zh.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(Qh=Qh=Qh||{})[Qh.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",Qh[Qh.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",Qh[Qh.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",Qh[Qh.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",Qh[Qh.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",Qh[Qh.UNSIGNED_INT=5125]="UNSIGNED_INT",Qh[Qh.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",Qh[Qh.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",Qh[Qh.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",Qh[Qh.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",Qh[Qh.BYTE=5120]="BYTE",Qh[Qh.SHORT=5122]="SHORT",Qh[Qh.INT=5124]="INT",Qh[Qh.FLOAT=5126]="FLOAT",Qh[Qh.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",Qh[Qh.HALF_FLOAT=36193]="HALF_FLOAT",($h=$h=$h||{})[$h.FLOAT=0]="FLOAT",$h[$h.INT=1]="INT",$h[$h.UINT=2]="UINT",(Jh=Jh=Jh||{})[Jh.NEAREST=0]="NEAREST",Jh[Jh.LINEAR=1]="LINEAR",(tf=tf=tf||{})[tf.CLAMP=33071]="CLAMP",tf[tf.REPEAT=10497]="REPEAT",tf[tf.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(ef=ef=ef||{})[ef.OFF=0]="OFF",ef[ef.POW2=1]="POW2",ef[ef.ON=2]="ON",ef[ef.ON_MANUAL=3]="ON_MANUAL",(nf=nf=nf||{})[nf.NPM=0]="NPM",nf[nf.UNPACK=1]="UNPACK",nf[nf.PMA=2]="PMA",nf[nf.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",nf[nf.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",nf[nf.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(rf=rf=rf||{})[rf.NO=0]="NO",rf[rf.YES=1]="YES",rf[rf.AUTO=2]="AUTO",rf[rf.BLEND=0]="BLEND",rf[rf.CLEAR=1]="CLEAR",rf[rf.BLIT=2]="BLIT",(of=of=of||{})[of.AUTO=0]="AUTO",of[of.MANUAL=1]="MANUAL",(af=af=af||{}).LOW="lowp",af.MEDIUM="mediump",af.HIGH="highp",(uf=uf=uf||{})[uf.NONE=0]="NONE",uf[uf.SCISSOR=1]="SCISSOR",uf[uf.STENCIL=2]="STENCIL",uf[uf.SPRITE=3]="SPRITE",(uf=sf=sf||{})[uf.NONE=0]="NONE",uf[uf.LOW=2]="LOW",uf[uf.MEDIUM=4]="MEDIUM",uf[uf.HIGH=8]="HIGH",(cf=cf=cf||{})[cf.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",cf[cf.ARRAY_BUFFER=34962]="ARRAY_BUFFER",cf[cf.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER";var pf=new Pe;ze.prototype._cacheAsBitmap=!1,ze.prototype._cacheData=null,ze.prototype._cacheAsBitmapResolution=null,ze.prototype._cacheAsBitmapMultisample=sf.NONE;var df=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(ze.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&((this._cacheAsBitmap=t)?(this._cacheData||(this._cacheData=new df),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),ze.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},ze.prototype._initCachedDisplayObject=function(t){var e,n,r,i,o,a,s,u;this._cacheData&&this._cacheData.sprite||(e=this.alpha,this.alpha=1,t.batch.flush(),n=this.getLocalBounds(null,!0).clone(),this.filters&&(u=this.filters[0].padding,n.pad(u)),n.ceil(dt.RESOLUTION),r=t.renderTexture.current,i=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,u=Mr.create({width:n.width,height:n.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:null!==(s=this.cacheAsBitmapMultisample)&&void 0!==s?s:t.multisample}),s="cacheAsBitmap_"+ ++Wt,this._cacheData.textureCacheId=s,Gn.addToCache(u.baseTexture,s),Rr.addToCache(u,s),s=this.transform.localTransform.copyTo(pf).invert().translate(-n.x,-n.y),this.render=this._cacheData.originalRender,t.render(this,{renderTexture:u,clear:!0,transform:s,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(r,i,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e,(u=new tc(u)).transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(n.x/n.width),u.anchor.y=-(n.y/n.height),u.alpha=e,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=u.containsPoint.bind(u))},ze.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},ze.prototype._initCachedDisplayObjectCanvas=function(t){var e,n,r,i,o,a;this._cacheData&&this._cacheData.sprite||(e=this.getLocalBounds(null,!0),n=this.alpha,this.alpha=1,r=t.context,i=t._projTransform,e.ceil(dt.RESOLUTION),a=Mr.create({width:e.width,height:e.height}),o="cacheAsBitmap_"+ ++Wt,this._cacheData.textureCacheId=o,Gn.addToCache(a.baseTexture,o),Rr.addToCache(a,o),this.transform.localTransform.copyTo(o=pf),o.invert(),o.tx-=e.x,o.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:a,clear:!0,transform:o,skipUpdateTransform:!1}),t.context=r,t._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n,(a=new tc(a)).transform.worldTransform=this.transform.worldTransform,a.anchor.x=-(e.x/e.width),a.anchor.y=-(e.y/e.height),a.alpha=n,a._bounds=this._bounds,this._cacheData.sprite=a,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=a.containsPoint.bind(a))},ze.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},ze.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},ze.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Gn.removeFromCache(this._cacheData.textureCacheId),Rr.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},ze.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},ze.prototype.name=null,Qe.prototype.getChildByName=function(t,e){for(var n=0,r=this.children.length;n<r;n++)if(this.children[n].name===t)return this.children[n];if(e)for(n=0,r=this.children.length;n<r;n++)if(this.children[n].getChildByName){var i=this.children[n].getChildByName(t,!0);if(i)return i}return null},ze.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new Te),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var yf=function(t,e){return(yf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function mf(t,e){function n(){this.constructor=t}yf(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var vf,gf=(mf(bf,vf=gl),bf.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],n=[],r=[],i=this.segWidth-1,o=this.segHeight-1,a=this.width/i,s=this.height/o,u=0;u<t;u++){var c=u%this.segWidth,l=u/this.segWidth|0;e.push(c*a,l*s),n.push(c/i,l/o)}for(var h=i*o,u=0;u<h;u++){var f=u%i,p=u/i|0,d=p*this.segWidth+f,y=p*this.segWidth+f+1,m=(1+p)*this.segWidth+f,f=(1+p)*this.segWidth+f+1;r.push(d,y,m,y,f,m)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},bf);function bf(t,e,n,r){void 0===t&&(t=100),void 0===e&&(e=100),void 0===n&&(n=10),void 0===r&&(r=10);var i=vf.call(this)||this;return i.segWidth=n,i.segHeight=r,i.width=t,i.height=e,i.build(),i}var _f,xf=(mf(wf,_f=gl),Object.defineProperty(wf.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),wf.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),n=this.getBuffer("aTextureCoord"),r=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),n.data=new Float32Array(4*t.length),r.data=new Uint16Array(6*(t.length-1)));var i=n.data,o=r.data;i[0]=0,i[1]=0,i[2]=0,i[3]=1;for(var a=0,s=t[0],u=this._width*this.textureScale,c=t.length,l=0;l<c;l++){var h,f,p=4*l;0<this.textureScale?(h=s.x-t[l].x,f=s.y-t[l].y,f=Math.sqrt(h*h+f*f),s=t[l],a+=f/u):a=l/(c-1),i[p]=a,i[p+1]=0,i[p+2]=a,i[p+3]=1}for(var d=0,l=0;l<c-1;l++){p=2*l;o[d++]=p,o[d++]=p+1,o[d++]=p+2,o[d++]=p+2,o[d++]=p+1,o[d++]=p+3}n.update(),r.update(),this.updateVertices()}}},wf.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e=t[0],n=this.buffers[0].data,r=t.length,i=0;i<r;i++){var o=t[i],a=4*i,s=-((l=i<t.length-1?t[i+1]:o).x-e.x),u=l.y-e.y,c=Math.sqrt(u*u+s*s),l=0<this.textureScale?this.textureScale*this._width/2:this._width/2;u/=c,s/=c,u*=l,s*=l,n[a]=o.x+u,n[1+a]=o.y+s,n[2+a]=o.x-u,n[3+a]=o.y-s,e=o}this.buffers[0].update()}},wf.prototype.update=function(){0<this.textureScale?this.build():this.updateVertices()},wf);function wf(t,e,n){void 0===t&&(t=200),void 0===n&&(n=0);var r=_f.call(this,new Float32Array(4*e.length),new Float32Array(4*e.length),new Uint16Array(6*(e.length-1)))||this;return r.points=e,r._width=t,r.textureScale=n,r.build(),r}var Tf,Of=(mf(Sf,Tf=fl),Sf.prototype._render=function(t){var e=this.geometry;!this.autoUpdate&&e._width===this.shader.texture.height||(e._width=this.shader.texture.height,e.update()),Tf.prototype._render.call(this,t)},Sf);function Sf(t,e,n){var r=this,i=new xf(t.height,e,n=void 0===n?0:n),e=new yl(t);return 0<n&&(t.baseTexture.wrapMode=ot.REPEAT),(r=Tf.call(this,i,e)||this).autoUpdate=!0,r}var Ef,Pf=(mf(kf,Ef=fl),kf.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry,e=this.shader.texture,n=e.width,e=e.height;!this.autoResize||t.width===n&&t.height===e||(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())},Object.defineProperty(kf.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),kf.prototype._render=function(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),Ef.prototype._render.call(this,t)},kf.prototype.destroy=function(t){this.shader.texture.off("update",this.textureUpdated,this),Ef.prototype.destroy.call(this,t)},kf);function kf(t,e,n){var r=this,e=new gf(t.width,t.height,e,n),n=new yl(Rr.WHITE);return(r=Ef.call(this,e,n)||this).texture=t,r.autoResize=!0,r}var Rf,Af=(mf(Cf,Rf=fl),Object.defineProperty(Cf.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),Cf.prototype._render=function(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),Rf.prototype._render.call(this,t)},Cf);function Cf(t,e,n,r,i){void 0===t&&(t=Rr.EMPTY);var o=this,r=new gl(e,n,r);r.getBuffer("aVertexPosition").static=!1;t=new yl(t);return(o=Rf.call(this,r,t,null,i)||this).autoUpdate=!0,o}var If,Mf=(mf(jf,If=Pf),jf.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(jf.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),jf.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},jf.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},jf.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,t=this._topHeight+this._bottomHeight,t=this._height>t?1:this._height/t;return Math.min(e,t)},Object.defineProperty(jf.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),jf.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var n=1/this._origWidth,t=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=n*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-n*this._rightWidth,e[9]=e[11]=e[13]=e[15]=t*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-t*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},jf);function jf(t,e,n,r,i){void 0===e&&(e=10),void 0===n&&(n=10),void 0===r&&(r=10),void 0===i&&(i=10);var o=If.call(this,Rr.WHITE,4,4)||this;return o._origWidth=t.orig.width,o._origHeight=t.orig.height,o._width=o._origWidth,o._height=o._origHeight,o._leftWidth=e,o._rightWidth=r,o._topHeight=n,o._bottomHeight=i,o.texture=t,o}var Df=function(t,e){return(Df=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Lf,Nf,Ff,Bf=(Df(Nf=Gf,Ff=Lf=tc),Nf.prototype=null===Ff?Object.create(Ff):(Uf.prototype=Ff.prototype,new Uf),Gf.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(an.shared.remove(this.update,this),this._isConnectedToTicker=!1))},Gf.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(an.shared.add(this.update,this,tn.HIGH),this._isConnectedToTicker=!0))},Gf.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},Gf.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},Gf.prototype.update=function(t){if(this._playing){var e=this.animationSpeed*t,n=this.currentFrame;if(null!==this._durations){var r=this._currentTime%1*this._durations[this.currentFrame];for(r+=e/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];var i=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*i,this._currentTime+=i;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(0<this.animationSpeed&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this.updateTexture())}},Gf.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},Gf.prototype.destroy=function(t){this.stop(),Lf.prototype.destroy.call(this,t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},Gf.fromFrames=function(t){for(var e=[],n=0;n<t.length;++n)e.push(Rr.from(t[n]));return new Gf(e)},Gf.fromImages=function(t){for(var e=[],n=0;n<t.length;++n)e.push(Rr.from(t[n]));return new Gf(e)},Object.defineProperty(Gf.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(Gf.prototype,"textures",{get:function(){return this._textures},set:function(t){if(t[0]instanceof Rr)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(Gf.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(Gf.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(Gf.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(an.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(an.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Gf);function Uf(){this.constructor=Nf}function Gf(t,e){void 0===e&&(e=!0);var n=Lf.call(this,t[0]instanceof Rr?t[0]:t[0].texture)||this;return n._textures=null,n._durations=null,n._autoUpdate=e,n._isConnectedToTicker=!1,n.animationSpeed=1,n.loop=!0,n.updateAnchor=!1,n.onComplete=null,n.onFrameChange=null,n.onLoop=null,n._currentTime=0,n._playing=!1,n._previousFrame=null,n.textures=t,n}ta.registerPlugin("accessibility",en),ta.registerPlugin("extract",Ia),ta.registerPlugin("interaction",On),ta.registerPlugin("particle",su),ta.registerPlugin("prepare",Bc),ta.registerPlugin("batch",Oa),ta.registerPlugin("tilingSprite",rl),$a.registerPlugin(Bl),$a.registerPlugin(vs),$a.registerPlugin(Is),$a.registerPlugin(Ks),$a.registerPlugin(Wc),ka.registerPlugin(un),ka.registerPlugin(ts);var Xf="6.1.3",Hf={AlphaFilter:Vl,BlurFilter:vh,BlurFilterPass:dh,ColorMatrixFilter:Th,DisplacementFilter:Ah,FXAAFilter:Nh,NoiseFilter:lf},zf=function(t,e){return(zf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var Vf,Wf,Yf,qf=(zf(Wf=Zf,Yf=Vf=to),Wf.prototype=null===Yf?Object.create(Yf):(Kf.prototype=Yf.prototype,new Kf),Zf.prototype.apply=function(t,e,n,r){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,n,r)},Zf);function Kf(){this.constructor=Wf}function Zf(t){var e=Vf.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform float gamma;\nuniform float contrast;\nuniform float saturation;\nuniform float brightness;\nuniform float red;\nuniform float green;\nuniform float blue;\nuniform float alpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (c.a > 0.0) {\n        c.rgb /= c.a;\n\n        vec3 rgb = pow(c.rgb, vec3(1. / gamma));\n        rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);\n        rgb.r *= red;\n        rgb.g *= green;\n        rgb.b *= blue;\n        c.rgb = rgb * brightness;\n\n        c.rgb *= c.a;\n    }\n\n    gl_FragColor = c * alpha;\n}\n")||this;return e.gamma=1,e.saturation=1,e.contrast=1,e.brightness=1,e.red=1,e.green=1,e.blue=1,e.alpha=1,Object.assign(e,t),e}var Qf=function(t,e){return(Qf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var $f,Jf,tp,ep=(Qf(Jf=rp,tp=$f=to),Jf.prototype=null===tp?Object.create(tp):(np.prototype=tp.prototype,new np),rp.prototype.apply=function(t,e,n,r){var i,o=this._pixelSize.x/e._frame.width,a=this._pixelSize.y/e._frame.height;if(1===this._quality||0===this._blur)i=this._kernels[0]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,t.applyFilter(this,e,n,r);else{for(var s,u=t.getFilterTexture(),c=e,l=u,h=this._quality-1,f=0;f<h;f++)i=this._kernels[f]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,t.applyFilter(this,c,l,1),s=c,c=l,l=s;i=this._kernels[h]+.5,this.uniforms.uOffset[0]=i*o,this.uniforms.uOffset[1]=i*a,t.applyFilter(this,c,n,r),t.returnFilterTexture(u)}},rp.prototype._updatePadding=function(){this.padding=Math.ceil(this._kernels.reduce(function(t,e){return t+e+.5},0))},rp.prototype._generateKernels=function(){var t=this._blur,e=this._quality,n=[t];if(0<t)for(var r=t,i=t/e,o=1;o<e;o++)n.push(r-=i);this._kernels=n,this._updatePadding()},Object.defineProperty(rp.prototype,"kernels",{get:function(){return this._kernels},set:function(t){Array.isArray(t)&&0<t.length?(this._kernels=t,this._quality=t.length,this._blur=Math.max.apply(Math,t)):(this._kernels=[0],this._quality=1)},enumerable:!1,configurable:!0}),Object.defineProperty(rp.prototype,"clamp",{get:function(){return this._clamp},enumerable:!1,configurable:!0}),Object.defineProperty(rp.prototype,"pixelSize",{get:function(){return this._pixelSize},set:function(t){"number"==typeof t?(this._pixelSize.x=t,this._pixelSize.y=t):Array.isArray(t)?(this._pixelSize.x=t[0],this._pixelSize.y=t[1]):t instanceof Te?(this._pixelSize.x=t.x,this._pixelSize.y=t.y):(this._pixelSize.x=1,this._pixelSize.y=1)},enumerable:!1,configurable:!0}),Object.defineProperty(rp.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()},enumerable:!1,configurable:!0}),Object.defineProperty(rp.prototype,"blur",{get:function(){return this._blur},set:function(t){this._blur=t,this._generateKernels()},enumerable:!1,configurable:!0}),rp);function np(){this.constructor=Jf}function rp(t,e,n){void 0===t&&(t=4),void 0===e&&(e=3);var r=$f.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",(n=void 0===n?!1:n)?"\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}\n":"\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}")||this;return r._kernels=[],r._blur=4,r._quality=3,r.uniforms.uOffset=new Float32Array(2),r._pixelSize=new Te,r.pixelSize=1,r._clamp=n,Array.isArray(t)?r.kernels=t:(r._blur=t,r.quality=e),r}var ip=function(t,e){return(ip=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function op(t,e){function n(){this.constructor=t}ip(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var ap,sp="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",up=(op(cp,ap=to),Object.defineProperty(cp.prototype,"threshold",{get:function(){return this.uniforms.threshold},set:function(t){this.uniforms.threshold=t},enumerable:!1,configurable:!0}),cp);function cp(t){void 0===t&&(t=.5);var e=ap.call(this,sp,"\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform float threshold;\n\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    // A simple & fast algorithm for getting brightness.\n    // It's inaccuracy , but good enought for this feature.\n    float _max = max(max(color.r, color.g), color.b);\n    float _min = min(min(color.r, color.g), color.b);\n    float brightness = (_max + _min) * 0.5;\n\n    if(brightness > threshold) {\n        gl_FragColor = color;\n    } else {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n}\n")||this;return e.threshold=t,e}var lp,hp=(op(fp,lp=to),fp.prototype.apply=function(t,e,n,r,i){var o=t.getFilterTexture();this._extractFilter.apply(t,e,o,1,i);i=t.getFilterTexture();this._blurFilter.apply(t,o,i,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=i,t.applyFilter(this,e,n,r),t.returnFilterTexture(i),t.returnFilterTexture(o)},Object.defineProperty(fp.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t,this._extractFilter&&(this._extractFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)},enumerable:!1,configurable:!0}),Object.defineProperty(fp.prototype,"threshold",{get:function(){return this._extractFilter.threshold},set:function(t){this._extractFilter.threshold=t},enumerable:!1,configurable:!0}),Object.defineProperty(fp.prototype,"kernels",{get:function(){return this._blurFilter.kernels},set:function(t){this._blurFilter.kernels=t},enumerable:!1,configurable:!0}),Object.defineProperty(fp.prototype,"blur",{get:function(){return this._blurFilter.blur},set:function(t){this._blurFilter.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(fp.prototype,"quality",{get:function(){return this._blurFilter.quality},set:function(t){this._blurFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(fp.prototype,"pixelSize",{get:function(){return this._blurFilter.pixelSize},set:function(t){this._blurFilter.pixelSize=t},enumerable:!1,configurable:!0}),fp.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:dt.FILTER_RESOLUTION},fp);function fp(t){var e=lp.call(this,sp,"uniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D bloomTexture;\nuniform float bloomScale;\nuniform float brightness;\n\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    color.rgb *= brightness;\n    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);\n    bloomColor.rgb *= bloomScale;\n    gl_FragColor = color + bloomColor;\n}\n")||this;e.bloomScale=1,e.brightness=1,e._resolution=dt.FILTER_RESOLUTION,"number"==typeof t&&(t={threshold:t});var n=Object.assign(fp.defaults,t);e.bloomScale=n.bloomScale,e.brightness=n.brightness;var r=n.kernels,i=n.blur,o=n.quality,a=n.pixelSize,t=n.resolution;return e._extractFilter=new up(n.threshold),e._extractFilter.resolution=t,e._blurFilter=r?new ep(r):new ep(i,o),e.pixelSize=a,e.resolution=t,e}var pp=function(t,e){return(pp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var dp,yp,mp,vp=(pp(yp=bp,mp=dp=to),yp.prototype=null===mp?Object.create(mp):(gp.prototype=mp.prototype,new gp),Object.defineProperty(bp.prototype,"size",{get:function(){return this.uniforms.pixelSize},set:function(t){this.uniforms.pixelSize=t},enumerable:!1,configurable:!0}),bp);function gp(){this.constructor=yp}function bp(t){void 0===t&&(t=8);var e=dp.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform vec4 filterArea;\nuniform float pixelSize;\nuniform sampler2D uSampler;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvec2 pixelate(vec2 coord, vec2 size)\n{\n    return floor( coord / size ) * size;\n}\n\nvec2 getMod(vec2 coord, vec2 size)\n{\n    return mod( coord , size) / size;\n}\n\nfloat character(float n, vec2 p)\n{\n    p = floor(p*vec2(4.0, -4.0) + 2.5);\n\n    if (clamp(p.x, 0.0, 4.0) == p.x)\n    {\n        if (clamp(p.y, 0.0, 4.0) == p.y)\n        {\n            if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;\n        }\n    }\n    return 0.0;\n}\n\nvoid main()\n{\n    vec2 coord = mapCoord(vTextureCoord);\n\n    // get the rounded color..\n    vec2 pixCoord = pixelate(coord, vec2(pixelSize));\n    pixCoord = unmapCoord(pixCoord);\n\n    vec4 color = texture2D(uSampler, pixCoord);\n\n    // determine the character to use\n    float gray = (color.r + color.g + color.b) / 3.0;\n\n    float n =  65536.0;             // .\n    if (gray > 0.2) n = 65600.0;    // :\n    if (gray > 0.3) n = 332772.0;   // *\n    if (gray > 0.4) n = 15255086.0; // o\n    if (gray > 0.5) n = 23385164.0; // &\n    if (gray > 0.6) n = 15252014.0; // 8\n    if (gray > 0.7) n = 13199452.0; // @\n    if (gray > 0.8) n = 11512810.0; // #\n\n    // get the mod..\n    vec2 modd = getMod(coord, vec2(pixelSize));\n\n    gl_FragColor = color * character( n, vec2(-1.0) + modd * 2.0);\n\n}\n")||this;return e.size=t,e}var _p=function(t,e){return(_p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var xp,wp,Tp,Op=(_p(wp=Ep,Tp=xp=to),wp.prototype=null===Tp?Object.create(Tp):(Sp.prototype=Tp.prototype,new Sp),Ep.prototype._updateTransform=function(){this.uniforms.transformX=this._thickness*Math.cos(this._angle),this.uniforms.transformY=this._thickness*Math.sin(this._angle)},Object.defineProperty(Ep.prototype,"rotation",{get:function(){return this._angle/fe},set:function(t){this._angle=t*fe,this._updateTransform()},enumerable:!1,configurable:!0}),Object.defineProperty(Ep.prototype,"thickness",{get:function(){return this._thickness},set:function(t){this._thickness=t,this._updateTransform()},enumerable:!1,configurable:!0}),Object.defineProperty(Ep.prototype,"lightColor",{get:function(){return Ct(this.uniforms.lightColor)},set:function(t){kt(t,this.uniforms.lightColor)},enumerable:!1,configurable:!0}),Object.defineProperty(Ep.prototype,"lightAlpha",{get:function(){return this.uniforms.lightAlpha},set:function(t){this.uniforms.lightAlpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(Ep.prototype,"shadowColor",{get:function(){return Ct(this.uniforms.shadowColor)},set:function(t){kt(t,this.uniforms.shadowColor)},enumerable:!1,configurable:!0}),Object.defineProperty(Ep.prototype,"shadowAlpha",{get:function(){return this.uniforms.shadowAlpha},set:function(t){this.uniforms.shadowAlpha=t},enumerable:!1,configurable:!0}),Ep);function Sp(){this.constructor=wp}function Ep(t){var e=xp.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform float transformX;\nuniform float transformY;\nuniform vec3 lightColor;\nuniform float lightAlpha;\nuniform vec3 shadowColor;\nuniform float shadowAlpha;\n\nvoid main(void) {\n    vec2 transform = vec2(1.0 / filterArea) * vec2(transformX, transformY);\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float light = texture2D(uSampler, vTextureCoord - transform).a;\n    float shadow = texture2D(uSampler, vTextureCoord + transform).a;\n\n    color.rgb = mix(color.rgb, lightColor, clamp((color.a - light) * lightAlpha, 0.0, 1.0));\n    color.rgb = mix(color.rgb, shadowColor, clamp((color.a - shadow) * shadowAlpha, 0.0, 1.0));\n    gl_FragColor = vec4(color.rgb * color.a, color.a);\n}\n")||this;return e._thickness=2,e._angle=0,e.uniforms.lightColor=new Float32Array(3),e.uniforms.shadowColor=new Float32Array(3),Object.assign(e,{rotation:45,thickness:2,lightColor:16777215,lightAlpha:.7,shadowColor:0,shadowAlpha:.7},t),e.padding=1,e}var Pp=function(t,e){return(Pp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var kp,Rp,Ap,Cp=(Pp(Rp=Mp,Ap=kp=to),Rp.prototype=null===Ap?Object.create(Ap):(Ip.prototype=Ap.prototype,new Ip),Mp.prototype.apply=function(t,e,n,r){var i=t.getFilterTexture();this.defaultFilter.apply(t,e,n,r),this.blurXFilter.apply(t,e,i,1),this.blurYFilter.apply(t,i,n,0),t.returnFilterTexture(i)},Object.defineProperty(Mp.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(Mp.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(Mp.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t},enumerable:!1,configurable:!0}),Mp);function Ip(){this.constructor=Rp}function Mp(t,e,n,r){void 0===t&&(t=2),void 0===e&&(e=4),void 0===n&&(n=dt.FILTER_RESOLUTION),void 0===r&&(r=5);var i,o,a=kp.call(this)||this;return"number"==typeof t?o=i=t:t instanceof Te?(i=t.x,o=t.y):Array.isArray(t)&&(i=t[0],o=t[1]),a.blurXFilter=new dh(!0,i,e,n,r),a.blurYFilter=new dh(!1,o,e,n,r),a.blurYFilter.blendMode=$.SCREEN,a.defaultFilter=new Vl,a}var jp=function(t,e){return(jp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var Dp,Lp,Np,Fp=(jp(Lp=Up,Np=Dp=to),Lp.prototype=null===Np?Object.create(Np):(Bp.prototype=Np.prototype,new Bp),Up.prototype.apply=function(t,e,n,r){var i=e.filterFrame,o=i.width,i=i.height;this.uniforms.dimensions[0]=o,this.uniforms.dimensions[1]=i,t.applyFilter(this,e,n,r)},Object.defineProperty(Up.prototype,"radius",{get:function(){return this.uniforms.radius},set:function(t){this.uniforms.radius=t},enumerable:!1,configurable:!0}),Object.defineProperty(Up.prototype,"strength",{get:function(){return this.uniforms.strength},set:function(t){this.uniforms.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(Up.prototype,"center",{get:function(){return this.uniforms.center},set:function(t){this.uniforms.center=t},enumerable:!1,configurable:!0}),Up.defaults={center:[.5,.5],radius:100,strength:1},Up);function Bp(){this.constructor=Lp}function Up(t){var e=Dp.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","uniform float radius;\nuniform float strength;\nuniform vec2 center;\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\n\nvoid main()\n{\n    vec2 coord = vTextureCoord * filterArea.xy;\n    coord -= center * dimensions.xy;\n    float distance = length(coord);\n    if (distance < radius) {\n        float percent = distance / radius;\n        if (strength > 0.0) {\n            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\n        } else {\n            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\n        }\n    }\n    coord += center * dimensions.xy;\n    coord /= filterArea.xy;\n    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    vec4 color = texture2D(uSampler, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    gl_FragColor = color;\n}\n")||this;return e.uniforms.dimensions=new Float32Array(2),Object.assign(e,Up.defaults,t),e}var Gp=function(t,e){return(Gp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var Xp,Hp,zp,Vp=(Gp(Hp=Yp,zp=Xp=to),Hp.prototype=null===zp?Object.create(zp):(Wp.prototype=zp.prototype,new Wp),Yp.prototype.apply=function(t,e,n,r){this.uniforms._mix=this.mix,t.applyFilter(this,e,n,r)},Object.defineProperty(Yp.prototype,"colorSize",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"colorMap",{get:function(){return this._colorMap},set:function(t){t&&(null!==(t=!(t instanceof Rr)?Rr.from(t):t)&&void 0!==t&&t.baseTexture&&(t.baseTexture.scaleMode=this._scaleMode,t.baseTexture.mipmap=at.OFF,this._size=t.height,this._sliceSize=1/this._size,this._slicePixelSize=this._sliceSize/this._size,this._sliceInnerSize=this._slicePixelSize*(this._size-1),this.uniforms._size=this._size,this.uniforms._sliceSize=this._sliceSize,this.uniforms._slicePixelSize=this._slicePixelSize,this.uniforms._sliceInnerSize=this._sliceInnerSize,this.uniforms.colorMap=t),this._colorMap=t)},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"nearest",{get:function(){return this._nearest},set:function(t){this._nearest=t,this._scaleMode=t?it.NEAREST:it.LINEAR;t=this._colorMap;t&&t.baseTexture&&(t.baseTexture._glTextures={},t.baseTexture.scaleMode=this._scaleMode,t.baseTexture.mipmap=at.OFF,t._updateID++,t.baseTexture.emit("update",t.baseTexture))},enumerable:!1,configurable:!0}),Yp.prototype.updateColorMap=function(){var t=this._colorMap;t&&t.baseTexture&&(t._updateID++,t.baseTexture.emit("update",t.baseTexture),this.colorMap=t)},Yp.prototype.destroy=function(t){void 0===t&&(t=!1),this._colorMap&&this._colorMap.destroy(t),Xp.prototype.destroy.call(this)},Yp);function Wp(){this.constructor=Hp}function Yp(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=1);var r=Xp.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D colorMap;\nuniform float _mix;\nuniform float _size;\nuniform float _sliceSize;\nuniform float _slicePixelSize;\nuniform float _sliceInnerSize;\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord.xy);\n\n    vec4 adjusted;\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n        float innerWidth = _size - 1.0;\n        float zSlice0 = min(floor(color.b * innerWidth), innerWidth);\n        float zSlice1 = min(zSlice0 + 1.0, innerWidth);\n        float xOffset = _slicePixelSize * 0.5 + color.r * _sliceInnerSize;\n        float s0 = xOffset + (zSlice0 * _sliceSize);\n        float s1 = xOffset + (zSlice1 * _sliceSize);\n        float yOffset = _sliceSize * 0.5 + color.g * (1.0 - _sliceSize);\n        vec4 slice0Color = texture2D(colorMap, vec2(s0,yOffset));\n        vec4 slice1Color = texture2D(colorMap, vec2(s1,yOffset));\n        float zOffset = fract(color.b * innerWidth);\n        adjusted = mix(slice0Color, slice1Color, zOffset);\n\n        color.rgb *= color.a;\n    }\n    gl_FragColor = vec4(mix(color, adjusted, _mix).rgb, color.a);\n\n}")||this;return r.mix=1,r._size=0,r._sliceSize=0,r._slicePixelSize=0,r._sliceInnerSize=0,r._nearest=!1,r._scaleMode=null,r._colorMap=null,r._scaleMode=null,r.nearest=e,r.mix=n,r.colorMap=t,r}var qp=function(t,e){return(qp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var Kp,Zp,Qp,$p=(qp(Zp=td,Qp=Kp=to),Zp.prototype=null===Qp?Object.create(Qp):(Jp.prototype=Qp.prototype,new Jp),Object.defineProperty(td.prototype,"color",{get:function(){return this._color},set:function(t){var e=this.uniforms.color;"number"==typeof t?(kt(t,e),this._color=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],this._color=Ct(e))},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this.uniforms.alpha=t,this._alpha=t},enumerable:!1,configurable:!0}),td);function Jp(){this.constructor=Zp}function td(t,e){void 0===t&&(t=0),void 0===e&&(e=1);var n=Kp.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec3 color;\nuniform float alpha;\n\nvoid main(void) {\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = vec4(mix(currentColor.rgb, color.rgb, currentColor.a * alpha), currentColor.a);\n}\n")||this;return n._color=0,n._alpha=1,n.uniforms.color=new Float32Array(3),n.color=t,n.alpha=e,n}var ed=function(t,e){return(ed=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var nd,rd,id,od=(ed(rd=sd,id=nd=to),rd.prototype=null===id?Object.create(id):(ad.prototype=id.prototype,new ad),Object.defineProperty(sd.prototype,"originalColor",{get:function(){return this._originalColor},set:function(t){var e=this.uniforms.originalColor;"number"==typeof t?(kt(t,e),this._originalColor=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],this._originalColor=Ct(e))},enumerable:!1,configurable:!0}),Object.defineProperty(sd.prototype,"newColor",{get:function(){return this._newColor},set:function(t){var e=this.uniforms.newColor;"number"==typeof t?(kt(t,e),this._newColor=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],this._newColor=Ct(e))},enumerable:!1,configurable:!0}),Object.defineProperty(sd.prototype,"epsilon",{get:function(){return this.uniforms.epsilon},set:function(t){this.uniforms.epsilon=t},enumerable:!1,configurable:!0}),sd);function ad(){this.constructor=rd}function sd(t,e,n){void 0===t&&(t=16711680),void 0===e&&(e=0),void 0===n&&(n=.4);var r=nd.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec3 originalColor;\nuniform vec3 newColor;\nuniform float epsilon;\nvoid main(void) {\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n    vec3 colorDiff = originalColor - (currentColor.rgb / max(currentColor.a, 0.0000000001));\n    float colorDistance = length(colorDiff);\n    float doReplace = step(colorDistance, epsilon);\n    gl_FragColor = vec4(mix(currentColor.rgb, (newColor + colorDiff) * currentColor.a, doReplace), currentColor.a);\n}\n")||this;return r._originalColor=16711680,r._newColor=0,r.uniforms.originalColor=new Float32Array(3),r.uniforms.newColor=new Float32Array(3),r.originalColor=t,r.newColor=e,r.epsilon=n,r}var ud=function(t,e){return(ud=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var cd,ld,hd,fd=(ud(ld=dd,hd=cd=to),ld.prototype=null===hd?Object.create(hd):(pd.prototype=hd.prototype,new pd),Object.defineProperty(dd.prototype,"matrix",{get:function(){return this.uniforms.matrix},set:function(t){var n=this;t.forEach(function(t,e){n.uniforms.matrix[e]=t})},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"width",{get:function(){return 1/this.uniforms.texelSize[0]},set:function(t){this.uniforms.texelSize[0]=1/t},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"height",{get:function(){return 1/this.uniforms.texelSize[1]},set:function(t){this.uniforms.texelSize[1]=1/t},enumerable:!1,configurable:!0}),dd);function pd(){this.constructor=ld}function dd(t,e,n){void 0===e&&(e=200),void 0===n&&(n=200);var r=cd.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision mediump float;\n\nvarying mediump vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 texelSize;\nuniform float matrix[9];\n\nvoid main(void)\n{\n   vec4 c11 = texture2D(uSampler, vTextureCoord - texelSize); // top left\n   vec4 c12 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - texelSize.y)); // top center\n   vec4 c13 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y - texelSize.y)); // top right\n\n   vec4 c21 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y)); // mid left\n   vec4 c22 = texture2D(uSampler, vTextureCoord); // mid center\n   vec4 c23 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y)); // mid right\n\n   vec4 c31 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y + texelSize.y)); // bottom left\n   vec4 c32 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + texelSize.y)); // bottom center\n   vec4 c33 = texture2D(uSampler, vTextureCoord + texelSize); // bottom right\n\n   gl_FragColor =\n       c11 * matrix[0] + c12 * matrix[1] + c13 * matrix[2] +\n       c21 * matrix[3] + c22 * matrix[4] + c23 * matrix[5] +\n       c31 * matrix[6] + c32 * matrix[7] + c33 * matrix[8];\n\n   gl_FragColor.a = c22.a;\n}\n")||this;return r.uniforms.texelSize=new Float32Array(2),r.uniforms.matrix=new Float32Array(9),void 0!==t&&(r.matrix=t),r.width=e,r.height=n,r}var yd=function(t,e){return(yd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var md,vd,gd,bd=(yd(vd=xd,gd=md=to),vd.prototype=null===gd?Object.create(gd):(_d.prototype=gd.prototype,new _d),xd);function _d(){this.constructor=vd}function xd(){return md.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);\n\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\n    if (lum < 1.00)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.75)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.50)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.3)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n}\n")||this}var wd=function(t,e){return(wd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var Td,Od,Sd,Ed=(wd(Od=kd,Sd=Td=to),Od.prototype=null===Sd?Object.create(Sd):(Pd.prototype=Sd.prototype,new Pd),kd.prototype.apply=function(t,e,n,r){var i=e.filterFrame,o=i.width,i=i.height;this.uniforms.dimensions[0]=o,this.uniforms.dimensions[1]=i,this.uniforms.seed=this.seed,this.uniforms.time=this.time,t.applyFilter(this,e,n,r)},Object.defineProperty(kd.prototype,"curvature",{get:function(){return this.uniforms.curvature},set:function(t){this.uniforms.curvature=t},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"lineWidth",{get:function(){return this.uniforms.lineWidth},set:function(t){this.uniforms.lineWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"lineContrast",{get:function(){return this.uniforms.lineContrast},set:function(t){this.uniforms.lineContrast=t},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"verticalLine",{get:function(){return this.uniforms.verticalLine},set:function(t){this.uniforms.verticalLine=t},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"noise",{get:function(){return this.uniforms.noise},set:function(t){this.uniforms.noise=t},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"noiseSize",{get:function(){return this.uniforms.noiseSize},set:function(t){this.uniforms.noiseSize=t},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"vignetting",{get:function(){return this.uniforms.vignetting},set:function(t){this.uniforms.vignetting=t},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"vignettingAlpha",{get:function(){return this.uniforms.vignettingAlpha},set:function(t){this.uniforms.vignettingAlpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"vignettingBlur",{get:function(){return this.uniforms.vignettingBlur},set:function(t){this.uniforms.vignettingBlur=t},enumerable:!1,configurable:!0}),kd.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0},kd);function Pd(){this.constructor=Od}function kd(t){var e=Td.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nconst float SQRT_2 = 1.414213;\n\nconst float light = 1.0;\n\nuniform float curvature;\nuniform float lineWidth;\nuniform float lineContrast;\nuniform bool verticalLine;\nuniform float noise;\nuniform float noiseSize;\n\nuniform float vignetting;\nuniform float vignettingAlpha;\nuniform float vignettingBlur;\n\nuniform float seed;\nuniform float time;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n    vec2 dir = vec2(vTextureCoord.xy - vec2(0.5, 0.5)) * filterArea.xy / dimensions;\n\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n    vec3 rgb = gl_FragColor.rgb;\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;\n        rgb += _noise * noise;\n    }\n\n    if (lineWidth > 0.0)\n    {\n        float _c = curvature > 0. ? curvature : 1.;\n        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;\n        vec2 uv = dir * k;\n\n        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;\n        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;\n        rgb *= j;\n        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);\n        rgb *= 0.99 + ceil(segment) * 0.015;\n    }\n\n    if (vignetting > 0.0)\n    {\n        float outter = SQRT_2 - vignetting * SQRT_2;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);\n        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);\n    }\n\n    gl_FragColor.rgb = rgb;\n}\n")||this;return e.time=0,e.seed=0,e.uniforms.dimensions=new Float32Array(2),Object.assign(e,kd.defaults,t),e}var Rd=function(t,e){return(Rd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var Ad,Cd,Id,Md=(Rd(Cd=Dd,Id=Ad=to),Cd.prototype=null===Id?Object.create(Id):(jd.prototype=Id.prototype,new jd),Object.defineProperty(Dd.prototype,"scale",{get:function(){return this.uniforms.scale},set:function(t){this.uniforms.scale=t},enumerable:!1,configurable:!0}),Object.defineProperty(Dd.prototype,"angle",{get:function(){return this.uniforms.angle},set:function(t){this.uniforms.angle=t},enumerable:!1,configurable:!0}),Dd);function jd(){this.constructor=Cd}function Dd(t,e){void 0===t&&(t=1),void 0===e&&(e=5);var n=Ad.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec4 filterArea;\nuniform sampler2D uSampler;\n\nuniform float angle;\nuniform float scale;\n\nfloat pattern()\n{\n   float s = sin(angle), c = cos(angle);\n   vec2 tex = vTextureCoord * filterArea.xy;\n   vec2 point = vec2(\n       c * tex.x - s * tex.y,\n       s * tex.x + c * tex.y\n   ) * scale;\n   return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvoid main()\n{\n   vec4 color = texture2D(uSampler, vTextureCoord);\n   float average = (color.r + color.g + color.b) / 3.0;\n   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\n}\n")||this;return n.scale=t,n.angle=e,n}var Ld=function(t,e){return(Ld=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var Nd,Fd,Bd,Ud=function(){return(Ud=Object.assign||function(t){for(var e,n=arguments,r=1,i=arguments.length;r<i;r++)for(var o in e=n[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Gd=(Ld(Fd=Hd,Bd=Nd=to),Fd.prototype=null===Bd?Object.create(Bd):(Xd.prototype=Bd.prototype,new Xd),Hd.prototype.apply=function(t,e,n,r){var i=t.getFilterTexture();this._tintFilter.apply(t,e,i,1),this._blurFilter.apply(t,i,n,r),!0!==this.shadowOnly&&t.applyFilter(this,e,n,0),t.returnFilterTexture(i)},Hd.prototype._updatePadding=function(){this.padding=this.distance+2*this.blur},Hd.prototype._updateShift=function(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))},Object.defineProperty(Hd.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t,this._tintFilter&&(this._tintFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)},enumerable:!1,configurable:!0}),Object.defineProperty(Hd.prototype,"distance",{get:function(){return this._distance},set:function(t){this._distance=t,this._updatePadding(),this._updateShift()},enumerable:!1,configurable:!0}),Object.defineProperty(Hd.prototype,"rotation",{get:function(){return this.angle/fe},set:function(t){this.angle=t*fe,this._updateShift()},enumerable:!1,configurable:!0}),Object.defineProperty(Hd.prototype,"alpha",{get:function(){return this._tintFilter.uniforms.alpha},set:function(t){this._tintFilter.uniforms.alpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(Hd.prototype,"color",{get:function(){return Ct(this._tintFilter.uniforms.color)},set:function(t){kt(t,this._tintFilter.uniforms.color)},enumerable:!1,configurable:!0}),Object.defineProperty(Hd.prototype,"kernels",{get:function(){return this._blurFilter.kernels},set:function(t){this._blurFilter.kernels=t},enumerable:!1,configurable:!0}),Object.defineProperty(Hd.prototype,"blur",{get:function(){return this._blurFilter.blur},set:function(t){this._blurFilter.blur=t,this._updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(Hd.prototype,"quality",{get:function(){return this._blurFilter.quality},set:function(t){this._blurFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(Hd.prototype,"pixelSize",{get:function(){return this._blurFilter.pixelSize},set:function(t){this._blurFilter.pixelSize=t},enumerable:!1,configurable:!0}),Hd.defaults={rotation:45,distance:5,color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:dt.FILTER_RESOLUTION},Hd);function Xd(){this.constructor=Fd}function Hd(t){var e=Nd.call(this)||this;e.angle=45,e._distance=5,e._resolution=dt.FILTER_RESOLUTION;var n=t?Ud(Ud({},Hd.defaults),t):Hd.defaults,r=n.kernels,i=n.blur,o=n.quality,a=n.pixelSize,t=n.resolution;e._tintFilter=new to("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform vec3 color;\n\nuniform vec2 shift;\nuniform vec4 inputSize;\n\nvoid main(void){\n    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);\n\n    // Premultiply alpha\n    sample.rgb = color.rgb * sample.a;\n\n    // alpha user alpha\n    sample *= alpha;\n\n    gl_FragColor = sample;\n}"),e._tintFilter.uniforms.color=new Float32Array(4),e._tintFilter.uniforms.shift=new Te,e._tintFilter.resolution=t,e._blurFilter=r?new ep(r):new ep(i,o),e.pixelSize=a,e.resolution=t;i=n.shadowOnly,o=n.rotation,a=n.distance,t=n.alpha,n=n.color;return e.shadowOnly=i,e.rotation=o,e.distance=a,e.alpha=t,e.color=n,e._updatePadding(),e}var zd=function(t,e){return(zd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var Vd,Wd,Yd,qd=(zd(Wd=Zd,Yd=Vd=to),Wd.prototype=null===Yd?Object.create(Yd):(Kd.prototype=Yd.prototype,new Kd),Object.defineProperty(Zd.prototype,"strength",{get:function(){return this.uniforms.strength},set:function(t){this.uniforms.strength=t},enumerable:!1,configurable:!0}),Zd);function Kd(){this.constructor=Wd}function Zd(t){void 0===t&&(t=5);var e=Vd.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float strength;\nuniform vec4 filterArea;\n\n\nvoid main(void)\n{\n\tvec2 onePixel = vec2(1.0 / filterArea);\n\n\tvec4 color;\n\n\tcolor.rgb = vec3(0.5);\n\n\tcolor -= texture2D(uSampler, vTextureCoord - onePixel) * strength;\n\tcolor += texture2D(uSampler, vTextureCoord + onePixel) * strength;\n\n\tcolor.rgb = vec3((color.r + color.g + color.b) / 3.0);\n\n\tfloat alpha = texture2D(uSampler, vTextureCoord).a;\n\n\tgl_FragColor = vec4(color.rgb * alpha, alpha);\n}\n")||this;return e.strength=t,e}var Qd=function(t,e){return(Qd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var $d,Jd,ty,ey=(Qd(Jd=ry,ty=$d=to),Jd.prototype=null===ty?Object.create(ty):(ny.prototype=ty.prototype,new ny),ry.prototype.apply=function(t,e,n,r){var i=e.filterFrame,o=i.width,i=i.height;this.uniforms.dimensions[0]=o,this.uniforms.dimensions[1]=i,this.uniforms.aspect=i/o,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,t.applyFilter(this,e,n,r)},ry.prototype._randomizeSizes=function(){var t=this._sizes,e=this._slices-1,n=this.sampleSize,r=Math.min(this.minSize/n,.9/this._slices);if(this.average){for(var i=this._slices,o=1,a=0;a<e;a++){var s=Math.max(o/(i-a)*(1-.6*Math.random()),r);o-=t[a]=s}t[e]=o}else{for(var o=1,u=Math.sqrt(1/this._slices),a=0;a<e;a++){s=Math.max(u*o*Math.random(),r);o-=t[a]=s}t[e]=o}this.shuffle()},ry.prototype.shuffle=function(){for(var t=this._sizes,e=this._slices-1;0<e;e--){var n=Math.random()*e>>0,r=t[e];t[e]=t[n],t[n]=r}},ry.prototype._randomizeOffsets=function(){for(var t=0;t<this._slices;t++)this._offsets[t]=Math.random()*(Math.random()<.5?-1:1)},ry.prototype.refresh=function(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()},ry.prototype.redraw=function(){var t=this.sampleSize,e=this.texture,n=this._canvas.getContext("2d");n.clearRect(0,0,8,t);for(var r=0,i=0;i<this._slices;i++){var o=Math.floor(256*this._offsets[i]),a=this._sizes[i]*t;n.fillStyle="rgba("+(0<o?o:0)+", "+(o<0?-o:0)+", 0, 1)",n.fillRect(0,r>>0,t,1+a>>0),r+=a}e.baseTexture.update(),this.uniforms.displacementMap=e},Object.defineProperty(ry.prototype,"sizes",{get:function(){return this._sizes},set:function(t){for(var e=Math.min(this._slices,t.length),n=0;n<e;n++)this._sizes[n]=t[n]},enumerable:!1,configurable:!0}),Object.defineProperty(ry.prototype,"offsets",{get:function(){return this._offsets},set:function(t){for(var e=Math.min(this._slices,t.length),n=0;n<e;n++)this._offsets[n]=t[n]},enumerable:!1,configurable:!0}),Object.defineProperty(ry.prototype,"slices",{get:function(){return this._slices},set:function(t){this._slices!==t&&(this._slices=t,this.uniforms.slices=t,this._sizes=this.uniforms.slicesWidth=new Float32Array(t),this._offsets=this.uniforms.slicesOffset=new Float32Array(t),this.refresh())},enumerable:!1,configurable:!0}),Object.defineProperty(ry.prototype,"direction",{get:function(){return this._direction},set:function(t){this._direction!==t&&(t=(this._direction=t)*fe,this.uniforms.sinDir=Math.sin(t),this.uniforms.cosDir=Math.cos(t))},enumerable:!1,configurable:!0}),Object.defineProperty(ry.prototype,"red",{get:function(){return this.uniforms.red},set:function(t){this.uniforms.red=t},enumerable:!1,configurable:!0}),Object.defineProperty(ry.prototype,"green",{get:function(){return this.uniforms.green},set:function(t){this.uniforms.green=t},enumerable:!1,configurable:!0}),Object.defineProperty(ry.prototype,"blue",{get:function(){return this.uniforms.blue},set:function(t){this.uniforms.blue=t},enumerable:!1,configurable:!0}),ry.prototype.destroy=function(){var t;null!==(t=this.texture)&&void 0!==t&&t.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null},ry.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},ry.TRANSPARENT=0,ry.ORIGINAL=1,ry.LOOP=2,ry.CLAMP=3,ry.MIRROR=4,ry);function ny(){this.constructor=Jd}function ry(t){var e=$d.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","// precision highp float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\nuniform float aspect;\n\nuniform sampler2D displacementMap;\nuniform float offset;\nuniform float sinDir;\nuniform float cosDir;\nuniform int fillMode;\n\nuniform float seed;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nconst int TRANSPARENT = 0;\nconst int ORIGINAL = 1;\nconst int LOOP = 2;\nconst int CLAMP = 3;\nconst int MIRROR = 4;\n\nvoid main(void)\n{\n    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;\n\n    if (coord.x > 1.0 || coord.y > 1.0) {\n        return;\n    }\n\n    float cx = coord.x - 0.5;\n    float cy = (coord.y - 0.5) * aspect;\n    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;\n\n    // displacementMap: repeat\n    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);\n\n    // displacementMap: mirror\n    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);\n\n    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));\n\n    float displacement = (dc.r - dc.g) * (offset / filterArea.x);\n\n    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);\n\n    if (fillMode == CLAMP) {\n        coord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    } else {\n        if( coord.x > filterClamp.z ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x -= filterClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x = filterClamp.z * 2.0 - coord.x;\n            }\n        } else if( coord.x < filterClamp.x ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x += filterClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x *= -filterClamp.z;\n            }\n        }\n\n        if( coord.y > filterClamp.w ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y -= filterClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y = filterClamp.w * 2.0 - coord.y;\n            }\n        } else if( coord.y < filterClamp.y ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y += filterClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y *= -filterClamp.w;\n            }\n        }\n    }\n\n    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;\n    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;\n    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;\n    gl_FragColor.a = texture2D(uSampler, coord).a;\n}\n")||this;return e.offset=100,e.fillMode=ry.TRANSPARENT,e.average=!1,e.seed=0,e.minSize=8,e.sampleSize=512,e._slices=0,e._offsets=new Float32Array(1),e._sizes=new Float32Array(1),e._direction=-1,e.uniforms.dimensions=new Float32Array(2),e._canvas=document.createElement("canvas"),e._canvas.width=4,e._canvas.height=e.sampleSize,e.texture=Rr.from(e._canvas,{scaleMode:it.NEAREST}),Object.assign(e,ry.defaults,t),e}var iy=function(t,e){return(iy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var oy,ay,sy,uy=(iy(ay=ly,sy=oy=to),ay.prototype=null===sy?Object.create(sy):(cy.prototype=sy.prototype,new cy),Object.defineProperty(ly.prototype,"color",{get:function(){return Ct(this.uniforms.glowColor)},set:function(t){kt(t,this.uniforms.glowColor)},enumerable:!1,configurable:!0}),Object.defineProperty(ly.prototype,"outerStrength",{get:function(){return this.uniforms.outerStrength},set:function(t){this.uniforms.outerStrength=t},enumerable:!1,configurable:!0}),Object.defineProperty(ly.prototype,"innerStrength",{get:function(){return this.uniforms.innerStrength},set:function(t){this.uniforms.innerStrength=t},enumerable:!1,configurable:!0}),Object.defineProperty(ly.prototype,"knockout",{get:function(){return this.uniforms.knockout},set:function(t){this.uniforms.knockout=t},enumerable:!1,configurable:!0}),ly.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1},ly);function cy(){this.constructor=ay}function ly(t){var e=this,n=Object.assign({},ly.defaults,t),r=n.outerStrength,i=n.innerStrength,o=n.color,a=n.knockout,t=n.quality,n=Math.round(n.distance);return(e=oy.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nuniform float outerStrength;\nuniform float innerStrength;\n\nuniform vec4 glowColor;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform bool knockout;\n\nconst float PI = 3.14159265358979323846264;\n\nconst float DIST = __DIST__;\nconst float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);\nconst float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);\n\nconst float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;\n\nvoid main(void) {\n    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);\n\n    float totalAlpha = 0.0;\n\n    vec2 direction;\n    vec2 displaced;\n    vec4 curColor;\n\n    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {\n       direction = vec2(cos(angle), sin(angle)) * px;\n\n       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {\n           displaced = clamp(vTextureCoord + direction * \n                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);\n\n           curColor = texture2D(uSampler, displaced);\n\n           totalAlpha += (DIST - curDistance) * curColor.a;\n       }\n    }\n    \n    curColor = texture2D(uSampler, vTextureCoord);\n\n    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);\n\n    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;\n    float innerGlowStrength = min(1.0, innerGlowAlpha);\n    \n    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);\n\n    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);\n    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);\n\n    vec4 outerGlowColor = outerGlowStrength * glowColor.rgba;\n    \n    if (knockout) {\n      float resultAlpha = outerGlowAlpha + innerGlowAlpha;\n      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);\n    }\n    else {\n      gl_FragColor = innerColor + outerGlowColor;\n    }\n}\n".replace(/__ANGLE_STEP_SIZE__/gi,""+(1/t/n).toFixed(7)).replace(/__DIST__/gi,n.toFixed(0)+".0"))||this).uniforms.glowColor=new Float32Array([0,0,0,1]),Object.assign(e,{color:o,outerStrength:r,innerStrength:i,padding:n,knockout:a}),e}var hy=function(t,e){return(hy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var fy,py,dy,yy=(hy(py=vy,dy=fy=to),py.prototype=null===dy?Object.create(dy):(my.prototype=dy.prototype,new my),vy.prototype.apply=function(t,e,n,r){var i=e.filterFrame,o=i.width,i=i.height;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=o,this.uniforms.dimensions[1]=i,this.uniforms.aspect=i/o,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,n,r)},Object.defineProperty(vy.prototype,"angle",{get:function(){return this._angle},set:function(t){t=(this._angle=t)*fe;this._angleLight.x=Math.cos(t),this._angleLight.y=Math.sin(t)},enumerable:!1,configurable:!0}),Object.defineProperty(vy.prototype,"gain",{get:function(){return this.uniforms.gain},set:function(t){this.uniforms.gain=t},enumerable:!1,configurable:!0}),Object.defineProperty(vy.prototype,"lacunarity",{get:function(){return this.uniforms.lacunarity},set:function(t){this.uniforms.lacunarity=t},enumerable:!1,configurable:!0}),Object.defineProperty(vy.prototype,"alpha",{get:function(){return this.uniforms.alpha},set:function(t){this.uniforms.alpha=t},enumerable:!1,configurable:!0}),vy.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1},vy);function my(){this.constructor=py}function vy(t){var e=fy.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nuniform vec2 light;\nuniform bool parallel;\nuniform float aspect;\n\nuniform float gain;\nuniform float lacunarity;\nuniform float time;\nuniform float alpha;\n\n${perlin}\n\nvoid main(void) {\n    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;\n\n    float d;\n\n    if (parallel) {\n        float _cos = light.x;\n        float _sin = light.y;\n        d = (_cos * coord.x) + (_sin * coord.y * aspect);\n    } else {\n        float dx = coord.x - light.x / dimensions.x;\n        float dy = (coord.y - light.y / dimensions.y) * aspect;\n        float dis = sqrt(dx * dx + dy * dy) + 0.00001;\n        d = dy / dis;\n    }\n\n    vec3 dir = vec3(d, d, 0.0);\n\n    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);\n    noise = mix(noise, 0.0, 0.3);\n    //fade vertically.\n    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);\n    mist.a = 1.0;\n    // apply user alpha\n    mist *= alpha;\n\n    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;\n\n}\n".replace("${perlin}","vec3 mod289(vec3 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 mod289(vec4 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 permute(vec4 x)\n{\n    return mod289(((x * 34.0) + 1.0) * x);\n}\nvec4 taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\nvec3 fade(vec3 t)\n{\n    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);\n}\n// Classic Perlin noise, periodic variant\nfloat pnoise(vec3 P, vec3 rep)\n{\n    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period\n    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period\n    Pi0 = mod289(Pi0);\n    Pi1 = mod289(Pi1);\n    vec3 Pf0 = fract(P); // Fractional part for interpolation\n    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n    vec4 iy = vec4(Pi0.yy, Pi1.yy);\n    vec4 iz0 = Pi0.zzzz;\n    vec4 iz1 = Pi1.zzzz;\n    vec4 ixy = permute(permute(ix) + iy);\n    vec4 ixy0 = permute(ixy + iz0);\n    vec4 ixy1 = permute(ixy + iz1);\n    vec4 gx0 = ixy0 * (1.0 / 7.0);\n    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n    gx0 = fract(gx0);\n    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n    vec4 sz0 = step(gz0, vec4(0.0));\n    gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n    gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n    vec4 gx1 = ixy1 * (1.0 / 7.0);\n    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n    gx1 = fract(gx1);\n    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n    vec4 sz1 = step(gz1, vec4(0.0));\n    gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n    gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);\n    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);\n    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);\n    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);\n    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);\n    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);\n    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);\n    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);\n    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n    g000 *= norm0.x;\n    g010 *= norm0.y;\n    g100 *= norm0.z;\n    g110 *= norm0.w;\n    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n    g001 *= norm1.x;\n    g011 *= norm1.y;\n    g101 *= norm1.z;\n    g111 *= norm1.w;\n    float n000 = dot(g000, Pf0);\n    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n    float n111 = dot(g111, Pf1);\n    vec3 fade_xyz = fade(Pf0);\n    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n    return 2.2 * n_xyz;\n}\nfloat turb(vec3 P, vec3 rep, float lacunarity, float gain)\n{\n    float sum = 0.0;\n    float sc = 1.0;\n    float totalgain = 1.0;\n    for (float i = 0.0; i < 6.0; i++)\n    {\n        sum += totalgain * pnoise(P * sc, rep);\n        sc *= lacunarity;\n        totalgain *= gain;\n    }\n    return abs(sum);\n}\n"))||this;e.parallel=!0,e.time=0,e._angle=0,e.uniforms.dimensions=new Float32Array(2);t=Object.assign(vy.defaults,t);return e._angleLight=new Te,e.angle=t.angle,e.gain=t.gain,e.lacunarity=t.lacunarity,e.alpha=t.alpha,e.parallel=t.parallel,e.center=t.center,e.time=t.time,e}var gy=function(t,e){return(gy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var by,_y,xy,wy=(gy(_y=Oy,xy=by=to),_y.prototype=null===xy?Object.create(xy):(Ty.prototype=xy.prototype,new Ty),Oy.prototype.apply=function(t,e,n,r){var i=this.velocity,o=i.x,i=i.y;this.uniforms.uKernelSize=0!==o||0!==i?this.kernelSize:0,t.applyFilter(this,e,n,r)},Object.defineProperty(Oy.prototype,"velocity",{get:function(){return this._velocity},set:function(t){this.setVelocity(t)},enumerable:!1,configurable:!0}),Oy.prototype.setVelocity=function(t){var e,n;Array.isArray(t)?(e=t[0],n=t[1],this._velocity.set(e,n)):this._velocity.copyFrom(t)},Oy.prototype.velocityChanged=function(){this.uniforms.uVelocity[0]=this._velocity.x,this.uniforms.uVelocity[1]=this._velocity.y,this.padding=1+(Math.max(Math.abs(this._velocity.x),Math.abs(this._velocity.y))>>0)},Object.defineProperty(Oy.prototype,"offset",{get:function(){return this.uniforms.uOffset},set:function(t){this.uniforms.uOffset=t},enumerable:!1,configurable:!0}),Oy);function Ty(){this.constructor=_y}function Oy(t,e,n){void 0===t&&(t=[0,0]),void 0===e&&(e=5),void 0===n&&(n=0);var r=by.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform vec2 uVelocity;\nuniform int uKernelSize;\nuniform float uOffset;\n\nconst int MAX_KERNEL_SIZE = 2048;\n\n// Notice:\n// the perfect way:\n//    int kernelSize = min(uKernelSize, MAX_KERNELSIZE);\n// BUT in real use-case , uKernelSize < MAX_KERNELSIZE almost always.\n// So use uKernelSize directly.\n\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    if (uKernelSize == 0)\n    {\n        gl_FragColor = color;\n        return;\n    }\n\n    vec2 velocity = uVelocity / filterArea.xy;\n    float offset = -uOffset / length(uVelocity) - 0.5;\n    int k = uKernelSize - 1;\n\n    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {\n        if (i == k) {\n            break;\n        }\n        vec2 bias = velocity * (float(i) / float(k) + offset);\n        color += texture2D(uSampler, vTextureCoord + bias);\n    }\n    gl_FragColor = color / float(uKernelSize);\n}\n")||this;return r.kernelSize=5,r.uniforms.uVelocity=new Float32Array(2),r._velocity=new Se(r.velocityChanged,r),r.setVelocity(t),r.kernelSize=e,r.offset=n,r}var Sy=function(t,e){return(Sy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var Ey,Py,ky,Ry=(Sy(Py=Cy,ky=Ey=to),Py.prototype=null===ky?Object.create(ky):(Ay.prototype=ky.prototype,new Ay),Object.defineProperty(Cy.prototype,"replacements",{get:function(){return this._replacements},set:function(t){var e=this.uniforms.originalColors,n=this.uniforms.targetColors,r=t.length;if(r>this._maxColors)throw new Error("Length of replacements ("+r+") exceeds the maximum colors length ("+this._maxColors+")");e[3*r]=-1;for(var i=0;i<r;i++){var o=t[i],a=o[0];"number"==typeof a?a=kt(a):o[0]=Ct(a),e[3*i]=a[0],e[3*i+1]=a[1],e[3*i+2]=a[2];a=o[1];"number"==typeof a?a=kt(a):o[1]=Ct(a),n[3*i]=a[0],n[3*i+1]=a[1],n[3*i+2]=a[2]}this._replacements=t},enumerable:!1,configurable:!0}),Cy.prototype.refresh=function(){this.replacements=this._replacements},Object.defineProperty(Cy.prototype,"maxColors",{get:function(){return this._maxColors},enumerable:!1,configurable:!0}),Object.defineProperty(Cy.prototype,"epsilon",{get:function(){return this.uniforms.epsilon},set:function(t){this.uniforms.epsilon=t},enumerable:!1,configurable:!0}),Cy);function Ay(){this.constructor=Py}function Cy(t,e,n){void 0===e&&(e=.05),void 0===n&&(n=t.length);var r=Ey.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform float epsilon;\n\nconst int MAX_COLORS = %maxColors%;\n\nuniform vec3 originalColors[MAX_COLORS];\nuniform vec3 targetColors[MAX_COLORS];\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n\n    float alpha = gl_FragColor.a;\n    if (alpha < 0.0001)\n    {\n      return;\n    }\n\n    vec3 color = gl_FragColor.rgb / alpha;\n\n    for(int i = 0; i < MAX_COLORS; i++)\n    {\n      vec3 origColor = originalColors[i];\n      if (origColor.r < 0.0)\n      {\n        break;\n      }\n      vec3 colorDiff = origColor - color;\n      if (length(colorDiff) < epsilon)\n      {\n        vec3 targetColor = targetColors[i];\n        gl_FragColor = vec4((targetColor + colorDiff) * alpha, alpha);\n        return;\n      }\n    }\n}\n".replace(/%maxColors%/g,n.toFixed(0)))||this;return r._replacements=[],r._maxColors=0,r.epsilon=e,r._maxColors=n,r.uniforms.originalColors=new Float32Array(3*n),r.uniforms.targetColors=new Float32Array(3*n),r.replacements=t,r}var Iy=function(t,e){return(Iy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var My,jy,Dy,Ly=(Iy(jy=Fy,Dy=My=to),jy.prototype=null===Dy?Object.create(Dy):(Ny.prototype=Dy.prototype,new Ny),Fy.prototype.apply=function(t,e,n,r){var i;this.uniforms.dimensions[0]=null===(i=e.filterFrame)||void 0===i?void 0:i.width,this.uniforms.dimensions[1]=null===(i=e.filterFrame)||void 0===i?void 0:i.height,this.uniforms.seed=this.seed,t.applyFilter(this,e,n,r)},Object.defineProperty(Fy.prototype,"sepia",{get:function(){return this.uniforms.sepia},set:function(t){this.uniforms.sepia=t},enumerable:!1,configurable:!0}),Object.defineProperty(Fy.prototype,"noise",{get:function(){return this.uniforms.noise},set:function(t){this.uniforms.noise=t},enumerable:!1,configurable:!0}),Object.defineProperty(Fy.prototype,"noiseSize",{get:function(){return this.uniforms.noiseSize},set:function(t){this.uniforms.noiseSize=t},enumerable:!1,configurable:!0}),Object.defineProperty(Fy.prototype,"scratch",{get:function(){return this.uniforms.scratch},set:function(t){this.uniforms.scratch=t},enumerable:!1,configurable:!0}),Object.defineProperty(Fy.prototype,"scratchDensity",{get:function(){return this.uniforms.scratchDensity},set:function(t){this.uniforms.scratchDensity=t},enumerable:!1,configurable:!0}),Object.defineProperty(Fy.prototype,"scratchWidth",{get:function(){return this.uniforms.scratchWidth},set:function(t){this.uniforms.scratchWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(Fy.prototype,"vignetting",{get:function(){return this.uniforms.vignetting},set:function(t){this.uniforms.vignetting=t},enumerable:!1,configurable:!0}),Object.defineProperty(Fy.prototype,"vignettingAlpha",{get:function(){return this.uniforms.vignettingAlpha},set:function(t){this.uniforms.vignettingAlpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(Fy.prototype,"vignettingBlur",{get:function(){return this.uniforms.vignettingBlur},set:function(t){this.uniforms.vignettingBlur=t},enumerable:!1,configurable:!0}),Fy.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3},Fy);function Ny(){this.constructor=jy}function Fy(t,e){void 0===e&&(e=0);var n=My.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nuniform float sepia;\nuniform float noise;\nuniform float noiseSize;\nuniform float scratch;\nuniform float scratchDensity;\nuniform float scratchWidth;\nuniform float vignetting;\nuniform float vignettingAlpha;\nuniform float vignettingBlur;\nuniform float seed;\n\nconst float SQRT_2 = 1.414213;\nconst vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvec3 Overlay(vec3 src, vec3 dst)\n{\n    // if (dst <= 0.5) then: 2 * src * dst\n    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)\n    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),\n                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),\n                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));\n}\n\n\nvoid main()\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n    vec3 color = gl_FragColor.rgb;\n\n    if (sepia > 0.0)\n    {\n        float gray = (color.x + color.y + color.z) / 3.0;\n        vec3 grayscale = vec3(gray);\n\n        color = Overlay(SEPIA_RGB, grayscale);\n\n        color = grayscale + sepia * (color - grayscale);\n    }\n\n    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;\n\n    if (vignetting > 0.0)\n    {\n        float outter = SQRT_2 - vignetting * SQRT_2;\n        vec2 dir = vec2(vec2(0.5, 0.5) - coord);\n        dir.y *= dimensions.y / dimensions.x;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);\n        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);\n    }\n\n    if (scratchDensity > seed && scratch != 0.0)\n    {\n        float phase = seed * 256.0;\n        float s = mod(floor(phase), 2.0);\n        float dist = 1.0 / scratchDensity;\n        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));\n        if (d < seed * 0.6 + 0.4)\n        {\n            highp float period = scratchDensity * 10.0;\n\n            float xx = coord.x * period + phase;\n            float aa = abs(mod(xx, 0.5) * 4.0);\n            float bb = mod(floor(xx / 0.5), 2.0);\n            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);\n\n            float kk = 2.0 * period;\n            float dw = scratchWidth / dimensions.x * (0.75 + seed);\n            float dh = dw * kk;\n\n            float tine = (yy - (2.0 - dh));\n\n            if (tine > 0.0) {\n                float _sign = sign(scratch);\n\n                tine = s * tine / period + scratch + 0.1;\n                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);\n\n                color.rgb *= tine;\n            }\n        }\n    }\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);\n        // float _noise = snoise(d) * 0.5;\n        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;\n        color += _noise * noise;\n    }\n\n    gl_FragColor.rgb = color;\n}\n")||this;return n.seed=0,n.uniforms.dimensions=new Float32Array(2),"number"==typeof t?(n.seed=t,t=void 0):n.seed=e,Object.assign(n,Fy.defaults,t),n}var By=function(t,e){return(By=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var Uy,Gy,Xy,Hy=(By(Gy=Vy,Xy=Uy=to),Gy.prototype=null===Xy?Object.create(Xy):(zy.prototype=Xy.prototype,new zy),Vy.getAngleStep=function(t){t=Math.max(t*Vy.MAX_SAMPLES,Vy.MIN_SAMPLES);return(2*Math.PI/t).toFixed(7)},Vy.prototype.apply=function(t,e,n,r){this.uniforms.thickness[0]=this._thickness/e._frame.width,this.uniforms.thickness[1]=this._thickness/e._frame.height,t.applyFilter(this,e,n,r)},Object.defineProperty(Vy.prototype,"color",{get:function(){return Ct(this.uniforms.outlineColor)},set:function(t){kt(t,this.uniforms.outlineColor)},enumerable:!1,configurable:!0}),Object.defineProperty(Vy.prototype,"thickness",{get:function(){return this._thickness},set:function(t){this._thickness=t,this.padding=t},enumerable:!1,configurable:!0}),Vy.MIN_SAMPLES=1,Vy.MAX_SAMPLES=100,Vy);function zy(){this.constructor=Gy}function Vy(t,e,n){void 0===t&&(t=1),void 0===e&&(e=0);var r=Uy.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 thickness;\nuniform vec4 outlineColor;\nuniform vec4 filterClamp;\n\nconst float DOUBLE_PI = 3.14159265358979323846264 * 2.;\n\nvoid main(void) {\n    vec4 ownColor = texture2D(uSampler, vTextureCoord);\n    vec4 curColor;\n    float maxAlpha = 0.;\n    vec2 displaced;\n    for (float angle = 0.; angle <= DOUBLE_PI; angle += ${angleStep}) {\n        displaced.x = vTextureCoord.x + thickness.x * cos(angle);\n        displaced.y = vTextureCoord.y + thickness.y * sin(angle);\n        curColor = texture2D(uSampler, clamp(displaced, filterClamp.xy, filterClamp.zw));\n        maxAlpha = max(maxAlpha, curColor.a);\n    }\n    float resultAlpha = max(maxAlpha, ownColor.a);\n    gl_FragColor = vec4((ownColor.rgb + outlineColor.rgb * (1. - ownColor.a)) * resultAlpha, resultAlpha);\n}\n".replace(/\$\{angleStep\}/,Vy.getAngleStep(n=void 0===n?.1:n)))||this;return r._thickness=1,r.uniforms.thickness=new Float32Array([0,0]),r.uniforms.outlineColor=new Float32Array([0,0,0,1]),Object.assign(r,{thickness:t,color:e,quality:n}),r}var Wy=function(t,e){return(Wy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var Yy,qy,Ky,Zy=(Wy(qy=$y,Ky=Yy=to),qy.prototype=null===Ky?Object.create(Ky):(Qy.prototype=Ky.prototype,new Qy),Object.defineProperty($y.prototype,"size",{get:function(){return this.uniforms.size},set:function(t){this.uniforms.size=t="number"==typeof t?[t,t]:t},enumerable:!1,configurable:!0}),$y);function Qy(){this.constructor=qy}function $y(t){void 0===t&&(t=10);var e=Yy.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform vec2 size;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvec2 pixelate(vec2 coord, vec2 size)\n{\n\treturn floor( coord / size ) * size;\n}\n\nvoid main(void)\n{\n    vec2 coord = mapCoord(vTextureCoord);\n\n    coord = pixelate(coord, size);\n\n    coord = unmapCoord(coord);\n\n    gl_FragColor = texture2D(uSampler, coord);\n}\n")||this;return e.size=t,e}var Jy=function(t,e){return(Jy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var t0,e0,n0,r0=(Jy(e0=o0,n0=t0=to),e0.prototype=null===n0?Object.create(n0):(i0.prototype=n0.prototype,new i0),o0.prototype.apply=function(t,e,n,r){this.uniforms.uKernelSize=0!==this._angle?this.kernelSize:0,t.applyFilter(this,e,n,r)},Object.defineProperty(o0.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t,this.uniforms.uRadian=t*Math.PI/180},enumerable:!1,configurable:!0}),Object.defineProperty(o0.prototype,"center",{get:function(){return this.uniforms.uCenter},set:function(t){this.uniforms.uCenter=t},enumerable:!1,configurable:!0}),Object.defineProperty(o0.prototype,"radius",{get:function(){return this.uniforms.uRadius},set:function(t){this.uniforms.uRadius=t=t<0||t===1/0?-1:t},enumerable:!1,configurable:!0}),o0);function i0(){this.constructor=e0}function o0(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=[0,0]),void 0===n&&(n=5),void 0===r&&(r=-1);var i=t0.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform float uRadian;\nuniform vec2 uCenter;\nuniform float uRadius;\nuniform int uKernelSize;\n\nconst int MAX_KERNEL_SIZE = 2048;\n\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    if (uKernelSize == 0)\n    {\n        gl_FragColor = color;\n        return;\n    }\n\n    float aspect = filterArea.y / filterArea.x;\n    vec2 center = uCenter.xy / filterArea.xy;\n    float gradient = uRadius / filterArea.x * 0.3;\n    float radius = uRadius / filterArea.x - gradient * 0.5;\n    int k = uKernelSize - 1;\n\n    vec2 coord = vTextureCoord;\n    vec2 dir = vec2(center - coord);\n    float dist = length(vec2(dir.x, dir.y * aspect));\n\n    float radianStep = uRadian;\n    if (radius >= 0.0 && dist > radius) {\n        float delta = dist - radius;\n        float gap = gradient;\n        float scale = 1.0 - abs(delta / gap);\n        if (scale <= 0.0) {\n            gl_FragColor = color;\n            return;\n        }\n        radianStep *= scale;\n    }\n    radianStep /= float(k);\n\n    float s = sin(radianStep);\n    float c = cos(radianStep);\n    mat2 rotationMatrix = mat2(vec2(c, -s), vec2(s, c));\n\n    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {\n        if (i == k) {\n            break;\n        }\n\n        coord -= center;\n        coord.y *= aspect;\n        coord = rotationMatrix * coord;\n        coord.y /= aspect;\n        coord += center;\n\n        vec4 sample = texture2D(uSampler, coord);\n\n        // switch to pre-multiplied alpha to correctly blur transparent images\n        // sample.rgb *= sample.a;\n\n        color += sample;\n    }\n\n    gl_FragColor = color / float(uKernelSize);\n}\n")||this;return i._angle=0,i.angle=t,i.center=e,i.kernelSize=n,i.radius=r,i}var a0=function(t,e){return(a0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var s0,u0,c0,l0=(a0(u0=f0,c0=s0=to),u0.prototype=null===c0?Object.create(c0):(h0.prototype=c0.prototype,new h0),f0.prototype.apply=function(t,e,n,r){var i;this.uniforms.dimensions[0]=null===(i=e.filterFrame)||void 0===i?void 0:i.width,this.uniforms.dimensions[1]=null===(i=e.filterFrame)||void 0===i?void 0:i.height,this.uniforms.time=this.time,t.applyFilter(this,e,n,r)},Object.defineProperty(f0.prototype,"mirror",{get:function(){return this.uniforms.mirror},set:function(t){this.uniforms.mirror=t},enumerable:!1,configurable:!0}),Object.defineProperty(f0.prototype,"boundary",{get:function(){return this.uniforms.boundary},set:function(t){this.uniforms.boundary=t},enumerable:!1,configurable:!0}),Object.defineProperty(f0.prototype,"amplitude",{get:function(){return this.uniforms.amplitude},set:function(t){this.uniforms.amplitude[0]=t[0],this.uniforms.amplitude[1]=t[1]},enumerable:!1,configurable:!0}),Object.defineProperty(f0.prototype,"waveLength",{get:function(){return this.uniforms.waveLength},set:function(t){this.uniforms.waveLength[0]=t[0],this.uniforms.waveLength[1]=t[1]},enumerable:!1,configurable:!0}),Object.defineProperty(f0.prototype,"alpha",{get:function(){return this.uniforms.alpha},set:function(t){this.uniforms.alpha[0]=t[0],this.uniforms.alpha[1]=t[1]},enumerable:!1,configurable:!0}),f0.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0},f0);function h0(){this.constructor=u0}function f0(t){var e=s0.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\n\nuniform bool mirror;\nuniform float boundary;\nuniform vec2 amplitude;\nuniform vec2 waveLength;\nuniform vec2 alpha;\nuniform float time;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n    vec2 coord = pixelCoord / dimensions;\n\n    if (coord.y < boundary) {\n        gl_FragColor = texture2D(uSampler, vTextureCoord);\n        return;\n    }\n\n    float k = (coord.y - boundary) / (1. - boundary + 0.0001);\n    float areaY = boundary * dimensions.y / filterArea.y;\n    float v = areaY + areaY - vTextureCoord.y;\n    float y = mirror ? v : vTextureCoord.y;\n\n    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;\n    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;\n    float _alpha = (alpha.y - alpha.x) * k + alpha.x;\n\n    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;\n    x = clamp(x, filterClamp.x, filterClamp.z);\n\n    vec4 color = texture2D(uSampler, vec2(x, y));\n\n    gl_FragColor = color * _alpha;\n}\n")||this;return e.time=0,e.uniforms.amplitude=new Float32Array(2),e.uniforms.waveLength=new Float32Array(2),e.uniforms.alpha=new Float32Array(2),e.uniforms.dimensions=new Float32Array(2),Object.assign(e,f0.defaults,t),e}var p0=function(t,e){return(p0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var d0,y0,m0,v0=(p0(y0=b0,m0=d0=to),y0.prototype=null===m0?Object.create(m0):(g0.prototype=m0.prototype,new g0),Object.defineProperty(b0.prototype,"red",{get:function(){return this.uniforms.red},set:function(t){this.uniforms.red=t},enumerable:!1,configurable:!0}),Object.defineProperty(b0.prototype,"green",{get:function(){return this.uniforms.green},set:function(t){this.uniforms.green=t},enumerable:!1,configurable:!0}),Object.defineProperty(b0.prototype,"blue",{get:function(){return this.uniforms.blue},set:function(t){this.uniforms.blue=t},enumerable:!1,configurable:!0}),b0);function g0(){this.constructor=y0}function b0(t,e,n){void 0===t&&(t=[-10,0]),void 0===e&&(e=[0,10]),void 0===n&&(n=[0,0]);var r=d0.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nvoid main(void)\n{\n   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/filterArea.xy).r;\n   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/filterArea.xy).g;\n   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/filterArea.xy).b;\n   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;\n}\n")||this;return r.red=t,r.green=e,r.blue=n,r}var _0=function(t,e){return(_0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var x0,w0,T0,O0=(_0(w0=E0,T0=x0=to),w0.prototype=null===T0?Object.create(T0):(S0.prototype=T0.prototype,new S0),E0.prototype.apply=function(t,e,n,r){this.uniforms.time=this.time,t.applyFilter(this,e,n,r)},Object.defineProperty(E0.prototype,"center",{get:function(){return this.uniforms.center},set:function(t){this.uniforms.center=t},enumerable:!1,configurable:!0}),Object.defineProperty(E0.prototype,"amplitude",{get:function(){return this.uniforms.amplitude},set:function(t){this.uniforms.amplitude=t},enumerable:!1,configurable:!0}),Object.defineProperty(E0.prototype,"wavelength",{get:function(){return this.uniforms.wavelength},set:function(t){this.uniforms.wavelength=t},enumerable:!1,configurable:!0}),Object.defineProperty(E0.prototype,"brightness",{get:function(){return this.uniforms.brightness},set:function(t){this.uniforms.brightness=t},enumerable:!1,configurable:!0}),Object.defineProperty(E0.prototype,"speed",{get:function(){return this.uniforms.speed},set:function(t){this.uniforms.speed=t},enumerable:!1,configurable:!0}),Object.defineProperty(E0.prototype,"radius",{get:function(){return this.uniforms.radius},set:function(t){this.uniforms.radius=t},enumerable:!1,configurable:!0}),E0.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1},E0);function S0(){this.constructor=w0}function E0(t,e,n){void 0===t&&(t=[0,0]),void 0===n&&(n=0);var r=x0.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\n\nuniform vec2 center;\n\nuniform float amplitude;\nuniform float wavelength;\n// uniform float power;\nuniform float brightness;\nuniform float speed;\nuniform float radius;\n\nuniform float time;\n\nconst float PI = 3.14159;\n\nvoid main()\n{\n    float halfWavelength = wavelength * 0.5 / filterArea.x;\n    float maxRadius = radius / filterArea.x;\n    float currentRadius = time * speed / filterArea.x;\n\n    float fade = 1.0;\n\n    if (maxRadius > 0.0) {\n        if (currentRadius > maxRadius) {\n            gl_FragColor = texture2D(uSampler, vTextureCoord);\n            return;\n        }\n        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);\n    }\n\n    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);\n    dir.y *= filterArea.y / filterArea.x;\n    float dist = length(dir);\n\n    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {\n        gl_FragColor = texture2D(uSampler, vTextureCoord);\n        return;\n    }\n\n    vec2 diffUV = normalize(dir);\n\n    float diff = (dist - currentRadius) / halfWavelength;\n\n    float p = 1.0 - pow(abs(diff), 2.0);\n\n    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );\n    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );\n\n    vec2 offset = diffUV * powDiff / filterArea.xy;\n\n    // Do clamp :\n    vec2 coord = vTextureCoord + offset;\n    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    vec4 color = texture2D(uSampler, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    // No clamp :\n    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);\n\n    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;\n\n    gl_FragColor = color;\n}\n")||this;return r.center=t,Object.assign(r,E0.defaults,e),r.time=n,r}var P0=function(t,e){return(P0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var k0,R0,A0,C0=(P0(R0=M0,A0=k0=to),R0.prototype=null===A0?Object.create(A0):(I0.prototype=A0.prototype,new I0),M0.prototype.apply=function(t,e,n,r){var i;this.uniforms.dimensions[0]=null===(i=e.filterFrame)||void 0===i?void 0:i.width,this.uniforms.dimensions[1]=null===(i=e.filterFrame)||void 0===i?void 0:i.height,t.applyFilter(this,e,n,r)},Object.defineProperty(M0.prototype,"texture",{get:function(){return this.uniforms.uLightmap},set:function(t){this.uniforms.uLightmap=t},enumerable:!1,configurable:!0}),Object.defineProperty(M0.prototype,"color",{get:function(){return this._color},set:function(t){var e=this.uniforms.ambientColor;"number"==typeof t?(kt(t,e),this._color=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],this._color=Ct(e))},enumerable:!1,configurable:!0}),Object.defineProperty(M0.prototype,"alpha",{get:function(){return this.uniforms.ambientColor[3]},set:function(t){this.uniforms.ambientColor[3]=t},enumerable:!1,configurable:!0}),M0);function I0(){this.constructor=R0}function M0(t,e,n){void 0===e&&(e=0),void 0===n&&(n=1);var r=k0.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform sampler2D uLightmap;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\nuniform vec4 ambientColor;\nvoid main() {\n    vec4 diffuseColor = texture2D(uSampler, vTextureCoord);\n    vec2 lightCoord = (vTextureCoord * filterArea.xy) / dimensions;\n    vec4 light = texture2D(uLightmap, lightCoord);\n    vec3 ambient = ambientColor.rgb * ambientColor.a;\n    vec3 intensity = ambient + light.rgb;\n    vec3 finalColor = diffuseColor.rgb * intensity;\n    gl_FragColor = vec4(finalColor, diffuseColor.a);\n}\n")||this;return r._color=0,r.uniforms.dimensions=new Float32Array(2),r.uniforms.ambientColor=new Float32Array([0,0,0,n]),r.texture=t,r.color=e,r}var j0=function(t,e){return(j0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function D0(t,e){function n(){this.constructor=t}j0(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var L0,N0=(D0(F0,L0=to),F0.prototype.updateDelta=function(){this.uniforms.delta.x=0,this.uniforms.delta.y=0},Object.defineProperty(F0.prototype,"blur",{get:function(){return this.uniforms.blur},set:function(t){this.uniforms.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(F0.prototype,"gradientBlur",{get:function(){return this.uniforms.gradientBlur},set:function(t){this.uniforms.gradientBlur=t},enumerable:!1,configurable:!0}),Object.defineProperty(F0.prototype,"start",{get:function(){return this.uniforms.start},set:function(t){this.uniforms.start=t,this.updateDelta()},enumerable:!1,configurable:!0}),Object.defineProperty(F0.prototype,"end",{get:function(){return this.uniforms.end},set:function(t){this.uniforms.end=t,this.updateDelta()},enumerable:!1,configurable:!0}),F0);function F0(t,e,n,r){void 0===t&&(t=100),void 0===e&&(e=600);var i=L0.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    color /= total;\n    color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n")||this;return i.uniforms.blur=t,i.uniforms.gradientBlur=e,i.uniforms.start=n||new Te(0,window.innerHeight/2),i.uniforms.end=r||new Te(600,window.innerHeight/2),i.uniforms.delta=new Te(30,30),i.uniforms.texSize=new Te(window.innerWidth,window.innerHeight),i.updateDelta(),i}var B0,U0=(D0(G0,B0=N0),G0.prototype.updateDelta=function(){var t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,n=Math.sqrt(t*t+e*e);this.uniforms.delta.x=t/n,this.uniforms.delta.y=e/n},G0);function G0(){return null!==B0&&B0.apply(this,arguments)||this}var X0,H0=(D0(z0,X0=N0),z0.prototype.updateDelta=function(){var t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,n=Math.sqrt(t*t+e*e);this.uniforms.delta.x=-e/n,this.uniforms.delta.y=t/n},z0);function z0(){return null!==X0&&X0.apply(this,arguments)||this}var V0,W0=(D0(Y0,V0=to),Y0.prototype.apply=function(t,e,n,r){var i=t.getFilterTexture();this.tiltShiftXFilter.apply(t,e,i,1),this.tiltShiftYFilter.apply(t,i,n,r),t.returnFilterTexture(i)},Object.defineProperty(Y0.prototype,"blur",{get:function(){return this.tiltShiftXFilter.blur},set:function(t){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=t},enumerable:!1,configurable:!0}),Object.defineProperty(Y0.prototype,"gradientBlur",{get:function(){return this.tiltShiftXFilter.gradientBlur},set:function(t){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=t},enumerable:!1,configurable:!0}),Object.defineProperty(Y0.prototype,"start",{get:function(){return this.tiltShiftXFilter.start},set:function(t){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=t},enumerable:!1,configurable:!0}),Object.defineProperty(Y0.prototype,"end",{get:function(){return this.tiltShiftXFilter.end},set:function(t){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=t},enumerable:!1,configurable:!0}),Y0);function Y0(t,e,n,r){void 0===t&&(t=100),void 0===e&&(e=600);var i=V0.call(this)||this;return i.tiltShiftXFilter=new U0(t,e,n,r),i.tiltShiftYFilter=new H0(t,e,n,r),i}var q0=function(t,e){return(q0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var K0,Z0,Q0,$0=(q0(Z0=t1,Q0=K0=to),Z0.prototype=null===Q0?Object.create(Q0):(J0.prototype=Q0.prototype,new J0),Object.defineProperty(t1.prototype,"offset",{get:function(){return this.uniforms.offset},set:function(t){this.uniforms.offset=t},enumerable:!1,configurable:!0}),Object.defineProperty(t1.prototype,"radius",{get:function(){return this.uniforms.radius},set:function(t){this.uniforms.radius=t},enumerable:!1,configurable:!0}),Object.defineProperty(t1.prototype,"angle",{get:function(){return this.uniforms.angle},set:function(t){this.uniforms.angle=t},enumerable:!1,configurable:!0}),t1.defaults={radius:200,angle:4,padding:20,offset:new Te},t1);function J0(){this.constructor=Z0}function t1(t){var e=K0.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform vec4 filterArea;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvec2 twist(vec2 coord)\n{\n    coord -= offset;\n\n    float dist = length(coord);\n\n    if (dist < radius)\n    {\n        float ratioDist = (radius - dist) / radius;\n        float angleMod = ratioDist * ratioDist * angle;\n        float s = sin(angleMod);\n        float c = cos(angleMod);\n        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n    }\n\n    coord += offset;\n\n    return coord;\n}\n\nvoid main(void)\n{\n\n    vec2 coord = mapCoord(vTextureCoord);\n\n    coord = twist(coord);\n\n    coord = unmapCoord(coord);\n\n    gl_FragColor = texture2D(uSampler, coord );\n\n}\n")||this;return Object.assign(e,t1.defaults,t),e}var e1=function(t,e){return(e1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var n1,r1,i1,o1=(e1(r1=s1,i1=n1=to),r1.prototype=null===i1?Object.create(i1):(a1.prototype=i1.prototype,new a1),Object.defineProperty(s1.prototype,"center",{get:function(){return this.uniforms.uCenter},set:function(t){this.uniforms.uCenter=t},enumerable:!1,configurable:!0}),Object.defineProperty(s1.prototype,"strength",{get:function(){return this.uniforms.uStrength},set:function(t){this.uniforms.uStrength=t},enumerable:!1,configurable:!0}),Object.defineProperty(s1.prototype,"innerRadius",{get:function(){return this.uniforms.uInnerRadius},set:function(t){this.uniforms.uInnerRadius=t},enumerable:!1,configurable:!0}),Object.defineProperty(s1.prototype,"radius",{get:function(){return this.uniforms.uRadius},set:function(t){this.uniforms.uRadius=t=t<0||t===1/0?-1:t},enumerable:!1,configurable:!0}),s1.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32},s1);function a1(){this.constructor=r1}function s1(t){var e=Object.assign(s1.defaults,t),t=e.maxKernelSize,e=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}(e,["maxKernelSize"]),n=n1.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform vec2 uCenter;\nuniform float uStrength;\nuniform float uInnerRadius;\nuniform float uRadius;\n\nconst float MAX_KERNEL_SIZE = ${maxKernelSize};\n\n// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand(vec2 co, float seed) {\n    const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);\n    return fract(sin(sn) * c + seed);\n}\n\nvoid main() {\n\n    float minGradient = uInnerRadius * 0.3;\n    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;\n\n    float gradient = uRadius * 0.3;\n    float radius = (uRadius - gradient * 0.5) / filterArea.x;\n\n    float countLimit = MAX_KERNEL_SIZE;\n\n    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);\n    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));\n\n    float strength = uStrength;\n\n    float delta = 0.0;\n    float gap;\n    if (dist < innerRadius) {\n        delta = innerRadius - dist;\n        gap = minGradient;\n    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity\n        delta = dist - radius;\n        gap = gradient;\n    }\n\n    if (delta > 0.0) {\n        float normalCount = gap / filterArea.x;\n        delta = (normalCount - delta) / normalCount;\n        countLimit *= delta;\n        strength *= delta;\n        if (countLimit < 1.0)\n        {\n            gl_FragColor = texture2D(uSampler, vTextureCoord);\n            return;\n        }\n    }\n\n    // randomize the lookup values to hide the fixed number of samples\n    float offset = rand(vTextureCoord, 0.0);\n\n    float total = 0.0;\n    vec4 color = vec4(0.0);\n\n    dir *= strength;\n\n    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {\n        float percent = (t + offset) / MAX_KERNEL_SIZE;\n        float weight = 4.0 * (percent - percent * percent);\n        vec2 p = vTextureCoord + dir * percent;\n        vec4 sample = texture2D(uSampler, p);\n\n        // switch to pre-multiplied alpha to correctly blur transparent images\n        // sample.rgb *= sample.a;\n\n        color += sample * weight;\n        total += weight;\n\n        if (t > countLimit){\n            break;\n        }\n    }\n\n    color /= total;\n    // switch back from pre-multiplied alpha\n    // color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n".replace("${maxKernelSize}",t.toFixed(1)))||this;return Object.assign(n,e),n}function u1(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c1(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l1,h1=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),c1(this,"_container",void 0),c1(this,"clock",0),c1(this,"fpsBackground",void 0),c1(this,"fpsText",void 0),c1(this,"pointBackground",void 0),c1(this,"pointText",void 0),this._container=new T.Container,e.suppressDiagnostics=!(null!=t&&t.enable),this.fpsBackground=new T.Graphics,this.fpsBackground.beginFill(0),this.fpsBackground.alpha=.25,this.fpsBackground.drawRect(0,zI.display.renderHeight-10,14,10),this._container.addChild(this.fpsBackground),this.fpsText=new T.BitmapText("",{fontName:"TecTacRegular",fontSize:8,align:"left"}),this.fpsText.x=2,this.fpsText.y=zI.display.renderHeight-9,this.fpsText.tint=15658734,this._container.addChild(this.fpsText),this.pointBackground=new T.Graphics,this.pointBackground.beginFill(0),this.pointBackground.alpha=.25,this.pointBackground.drawRect(16,zI.display.renderHeight-10,30,10),this._container.addChild(this.pointBackground),this.pointText=new T.BitmapText("",{fontName:"TecTacRegular",fontSize:8,align:"left"}),this.pointText.x=18,this.pointText.y=zI.display.renderHeight-9,this.pointText.tint=15658734,this._container.addChild(this.pointText),zI.globalTicker.add(this.update,this),this._container.visible=!1}var t,n,r;return t=e,(n=[{key:"container",get:function(){return this._container}},{key:"cursorPos",get:function(){return this.pointText.text},set:function(t){this.pointText.text=t}},{key:"update",value:function(){this.fpsText.text="".concat(Math.round(zI.FPS)),e.suppressDiagnostics||(this._container.visible=zI.devSettings.showDiagnosticLayer)}}])&&u1(t.prototype,n),r&&u1(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function f1(t){return function(t){if(Array.isArray(t))return p1(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return p1(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p1(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p1(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d1(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function y1(r){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?d1(Object(i),!0).forEach(function(t){var e,n;e=r,t=i[n=t],n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):d1(Object(i)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(i,t))})}return r}function m1(t){return(m1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v1(n){var r=x1();return function(){var t,e=T1(n);return function(t,e){{if(e&&("object"===m1(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return g1(t)}(this,r?(t=T1(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function g1(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b1(t){var n="function"==typeof Map?new Map:void 0;return function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return _1(t,arguments,T1(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),w1(e,t)}(t)}function _1(t,e,n){return(_1=x1()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);r=new(Function.bind.apply(t,r));return n&&w1(r,n.prototype),r}).apply(null,arguments)}function x1(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function w1(t,e){return(w1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function T1(t){return(T1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c1(h1,"suppressDiagnostics",!0),function(t){t.confirmType=function(){return function(t){return t}},t.implementsType=function(){return function(t){return t}};t.freezeObject=function(t){return Object.freeze(t),t},t.assignDefaults=function(t,e){var n={},r=t,i=e;return Object.keys(y1(y1({},t),e)).forEach(function(t){n[t]=(void 0!==r[t]?r:i)[t]}),n},t.destroyObject=function(t){var e=t;Object.keys(t).forEach(function(t){return e[t]=void 0})},t.Array2D=function(t,e,n){var r=n instanceof Function?n:function(){return n};return f1(Array(t)).map(function(t,n){return f1(Array(e)).map(function(t,e){return r(n,e)})})},t.createMulberry32=function(t){var e=null!=t?t:Math.random();return function(){var t=e+=1831565813,t=Math.imul(t^t>>>15,1|t);return(((t^=t+Math.imul(t^t>>>7,61|t))^t>>>14)>>>0)/4294967296}},t.choose=function(t){var e=Math.random;return t[(0,Math.floor)(e()*t.length)]},t.insertIf=function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t?n:[]},t.confine=function(t,e,n){var r;return n<e&&(r=e,e=n,n=r),t<e?t=e:n<t&&(t=n),t},t.clamp=function(t,e,n){if(n<e)throw new Error("min cannot be greater than max");return Math.min(n,Math.max(e,t))},t.rotate=function(t,e){return 0<=(t%=e)?t:t+e},t.within=function(t,e,n,r){return r?e<t&&t<n:e<=t&&t<=n},t.inRange=function(t,e,n,r){return r?e<t&&t<n:e<=t&&t<=n},t.validIndex=function(t,e){return l1.inRange(t,0,e-1)},t.rangeDisplacementSide=function(t,e,n){return-1*Number(t<e)+Number(n<t)},t.displacementFromRange=function(t,e,n){return(t-e)*Number(t<e)+(t-n)*Number(n<t)},t.sortByWeight=function(t){return t.slice().sort(function(t,e){return t.weight-e.weight})},t.boxCollision=function(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y},t.readBits=function(t,e,n){return t>>n&Math.pow(2,e)-1},t.writeBits=function(t,e,n,r){return n=Math.pow(2,n)-1,t&=~(n<<r),t+=(e&n)<<r},t.listToBouncingLoop=function(t){for(var e=t.slice(),n=t.length-2;0<n;n--)e.push(t[n]);return e},t.animationSpeedFromTimeDuration=function(t,e){return t/(60*e)},t.animationTimeDuration=function(t,e){return t/(60*e)},t.animationSpeedFromFrameInterval=function(t){return 1/t},t.repeatingSequence=function(e,t){function n(t){if(l1.validIndex(t,e.length))return e[t]}for(var r=2;r<=t;r++){for(var i=[],o=!0,a=0;a<r&&l1.validIndex(a,e.length);a++){var s=e[a]===n(a+2*r),u=e[a]===n(a+3*r);if(!s||!u){o=!1;break}i.push(e[a])}if(o)return i}return[]}}(l1=l1||{});var O1={error:function(t){for(var e,n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=console).error.apply(e,[t].concat(r))},errif:function(t,e){if(t){for(var n=arguments.length,r=new Array(2<n?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];O1.error(e,r)}},assert:function(t,e,n){if(!t)throw new(n||S1)(e)},ping:function(t){for(var e=void 0===t?"ping":t,n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=console).warn.apply(t,[e].concat(r))},print:function(t){for(var e,n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=console).warn.apply(e,[t].concat(r))},warn:function(t){for(var e,n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=console).warn.apply(e,[t].concat(r))},report:function(){O1.ping("Report:");for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(function(t){console.log(t)})},_logData:[],log:function(t,e,n){var r=null!=n?n:{},i=r.message,o=r.reason,a=r.error,s=r.warn,n=function(t,e){if(!e)return"";var t="  ".concat(t," "),n=" ".repeat(t.length),e=e.split("\n").map(function(t){return"".concat(n).concat(t)}).join("\n");return"\n".concat(t).concat(e.slice(n.length))},r="[".concat((new Date).toISOString(),"] fr").concat(zI.frameCount," ln").concat(O1._logData.length),o="".concat(r," ").concat(t," ").concat(e).concat(n(":",i)).concat(n(";",o));a?console.error(o):s&&console.warn(o),O1._logData.push(o)},exportLogToConsole:function(){console.groupCollapsed("System Log (".concat(O1._logData.length,")")),console.log(O1._logData.join("\n")),console.groupEnd()},get AssertionError(){return S1}},S1=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w1(t,e)}(u,b1(Error));var s=v1(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e,n,r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=g1(t),r="AssertionError",(n="name")in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return u}();function E1(t){return(E1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P1(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k1(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R1(n){var r=M1();return function(){var t,e=D1(n);return function(t,e){{if(e&&("object"===E1(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return A1(t)}(this,r?(t=D1(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function A1(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C1(t){var n="function"==typeof Map?new Map:void 0;return function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return I1(t,arguments,D1(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),j1(e,t)}(t)}function I1(t,e,n){return(I1=M1()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);r=new(Function.bind.apply(t,r));return n&&j1(r,n.prototype),r}).apply(null,arguments)}function M1(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function j1(t,e){return(j1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function D1(t){return(D1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function L1(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var N1,F1=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j1(t,e)}(o,C1(Error));var i=R1(o);function o(){var t;k1(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return L1(A1(t=i.call.apply(i,[this].concat(n))),"name","ResourceError"),t}return o}();(Nh=N1=N1||{})[Nh.Unbuilt=0]="Unbuilt",Nh[Nh.Building=1]="Building",Nh[Nh.Ready=2]="Ready",Nh[Nh.Destroyed=3]="Destroyed";var B1=function(){function o(){k1(this,o),L1(this,"state",N1.Unbuilt),L1(this,"linker",[]),L1(this,"halted",!1),L1(this,"_ticker",void 0),L1(this,"_resources",null),L1(this,"visualLayers",l1.freezeObject({root:new T.Container,world:new T.Container,backdrop:new T.Container,stage:new T.Container,hud:new T.Container}));var t=this.visualLayers,e=t.root,n=t.world,r=t.backdrop,i=t.stage,t=t.hud;n.addChild(r,i),e.addChild(n,t)}var t,e,n;return t=o,(e=[{key:"mustInitialize",get:function(){return this.state===N1.Unbuilt}},{key:"ready",get:function(){return this.state===N1.Ready}},{key:"destroyed",get:function(){return this.state===N1.Destroyed}},{key:"ticker",get:function(){if(!this._ticker)throw new Error("Attempted to access the scene's destroyed ticker.");return this._ticker}},{key:"resources",get:function(){if(!this._resources)throw new Error("Attempted to access the scene's destroyed resources.");return this._resources}},{key:"getSpritesheet",value:function(t){var e=this.resources[t].spritesheet;if(void 0===e)throw new F1("Cannot find spritesheet '".concat(t,"'"));return e}},{key:"texturesFrom",value:function(t){return this.getSpritesheet(t).textures}},{key:"animationsFrom",value:function(t){return this.getSpritesheet(t).animations}},{key:"init",value:function(){if(this.state!=N1.Unbuilt)throw new Error("Attempted to reconstruct a constructed scene.");this._ticker=new T.Ticker,this._ticker.start(),this.load()}},{key:"destroy",value:function(){if(this.state!=N1.Ready)throw new Error("Attempted to destroy an unconstructed scene.");O1.log("Scene","Destroy",{message:"Disassembling '".concat(this.constructor.name,"'")}),this.destroyStep(),this._ticker&&this._ticker.destroy(),this.visualLayers.root.destroy({children:!0}),this.state=N1.Destroyed}},{key:"load",value:function(){var t=this;zI.loader.reset(),zI.loader.reset(),this.loadStep(),this.linker.forEach(function(t){return zI.loader.add(t.name,t.url)}),this.state=N1.Building;function e(){t._resources=zI.loader.resources,t.setup()}0<this.linker.length?zI.loader.load().onComplete.once(e):e()}},{key:"setup",value:function(){this.setupStep(),this.state=N1.Ready}},{key:"update",value:function(){this.halted||this.state!=N1.Ready||this.updateStep()}},{key:"halt",value:function(){var t;this.halted=!0,null!==(t=this._ticker)&&void 0!==t&&t.stop()}},{key:"resume",value:function(){var t;this.halted=!1,null!==(t=this._ticker)&&void 0!==t&&t.start()}}])&&P1(t.prototype,e),n&&P1(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function U1(t){return(U1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function G1(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function X1(t,e){return(X1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function H1(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=z1(n);return function(t,e){{if(e&&("object"===U1(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=z1(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function z1(t){return(z1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}L1(B1,"resourceLinks",void 0),L1(B1,"resourceFonts",void 0);var V1=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&X1(t,e)}(i,B1);var t,e,n,r=H1(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"loadStep",value:function(){}},{key:"setupStep",value:function(){}},{key:"updateStep",value:function(){}},{key:"destroyStep",value:function(){}}])&&G1(t.prototype,e),n&&G1(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function W1(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Y1=function(){function r(){var t,e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),n=[],(e="workOrders")in(t=this)?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}var t,e,n;return t=r,(e=[{key:"close",value:function(){this.workOrders=this.workOrders.filter(function(t){return 1!=t.order.call(t.context)})}},{key:"send",value:function(t,e){this.workOrders.push({order:t,context:e})}},{key:"cancel",value:function(e,n){this.workOrders=this.workOrders.filter(function(t){return t.order!==e||t.context!==n})}},{key:"clear",value:function(){this.workOrders=[]}}])&&W1(t.prototype,e),n&&W1(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function q1(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var K1,Z1=function(){function r(){var t,e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),n={},(e="library")in(t=this)?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}var t,e,n;return t=r,(e=[{key:"register",value:function(){for(var n=this,t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];e.forEach(function(t){var e=n.library[t.id];O1.assert(void 0===e,"TextureLibrary ID ".concat(t.id," is being overwritten.")),e||(n.library[t.id]=t.texture)})}},{key:"update",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach(function(t){e.library[t.id]=t.texture})}},{key:"hasId",value:function(t){return Boolean(this.library[t])}},{key:"get",value:function(t){return this.library[t]}},{key:"flush",value:function(){var e=this;Object.keys(this.library).forEach(function(t){delete e.library[t]}),this.library={}}}])&&q1(t.prototype,e),n&&q1(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function Q1(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}(lf=K1=K1||{})[lf.Up=0]="Up",lf[lf.Pressed=1]="Pressed",lf[lf.Down=2]="Down",lf[lf.Released=3]="Released";function $1(t,e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,$1),Q1(this,"button1",void 0),Q1(this,"button2",void 0),Q1(this,"key1",void 0),Q1(this,"key2",void 0),this.button1=t,this.button2=e,this.key1=n,this.key2=r}function J1(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tm(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}for(var em=new $1(-1,-1,-1,-1),nm=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),tm(this,"map",void 0),tm(this,"_state",K1.Up),tm(this,"_releaseCancelled",!1),tm(this,"_framesHeld",0),tm(this,"_countHeldFrames",!0),this.map=null!=t?t:em}var t,n,r;return t=e,(n=[{key:"framesHeld",get:function(){return this._framesHeld}},{key:"timeHeld",get:function(){return this._framesHeld/60}},{key:"pressed",get:function(){return this._state===K1.Pressed}},{key:"down",get:function(){return this._state===K1.Down||this.pressed}},{key:"released",get:function(){return this._state===K1.Released}},{key:"up",get:function(){return this._state===K1.Up||this.released}},{key:"changed",get:function(){return this.pressed||this.released}},{key:"held",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(e.interrupt&&e.interrupt()||e.while&&!e.while())return this.cancel(),!1;t=this.down&&this._framesHeld>=t;return t&&e.once&&this.cancel(),t}},{key:"changeState",value:function(t){this._state=t,this._framesHeld=0}},{key:"update",value:function(t){var e=K1.Down,n=K1.Up,r=K1.Pressed,i=K1.Released;if(this._framesHeld++,this.pressed&&this.changeState(e),this.released&&this.changeState(n),this._releaseCancelled)return this.changeState(n),void(this._releaseCancelled=!1);this.up&&t&&this.changeState(r),this.down&&!t&&this.changeState(i)}},{key:"reset",value:function(){this._state=K1.Up}},{key:"cancel",value:function(){this._releaseCancelled=!0}},{key:"remap",value:function(t){this.map=t}}])&&J1(t.prototype,n),r&&J1(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),rm={},im=0;32*im<256;im++)rm[im]=0;function om(t){var e=document.activeElement!==zI.contextElement,t=t.keyCode===am.Tab;return e||t}window.addEventListener("keydown",function(t){var e,n;om(t)||(e=t.keyCode,n=Math.floor(e/32),rm[n]=l1.writeBits(rm[n],1,1,e%32),t.preventDefault())}),window.addEventListener("keyup",function(t){var e,n;om(t)||(e=t.keyCode,n=Math.floor(e/32),rm[n]=l1.writeBits(rm[n],0,1,e%32),t.preventDefault())});var Nh={keyDown:function(t){var e=Math.floor(t/32);return 1==l1.readBits(rm[e],1,t%32)},reset:function(){for(var t in rm)rm[t]=0}},am={Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,PauseBreak:19,CapsLock:20,Escape:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,LeftArrow:37,UpArrow:38,RightArrow:39,DownArrow:40,Insert:45,Delete:46,iRow0:48,iRow1:49,iRow2:50,iRow3:51,iRow4:52,iRow5:53,iRow6:54,iRow7:55,iRow8:56,iRow9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LeftWindowKey:91,RightWindowKey:92,SelectKey:93,Numpad0:96,Numpad1:97,Numpad2:98,Numpad3:99,Numpad4:100,Numpad5:101,Numpad6:102,Numpad7:103,Numpad8:104,Numpad9:105,Multiply:106,Add:107,Subtract:109,DecimalPoint:110,Divide:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NumLock:144,ScrollLock:145,Semicolon:186,EqualSign:187,Comma:188,Dash:189,Period:190,ForwardSlash:191,GraveAccent:192,OpenBracket:219,BackSlash:220,CloseBraket:221,SingleQuote:222};function sm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function um(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var cm,lm,hm=function(){function i(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),um(this,"enabled",void 0),um(this,"button",{}),um(this,"onPressEvents",[]),um(this,"onReleaseEvents",[]),um(this,"whileDownEvents",[]),this.enabled=(null==t?void 0:t.enable)||!1;var e,n=am;for(e in n){var r=this.enabled?n[e]:null,r=new $1(null,null,r,null);this.button[e]=new nm(r)}this.reset()}var t,e,n;return t=i,(e=[{key:"reset",value:function(){for(var t in this.button)this.button[t].reset()}},{key:"get",value:function(e){var t=Object.values(this.button).find(function(t){return t.map.key1===e});return void 0!==t?t:i.default_button}},{key:"getKeyModifier",value:function(t,e){var n,r,t=this.get(t);return e&&(n={Shift:am.Shift,Ctrl:am.Ctrl,Alt:am.Alt}[e],r=Object.values(this.button).find(function(t){return t.map.key1===n})),{button:t,modifier:r}}},{key:"pressed",value:function(t,e){t=this.getKeyModifier(t,e),e=t.button,t=t.modifier;return e.pressed&&(!t||t.down)}},{key:"down",value:function(t,e){t=this.getKeyModifier(t,e),e=t.button,t=t.modifier;return e.down&&(!t||t.down)}},{key:"update",value:function(){var n=this;if(this.enabled)for(var t in this.button)!function(t){var e=n.button[t],t=!1;null!=e.map.key1&&(t=i.keyboard.keyDown(e.map.key1)),e.update(t),e.pressed?n.handleEvents(n.onPressEvents.filter(function(t){return t.keyId===e.map.key1})):e.released?n.handleEvents(n.onReleaseEvents.filter(function(t){return t.keyId===e.map.key1})):e.down&&n.handleEvents(n.whileDownEvents.filter(function(t){return t.keyId===e.map.key1}))}(t)}},{key:"handleEvents",value:function(t){t.forEach(function(t){return t.callback.call(t.context)})}},{key:"onPress",value:function(t,e,n){this.enabled&&this.onPressEvents.push({keyId:t,callback:e,context:n})}},{key:"onRelease",value:function(t,e,n){this.enabled&&this.onReleaseEvents.push({keyId:t,callback:e,context:n})}},{key:"onDown",value:function(t,e,n){this.enabled&&this.whileDownEvents.push({keyId:t,callback:e,context:n})}},{key:"removeEvent",value:function(e,n,r){function i(t){return t.keyId===e&&t.callback===n&&t.context===r}this.onPressEvents=this.onPressEvents.filter(function(t){return!i(t)}),this.onReleaseEvents=this.onReleaseEvents.filter(function(t){return!i(t)}),this.whileDownEvents=this.whileDownEvents.filter(function(t){return!i(t)})}}])&&sm(t.prototype,e),n&&sm(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function fm(t,e,n){function r(t,e,n){i(!o(t,0,e),"".concat(n," must be within 0--").concat(e,": given ").concat(t))}var i=O1.errif,o=l1.within,a=Math.ceil,s=Math.abs;r(t,360,"hue"),r(e,100,"sat"),r(n,100,"val");var e=n/100*(e/100),s=e*(1-s(t/60%2-1)),u=n/100-e,c=[[0,s,e],[0,e,s],[s,e,0],[e,s,0],[e,0,s],[s,0,e]][0===t?0:a(t/60)-1],t=function(t){return 255*(c[t]+u)<<8*t};return t(2)+t(1)+t(0)}function pm(t,e,n){function r(t,e){i(!o(t,0,255),"".concat(e," must be within 0--255: given ").concat(t)),i(t-a(t)!=0,"".concat(e," must be an integer: given ").concat(t))}var i=O1.errif,o=l1.within,a=Math.floor;return r(t,"red"),r(e,"green"),r(n,"blue"),(t<<16)+(e<<8)+n}function dm(e){function t(t){return(e&255<<8*t)>>8*t}return{r:t(2),g:t(1),b:t(0)}}function ym(t){var e=Math.min,n=Math.max,r=dm(t),i=r.r/255,t=r.g/255,r=r.b/255,n=n(i,t,r),e=n-e(i,t,r),t=0==e?0:n===i?60*(t-r)/e:n===t?60*(2+(r-i)/e):60*(4+(i-t)/e);return{h:t<0?360+t:t,s:100*(0===n?0:e/n),v:100*n}}function mm(t){function r(t){return l1.clamp(t,0,1)}function e(t,e,n){return(t=2*r(t))<1?.5*e(t):.5*n(t-1)+.5}var n=t.easeIn,i=t.easeOut,t={in:function(t){return n(r(t))},out:function(t){return i(r(t))},inOut:function(t){return e(t,n,i)},outIn:function(t){return e(t,i,n)}};return Object.freeze(t),t}function vm(t){return function(t){if(Array.isArray(t))return gm(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return gm(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gm(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gm(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function bm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xm(t){return(xm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wm(t,e){return new Tm(t,e)}um(hm,"keyboard",Nh),um(hm,"default_button",new nm(new $1(null,null,null,null))),(lf=cm=cm||{}).HSV=fm,lf.RGB=pm,lf.isHex=function(t){return l1.within(t,0,16777215)},lf.getRGB=dm,lf.getHSV=ym,lf.multiply=function(t,e){var n,r,i=l1.clamp,o=Math.trunc,a=dm(t);for(n in a)a[n]=(r=a[n],i(o(e*r),0,255));return pm(a.r,a.g,a.b)},lf.adjustHSV=function(t,e,n,r){var i=l1.clamp,o=l1.rotate,t=ym(t);return fm(o(t.h+e,360),i(t.s*n,0,100),i(t.v*r,0,100))},function(t){t.quantize=function(e,n){return function(t){return Math.floor(e(t)*n)/n}};t.linear=mm({easeIn:function(t){return t},easeOut:function(t){return t}}),t.quad=mm({easeIn:function(t){return Math.pow(t,2)},easeOut:function(t){return 1-Math.pow(t-1,2)}}),t.cubic=mm({easeIn:function(t){return Math.pow(t,3)},easeOut:function(t){return 1+Math.pow(t-1,3)}}),t.quart=mm({easeIn:function(t){return Math.pow(t,4)},easeOut:function(t){return 1-Math.pow(t-1,4)}}),t.quint=mm({easeIn:function(t){return Math.pow(t,5)},easeOut:function(t){return 1+Math.pow(t-1,5)}}),t.sqrt=mm({easeIn:function(t){return 1-Math.sqrt(1-t)},easeOut:function(t){return Math.sqrt(t)}}),t.cbrt=mm({easeIn:function(t){return 1-Math.cbrt(1-t)},easeOut:function(t){return Math.cbrt(t)}}),t.qdrt=mm({easeIn:function(t){return 1-Math.sqrt(Math.sqrt(1-t))},easeOut:function(t){return Math.sqrt(Math.sqrt(t))}}),t.circ=mm({easeIn:function(t){return 1-Math.sqrt(1-Math.pow(t,2))},easeOut:function(t){return Math.sqrt(1-Math.pow(t-1,2))}}),t.cbcirc=mm({easeIn:function(t){return 1-Math.cbrt(1-Math.pow(t,3))},easeOut:function(t){return Math.cbrt(1+Math.pow(t-1,3))}}),t.sine=mm({easeIn:function(t){return 1-Math.cos(t*Math.PI*.5)},easeOut:function(t){return Math.sin(t*Math.PI*.5)}});var e=5*Math.PI/8,n=Math.sin(e);t.back=mm({easeIn:function(t){return Math.sin(t*t*e)/n},easeOut:function(t){return t}})}(lm=lm||{});var Tm=function(){function r(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),_m(this,"x",0),_m(this,"y",0),"object"==xm(t)?(this.x=t.x,this.y=t.y):(this.x=t||0,this.y="number"==typeof e?e:this.x)}var t,e,n;return t=r,n=[{key:"Origin",get:function(){return new r(0,0)}},{key:"Zero",get:function(){return r.Origin}},{key:"Up",get:function(){return new r(0,-1)}},{key:"Down",get:function(){return new r(0,1)}},{key:"Left",get:function(){return new r(-1,0)}},{key:"Right",get:function(){return new r(1,0)}},{key:"Cardinals",get:function(){return[r.Up,r.Right,r.Down,r.Left]}}],(e=[{key:"set",value:function(t,e){e=wm(t,e);return this.x=e.x,this.y=e.y,this}},{key:"clone",value:function(){return(new r).set(this)}},{key:"equal",value:function(t,e){e=wm(t,e);return this.x===e.x&&this.y===e.y}},{key:"notEqual",value:function(t,e){e=wm(t,e);return this.x!==e.x||this.y!==e.y}},{key:"add",value:function(t,e){e=wm(t,e);return e.set(e.x+this.x,e.y+this.y)}},{key:"addAll",value:function(t){return[this].concat(vm(t)).reduce(function(t,e){return t.add(e)})}},{key:"subtract",value:function(t,e){e=wm(t,e);return this.add(e.negative())}},{key:"apply",value:function(t){return this.clone().set(t(this.x),t(this.y))}},{key:"merge",value:function(t,e,n){n=new r(e,n);return new r(t(this.x,n.x),t(this.y,n.y))}},{key:"negative",value:function(){return this.apply(function(t){return-t})}},{key:"abs",value:function(){return this.apply(Math.abs)}},{key:"ceil",value:function(){return this.apply(Math.ceil)}},{key:"floor",value:function(){return this.apply(Math.floor)}},{key:"round",value:function(){return this.apply(Math.round)}},{key:"trunc",value:function(){return this.apply(Math.trunc)}},{key:"clamp",value:function(t,e){function n(t,e){return 0<=e?l1.clamp(t,0,e):l1.clamp(t,e,0)}return this.merge(n,new r(t,e))}},{key:"sumCoords",value:function(){return this.x+this.y}},{key:"multiply",value:function(t,e){e=wm(t,e);return new r(this.x*e.x,this.y*e.y)}},{key:"inverse",value:function(){return this.apply(function(t){return 0===t?0:1/t})}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"crossZ",value:function(t){return this.x*t.y-this.y*t.x}},{key:"manhattanDistance",value:function(t,e){return wm(t,e).subtract(this).manhattanMagnitude()}},{key:"distance",value:function(t,e){return wm(t,e).subtract(this).magnitude()}},{key:"magnitude",value:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}},{key:"manhattanMagnitude",value:function(){return this.abs().sumCoords()}},{key:"unit",value:function(){var t=this.magnitude();return 0!==t?this.multiply(1/t):r.Origin}},{key:"angle",value:function(){var t,e=Math.sign(this.crossZ(r.Right));return t=0===(t=Math.acos(this.x/this.magnitude())*e)?this.x<0?Math.PI:0:t}},{key:"polarAngle",value:function(){var t=2*Math.PI;return(t-this.angle())%t}},{key:"angleDifference",value:function(t){return Math.acos(this.dot(t)/(this.magnitude()*t.magnitude()))}},{key:"angleTo",value:function(t){var e=Math.sign(this.crossZ(t));return this.angleDifference(t)*e}},{key:"clockDirectionTo",value:function(t){return-Math.sign(this.crossZ(t))}},{key:"rotateByVector",value:function(t,e){e=wm(t,e).unit();return new r(this.x*e.x-this.y*e.y,this.x*e.y+this.y*e.x)}},{key:"toString",value:function(){return"(".concat(this.x,",").concat(this.y,")")}},{key:"toPrimitive",value:function(){return{x:this.x,y:this.y}}}])&&bm(t.prototype,e),n&&bm(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function Om(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Sm(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Em=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Sm(this,"skipNextButtonUpdate",!1),Sm(this,"button",new nm),Sm(this,"dragButton",new nm),Sm(this,"enterButton",new nm),Sm(this,"_pointerLocation",new Tm),Sm(this,"_pointerLastPressLocation",new Tm),Sm(this,"_pointerMoved",!1),Sm(this,"container",void 0),t.addListener("mousemove",this.updateMousePosition,this),t.addListener("mousedown",this.mouseDownHandler,this),t.addListener("mouseup",this.mouseUpHandler,this),t.addListener("mouseupoutside",this.mouseUpHandler,this),t.addListener("mouseover",this.mouseInHandler,this),t.addListener("mouseout",this.mouseOutHandler,this),t.interactive=!0,this.container=t,zI.scene.ticker.add(this.updateButtonState,this)}var t,n,r;return t=e,(n=[{key:"pointerDragging",get:function(){return this.dragButton.down}},{key:"pointerDragStarted",get:function(){return this.dragButton.pressed}},{key:"pointerDragStopped",get:function(){return this.dragButton.released}},{key:"pointerOver",get:function(){return this.enterButton.down}},{key:"pointerIn",get:function(){return this.enterButton.pressed}},{key:"pointerOut",get:function(){return this.enterButton.released}},{key:"pointerLocation",value:function(){return this._pointerLocation.clone()}},{key:"pointerPressedLocation",value:function(){return this._pointerLastPressLocation.clone()}},{key:"pointerMoved",get:function(){return this._pointerMoved}},{key:"clicked",value:function(){return this.button.released&&this.dragButton.up&&!this.dragButton.released}},{key:"destroy",value:function(){this.container.removeListener("mousemove",this.updateMousePosition,this),this.container.removeListener("mousedown",this.mouseDownHandler,this),this.container.removeListener("mouseup",this.mouseUpHandler,this),this.container.removeListener("mouseupoutside",this.mouseUpHandler,this),this.container.removeListener("mouseover",this.mouseInHandler,this),this.container.removeListener("mouseout",this.mouseOutHandler,this),this.container.interactive=!1,zI.scene.ticker.remove(this.updateButtonState,this)}},{key:"updateButtonState",value:function(){this.skipNextButtonUpdate||(this.button.update(this.button.down),this.dragButton.update(this.dragButton.down),this.enterButton.update(this.enterButton.down),this._pointerMoved=!1),this.skipNextButtonUpdate=!1}},{key:"updateMousePosition",value:function(t){t=t.data.getLocalPosition(this.container);this._pointerLocation.set(t),this.button.pressed&&this._pointerLastPressLocation.set(t),this._pointerMoved=!0,this.skipNextButtonUpdate=!0,this.button.down&&2<this._pointerLocation.distance(this._pointerLastPressLocation)&&this.dragButton.update(!0),this.pointerOut&&(this.button.cancel(),this.dragButton.cancel())}},{key:"mouseDownHandler",value:function(t){this.pointerOver&&(this.button.update(!0),this.skipNextButtonUpdate=!0),this.updateMousePosition(t),t.stopPropagation()}},{key:"mouseUpHandler",value:function(t){this.button.update(!1),this.dragButton.update(!1),this.skipNextButtonUpdate=!0,this.updateMousePosition(t),this.pointerOver&&t.stopPropagation()}},{key:"mouseInHandler",value:function(t){this.enterButton.update(!0),this.skipNextButtonUpdate=!0}},{key:"mouseOutHandler",value:function(t){this.enterButton.update(!1),this.skipNextButtonUpdate=!0}},{key:"enabled",get:function(){return this.container.interactive},set:function(t){(this.container.interactive=t)||(this.button.reset(),this.dragButton.reset(),this.enterButton.reset())}}])&&Om(t.prototype,n),r&&Om(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Pm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function km(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Rm=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),km(this,"_name",void 0),km(this,"_point",void 0),km(this,"_lastPoint",void 0),km(this,"_state",void 0),this._name=t||null,this._point=new Tm,this._lastPoint=new Tm,this._state=K1.Up}var t,n,r;return t=e,(n=[{key:"name",get:function(){return this._name}},{key:"point",get:function(){return this._point}},{key:"relativePoint",get:function(){return this._point.subtract(this._lastPoint)}},{key:"framePoint",get:function(){return this._point.multiply(this.relativePoint.abs().ceil())}},{key:"roaming",get:function(){return this._state==K1.Down||this.tilted}},{key:"neutral",get:function(){return this._state==K1.Up||this.returned}},{key:"tilted",get:function(){return this._state==K1.Pressed}},{key:"returned",get:function(){return this._state==K1.Released}},{key:"changed",get:function(){return this.tilted||this.returned}},{key:"update",value:function(t){this._lastPoint.set(this._point),this._point.x=l1.clamp(t.x,-1,1),this._point.y=l1.clamp(t.y,-1,1),this.returned&&(this._state=K1.Up),this.tilted&&(this._state=K1.Down);t=0!=this._point.x||0!=this._point.y;this.neutral&&t&&(this._state=K1.Pressed),this.roaming&&!t&&(this._state=K1.Released)}},{key:"reset",value:function(){this._point.set(0),this._lastPoint.set(0)}}])&&Pm(t.prototype,n),r&&Pm(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Am(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(t,e)||Cm(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cm(t,e){if(t){if("string"==typeof t)return Im(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Im(t,e):void 0}}function Im(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Mm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jm(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Dm,Lm,Nm,Fm=function(){function c(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),jm(this,"defaultToKeyboard",!1),jm(this,"controllerPortNumber",void 0),jm(this,"axis",{leftStick:new Rm("Left Stick"),rightStick:new Rm("Right Stick"),dpad:new Rm("D-Pad")}),jm(this,"button",{B:new nm(new $1(Dm.B,null,Lm.X,null)),A:new nm(new $1(Dm.A,null,Lm.Z,null)),Y:new nm(new $1(Dm.Y,null,Lm.V,null)),X:new nm(new $1(Dm.X,null,Lm.C,null)),leftBumper:new nm(new $1(Dm.leftBumper,null,Lm.S,null)),rightBumper:new nm(new $1(Dm.rightBumper,null,Lm.D,null)),leftTrigger:new nm(new $1(Dm.leftTrigger,null,Lm.Ctrl,null)),rightTrigger:new nm(new $1(Dm.rightTrigger,null,Lm.Shift,null)),select:new nm(new $1(Dm.select,null,Lm.F,null)),start:new nm(new $1(Dm.start,null,Lm.A,null)),leftStick:new nm(new $1(Dm.leftStick,null,Lm.Comma,null)),rightStick:new nm(new $1(Dm.rightStick,null,Lm.Period,null)),dpadUp:new nm(new $1(Dm.dpadUp,null,Lm.UpArrow,null)),dpadDown:new nm(new $1(Dm.dpadDown,null,Lm.DownArrow,null)),dpadLeft:new nm(new $1(Dm.dpadLeft,null,Lm.LeftArrow,null)),dpadRight:new nm(new $1(Dm.dpadRight,null,Lm.RightArrow,null))}),jm(this,"dpadButtons",[this.button.dpadUp,this.button.dpadDown,this.button.dpadLeft,this.button.dpadRight]),this.controllerPortNumber=0,this.reset()}var t,e,n;return t=c,(e=[{key:"reset",value:function(){for(var t in this.axis.leftStick.reset(),this.axis.rightStick.reset(),this.axis.dpad.reset(),this.button)this.button[t].reset()}},{key:"update",value:function(){var t,e=this.getNthGamepad(this.controllerPortNumber);for(t in this.button){var n=this.button[t],r=!1;e&&(null!=n.map.button1&&(r=e.buttons[n.map.button1].pressed),null!=n.map.button2&&(r=e.buttons[n.map.button2].pressed||r)),null!=n.map.key1&&(r=c.keyboard.keyDown(n.map.key1)||r),null!=n.map.key2&&(r=c.keyboard.keyDown(n.map.key2)||r),n.update(r)}var i,o,a,s=(this.button.dpadDown.down?1:0)-(this.button.dpadUp.down?1:0),u=(this.button.dpadRight.down?1:0)-(this.button.dpadLeft.down?1:0);this.axis.dpad.update(new Tm(u,s)),e&&(2==e.axes.length?(o=(i=Am(e.axes,2))[0],a=i[1],this.axis.leftStick.update(new Tm(o,a))):4<=e.axes.length&&(i=(s=Am(e.axes,4))[0],o=s[1],a=s[2],s=s[3],this.axis.leftStick.update(new Tm(i,o)),this.axis.rightStick.update(new Tm(a,s))))}},{key:"getNthGamepad",value:function(t){var e,n=0,r=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Cm(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}(navigator.getGamepads());try{for(r.s();!(e=r.n()).done;){var i=e.value;if(i&&"standard"==i.mapping){if(n==t)return i;n++}}}catch(t){r.e(t)}finally{r.f()}return null}}])&&Mm(t.prototype,e),n&&Mm(t,n),Object.defineProperty(t,"prototype",{writable:!1}),c}();function Bm(t){return(Bm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Um(t){return function(t){if(Array.isArray(t))return Gm(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Gm(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gm(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gm(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Xm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hm(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zm(t){return.001*t}function Vm(t){if("number"==typeof t)return{gap:t,repeat:-1};var e=t.gap,t=t.max;return{gap:e,repeat:t=t<0?-1:Math.max(0,t-1)}}jm(Fm,"keyboard",Nh),(Nh=Dm=Dm||{})[Nh.A=0]="A",Nh[Nh.B=1]="B",Nh[Nh.Y=2]="Y",Nh[Nh.X=3]="X",Nh[Nh.leftBumper=4]="leftBumper",Nh[Nh.rightBumper=5]="rightBumper",Nh[Nh.leftTrigger=6]="leftTrigger",Nh[Nh.rightTrigger=7]="rightTrigger",Nh[Nh.select=8]="select",Nh[Nh.start=9]="start",Nh[Nh.leftStick=10]="leftStick",Nh[Nh.rightStick=11]="rightStick",Nh[Nh.dpadUp=12]="dpadUp",Nh[Nh.dpadDown=13]="dpadDown",Nh[Nh.dpadLeft=14]="dpadLeft",Nh[Nh.dpadRight=15]="dpadRight",(Nh=Lm=Lm||{})[Nh.X=88]="X",Nh[Nh.Z=90]="Z",Nh[Nh.V=86]="V",Nh[Nh.C=67]="C",Nh[Nh.Ctrl=17]="Ctrl",Nh[Nh.D=68]="D",Nh[Nh.Shift=16]="Shift",Nh[Nh.F=70]="F",Nh[Nh.A=65]="A",Nh[Nh.S=83]="S",Nh[Nh.Comma=188]="Comma",Nh[Nh.Period=190]="Period",Nh[Nh.UpArrow=38]="UpArrow",Nh[Nh.DownArrow=40]="DownArrow",Nh[Nh.LeftArrow=37]="LeftArrow",Nh[Nh.RightArrow=39]="RightArrow",(Nh=Nm=Nm||{}).createTimerEvent=function(t){return l1.assignDefaults(t,{until:t.time,interval:t.time,repeat:0,completed:!1,action:function(){},object:t.object,target:t.target,ease:lm.linear.out})},Nh.getSpan=function(t){return t?t.until-t.time:0};var Wm=function(){function o(t,e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),Hm(this,"selfDestruct",!0),Hm(this,"looping",!1),Hm(this,"_destroyed",!1),Hm(this,"_started",!1),Hm(this,"elapsedMillis",0),Hm(this,"events",[]),Hm(this,"recurringEvents",[]),Hm(this,"timeCursor",0),Hm(this,"lastAdded",void 0),Hm(this,"timestampLabels",{}),Hm(this,"dirty",!1),e=null!==e&&void 0!==e?e:o.NULL_ACTION,t&&this.at(t),this.do(e,n),this.updateTicker.add(this.update,this)}var t,e,n;return t=o,n=[{key:"new",value:function(){return(new o).start()}},{key:"at",value:function(t){return o.new().at(t)}},{key:"wait",value:function(t){return o.at(t||0)}},{key:"do",value:function(t,e){return o.new().do(t,e)}},{key:"every",value:function(t,e,n){return o.new().every(t,e,n)}},{key:"transition",value:function(t,e,n){return o.new().transition(t,e,n)}},{key:"transitionEvery",value:function(t,e,n,r){return o.new().transitionEvery(t,e,n,r)}},{key:"tween",value:function(t,e,n,r){return o.new().tween(t,e,n,r)}},{key:"tweenEvery",value:function(t,e,n,r,i){return o.new().tweenEvery(t,e,n,r,i)}}],(e=[{key:"destroyed",get:function(){return this._destroyed}},{key:"started",get:function(){return this._started}},{key:"updateTicker",get:function(){return zI.scene.ticker}},{key:"destroy",value:function(){this._destroyed=!0}},{key:"_destroy",value:function(){this.updateTicker.remove(this.update,this),this.events.forEach(function(t){return l1.destroyObject(t)}),this.events=[],this.recurringEvents=[],this._started=!1,this._destroyed=!0}},{key:"clear",value:function(){this.events.forEach(function(t){return l1.destroyObject(t)}),this.events=[],this.recurringEvents=[]}},{key:"lengthMillis",get:function(){return Math.max.apply(Math,Um(this.events.map(function(t){return t.until})))}},{key:"length",get:function(){return zm(this.lengthMillis)}},{key:"start",value:function(){return this.destroyed||(this._started=!0),this}},{key:"startReset",value:function(){return this.reset(),this.start(),this}},{key:"stop",value:function(){return this._started=!1,this}},{key:"stopReset",value:function(){return this.reset(),this.stop(),this}},{key:"skip",value:function(){this.elapsedMillis=this.lengthMillis,this.update()}},{key:"reset",value:function(){return this.elapsedMillis=0,this.events.forEach(function(t){t.completed=!1,t.snap=void 0}),this.recurringEvents=[],this}},{key:"elapsed",get:function(){return zm(this.elapsedMillis)}},{key:"ticking",get:function(){return this._started&&this.elapsedMillis<this.lengthMillis}},{key:"finished",get:function(){return this.eventsExhausted}},{key:"eventsExhausted",get:function(){return this.events.every(function(t){return t.completed})&&this.recurringEvents.every(function(t){return t.completed})}},{key:"update",value:function(){this.destroyed&&this._destroy(),this._started&&!this.destroyed&&(this.handleEvents(this.events),this.handleEvents(this.recurringEvents),this.cullRecurringEvents(),this.elapsedMillis+=zI.deltaMS,this.eventsExhausted&&(this.looping?this.reset():this.selfDestruct&&this._destroy()))}},{key:"handleEvents",value:function(t){var n=this,r=this.elapsedMillis;t.forEach(function(t){var e;r<t.time||t.completed||(1===(e=t.until>t.time?l1.clamp((r-t.time)/(t.until-t.time),0,1):1)&&(t.completed=!0,t.snap=void 0),t.action.call(t.context,t.ease(e)),t.object&&t.target&&(t.snap||(t.snap=n.createSnap(t.object,t.target)),n.updateTween(t.object,t.snap,t.target,t.ease(e))),t.completed&&0!==t.repeat&&n.extendRecurringEvent(t))})}},{key:"createSnap",value:function(t,e){var s=t;return function t(e,n,r){if(null!==e&&0!==r&&!Object.values(e).some(function(t){return t===s})){var i,o={};for(i in n){var a=Bm(n[i]);"number"===a&&(o[i]=e[i]),"object"===a&&(a=[e[i],n[i]],o[i]=t(a[0],a[1],r-1))}return o}}(t,e,3)}},{key:"updateTween",value:function(t,e,n,r){if(!0!==t.destroyed)for(var i in n)if(void 0!==t[i]){var o=Bm(t[i]);if("object"===o){var a=[t[i],e[i],n[i]];this.updateTween(a[0],a[1],a[2],r)}else{if("number"!==o)throw new Error("Property of object '".concat(i,"' was of type '").concat(o,"' but expected object or number."));a=[e[i],n[i]],o=a[0];t[i]=(a[1]-o)*r+o}}}},{key:"extendRecurringEvent",value:function(t){var e=t.interval,n=t.action,r=t.context,i=t.object,o=t.target,a=t.ease,s=t.until+t.interval,u=s+(t.until-t.time),t=t.repeat<0?-1:Math.max(t.repeat-1,0),a=Nm.createTimerEvent({time:s,until:u,interval:e,repeat:t,action:n,context:r,object:i,target:o,ease:a});this.recurringEvents.push(a)}},{key:"cullRecurringEvents",value:function(){this.recurringEvents=this.recurringEvents.filter(function(t){return!t.completed})}},{key:"sortEvents",value:function(){return this.dirty&&this.events.sort(function(t,e){return t.time-e.time}),this}},{key:"noSelfDestruct",value:function(){return this.selfDestruct=!1,this}},{key:"loop",value:function(){return this.looping=!0,this}},{key:"at",value:function(t){if("end"===t)t=this.lengthMillis;else if("string"==typeof t){if(!this.timestampLabels[t])throw new Error("No label '".concat(t,"' exists among saved timestamps. Has it been recorded yet?"));t=this.timestampLabels[t]}else t*=1e3;return this.timeCursor=Math.max(t,0),this.lastAdded=void 0,this}},{key:"wait",value:function(t){return t?t*=1e3:t=Nm.getSpan(this.lastAdded),this.timeCursor+=Math.max(t,0),this.lastAdded=void 0,this}},{key:"label",value:function(t){if("end"===t)throw new Error("Cannot save a timestamp label 'end'; reserved keyword.");return this.timestampLabels[t]=this.timeCursor,this}},{key:"addEvent",value:function(t){this.events.push(t),this.lastAdded=t}},{key:"do",value:function(t,e){var n=this.timeCursor,e=Nm.createTimerEvent({time:n,action:t,context:e});return this.addEvent(e),this}},{key:"every",value:function(t,e,n){var r=this.timeCursor,i=Vm(t),o=i.gap,i=i.repeat,n=Nm.createTimerEvent({time:r,interval:t=1e3*o,repeat:i,action:e,context:n});return this.addEvent(n),this}},{key:"transition",value:function(t,e,n){var r=this.timeCursor,n=Nm.createTimerEvent({time:r,until:1e3*t+r,action:e,context:n});return this.addEvent(n),this}},{key:"transitionEvery",value:function(t,e,n,r){var i=this.timeCursor,o=1e3*e+i,a=Vm(t),e=a.gap,a=a.repeat,r=Nm.createTimerEvent({time:i,until:o,interval:t=1e3*e,repeat:a,action:n,context:r});return this.addEvent(r),this}},{key:"tween",value:function(t,e,n,r){r=r||lm.linear.out;var i=this.timeCursor,r=Nm.createTimerEvent({time:i,until:1e3*t+i,object:e,target:n,ease:r});return this.addEvent(r),this}},{key:"tweenEvery",value:function(t,e,n,r,i){i=i||lm.linear.out;var o=this.timeCursor,a=1e3*e+o,s=Vm(t),e=s.gap,s=s.repeat,i=Nm.createTimerEvent({time:o,until:a,interval:t=1e3*e,repeat:s,object:n,target:r,ease:i});return this.addEvent(i),this}},{key:"schedule",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach(function(t){e.addEvent(Nm.createTimerEvent(t))}),this}}])&&Xm(t.prototype,e),n&&Xm(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function Ym(t){return(Ym="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Km(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zm(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qm(n){var r=tv();return function(){var t,e=nv(n);return function(t,e){{if(e&&("object"===Ym(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=nv(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function $m(t){var n="function"==typeof Map?new Map:void 0;return function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return Jm(t,arguments,nv(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),ev(e,t)}(t)}function Jm(t,e,n){return(Jm=tv()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);r=new(Function.bind.apply(t,r));return n&&ev(r,n.prototype),r}).apply(null,arguments)}function tv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function ev(t,e){return(ev=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function nv(t){return(nv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Hm(Wm,"NULL_ACTION",function(){}),Hm(Wm,"NULL_EVENT",Nm.createTimerEvent({time:0,action:Wm.NULL_ACTION}));var rv=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ev(t,e)}(r,$m(Error));var n=Qm(r);function r(t,e){return Zm(this,r),(e=n.call(this,"".concat(t,"  ").concat(e))).name="StateTransitionError",e}return r}(),iv=function(){function t(){Zm(this,t),Km(this,"_machine",void 0),Km(this,"_exit",0),Km(this,"queueChange",0),Km(this,"_destroyed",!1),Km(this,"sysinitComplete",!1)}var e,n,r;return e=t,(n=[{key:"DOMAIN",get:function(){return"".concat(this.machine.DOMAIN,".").concat(this.name)}},{key:"machine",get:function(){if(!this._machine)throw"".concat(this.name,": Attempted to access reference to state-controller before that reference was filled. Has sysinit() been called?");return this._machine}},{key:"assets",get:function(){return this.machine.assets}},{key:"exit",get:function(){return this._exit}},{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.onDestroy(),this._destroyed=!0,this._machine=void 0}},{key:"sysinit",value:function(t){this.sysinitComplete?O1.log(this.DOMAIN,"SysInit",{message:"Rejecting sysinit request from ".concat(t.DOMAIN),reason:"State object already initialized.",warn:!0}):(this.sysinitComplete=!0,this._machine=t)}},{key:"wake",value:function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).fromRegress,t=void 0!==t&&t;try{this.machine.unqueue(this,this.queueChange),this.queueChange=0,this.assets.resetAssets(),t?this.onRegress():this.onAdvance(),this.configure()}catch(t){O1.log(this.DOMAIN,"Wake",{message:"".concat(t),error:!0}),this.machine.failToPreviousState(this),O1.print(this.machine.getStackTrace())}}},{key:"failTransition",value:function(t){throw 0===this._exit&&(this._exit=-1),new rv(this.name,t)}},{key:"onDestroy",value:function(){}},{key:"onAdvance",value:function(){}},{key:"onRegress",value:function(){}},{key:"updateSystem",value:function(){}},{key:"updateInput",value:function(){}},{key:"close",value:function(){}},{key:"prev",value:function(){}},{key:"advance",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=this.machine).advance.apply(t,[this].concat(n))&&(this.queueChange=n.length)}},{key:"regress",value:function(){this.machine.regress(this)}},{key:"regressTo",value:function(t){return this.machine.regressTo(this,t)}}])&&qm(e.prototype,n),r&&qm(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ov(t){return(ov="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function av(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function sv(t,e){return(sv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function uv(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=cv(n);return function(t,e){{if(e&&("object"===ov(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=cv(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function cv(t){return(cv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var lv=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sv(t,e)}(i,iv);var t,e,n,r=uv(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"Null"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!0}},{key:"configure",value:function(){}}])&&av(t.prototype,e),n&&av(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function hv(t){return function(t){if(Array.isArray(t))return pv(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||fv(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fv(t,e){if(t){if("string"==typeof t)return pv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pv(t,e):void 0}}function pv(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function dv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yv(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var mv;(Nh=mv=mv||{})[Nh.None=0]="None",Nh[Nh.NoneFromRegress=1]="NoneFromRegress",Nh[Nh.Next=2]="Next",Nh[Nh.Previous=3]="Previous",Nh[Nh.PreviousOnFail=4]="PreviousOnFail",Nh[Nh.SystemFailure=5]="SystemFailure",Nh[Nh.NextFromRegress=6]="NextFromRegress";var vv,gv,bv,_v,xv,wv=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),yv(this,"DOMAIN",void 0),yv(this,"assets",void 0),yv(this,"transitionIntent",mv.None),yv(this,"NULL_STATE",new lv),yv(this,"regressTarget",void 0),yv(this,"stack",[]),yv(this,"stackTrace",[]),yv(this,"queue",[]),this.DOMAIN="SM_".concat(t.name),this.assets=t.assets,this.pushQueue([t.entryPoint]),this.advance(this.NULL_STATE),zI.scene.ticker.add(this.update,this)}var t,n,r;return t=e,(n=[{key:"regressTargetLogString",get:function(){var t=null===(e=this.regressTarget)||void 0===e?void 0:e.name,e=this.regressTarget instanceof iv?" (obj)":" (class)";return"".concat(t).concat(e)}},{key:"destroy",value:function(){this.NULL_STATE.destroy(),this.NULL_STATE=void 0,this.assets.destroy(),this.stack.forEach(function(t){t.destroy()}),zI.scene.ticker.remove(this.update,this)}},{key:"currentState",get:function(){var t=this.stack[this.stack.length-1];return t||this.NULL_STATE}},{key:"update",value:function(){if(this.assets.update(),zI.devController.pressed(am.P)&&O1.ping(this.getStackTrace()),this.transitionIntent!==mv.SystemFailure)try{for(;this.transitionIntent==mv.Next||this.transitionIntent==mv.NextFromRegress;){if(0===this.queue.length)throw new Error("Cannot advance to next in queue: queue is empty.");var t=this.transitionIntent===mv.NextFromRegress?"":"";this.transitionIntent=mv.None;var e=this.currentState;this.currentState.close();var n=this.currentState.exit;this.log(t,"".concat(this.currentState.name),n);var r=this.queue.shift();this.stack.push(r),r.wake(),O1.log(this.DOMAIN,"HandleAdvanceToState",{message:"Advanced from '".concat(e.name,"' to '").concat(r.name,"'")}),this.cullNonRevertibles()}if(this.transitionIntent==mv.None||this.transitionIntent==mv.NoneFromRegress)try{this.currentState.updateSystem(),this.assets.suspendInteractivity()||this.currentState.updateInput()}catch(t){O1.log(this.DOMAIN,"StateUpdate",{message:"Attempting to regress to previous state from ".concat(this.currentState.name,"."),reason:"".concat(t),error:!0}),this.failToPreviousState(this.currentState)}for(;this.transitionIntent==mv.Previous||this.transitionIntent==mv.PreviousOnFail;){if(this.stackFailureLoop())throw new Error("Infinite failure loop detected.");if(this.currentState===this.NULL_STATE)throw new Error("Cannot revert state from null.");if(!this.currentState.revertible)throw new Error("Cannot revert unrevertible state ".concat(this.currentState.name,". RegressTarget=").concat(this.regressTargetLogString));var i=this.stack.pop();this.queue.unshift(i),this.transitionIntent===mv.Previous?(i.close(),i.prev(),this.log("","".concat(i.name),i.exit)):this.transitionIntent===mv.PreviousOnFail&&(this.log("","".concat(i.name),i.exit),this.transitionIntent=mv.Previous);var o=!1,a=this.regressTarget===this.currentState||this.regressTarget===this.currentState.type,s=!this.regressTarget,u=!1===this.currentState.skipOnUndo;(a||s&&u)&&(this.transitionIntent=mv.NoneFromRegress,this.currentState.wake({fromRegress:!0}),o=!0),O1.log(this.DOMAIN,"HandleRegressToState",{message:"Regressed from '".concat(i.name,"' to '").concat(this.currentState.name,"'; ").concat(o?"state did wake.":"state did not wake.")})}}catch(t){throw O1.ping(this.getStackTrace()),this.transitionIntent=mv.SystemFailure,t}}},{key:"isSelfsameState",value:function(t){return this.currentState===t||(O1.log(this.DOMAIN,"RequestAction_VerifySource",{message:"Rejecting intent.",reason:"Request from '".concat(t.name,"' does not match active state ('").concat(this.currentState.name,"')."),warn:!0}),!1)}},{key:"isAlreadyTransitioning",value:function(t){return!!this.transitioning&&(O1.log(this.DOMAIN,"RequestAction_VerifyIdle",{message:"Rejecting intent to transition by '".concat(t.name,"'."),reason:"A transition is already in progress.",warn:!0}),!0)}},{key:"transitioning",get:function(){return this.transitionIntent!==mv.None&&this.transitionIntent!==mv.NoneFromRegress}},{key:"pushQueue",value:function(t){var e=this,n=t.map(function(t){t=t instanceof iv?t:new t;return t.sysinit(e),t});(t=this.queue).unshift.apply(t,hv(n))}},{key:"unqueue",value:function(t,e){this.isSelfsameState(t)&&(this.queue.slice(0,e).forEach(function(t){return t.destroy()}),this.queue=this.queue.slice(e))}},{key:"advance",value:function(t){if(!this.isSelfsameState(t)||this.isAlreadyTransitioning(t))return!1;for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.pushQueue(n),this.transitionIntent=mv.Next,35<=this.queue.length&&O1.log(this.DOMAIN,"QueueNewStates",{message:"TurnMachine: queue is ".concat(this.queue.length," members long; warning level is ").concat(35,"."),warn:!0}),!0}},{key:"regress",value:function(t){return!(!this.isSelfsameState(t)||this.isAlreadyTransitioning(t))&&(this.transitionIntent=mv.Previous,!0)}},{key:"regressTo",value:function(t,e){if(!this.isSelfsameState(t)||this.isAlreadyTransitioning(t))return!1;var n,r=!1,i=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=fv(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}(this.stack.slice().reverse());try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o===e||o.type===e){r=!0;break}if(!o.revertible)break}}catch(t){i.e(t)}finally{i.f()}return r&&(this.transitionIntent=mv.Previous,this.regressTarget=e),r}},{key:"getState",value:function(t){for(var e=this.stack.length;0<e--;)if(this.stack[e].type===t)return this.stack[e]}},{key:"cullNonRevertibles",value:function(){for(var t,e,n=-1,r=Math.max(0,this.stack.length-20);0<r--;)if(!1===(null===(t=this.stack[r])||void 0===t?void 0:t.revertible)){n=r;break}0<n&&(e=this.stack.slice(0,n),this.stack=this.stack.slice(n),e.forEach(function(t){return t.destroy()}),O1.log(this.DOMAIN,"CullStateStack",{message:"Culled ".concat(n," unreachable turnstates.")}))}},{key:"failToPreviousState",value:function(t){if(0!=this.isSelfsameState(t)){if(!(1<this.stack.length))throw O1.ping(this.getStackTrace()),new Error("BattleSystemManager failed to advance state but has no state to revert to.");this.transitionIntent=mv.PreviousOnFail}}},{key:"stackFailureLoop",value:function(){var t=l1.repeatingSequence(this.stackTrace.map(function(t){return t.exit||0}).reverse(),5),e=0<t.length,t=t.some(function(t){return t<0});return e&&t}},{key:"log",value:function(t,e,n){this.stackTrace.push({msg:e,mode:t,exit:n}),20<this.stackTrace.length&&this.stackTrace.shift()}},{key:"getStackTrace",value:function(){var t=this.queue;t.slice().map(function(t,e){return"".concat("".concat(e).padStart(2,"0"),": ").concat(t.name)}).reverse().join("\n");var e=this.transitionIntent===mv.PreviousOnFail?"":this.transitionIntent===mv.NoneFromRegress?"":"",n="cur: ".concat(e," ").concat(this.currentState.exit," ").concat(this.currentState.name),e=this.stackTrace.map(function(t,e){var n=t.msg,r=t.mode,t=t.exit;return"".concat("".concat(e).padStart(2,"0"),": ").concat(r," ").concat(t," ").concat(n)}).reverse().join("\n");return"State History for '".concat(this.DOMAIN,"' (last ").concat(20,"):\nQueue\n").concat(t,"\n").concat(n,"\n").concat(e)}}])&&dv(t.prototype,n),r&&dv(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Tv(t){return["Inftry","Veh","Air","Heli","Ship","Sub"][t]}(Nh=vv=vv||{})[Nh.Infantry=0]="Infantry",Nh[Nh.Mech=1]="Mech",Nh[Nh.TireA=2]="TireA",Nh[Nh.TireB=3]="TireB",Nh[Nh.Tread=4]="Tread",Nh[Nh.Air=5]="Air",Nh[Nh.Ship=6]="Ship",Nh[Nh.Transport=7]="Transport",(Nh=gv=gv||{})[Nh.Infantry=0]="Infantry",Nh[Nh.Vehicle=1]="Vehicle",Nh[Nh.Air=2]="Air",Nh[Nh.Heli=3]="Heli",Nh[Nh.Ship=4]="Ship",Nh[Nh.Sub=5]="Sub",(Nh=bv=bv||{})[Nh.None=0]="None",Nh[Nh.Primary=1]="Primary",Nh[Nh.Secondary=2]="Secondary",(Nh=_v=_v||{})[Nh.None=0]="None",Nh[Nh.Ground=1]="Ground",Nh[Nh.Naval=2]="Naval",Nh[Nh.Air=3]="Air",(Nh=xv=xv||{})[Nh.None=0]="None",Nh[Nh.Neutral=1]="Neutral",Nh[Nh.Red=2]="Red",Nh[Nh.Blue=3]="Blue",Nh[Nh.Yellow=4]="Yellow",Nh[Nh.Black=5]="Black";var Ov,Sv,Ev=["white","white","red","blue","yellow","black"];function Pv(t){return function(t){if(Array.isArray(t))return kv(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return kv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kv(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kv(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Rv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Av(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}(Nh=Ov=Ov||{})[Nh.Left=0]="Left",Nh[Nh.Right=1]="Right",(Nh=pR=pR||{})[Nh.Normal=0]="Normal",Nh[Nh.Snow=1]="Snow",Nh[Nh.Ruin=2]="Ruin",Nh[Nh.Desert=3]="Desert",(Nh=yR=yR||{})[Nh.Clear=0]="Clear",Nh[Nh.Snow=1]="Snow",Nh[Nh.Sandstorm=2]="Sandstorm",Nh[Nh.Rain=3]="Rain",Nh[Nh.FogOfWar=4]="FogOfWar",Nh[Nh.Dynamic=5]="Dynamic",(Sv=Sv=Sv||{})[Sv.Balanced=0]="Balanced",Sv[Sv.Aggressive=1]="Aggressive",Sv[Sv.Defensive=2]="Defensive",(Mv=Mv=Mv||{})[Mv.Wait=0]="Wait",Mv[Mv.Attack=1]="Attack",Mv[Mv.Capture=2]="Capture",Mv[Mv.Supply=3]="Supply",Mv[Mv.Flare=4]="Flare",Mv[Mv.SelfDestruct=5]="SelfDestruct",Mv[Mv.Join=6]="Join",Mv[Mv.Load=7]="Load",Mv[Mv.Unload=8]="Unload",Mv[Mv.SpawnUnit=9]="SpawnUnit",Mv[Mv.SpawnLoadUnit=10]="SpawnLoadUnit",Mv[Mv.Destroy=11]="Destroy",Mv[Mv.LoadCO=12]="LoadCO",Mv[Mv.Silo=13]="Silo",Mv[Mv.EndTurn=14]="EndTurn";var Cv,Iv,Mv,jv,Dv="MapLayerSys",Lv=[{key:"sea"},{key:"bottom",children:[{key:"static",freezable:!0},{key:"animated"}]},{key:"top",rowSegmented:!0,children:[{key:"static",freezable:!0},{key:"animated"},{key:"glass-tile"},{key:"unit"}]},{key:"cloud-shadow"},{key:"ui"}],Nv=function(){function a(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),Av(this,"_path",void 0),Av(this,"_name",void 0),Av(this,"container",void 0),Av(this,"properties",void 0),Av(this,"children",void 0),this.container=new T.Container,this.properties=t,this.children=[],this._name=t.key,this._path=e?[].concat(Pv(e._path),[t.key]):[t.key]}var t,e,n;return t=a,(e=[{key:"path",get:function(){return this._path.join("/")}},{key:"name",get:function(){return this._name}},{key:"lazyBuildChildren",value:function(t){if(this.properties.rowSegmented)for(var e=this.children.length;e<=t;e++){var n=new a({key:String(e),children:this.properties.children},this);this.container.addChild(n.container),this.children.push(n)}else for(var r=this.properties.children||[],i=this.children.length;i<r.length;i++){var o=new a(r[i],this);this.container.addChild(o.container),this.children.push(o)}}},{key:"getChild",value:function(e){var n=this.path;function t(t){throw new ReferenceError("Can't parse path ".concat(n," by '").concat(e,"'; ").concat(t))}this.properties.children||t("no children.");var r=-1;return"string"==typeof e?(this.properties.rowSegmented&&t("layer is row indexed."),this.lazyBuildChildren(-1),-1===(r=this.children.findIndex(function(t){return t.properties.key===e}))&&t("key does not exist")):"number"==typeof e&&(this.properties.rowSegmented||t("layer is string indexed"),this.lazyBuildChildren(e),r=e),this.children[r]}},{key:"freeze",value:function(){this.children.forEach(function(t){return t.freeze()}),this.container.cacheAsBitmap=this.properties.freezable||!1}},{key:"update",value:function(){this.children.forEach(function(t){return t.update()});var t=this.container.cacheAsBitmap;this.container.cacheAsBitmap=!1,this.container.cacheAsBitmap=t}}])&&Rv(t.prototype,e),n&&Rv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}();function Fv(){if(Iv.isDestroyed())throw new Error("Attempting to access MapLayer system before construction; run MapLayerFunctions.Init() first.");for(var e=Cv,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach(function(t){e=e.getChild(t)}),e.container}Mv=Iv=Iv||{},jv=!0,Mv.isDestroyed=function(){return jv},Mv.Init=function(){jv?(Cv=new Nv({key:"root",children:Lv}),zI.scene.visualLayers.stage.addChild(Cv.container),jv=!1,O1.log(Dv,"Initialization")):O1.log(Dv,"Initialization",{message:"Initialization request rejected",reason:"Already initialized"})},Mv.Destroy=function(){jv||(Cv.container.destroy({children:!0}),jv=!0,O1.log(Dv,"Destruction"))},Mv.RowLayerFromWorldPosition=function(t){return Math.floor(t.y/zI.display.standardLength)},Mv.FreezeStaticLayers=function(){jv||(Cv.freeze(),O1.log(Dv,"SysFunc",{message:"Static visual components frozen to prevent redraw"}))},Mv.RerenderStaticLayers=function(){jv||Cv.update()},Mv.SortLayer=function(){!function t(e){e.children.forEach(t),e.sortChildren()}(Fv.apply(void 0,arguments)),O1.log(Dv,"LayerSorting")},Mv.Report=function(){O1.ping("MapLayer Paths",function e(t){var n=[t.path];return t.children.forEach(function(t){n.push(e(t))}),n.join("\n")}(Cv))};function Bv(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Uv=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Bv(this,"uniforms",{}),Bv(this,"filter",new T.Filter("","\r\nprecision mediump float;\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\nvoid main() {\r\n  float alpha = texture2D(uSampler, vTextureCoord).a;\r\n  gl_FragColor = vec4(alpha);\r\n}\r\n",this.uniforms))};function Gv(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Xv=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Gv(this,"uniforms",{origin:[0,0],slider:0,seed:0}),Gv(this,"filter",new to("","// #version 300 es    // WebGL2, but I don't know anything.\r\n\r\nprecision mediump float;\r\n\r\nvarying vec2 vTextureCoord;   // PIXI\r\nuniform sampler2D uSampler;\r\n\r\nuniform vec2 origin;          // Custom  These match the imported uniforms\r\n// uniform float time;\r\n// uniform float maxTime;\r\nuniform int seed;\r\n// uniform float mean;\r\n// uniform float std_deviation;\r\n\r\nfloat mean = .5;              // Custom  Test vals\r\nfloat std_deviation = .25;\r\n\r\nfloat max_brightness = .6;    // Dev settings, toggles, etc.\r\n\r\nconst float PI = 3.142;       // Constants\r\nconst float E  = 2.718;\r\n\r\n\r\nfloat gauss_distribution(float x) {\r\n  float e_exponent = -.5*pow((x - mean) / std_deviation, 2.0);\r\n  float e = pow(E, e_exponent);\r\n  float n = 1.0 / (std_deviation * sqrt(2.0 * PI)) * e;\r\n  return n;\r\n}\r\n\r\nfloat noiseAtPoint(vec4 p) {\r\n  float x = gauss_distribution(p.x / u_resolution.x);\r\n  float y = gauss_distribution(p.y / u_resolution.y);\r\n  return x;\r\n}\r\n\r\n\r\n\r\nvoid main() {\r\n  // vec4 base = texture2D(uSampler, vTextureCoord);\r\n\r\n  float n = noiseAtPoint(a_normal);\r\n\r\n  gl_FragColor = vec4(n, n, n, 1.0);\r\n}\r\n",this.uniforms)),this.uniforms.origin=[e.x,e.y]};function Hv(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var zv=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Hv(this,"uniforms",{}),Hv(this,"filter",new T.Filter("","\r\nprecision mediump float;\r\nvarying vec2 vTextureCoord;   // PIXI\r\nuniform sampler2D uSampler;\r\n\r\nfloat gate = .525;\r\nfloat gateRange = .15;\r\n\r\nfloat width = 16.0*20.0;\r\nfloat height = 16.0*12.0;\r\n\r\nfloat pick(float lum, float a, float b, float coefficient) {\r\n  float lim = (gateRange*coefficient) + gate - gateRange/2.0;\r\n  return (lum > lim) ? b : a;\r\n}\r\n\r\nfloat quantize(float n) {\r\n  float q = 4.0;\r\n  return floor(n * q) / q;\r\n}\r\n\r\nvoid main() {\r\n  vec4 base = texture2D(uSampler, vTextureCoord);\r\n  float lum = (0.2126*base.r + 0.7152*base.g + 0.0722*base.b);\r\n  // float lum = (base.r + base.g + base.b)/3.0;\r\n\r\n  vec2 coord = vTextureCoord * vec2(width,height);\r\n  coord = vec2(floor(coord.x), floor(coord.y));\r\n\r\n  float lightGate = quantize(mod(coord.x, 2.0)) * quantize(mod(coord.y, 2.0)) / 2.0;\r\n\r\n  vec4 black = vec4(0, 0, 0, 1);\r\n  vec4 gray = vec4(.20, .15, .20, 1);\r\n\r\n  vec4 color = vec4(\r\n    pick(lum, black.r, gray.r, lightGate),\r\n    pick(lum, black.g, gray.g, lightGate),\r\n    pick(lum, black.b, gray.b, lightGate),\r\n    1\r\n  );\r\n\r\n  gl_FragColor = color;\r\n}",this.uniforms))};function Vv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wv(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Yv,qv=function(){function r(t,e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),Wv(this,"uniforms",{dimensions:[16,32],maxTime:1,time:0}),Wv(this,"filter",new T.Filter("","\r\nprecision mediump float;\r\nvarying vec2 vTextureCoord;   // PIXI\r\nuniform sampler2D uSampler;\r\n\r\nuniform vec2 dimensions;      // Custom\r\nuniform float maxTime;\r\nuniform float time;\r\n\r\nfloat max_brightness = .6;    // Settings\r\nfloat light_diffusion = .7;     // lower is more diffuse; default is 1.0\r\n\r\nfloat brightness(vec2 a, vec2 b) {\r\n  float light_width = min(dimensions.x, dimensions.y) * .90;\r\n\r\n  float grad = distance(a, b) / light_width;\r\n  grad = clamp(1.0 - grad, 0.0, max_brightness);\r\n  grad = pow(grad, light_diffusion);    // Brightens the middle\r\n  return grad;\r\n}\r\n\r\nvec2 pixelate(vec2 a) {\r\n  return vec2(\r\n    floor(a.x * 16.0) / 16.0,\r\n    floor(a.y * 16.0) / 16.0\r\n  );\r\n}\r\n\r\nvoid main() {\r\n  vec4 base = texture2D(uSampler, vTextureCoord);\r\n\r\n  vec4 c1 = vec4(vec3(0.6), 1.0);   // Root color.\r\n  vec4 c2 = vec4(1.0);              // Spotlight color.\r\n\r\n  vec2 light_dimensions = vec2(dimensions.x, dimensions.y / 2.0);\r\n  vec2 light_offset = vec2(0.0, dimensions.y / 2.0);\r\n  \r\n  vec2 pos = pixelate(vTextureCoord) * dimensions;\r\n\r\n  float angle = time/maxTime * 3.14;\r\n  \r\n  vec2 lightsource = pixelate(vec2(\r\n    clamp(sin(angle)*.7+.5, 0.0, 1.0),\r\n    clamp(cos(angle)*.7+.5, 0.0, 1.0)\r\n  )) * light_dimensions + light_offset;\r\n  \r\n  float intensity = brightness(pos, lightsource);\r\n  \r\n  vec4 color = mix(c1, c2, intensity);\r\n  color *= base.a * 1.1;\r\n  \r\n  gl_FragColor = color;\r\n}\r\n",this.uniforms)),this.uniforms.dimensions=[t,e],this.uniforms.maxTime=n}var t,e,n;return t=r,(e=[{key:"update",value:function(t){this.uniforms.time+=.03*t}}])&&Vv(t.prototype,e),n&&Vv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}(),Kv=i;function Zv(t){return function(t){if(Array.isArray(t))return Qv(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Qv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qv(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qv(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Jv(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}!function(t){var e=t.spotlightFilter=new Kv.TileSpotlight(16,32,2.5);t.startSpotlightFilter=function(){zI.scene.ticker.remove(e.update,e),zI.scene.ticker.add(e.update,e)};var n=t.shorelineFilter=new Ry([[0,0],[0,0],[0,0],[0,0]],.015),r=t.shorelinePaletteSwaps=[[[13033199,13494007],[7183822,9876950],[6519708,6123404],[10270158,9876950]],[[13033199,13231607],[7183822,9745622],[6519708,6057620],[10270158,9745622]],[[13033199,12575991],[7183822,9087702],[6519708,6452628],[10270158,9087702]],[[13033199,12311023],[7183822,8956878],[6519708,6847900],[10270158,8956878]],[[13033199,11590127],[7183822,8430030],[6519708,6716572],[10270158,8430030]],[[13033199,11390951],[7183822,8364742],[6519708,7045797],[10270158,8364742]],[[13033199,10735847],[7183822,8035270],[6519708,6917037],[10270158,8035270]],[[13033199,10535911],[7183822,7903686],[6519708,7440557],[10270158,7903686]],[[13033199,10339806],[7183822,7377085],[6519708,7508917],[10270158,7377085]],[[13033199,9681374],[7183822,7508669],[6519708,8163773],[10270158,7508669]],[[13033199,9813206],[7183822,7113653],[6519708,8298173],[10270158,7113653]],[[13033199,9482966],[7183822,7244981],[6519708,8890054],[10270158,7244981]],[[13033199,9679830],[7183822,6918061],[6519708,9087174],[10270158,6918061]],[[13033199,9285070],[7183822,6981549],[6519708,9679054],[10270158,6981549]],[[13033199,9482190],[7183822,6588589],[6519708,10402262],[10270158,6588589]],[[13033199,9152710],[7183822,6717861],[6519708,10599126],[10270158,6717861]]],i=0,o=0;function a(){var t;6<(i+=zI.delta)&&(i-=6,t=15<o?r[31-o]:r[o],n.replacements=t,31<++o&&(o=0))}function s(t){t=t.x+1e3*t.y+1e3,t=l1.createMulberry32(t),t=Math.trunc(24*t());return"".concat(6<t?0:t)}function u(t){var e=t.up.landTile?1:0,n=t.right.landTile?1:0,r=t.down.landTile?1:0,i=t.left.landTile?1:0;return 1==(e=t.upright.landTile&&0==e&&1!=n?2:e)+(n=t.downright.landTile&&0==n&&1!=r?2:n)+(r=t.downleft.landTile&&0==r&&1!=i?2:r)+(i=t.upleft.landTile&&0==i&&1!=e?2:i)&&(t.up.type==Tg.River&&(e=3),t.right.type==Tg.River&&(n=3),t.down.type==Tg.River&&(r=3),t.left.type==Tg.River&&(i=3)),"".concat(e).concat(n).concat(r).concat(i)}function c(t){var e=t.up.shallowWater||t.up.landTile,n=t.upleft.shallowWater||t.upleft.landTile,r=t.upright.shallowWater||t.upright.landTile,i=t.down.shallowWater||t.down.landTile,o=t.downleft.shallowWater||t.downleft.landTile,a=t.downright.shallowWater||t.downright.landTile,s=t.left.shallowWater||t.left.landTile,t=t.right.shallowWater||t.right.landTile,a=i&&a&&t?1:0,o=i&&o&&s?1:0,s=e&&n&&s?1:0;return"".concat(e&&r&&t?1:0).concat(a).concat(o).concat(s)}function l(t,e,n){t=n===Tg.Meteor?"crater":n===Tg.Plasma?e?[r(e.up),r(e.right),r(e.down),r(e.left)].join(""):"0000":s(t);function r(t){return t instanceof Tg.Plain&&t.prevTileType===Tg.Plasma?1:0}return new T.Sprite(Sg.sheet.textures["plain-".concat(t,".png")])}function h(t){for(var e=[],n=0,r=[Ev[xv.Neutral],Ev[xv.Red],Ev[xv.Blue],Ev[xv.Yellow],Ev[xv.Black]];n<r.length;n++){var i=r[n];e.push(Sg.sheet.textures["".concat(t,"-").concat(i,".png")])}return new T.AnimatedSprite(e)}t.animateShoreline=a,t.startPaletteAnimation=function(){n.resolution=zI.renderer.resolution,Fv("bottom").filters=[n],zI.scene.ticker.add(a)},t.stopPaletteAnimation=function(){!1===Iv.isDestroyed()&&(Fv("bottom").filters=[]),zI.scene.ticker.remove(a)},t.addSeaLayer=function(t,e){var n=new T.AnimatedSprite(Sg.sheet.animations.sea),r=new T.TilingSprite(n.texture,t,e);Fv("sea").addChild(r),n.onFrameChange=function(){r.texture=n.texture},n.animationSpeed=.1,n.play()},t.removeSeaLayer=function(){},t.randomPlainTile=s,t.randomTileVariant=function(t,e){return t=t.x+1e3*t.y,t=l1.createMulberry32(t),e=Math.trunc(t()*e),"".concat(e)},t.seaCliffVariant=u,t.seaShallowVariant=c,t.beachVariant=function(t){var e=t.up.landTile?1:0,n=t.right.landTile?1:0,r=t.down.landTile?1:0,i=t.left.landTile?1:0;return e=t.up.type==Tg.Beach?2:e,n=t.right.type==Tg.Beach?2:n,r=t.down.type==Tg.Beach?2:r,i=t.left.type==Tg.Beach?2:i,"".concat(e).concat(n).concat(r).concat(i)},t.fourDirectionalVariant=function(e){for(var n=0,r=0,i=0,o=0,t=arguments.length,a=new Array(1<t?t-1:0),s=1;s<t;s++)a[s-1]=arguments[s];return a.forEach(function(t){n=e.up.type==t?1:n,r=e.right.type==t?1:r,i=e.down.type==t?1:i,o=e.left.type==t?1:o}),e.center.type==Tg.Bridge&&(n=e.up.landTile&&e.up.type!=Tg.River&&e.up.type!=Tg.Mountain&&e.up.type!=Tg.Fire?1:n,r=e.right.landTile&&e.right.type!=Tg.River&&e.right.type!=Tg.Mountain&&e.right.type!=Tg.Fire?1:r,i=e.down.landTile&&e.down.type!=Tg.River&&e.down.type!=Tg.Mountain&&e.down.type!=Tg.Fire?1:i,o=e.left.landTile&&e.left.type!=Tg.River&&e.left.type!=Tg.Mountain&&e.left.type!=Tg.Fire?1:o),e.center.type==Tg.River&&(n=e.up.landTile||e.up.type==Tg.Beach?n:1,r=e.right.landTile||e.right.type==Tg.Beach?r:1,i=e.down.landTile||e.down.type==Tg.Beach?i:1,o=e.left.landTile||e.left.type==Tg.Beach?o:1),e.center.type==Tg.Road&&(o=e.downleft.type==Tg.Road&&e.down.type==Tg.Road?0:o,o=e.upleft.type==Tg.Road&&e.up.type==Tg.Road?0:o,r=e.downright.type==Tg.Road&&e.down.type==Tg.Road?0:r,r=e.upright.type==Tg.Road&&e.up.type==Tg.Road?0:r),n=e.up.type==Tg.Void?0:n,r=e.right.type==Tg.Void?0:r,i=e.down.type==Tg.Void?0:i,o=e.left.type==Tg.Void?0:o,"".concat(n).concat(r).concat(i).concat(o)},t.lineDirectionalVariant=function(t,e){var n=t.left.type==e?1:0,e=t.right.type==e?1:0;return"".concat(n).concat(e)},t.createSeaLayer=function(t,e){null==(e=e||{}).includeCliffs&&(e.includeCliffs=!0),null==e.includeShallowWater&&(e.includeShallowWater=!0);var n,r=new T.Container;return e.includeShallowWater&&(t.center.shallowWater||t.center.shallowWaterSourceTile)&&(n="1111","0000"!=(n=!t.center.shallowWaterSourceTile?c(t):n)&&((n=new T.Sprite(Sg.sheet.textures["sea-shallow-".concat(n,".png")])).blendMode=T.BLEND_MODES.ADD,n.alpha=.1,r.addChild(n))),e&&!e.includeCliffs||"0000"!=(t=u(t))&&(t=new T.Sprite(Sg.sheet.textures["sea-cliff-".concat(t,".png")]),r.addChild(t)),r},t.createPlainLayer=l,t.createBuildingLayers=function(t,e,n){return{bottom:l(t,e),top:h(n)}},t.getBuildingSprite=h}(Yv=Yv||{});var tg=function(){function i(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),Jv(this,"built",!1),Jv(this,"layers",[]),Jv(this,"_shapeSerial","0"),Jv(this,"movementCost",void 0)}var t,e,n;return t=i,n=[{key:"getWhitemask",value:function(t){return i.whitemasks.get(t)}}],(e=[{key:"baseType",get:function(){return this.landTile?Tg.Plain:Tg.Sea}},{key:"shapeSerial",get:function(){return this._shapeSerial}},{key:"shapeId",get:function(){return"0"!==this.shapeSerial||this.building?"".concat(this.type.serial,":").concat(this.shapeSerial):"std"}},{key:"preview",get:function(){var t=this.name.replace(" ","").toLowerCase();return new T.Sprite(Sg.sheet.textures["".concat(t,".png")])}},{key:"illustration",get:function(){var t=this.name.replace(" ","").toLowerCase();return new T.Sprite(Sg.infoPortraitSheet.textures["".concat(t,"-landscape.png")])}},{key:"minimapIconName",get:function(){return this.name.toLowerCase().replace(" ","-")}},{key:"getMinimapIcon",value:function(){var t=zI.scene.animationsFrom("UISpritesheet"),e=zI.scene.texturesFrom("UISpritesheet"),n="MiniMap/".concat(this.minimapIconName),t=t[n],e=e["".concat(n,".png")];if(e||t||O1.log("TerrainObject","MinimapIcon",{message:"Could not find a texture or animation for '".concat(n,"'"),warn:!0}),t){t=new T.AnimatedSprite(t);return t.animationSpeed=1/12,t.play(),t}return new T.Sprite(e)}},{key:"landTile",get:function(){return!0}},{key:"building",get:function(){return!1}},{key:"damageable",get:function(){return!1}},{key:"dominoTypes",get:function(){return[]}},{key:"shallowWaterSourceTile",get:function(){return!0}},{key:"shallowWater",get:function(){return!0},set:function(t){}},{key:"generatesIncome",get:function(){return!1}},{key:"repairType",get:function(){return _v.None}},{key:"conceals",get:function(){return!1}},{key:"vision",get:function(){return 0}},{key:"getMovementCost",value:function(t){return[this.movementCost.infantry,this.movementCost.mech,this.movementCost.tireA,this.movementCost.tireB,this.movementCost.tread,this.movementCost.air,this.movementCost.ship,this.movementCost.transport][t]}},{key:"faction",get:function(){return xv.None},set:function(t){}},{key:"value",get:function(){return 0},set:function(t){}},{key:"init",value:function(t,n){this.destroyVisualObjects(),this.layers=[],this.orient(t,new Tm(n));var r=Iv.RowLayerFromWorldPosition(n);this.constructWhiteMask(),this.layers.forEach(function(t){var e=t.key.map(function(t){return"row"===t?r:t});Fv.apply(void 0,Zv(e)).addChild(t.object),t.object.position.set(n.x,n.y)}),this.built=!0}},{key:"destroy",value:function(){this.destroyVisualObjects()}},{key:"destroyVisualObjects",value:function(){this.layers.forEach(function(t){return t.object.destroy({children:!0})})}},{key:"constructWhiteMask",value:function(){var e,n,t,r=this.shapeId;i.whitemasks.hasId(r)||(e=new T.Container,n=zI.display.standardLength,(t=new T.Graphics).beginFill(16777215),t.drawRect(0,n,n,n),t.endFill(),e.addChild(t),this.layers.forEach(function(t){t.object.y=n,e.addChild(t.object)}),e.filters=[(new Uv).filter],t=zI.renderer.generateTexture(e,{scaleMode:T.SCALE_MODES.NEAREST,region:new T.Rectangle(0,0,16,32)}),i.whitemasks.register({id:r,texture:t}))}},{key:"getOverlayTexture",value:function(t){if(zI.textureLibrary.hasId(this.shapeId))return zI.textureLibrary.get(this.shapeId);var e=new T.Sprite;e.texture=i.whitemasks.get(t),e.filters=[Yv.spotlightFilter.filter];e=zI.renderer.generateTexture(e,{scaleMode:T.SCALE_MODES.NEAREST,region:e.getBounds()});return zI.textureLibrary.register({id:this.shapeId,texture:e}),e}},{key:"legalPlacement",value:function(t){return!0}},{key:"actionable",value:function(t){return!1}}])&&$v(t.prototype,e),n&&$v(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function eg(t){return(eg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ng(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rg(){return(rg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=sg(t)););return t}(t,e);if(r){e=Object.getOwnPropertyDescriptor(r,e);return e.get?e.get.call(arguments.length<3?t:n):e.value}}).apply(this,arguments)}function ig(t,e){return(ig=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function og(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=sg(n);return function(t,e){{if(e&&("object"===eg(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return ag(t)}(this,r?(t=sg(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function ag(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sg(t){return(sg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ug(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Jv(tg,"whitemasks",new Z1),Jv(tg,"serial",-1);var cg=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ig(t,e)}(i,tg);var t,e,n,r=og(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),ug(ag(t=r.call(this)),"buildingSprite",null),ug(ag(t),"_faction",xv.Neutral),ug(ag(t),"_hidden",!1),t}return t=i,(e=[{key:"preview",get:function(){var t=new T.Sprite(Sg.sheet.textures["plain-0.png"]),e=this.name.replace(" ","").toLowerCase(),e=Yv.getBuildingSprite(e);return this.buildingSprite&&e.gotoAndStop(this.buildingSprite.currentFrame),t.addChild(e),t}},{key:"minimapIconName",get:function(){var t=Ev[this.faction];return"building-".concat(t)}},{key:"building",get:function(){return!0}},{key:"buildingColorFrameIndex",value:function(t){var e;return(ug(e={},xv.None,0),ug(e,xv.Neutral,0),ug(e,xv.Red,1),ug(e,xv.Blue,2),ug(e,xv.Yellow,3),ug(e,xv.Black,4),e)[t]}},{key:"faction",get:function(){return this._faction},set:function(t){this._faction=t,this.built&&(O1.assert(Boolean(this.buildingSprite),"Terrain Object ".concat(this.name," was missing a building sprite to affect on color change.")),this.hidden||(t=this.buildingColorFrameIndex(this._faction),this.buildingSprite&&this.buildingSprite.gotoAndStop(t)))}},{key:"hidden",get:function(){return this._hidden},set:function(t){this._hidden=t;t=this._hidden?xv.Neutral:this.faction,t=this.buildingColorFrameIndex(t);this.buildingSprite&&this.buildingSprite.gotoAndStop(t),O1.assert(Boolean(this.buildingSprite),"Terrain Object ".concat(this.name," was missing a building sprite to affect on color change."))}},{key:"init",value:function(t,e){rg(sg(i.prototype),"init",this).call(this,t,e),this.faction=this._faction}}])&&ng(t.prototype,e),n&&ng(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(),lg=(n(4),regeneratorRuntime.mark(hg));function hg(e){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=null!=e?e:0;case 1:return t.next=4,n;case 4:n++,t.next=1;break;case 7:case"end":return t.stop()}},lg)}function fg(t){return(fg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pg(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yg(t,e,n){return e&&dg(t.prototype,e),n&&dg(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function mg(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vg(t,e)}function vg(t,e){return(vg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function gg(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=xg(n);return bg(this,r?(t=xg(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function bg(t,e){if(e&&("object"===fg(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _g(t)}function _g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xg(t){return(xg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wg(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Tg,Og=hg(-1),Sg={tileset:"NormalMapTilesheet",landImageset:"NormalMapLandscapeSheet",get sheet(){return zI.scene.getSpritesheet(Sg.tileset)},get infoPortraitSheet(){return zI.scene.getSpritesheet(Sg.landImageset)}};function Eg(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(t,e)||Pg(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pg(t,e){if(t){if("string"==typeof t)return kg(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kg(t,e):void 0}}function kg(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}!function(t){var e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"shallowWater",!1),wg(_g(e),"movementCost",{infantry:0,mech:0,tireA:0,tireB:0,tread:0,air:0,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"landTile",get:function(){return!1}},{key:"shallowWaterSourceTile",get:function(){return!1}},{key:"name",get:function(){return"Void"}},{key:"shortName",get:function(){return"Void"}},{key:"description",get:function(){return"Void"}},{key:"defenseRating",get:function(){return 0}},{key:"orient",value:function(t,e){}}]),r}();wg(e,"serial",Og.next().value),t.Void=e;var r=function(){mg(i,tg);var r=gg(i);function i(t,e){var n;return pg(this,i),wg(_g(n=r.call(this)),"variation",0),wg(_g(n),"movementCost",{infantry:1,mech:1,tireA:2,tireB:1,tread:1,air:1,ship:0,transport:0}),wg(_g(n),"prevTileType",void 0),e?bg(n):(t&&t.type===Tg.Plain?n.prevTileType=t.prevTileType:n.prevTileType=null==t?void 0:t.type,n)}return yg(i,[{key:"type",get:function(){return i}},{key:"illustration",get:function(){return 1==this.variation?new T.Sprite(Sg.infoPortraitSheet.textures["plain-meteor-landscape.png"]):2==this.variation?new T.Sprite(Sg.infoPortraitSheet.textures["plain-plasma-landscape.png"]):new T.Sprite(Sg.infoPortraitSheet.textures["plain-landscape.png"])}},{key:"name",get:function(){return"Plain"}},{key:"shortName",get:function(){return"Plain"}},{key:"description",get:function(){return"Plains are easily traveled but offer little defense."}},{key:"defenseRating",get:function(){return 1}},{key:"orient",value:function(t,e){t=Yv.createPlainLayer(e,t,this.prevTileType);this.layers.push({object:t,key:["bottom","static"]})}}]),i}();wg(r,"serial",Og.next().value),t.Plain=r;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:1,mech:1,tireA:1,tireB:1,tread:1,air:1,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"Road"}},{key:"shortName",get:function(){return"Road"}},{key:"description",get:function(){return"Well-surfaced roads provide optimum mobility, but little cover."}},{key:"defenseRating",get:function(){return 0}},{key:"orient",value:function(t,e){e=Yv.createPlainLayer(e,t);this.layers.push({object:e,key:["bottom","static"]});t=Yv.fourDirectionalVariant(t,Tg.Road,Tg.Bridge,Tg.HQ,Tg.City,Tg.Factory,Tg.Airport,Tg.Port,Tg.Radar,Tg.ComTower,Tg.Silo,Tg.TempAirpt,Tg.TempPort),e=new T.Sprite(Sg.sheet.textures["road-".concat(t,".png")]);this.layers.push({object:e,key:["bottom","static"]})}}]),r}();wg(e,"serial",Og.next().value),t.Road=e;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:1,mech:1,tireA:3,tireB:3,tread:2,air:1,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"Wood"}},{key:"shortName",get:function(){return"Wood"}},{key:"description",get:function(){return"Woods provide /hiding places/ for ground units in Fog of War."}},{key:"defenseRating",get:function(){return 3}},{key:"conceals",get:function(){return!0}},{key:"orient",value:function(t,e){e=Yv.createPlainLayer(e,t);this.layers.push({object:e,key:["bottom","static"]});t=Yv.lineDirectionalVariant(t,Tg.Wood),e=new T.Sprite(Sg.sheet.textures["wood-".concat(t,".png")]);this.layers.push({object:e,key:["bottom","static"]})}}]),r}();wg(e,"serial",Og.next().value),t.Wood=e;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:2,mech:1,tireA:0,tireB:0,tread:0,air:1,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"Mountain"}},{key:"shortName",get:function(){return"Mtn"}},{key:"description",get:function(){return"In Fog of War, these add 3 to the /vision/ of infantry and mech units."}},{key:"defenseRating",get:function(){return 4}},{key:"orient",value:function(t,e){e=Yv.createPlainLayer(e,t);this.layers.push({object:e,key:["bottom","static"]}),this._shapeSerial=Yv.lineDirectionalVariant(t,Tg.Mountain),e=new T.Sprite(Sg.sheet.textures["mountain-".concat(this._shapeSerial,".png")]),this.layers.push({object:e,key:["top","row","static"],maskShape:!0}),(e=new T.Sprite(Sg.sheet.textures["shadow.png"])).alpha=.25,this.layers.push({object:e,key:["top","row","static"]})}}]),r}();wg(e,"serial",Og.next().value),t.Mountain=e;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:1,mech:1,tireA:3,tireB:3,tread:2,air:1,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"Wasteland"}},{key:"shortName",get:function(){return"Wstlnd"}},{key:"description",get:function(){return"This impairs mobility for all but infantry and mech units."}},{key:"defenseRating",get:function(){return 2}},{key:"orient",value:function(t,e){e=Yv.randomTileVariant(e,6),e=new T.Sprite(Sg.sheet.textures["wasteland-".concat(e,".png")]);this.layers.push({object:e,key:["bottom","static"]})}}]),r}();wg(e,"serial",Og.next().value),t.Wasteland=e;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:1,mech:1,tireA:2,tireB:1,tread:1,air:1,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"Ruins"}},{key:"shortName",get:function(){return"Ruins"}},{key:"description",get:function(){return"Ruins provide /hiding places/ for ground units during Fog of War."}},{key:"defenseRating",get:function(){return 1}},{key:"conceals",get:function(){return!0}},{key:"orient",value:function(t,e){t=Yv.createPlainLayer(e,t);this.layers.push({object:t,key:["bottom","static"]});e=Yv.randomTileVariant(e,3),t=new T.Sprite(Sg.sheet.textures["ruins-".concat(e,".png")]);this.layers.push({object:t,key:["bottom","static"]})}}]),r}();wg(e,"serial",Og.next().value),t.Ruins=e;var i=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"landTile",void 0),wg(_g(e),"shallowWater",!1),wg(_g(e),"movementCost",{infantry:1,mech:1,tireA:1,tireB:1,tread:1,air:1,ship:0,transport:0}),e.landTile=!1,t&&(e.landTile=t.landTile),e.landTile||(e.movementCost.ship=1,e.movementCost.transport=1),e}return yg(r,[{key:"type",get:function(){return r}},{key:"shallowWaterSourceTile",get:function(){return!1}},{key:"name",get:function(){return"Bridge"}},{key:"shortName",get:function(){return"Bridge"}},{key:"minimapIconName",get:function(){return"road"}},{key:"description",get:function(){return"Naval units can't pass under river bridges."}},{key:"defenseRating",get:function(){return 0}},{key:"orient",value:function(t,e){var n;this.landTile?(n=Yv.fourDirectionalVariant(t,Tg.River,Tg.Bridge),n=new T.Sprite(Sg.sheet.textures["river-".concat(n,".png")]),this.layers.push({object:n,key:["bottom","static"]})):(n=Yv.createSeaLayer(t),this.layers.push({object:n,key:["bottom","static"]}));t=Yv.fourDirectionalVariant(t,Tg.Bridge,Tg.Port,Tg.TempPort),t=new T.Sprite(Sg.sheet.textures["bridge-".concat(t,".png")]);this.layers.push({object:t,key:["bottom","static"]})}},{key:"legalPlacement",value:function(t){return t.center.type==Tg.Sea||t.center.type==Tg.River||t.center.type==Tg.Bridge}}]),r}();wg(i,"serial",Og.next().value),t.Bridge=i;e=function(){mg(n,i);var e=gg(n);function n(t){return pg(this,n),e.call(this,new r)}return n}();wg(e,"serial",Og.next().value),t.RiverBridge=e;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:2,mech:1,tireA:0,tireB:0,tread:0,air:1,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"River"}},{key:"shortName",get:function(){return"River"}},{key:"description",get:function(){return"Only foot soldiers can ford rivers."}},{key:"defenseRating",get:function(){return 0}},{key:"orient",value:function(t,e){t=Yv.fourDirectionalVariant(t,Tg.River,Tg.Bridge),t=new T.Sprite(Sg.sheet.textures["river-".concat(t,".png")]);this.layers.push({object:t,key:["bottom","static"]})}}]),r}();wg(e,"serial",Og.next().value),t.River=e;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"shallowWater",!1),wg(_g(e),"movementCost",{infantry:0,mech:0,tireA:0,tireB:0,tread:0,air:1,ship:1,transport:1}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"landTile",get:function(){return!1}},{key:"shallowWaterSourceTile",get:function(){return!1}},{key:"name",get:function(){return"Sea"}},{key:"shortName",get:function(){return"Sea"}},{key:"description",get:function(){return"Naval and air forces have good mobility on calm seas."}},{key:"defenseRating",get:function(){return 0}},{key:"orient",value:function(t,e){t=Yv.createSeaLayer(t);this.layers.push({object:t,key:["bottom","static"]})}}]),r}();wg(e,"serial",Og.next().value),t.Sea=e;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:1,mech:1,tireA:2,tireB:2,tread:1,air:1,ship:0,transport:1}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"landTile",get:function(){return!1}},{key:"name",get:function(){return"Beach"}},{key:"shortName",get:function(){return"Beach"}},{key:"description",get:function(){return"Landers and gunboats can /load and drop/ units here."}},{key:"defenseRating",get:function(){return 0}},{key:"orient",value:function(t,e){var n=Yv.createSeaLayer(t,{includeCliffs:!1});this.layers.push({object:n,key:["bottom","static"]});t=Yv.beachVariant(t),t=new T.Sprite(Sg.sheet.textures["beach-".concat(t,".png")]);this.layers.push({object:t,key:["bottom","static"]})}},{key:"legalPlacement",value:function(t){var e=!0;return(t.upleft.landTile&&!t.up.landTile&&!t.left.landTile||t.upright.landTile&&!t.up.landTile&&!t.right.landTile||t.downleft.landTile&&!t.down.landTile&&!t.left.landTile||t.downright.landTile&&!t.down.landTile&&!t.right.landTile)&&(e=!1),(t.left.landTile&&t.right.landTile&&!t.up.landTile&&!t.down.landTile||t.up.landTile&&t.down.landTile&&!t.left.landTile&&!t.right.landTile)&&(e=!1),t.up.landTile&&t.right.landTile&&t.down.landTile&&t.left.landTile&&(e=!1),e=!(t.up.landTile||t.right.landTile||t.down.landTile||t.left.landTile)?!1:e}}]),r}();wg(e,"serial",Og.next().value),t.Beach=e;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"shallowWater",!1),wg(_g(e),"movementCost",{infantry:0,mech:0,tireA:0,tireB:0,tread:0,air:1,ship:2,transport:2}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"illustration",get:function(){return new T.Sprite(Sg.infoPortraitSheet.textures["sea-landscape.png"])}},{key:"landTile",get:function(){return!1}},{key:"shallowWaterSourceTile",get:function(){return!1}},{key:"name",get:function(){return"Rough Sea"}},{key:"shortName",get:function(){return"Rough"}},{key:"description",get:function(){return"Slows the movement of naval units, but air units are not affected."}},{key:"defenseRating",get:function(){return 2}},{key:"orient",value:function(t,e){var n=Yv.createSeaLayer(t,{includeCliffs:!1}),t=new T.AnimatedSprite(Sg.sheet.animations.roughsea);t.animationSpeed=.125,t.play(),n.addChildAt(t,0),this.layers.push({object:n,key:["bottom","animated"]})}},{key:"legalPlacement",value:function(t){var e=!0;return t.list.forEach(function(t){t.landTile&&(e=!1)}),e}}]),r}();wg(e,"serial",Og.next().value),t.RoughSea=e;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:0,mech:0,tireA:0,tireB:0,tread:0,air:1,ship:1,transport:1}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"illustration",get:function(){return new T.Sprite(Sg.infoPortraitSheet.textures["sea-landscape.png"])}},{key:"landTile",get:function(){return!1}},{key:"name",get:function(){return"Mist"}},{key:"shortName",get:function(){return"Mist"}},{key:"description",get:function(){return"Mist provides ideal /hiding places/ for naval units in Fog of War."}},{key:"defenseRating",get:function(){return 1}},{key:"conceals",get:function(){return!0}},{key:"orient",value:function(t,e){var n=Yv.createSeaLayer(t);this.layers.push({object:n,key:["bottom","static"]}),this._shapeSerial=Yv.lineDirectionalVariant(t,r);t=new T.Sprite(Sg.sheet.textures["mist-".concat(this._shapeSerial,".png")]);t.alpha=.75,this.layers.push({object:t,key:["top","row","static"],maskShape:!0})}}]),r}();wg(e,"serial",Og.next().value),t.Mist=e;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:0,mech:0,tireA:0,tireB:0,tread:0,air:1,ship:2,transport:2}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"landTile",get:function(){return!1}},{key:"name",get:function(){return"Reef"}},{key:"shortName",get:function(){return"Reef"}},{key:"description",get:function(){return"Spiky reefs provide ideal /hiding places/ for naval units in Fog of War."}},{key:"defenseRating",get:function(){return 2}},{key:"conceals",get:function(){return!0}},{key:"orient",value:function(t,e){t=Yv.createSeaLayer(t,{includeCliffs:!1});this.layers.push({object:t,key:["bottom","static"]});e=Yv.randomTileVariant(e,4),e=new T.Sprite(Sg.sheet.textures["reef-".concat(e,".png")]);this.layers.push({object:e,key:["bottom","static"]})}},{key:"legalPlacement",value:function(t){var e=!0;return t.list.forEach(function(t){t.landTile&&(e=!1)}),e}}]),r}();wg(e,"serial",Og.next().value),t.Reef=e;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:0,mech:0,tireA:0,tireB:0,tread:0,air:0,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"illustration",get:function(){var t=new T.AnimatedSprite(Sg.infoPortraitSheet.animations["default-landscape"]);return t.animationSpeed=.3,t.gotoAndPlay(Math.floor(Math.random()*t.totalFrames)),t}},{key:"name",get:function(){return"Fire"}},{key:"shortName",get:function(){return"Fire"}},{key:"description",get:function(){return"Prevents unit movement and illuminates a /5-square/ area in Fog of War."}},{key:"defenseRating",get:function(){return 0}},{key:"vision",get:function(){return 5}},{key:"orient",value:function(t,e){var n=new T.Sprite(Sg.sheet.textures["plain-crag.png"]);this.layers.push({object:n,key:["bottom","static"]});n=new T.AnimatedSprite(Sg.sheet.animations.fire);n.animationSpeed=.25,n.play(),this.layers.push({object:n,key:["top","row","animated"]})}}]),r}();wg(e,"serial",Og.next().value),t.Fire=e;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"landTile",void 0),wg(_g(e),"_value",99),wg(_g(e),"movementCost",{infantry:0,mech:0,tireA:0,tireB:0,tread:0,air:0,ship:0,transport:0}),e.landTile=!0,t&&(e.landTile=t.landTile),e}return yg(r,[{key:"type",get:function(){return r}},{key:"illustration",get:function(){var t=new T.AnimatedSprite(Sg.infoPortraitSheet.animations["default-landscape"]);return t.animationSpeed=.3,t.gotoAndPlay(Math.floor(Math.random()*t.totalFrames)),t}},{key:"damageable",get:function(){return!0}},{key:"dominoTypes",get:function(){return[o]}},{key:"name",get:function(){return"Meteor"}},{key:"shortName",get:function(){return"Meteor"}},{key:"description",get:function(){return"/Destroy/ meteor chunks to eliminate any nearby plasma."}},{key:"defenseRating",get:function(){return 0}},{key:"value",get:function(){return this._value},set:function(t){this._value=l1.clamp(t,0,99)}},{key:"orient",value:function(t,e){var n;this.landTile?(n=Yv.createPlainLayer(e,t),this.layers.push({object:n,key:["bottom","static"]})):(n=Yv.createSeaLayer(t),this.layers.push({object:n,key:["bottom","static"]})),this._shapeSerial=Yv.fourDirectionalVariant(t,Tg.Plasma),this._shapeSerial="0"+this._shapeSerial.slice(1);t=new T.AnimatedSprite(Sg.sheet.animations["meteor-".concat(this._shapeSerial)]);t.animationSpeed=.2,"0000"!=this._shapeSerial&&t.play(),this.layers.push({object:t,key:["top","row","animated"],maskShape:!0})}}]),r}();wg(e,"serial",Og.next().value),t.Meteor=e;var o=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"landTile",void 0),wg(_g(e),"shallowWater",!1),wg(_g(e),"movementCost",{infantry:0,mech:0,tireA:0,tireB:0,tread:0,air:0,ship:0,transport:0}),e.landTile=!0,t&&(e.landTile=t.landTile),e}return yg(r,[{key:"type",get:function(){return r}},{key:"illustration",get:function(){var t=new T.AnimatedSprite(Sg.infoPortraitSheet.animations["default-landscape"]);return t.animationSpeed=.3,t.gotoAndPlay(Math.floor(Math.random()*t.totalFrames)),t}},{key:"dominoTypes",get:function(){return[r]}},{key:"shallowWaterSourceTile",get:function(){return!1}},{key:"name",get:function(){return"Plasma"}},{key:"shortName",get:function(){return"Plasma"}},{key:"description",get:function(){return"Plasma is impassable but disappears if /meteor chunks/ are destroyed."}},{key:"defenseRating",get:function(){return 0}},{key:"orient",value:function(t,e){var n;this.landTile?(n=Yv.createPlainLayer(e,t),this.layers.push({object:n,key:["bottom","static"]})):(n=Yv.createSeaLayer(t),this.layers.push({object:n,key:["bottom","static"]})),this._shapeSerial=Yv.fourDirectionalVariant(t,Tg.Plasma,Tg.Meteor);t=new T.AnimatedSprite(Sg.sheet.animations["plasma-".concat(this._shapeSerial)]);t.animationSpeed=.25,t.play(),this.layers.push({object:t,key:["top","row","animated"]})}}]),r}();wg(o,"serial",Og.next().value),t.Plasma=o;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:0,mech:0,tireA:0,tireB:0,tread:0,air:0,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"Pipeline"}},{key:"shortName",get:function(){return"Pipe"}},{key:"description",get:function(){return"Its armor renders the pipeline indestructible. No units can pass it."}},{key:"defenseRating",get:function(){return 0}},{key:"orient",value:function(t,e){}},{key:"legalPlacement",value:function(t){return!1}}]),r}();wg(e,"serial",Og.next().value),t.Pipeline=e;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"_value",99),wg(_g(e),"movementCost",{infantry:0,mech:0,tireA:0,tireB:0,tread:0,air:0,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"Pipe Seam"}},{key:"shortName",get:function(){return"Pipe"}},{key:"description",get:function(){return"The armor is weaker here than on other sections of the pipe."}},{key:"defenseRating",get:function(){return 0}},{key:"value",get:function(){return this._value},set:function(t){this._value=l1.clamp(t,0,99)}},{key:"orient",value:function(t,e){}},{key:"legalPlacement",value:function(t){return!1}}]),r}();wg(e,"serial",Og.next().value),t.PipeSeam=e;e=function(){mg(r,cg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:1,mech:1,tireA:1,tireB:1,tread:1,air:1,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"HQ"}},{key:"shortName",get:function(){return"HQ"}},{key:"minimapIconName",get:function(){return"hq-".concat(Ev[this.faction])}},{key:"description",get:function(){return"Capture the HQ to /end a battle/. Ground units can /resupply/ here too."}},{key:"defenseRating",get:function(){return 4}},{key:"generatesIncome",get:function(){return!0}},{key:"repairType",get:function(){return _v.Ground}},{key:"conceals",get:function(){return!0}},{key:"vision",get:function(){return 2}},{key:"hidden",set:function(t){}},{key:"orient",value:function(t,e){t=Yv.createBuildingLayers(e,t,"hq");this.buildingSprite=t.top,this.layers.push({object:t.bottom,key:["bottom","static"]}),this.layers.push({object:t.top,key:["top","row","animated"],maskShape:!0})}}]),r}();wg(e,"serial",Og.next().value),t.HQ=e;e=function(){mg(r,cg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:1,mech:1,tireA:1,tireB:1,tread:1,air:1,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"City"}},{key:"shortName",get:function(){return"City"}},{key:"description",get:function(){return"A populated city. Once captured, ground units can /resupply/ here."}},{key:"defenseRating",get:function(){return 2}},{key:"generatesIncome",get:function(){return!0}},{key:"repairType",get:function(){return _v.Ground}},{key:"conceals",get:function(){return!0}},{key:"vision",get:function(){return 2}},{key:"orient",value:function(t,e){t=Yv.createBuildingLayers(e,t,"city");this.buildingSprite=t.top,this.layers.push({object:t.bottom,key:["bottom","static"]}),this.layers.push({object:t.top,key:["top","row","animated"],maskShape:!0})}}]),r}();wg(e,"serial",Og.next().value),t.City=e;e=function(){mg(r,cg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:1,mech:1,tireA:1,tireB:1,tread:1,air:1,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"Com Tower"}},{key:"shortName",get:function(){return"Com T"}},{key:"description",get:function(){return"Once captured, this boosts your /attack and defense/."}},{key:"defenseRating",get:function(){return 3}},{key:"generatesIncome",get:function(){return!0}},{key:"conceals",get:function(){return!0}},{key:"vision",get:function(){return 2}},{key:"orient",value:function(t,e){t=Yv.createBuildingLayers(e,t,"comtower");this.buildingSprite=t.top,this.layers.push({object:t.bottom,key:["bottom","static"]}),this.layers.push({object:t.top,key:["top","row","animated"],maskShape:!0})}}]),r}();wg(e,"serial",Og.next().value),t.ComTower=e;e=function(){mg(r,cg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:1,mech:1,tireA:1,tireB:1,tread:1,air:1,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"Radar"}},{key:"shortName",get:function(){return"Radar"}},{key:"description",get:function(){return"This reveals a /5-square/ area during Fog of War conditions."}},{key:"defenseRating",get:function(){return 3}},{key:"generatesIncome",get:function(){return!0}},{key:"conceals",get:function(){return!0}},{key:"vision",get:function(){return 5}},{key:"orient",value:function(t,e){t=Yv.createBuildingLayers(e,t,"radar");this.buildingSprite=t.top,this.layers.push({object:t.bottom,key:["bottom","static"]}),this.layers.push({object:t.top,key:["top","row","animated"],maskShape:!0})}}]),r}();wg(e,"serial",Og.next().value),t.Radar=e;e=function(){mg(r,tg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"siloSprite",void 0),wg(_g(e),"_used",!1),wg(_g(e),"movementCost",{infantry:1,mech:1,tireA:1,tireB:1,tread:1,air:1,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"illustration",get:function(){var t=this.used?"used":"unused";return new T.Sprite(Sg.infoPortraitSheet.textures["silo-".concat(t,"-landscape.png")])}},{key:"name",get:function(){return"Silo"}},{key:"shortName",get:function(){return"Silo"}},{key:"description",get:function(){return"Foot soldiers can launch this. It damages a /13-square/ area."}},{key:"defenseRating",get:function(){return 2}},{key:"conceals",get:function(){return!0}},{key:"updateTexture",value:function(){var t=this._used?2:1,t=Sg.sheet.textures["silo-".concat(t,".png")];this.siloSprite.texture=t,this.siloSprite.anchor.y=.5,this._shapeSerial="".concat(this._used?0:1)}},{key:"used",get:function(){return this._used},set:function(t){this._used=t,this.updateTexture()}},{key:"actionable",value:function(t){return t.soldierUnit&&!this.used}},{key:"orient",value:function(t,e){t=Yv.createPlainLayer(e,t);this.layers.push({object:t,key:["bottom","static"]}),this.siloSprite=new T.Sprite,this.updateTexture(),this.layers.push({object:this.siloSprite,key:["top","row","animated"],maskShape:!0})}}]),r}();wg(e,"serial",Og.next().value),t.Silo=e;e=function(){mg(r,cg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:1,mech:1,tireA:1,tireB:1,tread:1,air:1,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"Factory"}},{key:"shortName",get:function(){return"Fctry"}},{key:"description",get:function(){return"Once captured, this can be used to /produce and resupply/ ground units."}},{key:"defenseRating",get:function(){return 3}},{key:"generatesIncome",get:function(){return!0}},{key:"repairType",get:function(){return _v.Ground}},{key:"conceals",get:function(){return!0}},{key:"vision",get:function(){return 2}},{key:"orient",value:function(t,e){t=Yv.createBuildingLayers(e,t,"factory");this.buildingSprite=t.top,this.layers.push({object:t.bottom,key:["bottom","static"]}),this.layers.push({object:t.top,key:["top","row","animated"],maskShape:!0})}}]),r}();wg(e,"serial",Og.next().value),t.Factory=e;e=function(){mg(r,cg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:1,mech:1,tireA:1,tireB:1,tread:1,air:1,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"Airport"}},{key:"shortName",get:function(){return"Airport"}},{key:"description",get:function(){return"Once captured, this can be used to /produce and resupply/ air units."}},{key:"defenseRating",get:function(){return 3}},{key:"generatesIncome",get:function(){return!0}},{key:"repairType",get:function(){return _v.Air}},{key:"conceals",get:function(){return!0}},{key:"vision",get:function(){return 2}},{key:"orient",value:function(t,e){t=Yv.createBuildingLayers(e,t,"airport");this.buildingSprite=t.top,this.layers.push({object:t.bottom,key:["bottom","static"]}),this.layers.push({object:t.top,key:["top","row","animated"],maskShape:!0})}}]),r}();wg(e,"serial",Og.next().value),t.Airport=e;e=function(){mg(r,cg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:1,mech:1,tireA:1,tireB:1,tread:1,air:1,ship:1,transport:1}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"landTile",get:function(){return!1}},{key:"name",get:function(){return"Port"}},{key:"shortName",get:function(){return"Port"}},{key:"description",get:function(){return"Once captured, this can be used to /produce and resupply/ naval units."}},{key:"defenseRating",get:function(){return 3}},{key:"generatesIncome",get:function(){return!0}},{key:"repairType",get:function(){return _v.Naval}},{key:"conceals",get:function(){return!0}},{key:"vision",get:function(){return 2}},{key:"orient",value:function(t,e){e=Yv.createBuildingLayers(e,t,"port");e.bottom=Yv.createSeaLayer(t),this.buildingSprite=e.top,this.layers.push({object:e.bottom,key:["bottom","static"]}),this.layers.push({object:e.top,key:["top","row","animated"],maskShape:!0})}}]),r}();wg(e,"serial",Og.next().value),t.Port=e;e=function(){mg(r,cg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:1,mech:1,tireA:1,tireB:1,tread:1,air:1,ship:0,transport:0}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"name",get:function(){return"Temp Airpt"}},{key:"shortName",get:function(){return"T Air"}},{key:"description",get:function(){return"A temporary airport that can /resupply/ and /repair/ air units."}},{key:"defenseRating",get:function(){return 1}},{key:"repairType",get:function(){return _v.Air}},{key:"conceals",get:function(){return!0}},{key:"vision",get:function(){return 2}},{key:"orient",value:function(t,e){t=Yv.createBuildingLayers(e,t,"tempairpt");this.buildingSprite=t.top,this.layers.push({object:t.bottom,key:["bottom","static"]}),this.layers.push({object:t.top,key:["top","row","animated"],maskShape:!0})}}]),r}();wg(e,"serial",Og.next().value),t.TempAirpt=e;e=function(){mg(r,cg);var n=gg(r);function r(t){var e;return pg(this,r),wg(_g(e=n.call(this)),"movementCost",{infantry:1,mech:1,tireA:1,tireB:1,tread:1,air:1,ship:1,transport:1}),e}return yg(r,[{key:"type",get:function(){return r}},{key:"landTile",get:function(){return!1}},{key:"name",get:function(){return"Temp Port"}},{key:"shortName",get:function(){return"T Port"}},{key:"description",get:function(){return"A temporary port that can /resupply//repair/ naval units."}},{key:"defenseRating",get:function(){return 1}},{key:"repairType",get:function(){return _v.Naval}},{key:"conceals",get:function(){return!0}},{key:"vision",get:function(){return 2}},{key:"orient",value:function(t,e){e=Yv.createBuildingLayers(e,t,"tempport");e.bottom=Yv.createSeaLayer(t),this.buildingSprite=e.top,this.layers.push({object:e.bottom,key:["bottom","static"]}),this.layers.push({object:e.top,key:["top","row","animated"],maskShape:!0})}}]),r}();wg(e,"serial",Og.next().value),t.TempPort=e}(Tg=Tg||{});var Rg=Tg.HQ.serial,Ag=Tg.Factory.serial;var Cg,Ig,Mg=[{name:"Demo Island",size:{width:16,height:15},players:2,map:[[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,0,2,4,4,2,0,9,9,9,9,9],[9,9,9,0,3,0,0,0,0,0,0,3,0,9,9,9],[9,9,2,20,3,2,20,20,20,20,2,3,20,2,9,9],[9,9,2,1,2,3,1,3,3,1,3,2,1,2,9,9],[9,9,24,1,3,1,1,1,1,1,1,3,1,24,9,9],[9,24,1,1,3,1,20,2,2,20,1,3,1,1,24,9],[9,19,24,1,3,1,20,4,4,20,1,3,1,24,19,9],[9,24,2,1,1,1,2,3,3,2,1,1,1,2,24,9],[9,0,0,23,4,20,3,3,3,3,20,4,23,0,0,9],[9,20,20,0,2,2,3,2,2,3,2,2,0,20,20,9],[9,9,9,3,9,9,3,0,0,3,9,9,3,9,9,9],[9,9,0,9,9,9,9,21,21,9,9,9,9,0,9,9],[9,9,9,9,9,13,9,9,9,9,13,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9]],owners:[{location:{x:3,y:3},player:0},{location:{x:2,y:5},player:0},{location:{x:1,y:6},player:0},{location:{x:1,y:7},player:0},{location:{x:2,y:7},player:0},{location:{x:1,y:8},player:0},{location:{x:5,y:9},player:0},{location:{x:1,y:10},player:0},{location:{x:2,y:10},player:0},{location:{x:12,y:3},player:1},{location:{x:13,y:5},player:1},{location:{x:14,y:6},player:1},{location:{x:13,y:7},player:1},{location:{x:14,y:7},player:1},{location:{x:14,y:8},player:1},{location:{x:10,y:9},player:1},{location:{x:13,y:10},player:1},{location:{x:14,y:10},player:1}],predeploy:[]},{name:"DevRoom Sm 2P",size:{width:7,height:7},players:2,map:[[0,25,2,2,21,8,14],[20,19,24,2,22,6,2],[0,24,15,26,9,28,4],[16,16,16,9,9,12,4],[15,20,3,3,9,12,27],[20,19,1,1,6,5,23],[24,24,0,24,9,10,9]],owners:[{location:{x:1,y:0},player:0},{location:{x:0,y:1},player:0},{location:{x:1,y:1},player:0},{location:{x:2,y:1},player:0},{location:{x:1,y:2},player:0},{location:{x:1,y:4},player:1},{location:{x:0,y:5},player:1},{location:{x:1,y:5},player:1},{location:{x:0,y:6},player:1},{location:{x:1,y:6},player:1}],predeploy:[]},{name:"DevRoom Lg 4P",size:{width:32,height:27},players:4,map:[[0,2,2,2,1,2,3,3,2,2,0,0,0,2,2,3,3,3,3,3,3,3,0,0,2,0,0,0,0,0,0,0],[0,0,0,2,1,0,2,3,3,2,0,20,0,24,0,2,3,3,3,3,0,0,20,20,0,2,0,0,2,2,2,0],[0,0,19,0,1,0,2,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,0,0,2,2],[0,0,0,0,1,20,0,2,3,3,1,0,0,0,0,0,3,3,24,0,22,0,0,20,0,0,1,0,0,0,0,2],[0,2,0,20,1,0,0,0,0,0,1,0,0,9,9,9,3,3,0,0,0,0,0,0,20,0,24,0,0,20,0,2],[0,2,2,0,1,25,0,2,20,20,1,0,9,9,9,9,9,9,0,2,0,20,20,0,2,24,19,24,0,0,0,2],[9,0,0,24,1,1,1,1,1,1,1,2,9,9,14,9,9,9,9,9,2,2,0,2,0,0,24,0,0,0,2,2],[9,9,0,0,2,0,0,0,2,3,1,0,9,9,9,9,9,9,9,9,9,9,0,0,0,25,0,25,0,0,2,2],[9,9,9,0,2,2,20,20,2,3,1,0,24,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,2,2,2],[9,9,6,0,0,2,2,2,2,3,1,20,3,0,0,9,9,9,13,9,9,9,9,9,10,0,0,0,2,9,9,2],[9,9,6,9,0,0,0,2,2,2,1,1,1,1,0,3,9,9,9,9,9,9,9,9,9,10,10,10,2,0,2,2],[9,9,6,9,6,9,0,0,2,2,3,3,3,1,0,3,0,0,9,9,13,9,9,9,9,9,9,9,9,0,0,0],[9,1,1,6,6,9,0,0,0,2,20,3,3,1,20,3,3,0,0,9,9,9,9,9,9,13,9,9,9,9,2,0],[9,20,3,9,6,9,9,0,0,0,2,2,3,1,1,1,20,0,0,0,26,9,9,13,9,9,9,9,9,9,0,2],[9,20,0,9,0,9,9,9,9,0,0,2,2,20,3,3,0,20,0,24,0,9,9,9,9,9,9,9,9,9,9,2],[9,9,6,0,24,2,9,9,9,9,0,0,0,2,2,2,0,0,24,0,24,9,9,10,9,9,9,9,9,9,9,0],[9,9,9,24,19,24,9,9,9,9,9,0,0,0,0,2,2,2,0,24,0,0,0,0,10,10,9,9,9,9,9,9],[9,20,6,0,24,0,26,9,9,9,9,9,9,0,0,0,0,2,2,2,2,0,25,0,0,2,10,9,9,9,9,9],[9,20,9,9,10,10,9,9,9,9,9,9,9,9,0,0,0,0,2,2,2,0,0,0,2,0,19,10,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,20,23,2,0,2,2,0,0,0,2,10,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,0,0,0,2,0,10,10,0,2,10,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,0,0,2,2,9,9,10,10,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,0,2,2,0,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,2,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9]],owners:[{location:{x:14,y:12},player:0},{location:{x:16,y:13},player:0},{location:{x:20,y:13},player:0},{location:{x:17,y:14},player:0},{location:{x:19,y:14},player:0},{location:{x:18,y:15},player:0},{location:{x:20,y:15},player:0},{location:{x:19,y:16},player:0},{location:{x:26,y:18},player:0},{location:{x:27,y:2},player:1},{location:{x:18,y:3},player:1},{location:{x:23,y:3},player:1},{location:{x:24,y:4},player:1},{location:{x:26,y:4},player:1},{location:{x:29,y:4},player:1},{location:{x:21,y:5},player:1},{location:{x:22,y:5},player:1},{location:{x:25,y:5},player:1},{location:{x:26,y:5},player:1},{location:{x:27,y:5},player:1},{location:{x:26,y:6},player:1},{location:{x:25,y:7},player:1},{location:{x:27,y:7},player:1},{location:{x:2,y:2},player:2},{location:{x:5,y:3},player:2},{location:{x:3,y:4},player:2},{location:{x:5,y:5},player:2},{location:{x:3,y:6},player:2},{location:{x:6,y:8},player:2},{location:{x:7,y:8},player:2},{location:{x:4,y:15},player:3},{location:{x:3,y:16},player:3},{location:{x:4,y:16},player:3},{location:{x:5,y:16},player:3},{location:{x:1,y:17},player:3},{location:{x:4,y:17},player:3},{location:{x:6,y:17},player:3},{location:{x:1,y:18},player:3}],predeploy:[{location:{x:23,y:7},serial:0,player:0},{location:{x:23,y:6},serial:13,player:0},{location:{x:22,y:7},serial:2,player:0},{location:{x:24,y:8},serial:6,player:0},{location:{x:22,y:14},serial:22,player:0},{location:{x:21,y:15},serial:23,player:0},{location:{x:25,y:15},serial:24,player:0},{location:{x:24,y:16},serial:27,player:0},{location:{x:23,y:15},serial:26,player:0},{location:{x:22,y:16},serial:7,player:0},{location:{x:21,y:16},serial:6,player:0},{location:{x:23,y:17},serial:4,player:0},{location:{x:20,y:17},serial:14,player:0},{location:{x:20,y:14},serial:20,player:0},{location:{x:19,y:14},serial:1,player:0},{location:{x:26,y:5},serial:11,player:1},{location:{x:25,y:4},serial:7,player:1}]}].concat(function(t){if(Array.isArray(t))return kg(t)}(Cg=[[10,10],[15,15],[20,20],[30,30],[50,50],[70,40,"mmap max"],[100,100,"lag king"]].map(function(t){t=Eg(t,3);return function(t,e,n){O1.assert(5<=t&&5<=e,"Map dimensions shorter than 5 tiles are not allowed: tried width=".concat(t," and height=").concat(e)),n=null!==n&&void 0!==n?n:"";for(var r={name:"Design ".concat(t,"x").concat(e," ").concat(n),size:{width:t,height:e},players:4,map:l1.Array2D(e,t,0),owners:[{location:{x:0,y:0},player:0},{location:{x:0,y:1},player:0},{location:{x:1,y:0},player:1},{location:{x:1,y:1},player:1},{location:{x:2,y:0},player:2},{location:{x:2,y:1},player:2},{location:{x:3,y:0},player:3},{location:{x:3,y:1},player:3}],predeploy:[]},i=0;i<4;i++)r.map[0][i]=Rg,r.map[1][i]=Ag;return r}(t[0],t[1],t[2])}))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(Cg)||Pg(Cg)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),jg=[{name:"X Auto-tileset",size:{width:30,height:20},players:2,map:[[9,9,13,9,20,1,1,1,1,1,1,24,1,0,1,20,2,0,0,19,0,3,0,0,0,9,9,9,9,9],[9,9,9,9,10,10,10,10,9,26,1,1,1,1,1,1,1,1,0,1,0,0,20,9,0,9,9,9,9,9],[9,13,9,9,9,9,9,9,9,26,1,2,20,3,10,10,10,1,3,1,2,1,1,1,0,9,9,9,9,9],[9,9,9,9,20,1,1,20,1,1,1,3,9,9,9,9,9,1,1,1,9,9,9,2,0,9,9,9,9,9],[9,9,9,9,10,10,9,9,3,9,9,9,9,9,9,3,9,3,20,1,9,9,9,9,0,9,9,9,9,9],[10,0,10,9,9,9,9,3,9,9,9,9,3,9,9,9,9,9,3,20,9,9,9,9,0,9,9,9,9,9],[20,20,20,10,9,9,9,9,9,9,9,26,0,20,9,9,9,9,9,3,9,9,13,9,0,9,9,9,9,9],[10,0,10,9,9,9,11,9,11,9,9,10,24,10,9,9,9,9,9,9,9,9,9,9,0,9,9,9,9,9],[9,10,9,9,11,11,11,9,9,9,9,10,0,10,9,9,9,9,9,9,9,9,9,9,0,9,9,9,9,9],[9,9,9,9,9,13,11,11,9,9,13,9,9,9,9,9,9,9,9,9,9,9,9,9,0,9,9,9,9,9],[9,9,9,13,9,9,9,11,11,9,9,9,9,9,9,9,9,10,24,26,9,9,9,9,0,9,9,9,9,9],[9,9,9,9,9,11,9,10,9,11,9,3,9,9,9,9,10,20,0,24,9,9,9,9,0,9,9,9,9,9],[9,3,9,9,11,9,10,20,10,9,9,9,9,9,9,10,0,20,20,20,9,9,9,9,0,9,9,9,9,9],[9,9,9,9,9,10,20,24,20,9,9,9,9,9,10,20,20,0,20,19,9,9,9,9,0,9,9,9,9,9],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,9,9,9,9,9]],owners:[{location:{x:18,y:10},player:0},{location:{x:19,y:10},player:0},{location:{x:17,y:11},player:0},{location:{x:19,y:11},player:0},{location:{x:17,y:12},player:0},{location:{x:18,y:12},player:0},{location:{x:19,y:12},player:0},{location:{x:15,y:13},player:0},{location:{x:16,y:13},player:0},{location:{x:18,y:13},player:0},{location:{x:19,y:13},player:0},{location:{x:11,y:0},player:1},{location:{x:15,y:0},player:1},{location:{x:19,y:0},player:1},{location:{x:9,y:1},player:1},{location:{x:22,y:1},player:1},{location:{x:9,y:2},player:1},{location:{x:12,y:2},player:1},{location:{x:7,y:3},player:1},{location:{x:18,y:4},player:1},{location:{x:19,y:5},player:1}],predeploy:[]},{name:"X Terrain Details",size:{width:17,height:17},players:2,map:[[3,2,2,0,1,3,5,8,3,3,3,3,3,3,3,3,3],[3,2,2,0,1,3,3,8,8,3,3,3,0,0,3,3,3],[3,2,0,20,1,1,3,20,8,2,0,0,0,2,3,3,3],[3,0,0,20,24,1,1,1,6,1,1,1,1,2,20,3,3],[3,3,0,0,20,20,1,4,8,0,2,2,1,1,20,20,0],[0,3,2,1,1,1,1,10,9,9,9,26,24,1,1,2,24],[0,0,1,1,10,10,10,9,9,9,9,0,2,20,1,19,0],[0,1,1,0,10,9,9,9,9,9,9,0,0,1,0,0,0],[2,1,2,9,9,9,13,9,9,11,9,0,0,1,0,0,0],[0,1,2,9,9,9,9,11,11,9,9,0,0,1,2,0,2],[0,1,1,0,0,9,9,9,9,9,9,9,0,1,1,0,3],[24,0,1,20,0,9,9,9,9,9,9,9,9,0,1,0,3],[20,20,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,19,1,0,26,9,9,9,9,9,10,0,1,1,0,3,3],[0,0,1,24,0,2,9,9,10,10,20,20,1,0,3,3,3],[3,3,1,1,1,2,0,8,2,1,1,1,1,20,3,3,3],[3,3,3,0,1,1,1,6,1,1,24,20,1,3,3,3,3]],owners:[{location:{x:0,y:11},player:0},{location:{x:3,y:11},player:0},{location:{x:0,y:12},player:0},{location:{x:1,y:12},player:0},{location:{x:1,y:13},player:0},{location:{x:4,y:13},player:0},{location:{x:3,y:14},player:0},{location:{x:14,y:3},player:1},{location:{x:14,y:4},player:1},{location:{x:15,y:4},player:1},{location:{x:11,y:5},player:1},{location:{x:12,y:5},player:1},{location:{x:16,y:5},player:1},{location:{x:13,y:6},player:1},{location:{x:15,y:6},player:1}],predeploy:[]},{name:"X AAir Attack Heli",size:{width:22,height:13},players:3,map:[[0,0,0,0,4,0,0,4,4,5,20,4,0,0,2,0,0,4,0,2,0,4],[4,20,20,3,0,0,3,3,3,4,4,0,0,3,0,2,0,2,0,20,20,0],[0,4,0,0,3,4,0,5,3,3,3,4,3,3,3,0,20,0,1,1,1,1],[25,0,0,2,0,4,0,3,3,3,0,4,0,3,3,0,0,2,1,5,20,0],[0,20,4,20,4,0,24,0,3,0,20,1,20,0,3,3,0,4,1,0,0,25],[19,0,20,4,0,0,0,3,3,0,2,1,0,2,4,3,0,0,1,0,24,0],[0,20,0,20,3,0,4,3,2,0,4,1,4,0,4,3,20,0,4,1,1,19],[19,0,20,0,0,4,25,3,3,4,20,1,20,0,4,4,1,1,4,4,24,0],[0,20,2,24,3,0,3,3,3,4,4,1,0,2,3,4,4,0,1,0,0,25],[25,0,0,1,3,0,20,3,3,3,2,1,0,3,3,0,0,0,1,0,0,0],[0,0,4,1,2,0,0,3,3,0,3,1,3,3,3,0,4,20,1,20,20,0],[0,20,20,1,3,0,3,20,3,20,2,1,0,3,0,4,0,0,1,1,1,1],[4,4,1,1,1,1,1,1,1,1,1,1,20,2,4,0,2,0,0,20,5,0]],owners:[{location:{x:1,y:4},player:0},{location:{x:10,y:4},player:0},{location:{x:12,y:4},player:0},{location:{x:0,y:5},player:0},{location:{x:2,y:5},player:0},{location:{x:1,y:6},player:0},{location:{x:10,y:7},player:0},{location:{x:12,y:7},player:0},{location:{x:0,y:7},player:1},{location:{x:2,y:7},player:1},{location:{x:1,y:8},player:1},{location:{x:19,y:1},player:2},{location:{x:20,y:1},player:2},{location:{x:20,y:3},player:2},{location:{x:21,y:4},player:2},{location:{x:20,y:5},player:2},{location:{x:21,y:6},player:2},{location:{x:20,y:7},player:2},{location:{x:21,y:8},player:2},{location:{x:19,y:10},player:2},{location:{x:20,y:10},player:2},{location:{x:19,y:12},player:2}],predeploy:[{location:{x:8,y:4},serial:0,player:0},{location:{x:10,y:4},serial:0,player:0},{location:{x:10,y:7},serial:1,player:0},{location:{x:8,y:7},serial:1,player:0},{location:{x:11,y:6},serial:2,player:0},{location:{x:11,y:5},serial:5,player:0},{location:{x:0,y:7},serial:12,player:1},{location:{x:2,y:8},serial:5,player:1},{location:{x:3,y:6},serial:12,player:1},{location:{x:2,y:4},serial:5,player:1},{location:{x:5,y:4},serial:6,player:1},{location:{x:5,y:8},serial:6,player:1},{location:{x:20,y:2},serial:17,player:2},{location:{x:21,y:3},serial:19,player:2},{location:{x:19,y:4},serial:14,player:2},{location:{x:20,y:6},serial:15,player:2},{location:{x:18,y:6},serial:14,player:2},{location:{x:19,y:8},serial:14,player:2},{location:{x:21,y:9},serial:19,player:2},{location:{x:20,y:10},serial:17,player:2},{location:{x:15,y:6},serial:19,player:2}]},{name:"X Flare Reveal FoW",size:{width:20,height:20},players:2,map:[[1,1,2,3,0,0,2,2,3,3,1,1,1,1,1,1,1,3,3,1],[19,1,20,20,24,20,20,0,0,0,1,20,2,24,2,20,1,0,2,1],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,1,26,9,9,9,26,0,1,0,10,10,10,10,10,10,20,1,2,1],[20,1,9,9,9,9,9,5,1,1,6,6,6,6,6,6,1,1,0,1],[1,1,6,9,9,9,6,1,1,3,9,9,9,9,9,9,5,1,5,1],[9,9,9,9,9,9,9,10,10,9,9,11,11,11,9,9,9,6,9,6],[9,11,11,9,9,9,11,11,11,11,11,11,11,11,11,9,9,6,9,6],[9,9,9,9,9,9,9,9,9,9,9,10,10,10,9,11,11,6,11,6],[10,10,10,10,10,10,10,9,11,11,9,2,20,24,10,9,9,6,9,6],[1,1,1,1,1,1,1,10,11,9,9,26,0,1,10,9,9,6,9,1],[1,2,24,5,26,2,1,10,9,9,9,9,9,6,9,11,10,1,2,1],[6,9,9,9,9,9,6,9,11,11,11,11,9,6,9,11,10,1,1,1],[6,9,11,11,11,9,9,9,9,9,9,9,9,6,9,9,9,26,1,24],[6,9,9,9,9,9,9,9,9,9,9,11,11,6,9,9,9,9,1,0],[6,11,11,11,11,9,9,9,11,11,11,9,9,6,9,9,9,10,1,20],[6,9,9,9,9,9,9,9,9,9,9,9,9,1,3,3,2,20,1,1],[6,10,10,10,10,10,6,10,24,20,10,10,20,1,0,0,0,0,1,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],[3,2,5,0,1,20,1,2,3,20,0,20,2,3,0,20,0,19,1,3]],owners:[{location:{x:2,y:11},player:0},{location:{x:17,y:13},player:0},{location:{x:19,y:13},player:0},{location:{x:19,y:15},player:0},{location:{x:17,y:16},player:0},{location:{x:8,y:17},player:0},{location:{x:9,y:17},player:0},{location:{x:12,y:17},player:0},{location:{x:17,y:19},player:0},{location:{x:0,y:1},player:1},{location:{x:2,y:1},player:1},{location:{x:3,y:1},player:1},{location:{x:4,y:1},player:1},{location:{x:5,y:1},player:1},{location:{x:6,y:1},player:1},{location:{x:11,y:1},player:1},{location:{x:13,y:1},player:1},{location:{x:15,y:1},player:1},{location:{x:2,y:3},player:1},{location:{x:6,y:3},player:1},{location:{x:0,y:4},player:1}],predeploy:[{location:{x:5,y:18},serial:0,player:0},{location:{x:9,y:18},serial:0,player:0},{location:{x:17,y:18},serial:0,player:0},{location:{x:16,y:11},serial:26,player:0},{location:{x:19,y:16},serial:8,player:0},{location:{x:17,y:16},serial:13,player:0},{location:{x:15,y:15},serial:25,player:0},{location:{x:12,y:18},serial:10,player:0},{location:{x:13,y:17},serial:2,player:0},{location:{x:11,y:16},serial:24,player:0},{location:{x:7,y:17},serial:27,player:0},{location:{x:3,y:16},serial:22,player:0},{location:{x:2,y:18},serial:13,player:0},{location:{x:0,y:18},serial:6,player:0},{location:{x:17,y:11},serial:1,player:0},{location:{x:16,y:12},serial:0,player:0},{location:{x:19,y:8},serial:11,player:0},{location:{x:12,y:7},serial:24,player:0},{location:{x:19,y:10},serial:6,player:0},{location:{x:17,y:9},serial:4,player:0},{location:{x:17,y:7},serial:1,player:0},{location:{x:17,y:8},serial:11,player:0},{location:{x:12,y:10},serial:2,player:0},{location:{x:8,y:10},serial:22,player:0},{location:{x:9,y:12},serial:25,player:0},{location:{x:4,y:11},serial:0,player:0},{location:{x:2,y:10},serial:13,player:0},{location:{x:3,y:3},serial:22,player:1},{location:{x:5,y:5},serial:23,player:1},{location:{x:1,y:6},serial:27,player:1},{location:{x:2,y:0},serial:11,player:1},{location:{x:16,y:5},serial:1,player:1},{location:{x:8,y:4},serial:1,player:1},{location:{x:0,y:1},serial:8,player:1},{location:{x:19,y:2},serial:6,player:1},{location:{x:18,y:5},serial:10,player:1},{location:{x:11,y:6},serial:22,player:1},{location:{x:8,y:7},serial:22,player:1},{location:{x:17,y:4},serial:8,player:1},{location:{x:19,y:5},serial:7,player:1},{location:{x:18,y:4},serial:1,player:1},{location:{x:18,y:3},serial:11,player:1},{location:{x:14,y:6},serial:26,player:1},{location:{x:15,y:2},serial:0,player:1},{location:{x:14,y:4},serial:0,player:1},{location:{x:12,y:1},serial:11,player:1},{location:{x:14,y:1},serial:11,player:1},{location:{x:4,y:6},serial:22,player:1},{location:{x:6,y:8},serial:23,player:1},{location:{x:8,y:9},serial:27,player:1}]},{name:"X Spinny Helicopter",size:{width:32,height:15},players:2,map:[[9,9,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[9,3,3,3,0,0,3,3,3,3,3,0,3,3,3,3,0,3,3,3,3,3,3,3,3,3,3,3,0,3,3,3],[3,3,0,24,0,25,0,0,0,0,0,20,3,3,3,0,27,0,0,0,3,3,3,0,0,0,3,3,20,3,3,3],[3,0,24,19,24,0,0,3,3,3,0,0,0,0,3,3,0,0,20,0,0,0,0,0,20,0,0,0,0,3,3,3],[3,0,0,24,0,0,0,3,3,3,20,3,3,0,3,0,0,3,3,3,3,3,0,0,0,0,3,3,0,3,3,3],[3,0,25,0,0,0,0,3,3,3,3,3,3,0,0,0,0,0,3,3,3,3,20,20,20,3,3,3,0,0,3,3],[3,3,0,0,3,3,0,0,3,3,3,3,3,0,3,3,0,3,3,3,3,3,3,3,3,3,3,3,3,0,0,3],[3,3,0,3,3,3,0,0,0,0,0,0,0,0,3,3,0,3,3,3,3,3,3,3,3,3,3,3,3,0,20,3],[3,3,0,3,3,3,20,20,20,3,3,3,0,3,3,3,0,3,3,0,3,3,3,3,3,3,0,3,3,0,0,3],[3,0,0,3,3,3,3,3,3,3,3,3,0,3,3,3,0,0,0,0,0,0,3,3,3,3,20,3,0,0,0,3],[3,0,3,3,3,3,3,3,3,3,3,0,0,0,0,0,20,0,3,3,3,0,0,0,0,3,0,0,0,0,0,3],[3,0,0,0,3,3,3,3,0,3,3,0,3,0,3,0,0,0,3,0,3,3,3,3,0,0,0,0,24,25,3,3],[3,20,3,0,0,0,0,0,20,0,0,0,3,27,3,20,0,3,3,20,0,0,3,3,0,0,0,24,19,20,3,3],[3,3,3,3,3,3,3,20,3,3,3,3,3,3,3,0,27,3,3,3,20,20,3,3,3,0,25,0,24,0,3,9],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,9,9]],owners:[{location:{x:3,y:2},player:0},{location:{x:5,y:2},player:0},{location:{x:2,y:3},player:0},{location:{x:3,y:3},player:0},{location:{x:4,y:3},player:0},{location:{x:3,y:4},player:0},{location:{x:2,y:5},player:0},{location:{x:28,y:11},player:1},{location:{x:29,y:11},player:1},{location:{x:27,y:12},player:1},{location:{x:28,y:12},player:1},{location:{x:29,y:12},player:1},{location:{x:26,y:13},player:1},{location:{x:28,y:13},player:1}],predeploy:[{location:{x:16,y:7},serial:19,player:0}]},{name:"X Contextual Actions",size:{width:32,height:18},players:4,map:[[9,9,9,9,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,9,9,9,9,9],[9,9,0,24,0,20,20,0,0,0,0,9,9,0,9,9,9,9,9,0,0,9,0,0,0,0,0,0,0,9,9,9],[9,0,26,0,19,1,1,1,1,1,1,1,9,1,0,9,9,9,0,20,20,0,0,0,0,0,24,0,0,0,9,9],[9,9,9,24,0,0,20,20,9,9,20,20,9,1,0,0,9,9,0,0,20,20,0,9,0,26,0,19,0,9,9,9],[9,9,9,10,10,10,9,9,9,9,9,9,9,1,0,0,9,9,9,20,20,0,9,9,9,9,24,1,0,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,0,1,0,0,10,9,9,9,9,9,9,9,9,9,0,1,0,0,9,9],[9,9,9,9,9,13,9,0,0,0,9,9,9,1,0,0,10,9,9,9,9,9,9,13,9,9,10,1,0,0,9,9],[9,9,20,20,9,9,9,20,0,0,0,0,0,1,23,0,10,9,9,9,10,10,9,9,9,9,10,1,20,20,10,9],[9,0,0,1,9,9,9,9,20,0,20,1,1,1,0,9,9,9,9,0,0,0,9,9,9,9,10,1,0,0,10,9],[9,0,0,1,0,9,9,9,9,20,0,0,10,10,10,9,9,9,20,20,0,0,0,9,9,9,0,1,0,0,9,9],[9,0,0,1,0,9,9,9,9,10,10,10,9,9,9,9,9,0,1,0,0,0,0,9,9,9,20,1,20,9,9,9],[9,9,20,1,20,9,9,13,9,9,9,9,9,13,9,10,0,0,1,20,20,9,9,9,9,9,9,9,9,9,9,9],[9,9,0,1,9,9,9,9,10,10,10,9,9,9,9,10,20,20,1,9,9,9,9,9,13,9,9,9,9,9,9,9],[9,0,0,1,24,9,9,9,0,0,0,10,10,9,9,9,0,0,1,9,9,9,0,9,9,10,10,26,0,9,9,9],[9,0,0,19,0,26,0,0,0,20,20,0,0,10,9,9,0,0,1,9,0,20,20,9,9,0,24,0,24,0,9,9],[9,20,20,0,24,1,1,1,1,1,1,20,20,0,10,9,9,0,1,9,1,1,1,1,1,1,1,19,0,0,9,9],[9,9,0,0,0,9,0,0,9,9,0,0,0,9,9,9,9,9,9,9,0,0,20,20,0,0,0,0,0,9,9,9],[9,9,9,0,9,9,9,9,9,9,9,9,9,9,9,13,9,9,9,9,9,9,0,0,9,9,0,9,9,9,9,9]],owners:[{location:{x:3,y:1},player:0},{location:{x:5,y:1},player:0},{location:{x:6,y:1},player:0},{location:{x:2,y:2},player:0},{location:{x:4,y:2},player:0},{location:{x:3,y:3},player:0},{location:{x:6,y:3},player:0},{location:{x:7,y:3},player:0},{location:{x:2,y:11},player:1},{location:{x:4,y:11},player:1},{location:{x:4,y:13},player:1},{location:{x:3,y:14},player:1},{location:{x:5,y:14},player:1},{location:{x:1,y:15},player:1},{location:{x:2,y:15},player:1},{location:{x:4,y:15},player:1},{location:{x:19,y:2},player:2},{location:{x:20,y:2},player:2},{location:{x:26,y:2},player:2},{location:{x:20,y:3},player:2},{location:{x:21,y:3},player:2},{location:{x:25,y:3},player:2},{location:{x:27,y:3},player:2},{location:{x:26,y:4},player:2},{location:{x:27,y:13},player:3},{location:{x:21,y:14},player:3},{location:{x:22,y:14},player:3},{location:{x:26,y:14},player:3},{location:{x:28,y:14},player:3},{location:{x:27,y:15},player:3},{location:{x:22,y:16},player:3},{location:{x:23,y:16},player:3}],predeploy:[{location:{x:12,y:7},serial:0,player:0},{location:{x:14,y:6},serial:13,player:0},{location:{x:14,y:8},serial:0,player:0},{location:{x:16,y:6},serial:26,player:0}]},{name:"X Silo",size:{width:10,height:10},players:4,map:[[20,1,1,1,20,1,1,1,1,20],[1,23,23,23,23,23,23,23,22,1],[1,23,19,1,1,1,1,19,23,1],[1,23,1,23,23,23,23,1,23,1],[1,23,1,23,20,20,23,1,23,20],[20,23,1,23,20,20,23,1,23,1],[1,23,1,23,23,23,23,1,23,1],[1,23,19,1,1,1,1,19,23,1],[1,22,23,23,23,23,23,23,23,1],[20,1,1,1,1,20,1,1,1,20]],owners:[{location:{x:0,y:0},player:0},{location:{x:5,y:4},player:0},{location:{x:9,y:4},player:0},{location:{x:2,y:7},player:0},{location:{x:9,y:0},player:1},{location:{x:2,y:2},player:1},{location:{x:5,y:5},player:1},{location:{x:1,y:8},player:1},{location:{x:5,y:9},player:1},{location:{x:7,y:2},player:2},{location:{x:0,y:5},player:2},{location:{x:4,y:5},player:2},{location:{x:9,y:9},player:2},{location:{x:4,y:0},player:3},{location:{x:8,y:1},player:3},{location:{x:4,y:4},player:3},{location:{x:7,y:7},player:3},{location:{x:0,y:9},player:3}],predeploy:[{location:{x:1,y:6},serial:1,player:0},{location:{x:2,y:7},serial:1,player:0},{location:{x:3,y:8},serial:1,player:0},{location:{x:1,y:4},serial:1,player:0},{location:{x:2,y:5},serial:1,player:0},{location:{x:4,y:7},serial:1,player:0},{location:{x:5,y:8},serial:1,player:0},{location:{x:3,y:1},serial:8,player:1},{location:{x:2,y:2},serial:8,player:1},{location:{x:3,y:2},serial:8,player:1},{location:{x:4,y:2},serial:8,player:1},{location:{x:2,y:4},serial:8,player:1},{location:{x:4,y:4},serial:8,player:1},{location:{x:5,y:3},serial:8,player:1},{location:{x:3,y:3},serial:8,player:1},{location:{x:5,y:2},serial:8,player:1},{location:{x:8,y:3},serial:1,player:2},{location:{x:7,y:4},serial:1,player:2},{location:{x:4,y:1},serial:1,player:2},{location:{x:6,y:1},serial:1,player:2},{location:{x:5,y:1},serial:1,player:2},{location:{x:6,y:2},serial:1,player:2},{location:{x:8,y:2},serial:1,player:2},{location:{x:8,y:6},serial:8,player:3},{location:{x:7,y:5},serial:8,player:3},{location:{x:6,y:7},serial:8,player:3},{location:{x:6,y:4},serial:8,player:3},{location:{x:5,y:5},serial:8,player:3},{location:{x:8,y:5},serial:8,player:3},{location:{x:5,y:6},serial:8,player:3},{location:{x:4,y:5},serial:8,player:3},{location:{x:7,y:3},serial:8,player:3}]},{name:"X Battleship",size:{width:30,height:20},players:4,map:[[2,1,0,24,0,24,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2],[0,1,20,0,19,1,1,2,2,2,3,3,3,3,3,3,3,3,20,2,3,2,3,3,3,3,20,2,3,2],[1,1,1,1,1,1,20,3,2,2,2,3,3,2,20,3,25,2,3,2,2,2,2,2,2,2,2,2,2,2],[0,1,20,0,0,20,0,0,3,2,2,2,2,2,3,3,2,2,2,3,2,2,3,3,3,0,0,0,3,0],[1,1,1,1,1,1,1,0,0,3,3,3,3,3,3,3,3,2,2,3,2,2,2,3,0,20,0,0,0,0],[9,0,0,0,0,2,1,1,1,1,1,0,0,2,2,0,2,3,2,2,3,2,2,0,3,3,24,0,3,0],[9,9,9,9,0,0,0,0,26,26,1,0,3,3,2,2,2,0,2,20,2,2,2,3,0,0,0,19,3,25],[9,9,9,9,9,0,0,9,9,9,0,9,9,3,3,0,2,0,2,3,3,2,3,0,0,0,0,0,0,0],[9,9,9,9,9,9,0,9,9,0,0,9,9,9,3,3,2,2,24,20,3,2,0,0,3,3,0,20,9,9],[9,9,9,9,9,9,9,9,9,0,9,9,0,0,9,3,3,3,20,20,3,2,2,3,3,9,9,9,9,2],[9,9,9,9,9,9,9,9,9,9,9,9,9,0,9,9,26,0,2,2,3,2,3,9,9,9,3,3,3,3],[9,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,2,2,9,9,9,9,3,3,3,9,9,9],[9,0,26,26,9,9,9,9,9,0,9,9,9,13,9,9,9,9,10,10,9,9,3,3,9,9,9,9,9,13],[9,0,0,0,0,9,9,9,0,0,0,9,9,9,13,13,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[24,2,0,19,0,24,9,24,0,0,0,0,9,9,13,9,9,9,9,9,9,13,9,9,1,9,9,9,9,9],[0,0,0,0,20,0,9,0,2,20,0,0,0,6,6,6,0,9,9,9,9,9,9,9,9,9,13,9,9,9],[2,0,0,0,0,10,9,9,2,9,9,9,9,9,9,9,0,6,6,0,9,1,9,9,9,9,9,9,9,9],[0,0,0,0,0,10,9,9,9,9,0,0,2,0,9,9,0,9,9,0,0,0,9,9,9,26,26,26,1,1],[0,0,0,0,2,10,10,10,0,0,0,0,0,0,0,9,0,9,9,9,9,0,0,0,0,0,0,0,0,1],[0,20,0,0,0,0,0,0,0,20,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,19,0,24,1,1]],owners:[{location:{x:3,y:0},player:0},{location:{x:5,y:0},player:0},{location:{x:2,y:1},player:0},{location:{x:4,y:1},player:0},{location:{x:18,y:1},player:0},{location:{x:6,y:2},player:0},{location:{x:14,y:2},player:0},{location:{x:16,y:2},player:0},{location:{x:2,y:3},player:0},{location:{x:5,y:3},player:0},{location:{x:18,y:8},player:0},{location:{x:19,y:8},player:0},{location:{x:18,y:9},player:0},{location:{x:19,y:9},player:0},{location:{x:8,y:6},player:1},{location:{x:9,y:6},player:1},{location:{x:2,y:12},player:1},{location:{x:3,y:12},player:1},{location:{x:3,y:14},player:1},{location:{x:5,y:14},player:1},{location:{x:4,y:15},player:1},{location:{x:25,y:4},player:2},{location:{x:26,y:5},player:2},{location:{x:27,y:6},player:2},{location:{x:29,y:6},player:2},{location:{x:27,y:8},player:2},{location:{x:25,y:17},player:3},{location:{x:26,y:17},player:3},{location:{x:27,y:17},player:3},{location:{x:25,y:19},player:3},{location:{x:27,y:19},player:3}],predeploy:[{location:{x:19,y:8},serial:9,player:0},{location:{x:23,y:8},serial:11,player:0},{location:{x:24,y:7},serial:7,player:0},{location:{x:22,y:6},serial:0,player:0},{location:{x:21,y:6},serial:1,player:0},{location:{x:16,y:10},serial:0,player:0},{location:{x:19,y:5},serial:6,player:0},{location:{x:17,y:13},serial:23,player:0},{location:{x:1,y:12},serial:1,player:1},{location:{x:1,y:13},serial:1,player:1},{location:{x:2,y:13},serial:1,player:1},{location:{x:3,y:13},serial:1,player:1},{location:{x:4,y:13},serial:1,player:1},{location:{x:2,y:14},serial:7,player:1},{location:{x:4,y:14},serial:7,player:1},{location:{x:3,y:15},serial:7,player:1},{location:{x:3,y:12},serial:22,player:1},{location:{x:29,y:6},serial:15,player:2},{location:{x:17,y:0},serial:2,player:2},{location:{x:16,y:0},serial:2,player:2},{location:{x:15,y:0},serial:2,player:2},{location:{x:14,y:0},serial:2,player:2},{location:{x:13,y:0},serial:2,player:2},{location:{x:12,y:0},serial:2,player:2},{location:{x:10,y:3},serial:7,player:2},{location:{x:10,y:2},serial:7,player:2},{location:{x:26,y:3},serial:2,player:2},{location:{x:27,y:4},serial:21,player:2},{location:{x:23,y:2},serial:19,player:2},{location:{x:21,y:3},serial:19,player:2},{location:{x:25,y:7},serial:6,player:2},{location:{x:24,y:6},serial:1,player:2},{location:{x:26,y:6},serial:1,player:2},{location:{x:27,y:6},serial:10,player:2},{location:{x:26,y:5},serial:6,player:2},{location:{x:24,y:16},serial:22,player:3},{location:{x:26,y:15},serial:22,player:3},{location:{x:23,y:14},serial:25,player:3},{location:{x:22,y:15},serial:26,player:3},{location:{x:26,y:17},serial:24,player:3},{location:{x:25,y:19},serial:8,player:3},{location:{x:21,y:19},serial:13,player:3},{location:{x:21,y:18},serial:1,player:3},{location:{x:29,y:12},serial:22,player:3},{location:{x:18,y:14},serial:24,player:3}]},{name:"X HQ Espionage",size:{width:28,height:22},players:3,map:[[3,0,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,3,3,3,3,3,3,3,3,0,0],[3,0,1,20,3,3,0,0,3,3,0,20,24,20,1,1,1,1,1,1,1,1,1,1,1,1,20,20],[3,0,24,10,10,9,9,9,9,9,10,10,9,26,3,3,3,2,2,2,10,10,10,10,0,1,0,0],[2,26,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,26,0,0],[3,9,9,9,9,9,9,9,9,9,9,12,12,12,9,9,9,9,9,9,9,9,9,9,10,24,19,24],[3,9,9,9,26,2,0,3,10,10,3,3,3,2,10,10,0,2,3,9,9,9,9,9,9,26,24,2],[3,9,9,9,0,0,20,3,24,0,0,0,0,2,2,0,0,0,2,3,9,9,9,9,10,0,2,3],[3,9,9,0,3,20,19,20,0,0,0,3,3,20,24,0,0,20,0,24,0,10,10,10,0,0,0,0],[3,9,9,2,3,0,20,24,2,3,3,12,3,3,0,9,9,9,3,0,20,0,24,0,0,0,0,0],[3,9,9,0,2,0,0,2,9,9,12,12,12,9,12,9,9,9,9,9,9,9,3,3,2,0,0,2],[3,9,9,9,10,10,10,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,3,3,3,2,2],[2,9,9,9,9,9,9,9,9,9,9,10,10,9,9,12,12,9,9,9,9,9,9,9,9,3,0,2],[2,20,9,9,9,9,9,9,9,3,3,2,0,26,2,2,2,10,10,10,10,9,9,9,9,9,0,2],[0,0,24,0,9,9,9,9,3,3,3,0,0,1,1,1,24,2,2,2,3,3,9,9,9,9,9,0],[0,0,0,24,10,10,3,3,3,3,3,20,20,1,2,3,0,2,0,0,0,20,3,3,9,9,9,9],[3,0,24,1,1,1,1,1,2,2,3,3,3,1,3,3,3,0,0,0,20,0,3,3,3,9,9,9],[3,24,1,10,10,10,0,1,1,1,1,1,1,1,0,20,3,3,0,20,0,0,26,3,3,9,9,9],[0,0,26,9,9,9,9,3,3,2,3,3,3,0,0,10,10,3,3,3,10,10,9,9,9,9,9,26],[0,19,1,10,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0],[0,0,26,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,24,0],[0,0,0,10,10,10,10,3,0,0,3,10,10,3,0,0,3,3,10,2,3,3,10,10,10,0,0,3],[0,0,0,20,24,0,0,0,2,2,0,20,20,0,0,0,0,0,2,2,0,0,20,20,0,0,3,3]],owners:[{location:{x:17,y:7},player:0},{location:{x:19,y:7},player:0},{location:{x:20,y:8},player:0},{location:{x:22,y:8},player:0},{location:{x:1,y:12},player:0},{location:{x:2,y:13},player:0},{location:{x:3,y:14},player:0},{location:{x:11,y:14},player:0},{location:{x:2,y:15},player:0},{location:{x:1,y:16},player:0},{location:{x:2,y:17},player:0},{location:{x:1,y:18},player:0},{location:{x:2,y:19},player:0},{location:{x:3,y:21},player:0},{location:{x:4,y:21},player:0},{location:{x:26,y:1},player:1},{location:{x:27,y:1},player:1},{location:{x:25,y:3},player:1},{location:{x:25,y:4},player:1},{location:{x:26,y:4},player:1},{location:{x:27,y:4},player:1},{location:{x:25,y:5},player:1},{location:{x:26,y:5},player:1},{location:{x:4,y:5},player:2},{location:{x:6,y:6},player:2},{location:{x:8,y:6},player:2},{location:{x:5,y:7},player:2},{location:{x:6,y:7},player:2},{location:{x:7,y:7},player:2},{location:{x:13,y:7},player:2},{location:{x:14,y:7},player:2},{location:{x:6,y:8},player:2},{location:{x:7,y:8},player:2}],predeploy:[{location:{x:5,y:10},serial:26,player:0},{location:{x:14,y:9},serial:26,player:0},{location:{x:15,y:6},serial:6,player:0},{location:{x:13,y:6},serial:6,player:0},{location:{x:13,y:5},serial:10,player:0},{location:{x:14,y:7},serial:0,player:0},{location:{x:17,y:7},serial:6,player:0},{location:{x:16,y:6},serial:11,player:0},{location:{x:19,y:7},serial:2,player:0},{location:{x:5,y:9},serial:0,player:0},{location:{x:6,y:10},serial:7,player:0},{location:{x:12,y:6},serial:6,player:2},{location:{x:11,y:6},serial:9,player:2},{location:{x:12,y:7},serial:1,player:2},{location:{x:10,y:7},serial:9,player:2},{location:{x:10,y:6},serial:6,player:2},{location:{x:7,y:7},serial:7,player:2},{location:{x:7,y:8},serial:11,player:2},{location:{x:8,y:6},serial:11,player:2},{location:{x:5,y:6},serial:11,player:2}]},{name:"X Map Editor",size:{width:32,height:18},players:4,map:[[9,9,9,9,0,2,2,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,9,9,9,9,9],[9,9,0,24,0,20,20,0,4,4,0,9,9,22,9,9,9,9,9,0,0,9,0,0,0,0,0,0,0,9,9,9],[9,0,26,0,19,1,1,1,1,1,1,1,9,1,0,9,9,9,0,20,20,0,0,0,0,0,24,0,0,0,9,9],[0,5,9,24,2,0,20,20,9,9,20,20,9,1,0,14,9,9,0,0,20,20,0,9,0,26,0,19,0,9,9,9],[9,2,9,9,9,12,12,12,12,12,9,12,12,1,0,0,9,9,9,20,20,0,9,9,9,9,24,1,0,9,9,9],[9,0,2,6,6,5,12,9,9,9,9,12,0,14,0,0,10,9,9,9,6,9,9,9,9,9,0,1,0,0,9,9],[9,12,12,9,9,9,9,4,0,16,12,12,12,1,0,15,9,9,3,3,6,9,9,13,9,9,10,1,0,0,9,9],[12,12,20,5,9,13,9,20,4,16,16,16,15,1,0,21,6,0,10,3,6,10,9,9,9,9,10,1,20,20,10,9],[12,0,0,1,9,12,9,9,5,0,20,0,0,1,5,9,6,0,10,1,1,0,9,9,9,9,10,1,0,0,10,9],[9,8,8,1,0,9,13,12,12,20,0,16,10,10,10,9,9,0,20,20,0,3,1,9,9,9,0,1,0,0,9,9],[9,0,8,6,8,12,9,9,12,10,10,10,12,9,9,6,6,0,1,0,1,0,3,9,9,9,20,1,20,9,9,9],[9,9,20,1,20,9,12,13,6,6,9,9,9,13,9,10,0,0,1,20,20,9,9,9,9,9,9,9,9,9,9,9],[9,9,0,1,9,9,9,9,10,6,10,9,9,9,9,10,20,20,1,9,9,9,9,9,13,9,9,9,9,9,9,9],[9,0,0,1,24,9,9,9,0,0,0,10,10,9,9,9,0,0,1,9,9,9,0,9,9,10,10,26,0,9,9,9],[9,0,0,19,0,26,0,0,0,20,20,0,0,10,9,9,0,0,1,9,0,20,20,9,9,0,24,0,24,0,9,9],[9,20,20,0,24,1,1,1,1,1,1,20,20,0,10,9,9,0,1,9,1,1,1,1,1,1,1,19,0,0,9,9],[9,9,0,0,0,9,0,0,9,9,0,0,0,9,9,9,9,9,9,9,0,0,20,20,0,0,0,0,0,9,9,9],[9,9,9,0,9,9,9,9,9,9,9,9,9,9,9,13,9,9,9,9,9,9,0,0,9,9,0,9,9,9,9,9]],owners:[{location:{x:3,y:1},player:0},{location:{x:5,y:1},player:0},{location:{x:6,y:1},player:0},{location:{x:2,y:2},player:0},{location:{x:4,y:2},player:0},{location:{x:3,y:3},player:0},{location:{x:6,y:3},player:0},{location:{x:7,y:3},player:0},{location:{x:2,y:11},player:1},{location:{x:4,y:11},player:1},{location:{x:4,y:13},player:1},{location:{x:3,y:14},player:1},{location:{x:5,y:14},player:1},{location:{x:1,y:15},player:1},{location:{x:2,y:15},player:1},{location:{x:4,y:15},player:1},{location:{x:19,y:2},player:2},{location:{x:20,y:2},player:2},{location:{x:26,y:2},player:2},{location:{x:20,y:3},player:2},{location:{x:21,y:3},player:2},{location:{x:25,y:3},player:2},{location:{x:27,y:3},player:2},{location:{x:26,y:4},player:2},{location:{x:27,y:13},player:3},{location:{x:21,y:14},player:3},{location:{x:22,y:14},player:3},{location:{x:26,y:14},player:3},{location:{x:28,y:14},player:3},{location:{x:27,y:15},player:3},{location:{x:22,y:16},player:3},{location:{x:23,y:16},player:3}],predeploy:[]}],Dg=[{name:"C12: History of Hate",size:{width:20,height:14},players:3,map:[[2,0,0,2,2,0,0,0,3,0,0,0,0,3,3,0,0,2,0,0],[9,10,10,9,9,10,10,10,9,10,10,10,10,9,9,9,9,9,9,0],[13,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0],[9,9,11,11,11,11,11,11,11,11,11,11,11,11,9,10,10,10,9,9],[9,9,9,9,9,13,9,9,9,12,12,12,9,9,13,9,9,9,10,0],[0,10,9,9,9,9,9,9,12,12,12,12,12,9,9,9,13,9,10,0],[2,0,0,0,0,9,9,12,12,12,12,12,12,12,9,9,9,9,10,0],[0,0,2,10,9,9,12,12,12,12,12,12,12,12,12,9,9,0,0,0],[0,10,9,9,9,9,9,12,12,12,12,12,12,12,9,0,0,0,10,9],[10,9,9,9,13,9,9,9,12,12,12,12,12,9,9,9,9,9,9,9],[9,10,10,10,9,9,13,9,9,12,12,12,9,9,9,9,9,13,9,9],[0,0,0,0,9,11,11,11,11,11,11,11,11,11,11,11,11,9,9,13],[2,9,9,9,9,9,10,10,10,10,9,9,10,10,9,9,10,10,9,9],[3,3,0,0,0,0,2,0,0,0,0,3,0,0,2,2,0,0,3,2]],owners:[],predeploy:[{location:{x:8,y:12},serial:27,player:0},{location:{x:4,y:12},serial:25,player:0},{location:{x:6,y:11},serial:25,player:0},{location:{x:11,y:12},serial:24,player:0},{location:{x:4,y:9},serial:27,player:0},{location:{x:3,y:8},serial:24,player:0},{location:{x:3,y:10},serial:26,player:0},{location:{x:2,y:10},serial:17,player:0},{location:{x:2,y:12},serial:22,player:0},{location:{x:7,y:13},serial:13,player:0},{location:{x:0,y:7},serial:13,player:0},{location:{x:2,y:6},serial:19,player:0},{location:{x:7,y:4},serial:27,player:1},{location:{x:9,y:10},serial:27,player:1},{location:{x:17,y:11},serial:27,player:1},{location:{x:18,y:10},serial:22,player:1},{location:{x:17,y:1},serial:22,player:1},{location:{x:12,y:9},serial:25,player:1},{location:{x:14,y:1},serial:25,player:1},{location:{x:7,y:7},serial:22,player:1},{location:{x:17,y:4},serial:24,player:1},{location:{x:19,y:7},serial:14,player:1},{location:{x:18,y:2},serial:15,player:1},{location:{x:13,y:3},serial:19,player:1},{location:{x:2,y:5},serial:19,player:2},{location:{x:2,y:3},serial:19,player:2},{location:{x:3,y:4},serial:17,player:2}]},{name:"C13: Greyfield Strikes",size:{width:20,height:14},players:3,map:[[9,9,13,9,20,1,1,1,1,1,1,24,1,0,1,20,2,0,0,19],[9,9,9,9,10,10,10,10,9,26,1,1,1,1,1,1,1,1,0,1],[9,13,9,9,9,9,9,9,9,26,1,2,20,3,10,10,10,1,3,1],[9,9,9,9,20,1,1,20,1,1,1,3,9,9,9,9,9,1,1,1],[9,9,9,9,10,10,9,9,3,9,9,9,9,9,9,3,9,3,20,1],[10,0,10,9,9,9,9,3,9,9,9,9,3,9,9,9,9,9,3,20],[20,20,20,10,9,9,9,9,9,9,9,26,0,20,9,9,9,9,9,3],[10,0,10,9,9,9,11,9,11,9,9,10,24,10,9,9,9,9,9,9],[9,10,9,9,11,11,11,9,9,9,9,10,0,10,9,9,9,9,9,9],[9,9,9,9,9,13,11,11,9,9,13,9,9,9,9,9,9,9,9,9],[9,9,9,13,9,9,9,11,11,9,9,9,9,9,9,9,9,10,24,26],[9,9,9,9,9,11,9,10,9,11,9,3,9,9,9,9,10,20,0,24],[9,3,9,9,11,9,10,20,10,9,9,9,9,9,9,10,0,20,20,20],[9,9,9,11,11,10,20,24,20,10,11,9,9,9,10,20,20,0,20,19]],owners:[{location:{x:18,y:10},player:0},{location:{x:19,y:10},player:0},{location:{x:17,y:11},player:0},{location:{x:19,y:11},player:0},{location:{x:17,y:12},player:0},{location:{x:18,y:12},player:0},{location:{x:19,y:12},player:0},{location:{x:15,y:13},player:0},{location:{x:16,y:13},player:0},{location:{x:18,y:13},player:0},{location:{x:19,y:13},player:0},{location:{x:11,y:0},player:1},{location:{x:15,y:0},player:1},{location:{x:19,y:0},player:1},{location:{x:9,y:1},player:1},{location:{x:9,y:2},player:1},{location:{x:12,y:2},player:1},{location:{x:7,y:3},player:1},{location:{x:18,y:4},player:1},{location:{x:19,y:5},player:1}],predeploy:[{location:{x:18,y:13},serial:13,player:0},{location:{x:16,y:13},serial:0,player:0},{location:{x:14,y:13},serial:27,player:0},{location:{x:15,y:12},serial:26,player:0},{location:{x:17,y:12},serial:0,player:0},{location:{x:15,y:11},serial:23,player:0},{location:{x:17,y:10},serial:27,player:0},{location:{x:16,y:9},serial:25,player:0},{location:{x:18,y:9},serial:22,player:0},{location:{x:17,y:8},serial:24,player:0},{location:{x:1,y:1},serial:23,player:1},{location:{x:4,y:1},serial:27,player:1},{location:{x:6,y:1},serial:26,player:1},{location:{x:8,y:0},serial:0,player:1},{location:{x:12,y:1},serial:6,player:1},{location:{x:17,y:0},serial:7,player:1},{location:{x:19,y:0},serial:12,player:1},{location:{x:7,y:2},serial:22,player:1},{location:{x:19,y:2},serial:5,player:1},{location:{x:7,y:3},serial:1,player:1},{location:{x:10,y:3},serial:9,player:1},{location:{x:14,y:3},serial:27,player:1},{location:{x:18,y:4},serial:12,player:1},{location:{x:3,y:11},serial:22,player:1},{location:{x:4,y:8},serial:27,player:2},{location:{x:6,y:10},serial:27,player:2},{location:{x:12,y:6},serial:13,player:2}]},{name:"C15: Icy Retreat",size:{width:24,height:10},players:3,map:[[3,3,3,3,3,4,8,3,3,2,2,2,4,3,9,3,3,0,9,9,3,20,4,20],[3,3,20,3,4,15,8,3,3,3,20,20,3,9,9,9,9,9,9,15,9,3,20,3],[1,4,4,0,0,4,8,15,1,1,4,1,1,6,6,9,15,11,11,9,9,9,5,0],[4,15,20,2,4,20,8,16,20,0,0,20,9,9,6,6,6,6,6,6,6,6,20,24],[20,16,0,9,0,8,8,16,0,0,9,9,9,11,11,6,9,11,9,11,6,9,9,24],[4,16,4,1,1,7,1,16,1,1,6,6,6,6,6,6,6,6,6,6,6,6,20,24],[0,16,2,2,8,8,2,16,5,20,9,6,11,9,11,11,9,6,11,9,9,9,0,0],[20,16,0,0,8,0,0,15,0,4,6,6,6,6,6,6,6,6,6,6,0,0,0,4],[4,16,2,3,8,3,3,0,2,2,9,6,9,9,9,9,9,9,9,5,0,0,20,4],[3,15,0,20,8,2,3,20,20,9,9,20,9,11,9,20,20,0,0,2,0,20,4,20]],owners:[{location:{x:10,y:1},player:0},{location:{x:11,y:1},player:0},{location:{x:8,y:3},player:0},{location:{x:11,y:3},player:0},{location:{x:9,y:6},player:0},{location:{x:0,y:7},player:0},{location:{x:7,y:9},player:0},{location:{x:8,y:9},player:0},{location:{x:0,y:4},player:1},{location:{x:23,y:0},player:2},{location:{x:22,y:1},player:2},{location:{x:22,y:3},player:2},{location:{x:23,y:3},player:2},{location:{x:23,y:4},player:2},{location:{x:22,y:5},player:2},{location:{x:23,y:5},player:2},{location:{x:22,y:8},player:2},{location:{x:23,y:9},player:2}],predeploy:[{location:{x:13,y:5},serial:0,player:0},{location:{x:15,y:5},serial:9,player:0},{location:{x:15,y:7},serial:6,player:0},{location:{x:17,y:7},serial:13,player:0},{location:{x:19,y:7},serial:1,player:0},{location:{x:20,y:5},serial:5,player:0},{location:{x:17,y:3},serial:5,player:0},{location:{x:17,y:5},serial:7,player:0},{location:{x:15,y:3},serial:0,player:1},{location:{x:19,y:5},serial:3,player:1},{location:{x:23,y:6},serial:8,player:2},{location:{x:23,y:4},serial:8,player:2},{location:{x:23,y:2},serial:8,player:2},{location:{x:22,y:1},serial:6,player:2},{location:{x:23,y:0},serial:19,player:2},{location:{x:23,y:9},serial:6,player:2},{location:{x:20,y:3},serial:2,player:2},{location:{x:16,y:4},serial:19,player:2},{location:{x:11,y:9},serial:11,player:2},{location:{x:6,y:5},serial:9,player:2},{location:{x:2,y:2},serial:3,player:2},{location:{x:3,y:9},serial:3,player:2},{location:{x:5,y:8},serial:0,player:2},{location:{x:9,y:1},serial:1,player:2}]},{name:"C20: Waylon Flies Again",size:{width:22,height:13},players:3,map:[[0,0,0,0,4,0,0,4,4,5,20,4,0,0,2,0,0,4,0,2,0,4],[4,20,20,3,0,0,3,3,3,4,4,0,0,3,0,2,0,2,0,20,20,0],[0,4,0,0,3,4,0,5,3,3,3,4,3,3,3,0,20,0,1,1,1,1],[25,0,0,2,0,4,0,3,3,3,0,4,0,3,3,0,0,2,1,5,20,0],[0,20,4,20,4,0,24,0,3,0,20,1,20,0,3,3,0,4,1,0,0,25],[19,0,20,4,0,0,0,3,3,0,2,1,0,2,4,3,0,0,1,0,24,0],[0,20,0,20,3,0,4,3,2,0,4,1,4,0,4,3,20,0,4,1,1,19],[19,0,20,0,0,4,25,3,3,4,20,1,20,0,4,4,1,1,4,4,24,0],[0,20,2,24,3,0,3,3,3,4,4,1,0,2,3,4,4,0,1,0,0,25],[25,0,0,1,3,0,20,3,3,3,2,1,0,3,3,0,0,0,1,0,0,0],[0,0,4,1,2,0,0,3,3,0,3,1,3,3,3,0,4,20,1,20,20,0],[0,20,20,1,3,0,3,20,3,20,2,1,0,3,0,4,0,0,1,1,1,1],[4,4,1,1,1,1,1,1,1,1,1,1,20,2,4,0,2,0,0,20,5,0]],owners:[{location:{x:1,y:4},player:0},{location:{x:10,y:4},player:0},{location:{x:12,y:4},player:0},{location:{x:0,y:5},player:0},{location:{x:2,y:5},player:0},{location:{x:1,y:6},player:0},{location:{x:10,y:7},player:0},{location:{x:12,y:7},player:0},{location:{x:0,y:7},player:1},{location:{x:2,y:7},player:1},{location:{x:1,y:8},player:1},{location:{x:19,y:1},player:2},{location:{x:20,y:1},player:2},{location:{x:20,y:3},player:2},{location:{x:21,y:4},player:2},{location:{x:20,y:5},player:2},{location:{x:21,y:6},player:2},{location:{x:20,y:7},player:2},{location:{x:21,y:8},player:2},{location:{x:19,y:10},player:2},{location:{x:20,y:10},player:2},{location:{x:19,y:12},player:2}],predeploy:[{location:{x:8,y:4},serial:0,player:0},{location:{x:10,y:4},serial:0,player:0},{location:{x:10,y:7},serial:1,player:0},{location:{x:8,y:7},serial:1,player:0},{location:{x:11,y:6},serial:2,player:0},{location:{x:11,y:5},serial:5,player:0},{location:{x:0,y:7},serial:12,player:1},{location:{x:2,y:8},serial:5,player:1},{location:{x:3,y:6},serial:12,player:1},{location:{x:2,y:4},serial:5,player:1},{location:{x:5,y:4},serial:6,player:1},{location:{x:5,y:8},serial:6,player:1},{location:{x:20,y:2},serial:17,player:2},{location:{x:21,y:3},serial:19,player:2},{location:{x:19,y:4},serial:14,player:2},{location:{x:20,y:6},serial:15,player:2},{location:{x:18,y:6},serial:14,player:2},{location:{x:19,y:8},serial:14,player:2},{location:{x:21,y:9},serial:19,player:2},{location:{x:20,y:10},serial:17,player:2},{location:{x:15,y:6},serial:19,player:2}]},{name:"C21: Lin's Gambit",size:{width:20,height:20},players:2,map:[[1,1,2,3,0,0,2,2,3,3,1,1,1,1,1,1,1,3,3,1],[19,1,20,20,24,20,20,0,0,0,1,20,2,24,2,20,1,0,2,1],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,1,26,9,9,9,26,0,1,0,10,10,10,10,10,10,20,1,2,1],[20,1,9,9,9,9,9,5,1,1,6,6,6,6,6,6,1,1,0,1],[1,1,6,9,9,9,6,1,1,3,9,9,9,9,9,9,5,1,5,1],[9,9,9,9,9,9,9,10,10,9,9,11,11,11,9,9,9,6,9,6],[9,11,11,9,9,9,11,11,11,11,11,11,11,11,11,9,9,6,9,6],[9,9,9,9,9,9,9,9,9,9,9,10,10,10,9,11,11,6,11,6],[10,10,10,10,10,10,10,9,11,11,9,2,20,24,10,9,9,6,9,6],[1,1,1,1,1,1,1,10,11,9,9,26,0,1,10,9,9,6,9,1],[1,2,24,5,26,2,1,10,9,9,9,9,9,6,9,11,10,1,2,1],[6,9,9,9,9,9,6,9,11,11,11,11,9,6,9,11,10,1,1,1],[6,9,11,11,11,9,9,9,9,9,9,9,9,6,9,9,9,26,1,24],[6,9,9,9,9,9,9,9,9,9,9,11,11,6,9,9,9,9,1,0],[6,11,11,11,11,9,9,9,11,11,11,9,9,6,9,9,9,10,1,20],[6,9,9,9,9,9,9,9,9,9,9,9,9,1,3,3,2,20,1,1],[6,10,10,10,10,10,6,10,24,20,10,10,20,1,0,0,0,0,1,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],[3,2,5,0,1,20,1,2,3,20,0,20,2,3,0,20,0,19,1,3]],owners:[{location:{x:17,y:13},player:0},{location:{x:19,y:13},player:0},{location:{x:19,y:15},player:0},{location:{x:17,y:16},player:0},{location:{x:8,y:17},player:0},{location:{x:9,y:17},player:0},{location:{x:12,y:17},player:0},{location:{x:17,y:19},player:0},{location:{x:0,y:1},player:1},{location:{x:2,y:1},player:1},{location:{x:3,y:1},player:1},{location:{x:4,y:1},player:1},{location:{x:5,y:1},player:1},{location:{x:6,y:1},player:1},{location:{x:11,y:1},player:1},{location:{x:13,y:1},player:1},{location:{x:15,y:1},player:1},{location:{x:2,y:3},player:1},{location:{x:6,y:3},player:1},{location:{x:0,y:4},player:1}],predeploy:[{location:{x:5,y:18},serial:0,player:0},{location:{x:9,y:18},serial:0,player:0},{location:{x:17,y:18},serial:0,player:0},{location:{x:17,y:11},serial:1,player:0},{location:{x:16,y:11},serial:26,player:0},{location:{x:19,y:11},serial:11,player:0},{location:{x:18,y:12},serial:4,player:0},{location:{x:18,y:14},serial:11,player:0},{location:{x:19,y:16},serial:8,player:0},{location:{x:17,y:16},serial:13,player:0},{location:{x:15,y:15},serial:25,player:0},{location:{x:16,y:13},serial:24,player:0},{location:{x:12,y:18},serial:10,player:0},{location:{x:13,y:17},serial:2,player:0},{location:{x:11,y:16},serial:24,player:0},{location:{x:7,y:17},serial:27,player:0},{location:{x:5,y:15},serial:25,player:0},{location:{x:2,y:14},serial:25,player:0},{location:{x:3,y:16},serial:22,player:0},{location:{x:2,y:18},serial:13,player:0},{location:{x:0,y:18},serial:6,player:0},{location:{x:2,y:4},serial:22,player:1},{location:{x:3,y:3},serial:22,player:1},{location:{x:5,y:3},serial:22,player:1},{location:{x:6,y:4},serial:22,player:1},{location:{x:3,y:5},serial:23,player:1},{location:{x:5,y:5},serial:23,player:1},{location:{x:7,y:6},serial:27,player:1},{location:{x:1,y:6},serial:27,player:1},{location:{x:14,y:3},serial:26,player:1},{location:{x:11,y:3},serial:26,player:1},{location:{x:18,y:1},serial:11,player:1},{location:{x:7,y:0},serial:11,player:1},{location:{x:2,y:0},serial:11,player:1},{location:{x:6,y:1},serial:11,player:1},{location:{x:16,y:5},serial:1,player:1},{location:{x:18,y:3},serial:1,player:1},{location:{x:8,y:4},serial:1,player:1},{location:{x:0,y:1},serial:8,player:1},{location:{x:14,y:1},serial:7,player:1},{location:{x:19,y:2},serial:6,player:1},{location:{x:18,y:5},serial:10,player:1}]},{name:"C23: Sacrificial Lamb",size:{width:22,height:18},players:2,map:[[3,23,3,15,9,9,11,11,9,9,12,9,9,26,0,3,3,1,0,0,2,3],[3,23,23,16,9,9,11,9,9,9,9,9,9,9,4,24,1,1,19,21,1,1],[15,16,16,15,9,9,9,9,9,3,3,8,10,10,0,1,20,1,1,1,1,3],[3,0,0,10,9,9,9,9,3,2,0,8,15,1,1,1,0,5,0,1,24,2],[2,20,10,9,9,12,9,2,0,1,1,1,8,8,15,8,8,1,1,1,0,3],[20,10,9,9,12,9,9,0,20,1,21,1,1,1,4,0,8,0,10,10,26,3],[9,9,9,12,9,9,9,10,0,1,1,1,20,1,1,1,8,0,9,9,9,9],[9,9,12,9,9,9,9,9,9,0,20,1,1,1,0,20,8,8,8,9,12,9],[11,9,9,9,11,11,9,9,9,10,0,5,1,24,0,0,4,0,0,9,9,9],[9,9,9,9,9,9,11,9,9,9,0,0,1,1,5,0,0,20,20,10,12,9],[20,0,26,9,9,9,9,11,9,9,9,0,20,1,1,1,20,1,0,10,12,9],[3,20,0,0,10,10,9,9,11,9,9,10,0,0,0,1,1,1,9,9,9,9],[0,24,20,0,20,0,10,9,9,11,9,9,9,9,0,0,20,9,9,9,12,9],[3,0,0,0,0,20,0,10,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[2,0,0,0,20,0,20,0,10,9,9,11,9,9,9,9,11,11,9,10,0,4],[20,0,19,0,0,0,0,0,0,10,9,9,11,9,9,11,9,9,10,0,0,20],[3,4,0,0,0,20,20,24,0,26,9,9,9,9,9,9,10,10,0,20,3,23],[3,3,20,20,3,20,0,3,20,0,9,9,12,9,9,10,0,4,5,3,23,23]],owners:[{location:{x:0,y:10},player:0},{location:{x:2,y:10},player:0},{location:{x:1,y:11},player:0},{location:{x:1,y:12},player:0},{location:{x:2,y:12},player:0},{location:{x:4,y:12},player:0},{location:{x:5,y:13},player:0},{location:{x:4,y:14},player:0},{location:{x:6,y:14},player:0},{location:{x:0,y:15},player:0},{location:{x:2,y:15},player:0},{location:{x:5,y:16},player:0},{location:{x:6,y:16},player:0},{location:{x:7,y:16},player:0},{location:{x:9,y:16},player:0},{location:{x:2,y:17},player:0},{location:{x:3,y:17},player:0},{location:{x:5,y:17},player:0},{location:{x:8,y:17},player:0},{location:{x:13,y:0},player:1},{location:{x:15,y:1},player:1},{location:{x:18,y:1},player:1},{location:{x:19,y:1},player:1},{location:{x:16,y:2},player:1},{location:{x:20,y:3},player:1},{location:{x:10,y:5},player:1},{location:{x:20,y:5},player:1},{location:{x:12,y:6},player:1},{location:{x:15,y:7},player:1},{location:{x:18,y:9},player:1},{location:{x:16,y:10},player:1}],predeploy:[{location:{x:1,y:14},serial:0,player:0},{location:{x:3,y:14},serial:0,player:0},{location:{x:3,y:16},serial:0,player:0},{location:{x:5,y:15},serial:8,player:0},{location:{x:2,y:13},serial:8,player:0},{location:{x:1,y:9},serial:22,player:0},{location:{x:3,y:10},serial:22,player:0},{location:{x:5,y:10},serial:25,player:0},{location:{x:6,y:11},serial:25,player:0},{location:{x:8,y:13},serial:25,player:0},{location:{x:10,y:14},serial:26,player:0},{location:{x:11,y:17},serial:26,player:0},{location:{x:8,y:11},serial:26,player:0},{location:{x:3,y:8},serial:26,player:0},{location:{x:16,y:3},serial:1,player:1},{location:{x:18,y:3},serial:1,player:1},{location:{x:18,y:2},serial:11,player:1},{location:{x:17,y:1},serial:11,player:1},{location:{x:15,y:1},serial:1,player:1},{location:{x:18,y:5},serial:26,player:1},{location:{x:20,y:7},serial:25,player:1},{location:{x:10,y:0},serial:25,player:1},{location:{x:20,y:12},serial:27,player:1},{location:{x:14,y:11},serial:6,player:1},{location:{x:17,y:9},serial:11,player:1},{location:{x:14,y:9},serial:9,player:1},{location:{x:11,y:8},serial:10,player:1},{location:{x:11,y:6},serial:11,player:1},{location:{x:9,y:4},serial:11,player:1},{location:{x:9,y:6},serial:6,player:1},{location:{x:3,y:6},serial:27,player:1},{location:{x:11,y:4},serial:5,player:1}]}],Lg=[{name:"T01: Extreme Edge",size:{width:17,height:19},players:2,map:[[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[3,3,1,1,24,3,0,3,19,3,0,3,24,1,1,3,3],[3,0,1,0,0,16,3,27,3,3,3,16,4,0,1,0,3],[3,0,1,0,4,16,0,4,25,4,0,16,4,0,1,0,3],[9,9,1,0,9,16,9,9,9,9,9,16,9,1,1,9,9],[13,9,1,0,9,16,9,9,9,9,9,16,9,1,0,9,13],[13,9,1,9,9,16,9,9,9,9,9,16,9,1,0,9,13],[16,16,16,16,16,15,9,9,15,9,9,15,9,1,9,9,13],[13,9,0,9,9,16,20,20,20,9,20,16,9,1,9,9,13],[13,9,0,27,9,16,20,20,20,20,20,16,9,27,0,9,13],[13,9,9,1,9,16,20,9,20,20,20,16,9,9,0,9,13],[13,9,9,1,9,15,9,9,15,9,9,15,16,16,16,16,16],[13,9,0,1,9,16,9,9,9,9,9,1,9,9,1,9,13],[13,9,0,1,9,16,9,9,9,9,9,1,9,0,1,9,13],[9,9,1,1,9,16,9,9,9,9,9,16,9,0,1,9,9],[3,0,1,0,4,16,0,4,25,4,0,16,4,0,1,0,3],[3,0,1,0,4,16,3,3,3,3,3,16,4,0,1,0,3],[3,3,1,1,24,3,0,3,19,3,0,3,24,1,1,3,3],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]],owners:[{location:{x:7,y:2},player:0},{location:{x:6,y:8},player:0},{location:{x:10,y:8},player:0},{location:{x:3,y:9},player:0},{location:{x:8,y:15},player:0},{location:{x:4,y:17},player:0},{location:{x:8,y:17},player:0},{location:{x:12,y:17},player:0},{location:{x:4,y:1},player:1},{location:{x:8,y:1},player:1},{location:{x:12,y:1},player:1},{location:{x:8,y:3},player:1},{location:{x:13,y:9},player:1},{location:{x:6,y:10},player:1},{location:{x:10,y:10},player:1}],predeploy:[]},{name:"T04: Metro Island",size:{width:16,height:15},players:2,map:[[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,0,2,4,4,2,0,9,9,9,9,9],[9,9,9,0,3,0,0,0,0,0,0,3,0,9,9,9],[9,9,2,20,3,2,20,20,20,20,2,3,20,2,9,9],[9,9,2,1,2,3,1,3,3,1,3,2,1,2,9,9],[9,9,24,1,3,1,1,1,1,1,1,3,1,24,9,9],[9,24,1,1,3,1,20,2,2,20,1,3,1,1,24,9],[9,19,24,1,3,1,20,4,4,20,1,3,1,24,19,9],[9,24,2,1,1,1,2,3,3,2,1,1,1,2,24,9],[9,0,0,0,4,20,3,3,3,3,20,4,0,0,0,9],[9,20,20,0,2,2,3,2,2,3,2,2,0,20,20,9],[9,9,9,3,9,9,3,0,0,3,9,9,3,9,9,9],[9,9,0,9,9,9,9,0,0,9,9,9,9,0,9,9],[9,9,9,9,9,13,9,9,9,9,13,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9]],owners:[{location:{x:3,y:3},player:0},{location:{x:2,y:5},player:0},{location:{x:1,y:6},player:0},{location:{x:1,y:7},player:0},{location:{x:2,y:7},player:0},{location:{x:1,y:8},player:0},{location:{x:5,y:9},player:0},{location:{x:1,y:10},player:0},{location:{x:2,y:10},player:0},{location:{x:12,y:3},player:1},{location:{x:13,y:5},player:1},{location:{x:14,y:6},player:1},{location:{x:13,y:7},player:1},{location:{x:14,y:7},player:1},{location:{x:14,y:8},player:1},{location:{x:10,y:9},player:1},{location:{x:13,y:10},player:1},{location:{x:14,y:10},player:1}],predeploy:[]},{name:"T05: Eerie Lake",size:{width:17,height:17},players:2,map:[[3,2,2,0,1,3,3,8,3,3,3,3,3,3,3,3,3],[3,2,0,20,1,1,3,8,8,2,0,0,0,2,3,3,3],[3,0,0,20,24,1,1,1,7,1,1,1,1,2,20,3,3],[3,3,0,0,20,20,1,4,8,0,2,2,1,1,20,20,0],[0,3,2,1,1,1,1,10,9,9,9,0,24,1,1,2,24],[0,0,1,1,10,10,10,9,9,9,9,26,0,20,1,0,0],[0,1,1,0,10,9,9,9,9,9,9,0,2,1,1,19,0],[2,1,2,9,9,9,13,9,9,11,9,0,0,1,0,0,0],[0,1,2,9,9,9,9,11,11,9,9,0,0,1,2,0,2],[0,1,1,9,9,9,9,9,9,9,9,9,0,1,1,0,0],[0,2,1,0,0,9,9,11,11,9,9,9,9,2,1,0,3],[24,0,1,20,0,9,11,9,9,13,9,9,9,1,1,0,3],[20,20,1,0,0,9,9,9,9,9,9,9,10,1,2,0,3],[0,19,1,0,26,9,9,9,9,9,10,0,1,1,0,3,3],[0,0,1,24,0,2,9,9,10,10,20,20,1,0,3,3,3],[3,3,1,1,1,2,0,8,2,1,1,1,1,20,3,3,3],[3,3,3,0,1,1,1,7,1,1,24,20,1,3,3,3,3]],owners:[{location:{x:0,y:11},player:0},{location:{x:3,y:11},player:0},{location:{x:0,y:12},player:0},{location:{x:1,y:12},player:0},{location:{x:1,y:13},player:0},{location:{x:4,y:13},player:0},{location:{x:3,y:14},player:0},{location:{x:14,y:2},player:1},{location:{x:14,y:3},player:1},{location:{x:15,y:3},player:1},{location:{x:12,y:4},player:1},{location:{x:16,y:4},player:1},{location:{x:11,y:5},player:1},{location:{x:13,y:5},player:1},{location:{x:15,y:6},player:1}],predeploy:[]},{name:"T06: Clear Island",size:{width:24,height:18},players:2,map:[[11,11,11,11,9,9,9,9,9,9,13,13,13,9,9,9,9,9,9,9,11,11,11,11],[11,11,9,9,9,9,9,9,9,9,9,13,9,9,9,9,9,10,9,9,9,9,11,11],[9,9,9,9,0,26,0,10,10,10,9,9,13,9,10,10,10,0,26,24,9,9,9,9],[9,9,10,24,19,24,20,20,20,3,10,9,9,10,3,20,20,20,24,19,24,10,9,9],[9,20,20,1,1,1,1,1,1,2,20,9,9,20,2,1,1,1,1,1,1,20,20,9],[9,10,0,24,26,24,2,0,1,1,1,6,6,1,1,1,0,2,24,26,24,0,10,9],[9,9,9,9,9,0,20,3,1,2,10,9,9,10,2,1,3,20,2,9,9,9,9,9],[11,9,9,9,9,9,10,10,1,2,10,9,9,10,2,1,10,10,9,9,9,9,9,11],[11,9,9,9,9,9,9,9,6,10,9,9,13,9,10,6,9,9,9,9,9,9,9,11],[11,11,9,9,9,9,10,10,6,9,13,9,9,9,9,6,10,10,9,9,10,9,9,9],[11,9,9,9,9,10,0,2,1,9,9,9,20,9,9,1,2,0,10,10,0,0,9,9],[9,9,10,10,1,1,1,1,1,9,0,1,1,1,1,1,1,1,1,1,0,10,9,9],[9,9,0,0,20,1,20,20,20,1,1,1,0,0,20,1,20,20,20,1,20,9,9,9],[9,9,10,0,0,1,1,1,1,1,20,10,10,10,0,1,1,1,1,1,2,9,9,9],[9,9,9,10,0,0,2,2,2,10,10,9,9,9,10,2,2,2,10,10,10,9,9,9],[9,9,9,9,10,10,10,10,9,9,9,9,9,9,9,10,10,10,9,9,9,9,9,9],[9,13,9,9,9,9,9,9,9,9,9,11,11,9,9,9,9,9,9,9,9,9,13,9],[9,9,9,9,9,9,9,9,9,11,11,11,11,11,11,9,9,9,9,9,9,9,9,9]],owners:[{location:{x:5,y:2},player:0},{location:{x:3,y:3},player:0},{location:{x:4,y:3},player:0},{location:{x:5,y:3},player:0},{location:{x:6,y:3},player:0},{location:{x:7,y:3},player:0},{location:{x:8,y:3},player:0},{location:{x:1,y:4},player:0},{location:{x:2,y:4},player:0},{location:{x:3,y:5},player:0},{location:{x:4,y:5},player:0},{location:{x:5,y:5},player:0},{location:{x:6,y:6},player:0},{location:{x:18,y:2},player:1},{location:{x:19,y:2},player:1},{location:{x:15,y:3},player:1},{location:{x:16,y:3},player:1},{location:{x:17,y:3},player:1},{location:{x:18,y:3},player:1},{location:{x:19,y:3},player:1},{location:{x:20,y:3},player:1},{location:{x:21,y:4},player:1},{location:{x:22,y:4},player:1},{location:{x:18,y:5},player:1},{location:{x:19,y:5},player:1},{location:{x:20,y:5},player:1},{location:{x:17,y:6},player:1}],predeploy:[]},{name:"T07: Tatter River",size:{width:32,height:28},players:4,map:[[2,2,2,2,0,9,9,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,2,2,2,3,3,3,3],[2,2,2,2,9,9,9,8,8,8,8,8,8,8,8,8,8,2,0,0,0,0,0,0,0,0,0,2,3,3,3,3],[2,2,2,0,9,9,9,0,2,0,0,0,0,0,0,0,8,0,0,0,0,20,20,20,0,25,24,0,2,3,3,3],[2,2,0,9,9,9,2,25,2,2,24,1,1,1,20,0,8,0,0,0,0,1,1,1,1,24,24,19,24,3,3,3],[2,2,9,9,9,0,0,24,19,24,0,1,0,0,0,0,8,2,2,0,0,0,1,0,2,2,0,24,1,2,3,3],[2,2,9,9,9,0,24,0,24,0,25,1,0,2,2,0,8,2,2,2,0,0,1,0,0,2,25,0,1,2,3,3],[2,9,9,9,0,0,2,2,0,2,2,1,0,0,0,2,8,8,8,8,8,0,1,20,0,0,2,0,1,0,2,3],[9,9,9,0,0,0,0,0,2,0,0,1,20,20,0,0,8,2,2,2,8,20,1,0,0,2,2,20,1,20,2,3],[9,9,9,8,8,8,8,8,2,20,20,1,2,2,0,2,8,2,2,0,8,0,0,0,2,2,0,0,0,0,0,3],[9,9,9,2,0,2,2,8,0,2,2,0,2,2,2,0,8,2,0,0,8,0,0,0,8,8,8,8,8,8,8,8],[9,2,2,0,24,0,0,8,8,8,8,8,8,8,8,8,8,0,0,2,8,0,0,0,8,2,0,0,0,0,0,0],[2,2,0,20,1,20,0,2,0,0,0,0,0,0,0,0,2,0,20,0,8,8,8,8,8,0,0,20,24,0,0,2],[2,0,0,0,1,0,0,0,0,20,20,0,25,20,20,0,2,0,0,2,2,2,0,0,2,2,0,1,1,20,0,2],[2,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,2,2,2,0,0,20,0,0,20,1,0,0,2,2],[0,0,1,0,2,2,0,0,2,2,2,2,2,0,0,0,1,0,2,2,2,25,1,1,1,1,1,1,20,0,2,2],[0,20,1,20,2,8,8,8,8,8,8,8,8,8,0,20,1,0,2,2,2,0,2,0,0,0,0,1,0,0,0,2],[2,0,24,0,0,8,2,2,0,0,0,0,0,8,0,0,1,25,2,2,2,2,0,0,0,0,20,1,0,0,0,2],[8,8,8,8,8,8,2,0,0,0,20,20,20,8,2,0,1,0,0,2,0,0,0,2,2,0,0,24,20,0,0,0],[2,2,2,2,2,2,2,1,1,1,1,1,1,8,2,0,1,20,20,0,0,0,2,8,8,8,8,8,8,8,8,8],[2,2,0,2,2,0,0,1,0,0,0,0,2,8,2,2,0,0,0,0,0,2,2,8,0,0,0,0,0,0,0,0],[2,0,0,0,0,0,0,1,20,20,0,2,2,8,2,2,2,0,0,2,2,2,2,8,2,0,20,1,20,0,0,0],[2,0,0,24,25,24,1,1,0,0,0,2,2,8,8,8,8,8,8,8,8,8,8,8,2,2,0,1,0,0,0,2],[0,0,0,24,19,24,0,0,0,0,2,2,2,8,0,0,0,0,0,0,0,0,0,2,2,0,24,1,24,0,0,2],[2,0,0,0,24,0,25,0,0,2,8,8,8,8,20,20,20,0,0,0,0,20,0,0,0,25,24,19,24,25,0,2],[2,2,0,0,0,0,0,2,2,2,8,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,24,0,0,2,2],[2,2,2,2,0,0,2,2,2,2,8,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2],[8,8,8,8,8,8,8,8,8,8,8,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,2,2,2,2],[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,2,2,2,2,2,2]],owners:[{location:{x:7,y:3},player:0},{location:{x:10,y:3},player:0},{location:{x:7,y:4},player:0},{location:{x:8,y:4},player:0},{location:{x:9,y:4},player:0},{location:{x:6,y:5},player:0},{location:{x:8,y:5},player:0},{location:{x:10,y:5},player:0},{location:{x:25,y:2},player:1},{location:{x:26,y:2},player:1},{location:{x:25,y:3},player:1},{location:{x:26,y:3},player:1},{location:{x:27,y:3},player:1},{location:{x:28,y:3},player:1},{location:{x:27,y:4},player:1},{location:{x:26,y:5},player:1},{location:{x:3,y:21},player:2},{location:{x:4,y:21},player:2},{location:{x:5,y:21},player:2},{location:{x:3,y:22},player:2},{location:{x:4,y:22},player:2},{location:{x:5,y:22},player:2},{location:{x:4,y:23},player:2},{location:{x:6,y:23},player:2},{location:{x:26,y:22},player:3},{location:{x:28,y:22},player:3},{location:{x:25,y:23},player:3},{location:{x:26,y:23},player:3},{location:{x:27,y:23},player:3},{location:{x:28,y:23},player:3},{location:{x:29,y:23},player:3},{location:{x:27,y:24},player:3}],predeploy:[]},{name:"T15: Jay Islands",size:{width:32,height:18},players:4,map:[[9,9,9,9,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,9,9,9,9,9],[9,9,0,24,0,20,20,0,0,0,0,9,9,0,9,9,9,9,9,0,0,9,0,0,0,0,0,0,0,9,9,9],[9,0,26,0,19,1,1,1,1,1,1,1,9,1,0,9,9,9,0,20,20,0,0,0,0,0,24,0,0,0,9,9],[9,9,9,24,0,0,20,20,9,9,20,20,9,1,0,0,9,9,0,0,20,20,0,9,0,26,0,19,0,9,9,9],[9,9,9,10,10,10,9,9,9,9,9,9,9,1,0,0,9,9,9,20,20,0,9,9,9,9,24,1,0,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,0,1,0,0,10,9,9,9,9,9,9,9,9,9,0,1,0,0,9,9],[9,9,9,9,9,13,9,0,0,0,9,9,9,1,0,0,10,9,9,9,9,9,9,13,9,9,10,1,0,0,9,9],[9,9,20,20,9,9,9,20,0,0,0,0,0,1,0,0,10,9,9,9,10,10,9,9,9,9,10,1,20,20,10,9],[9,0,0,1,9,9,9,9,20,0,20,0,0,1,0,9,9,9,9,0,0,0,9,9,9,9,10,1,0,0,10,9],[9,0,0,1,0,9,9,9,9,20,0,0,10,10,10,9,9,9,20,20,0,0,0,9,9,9,0,1,0,0,9,9],[9,0,0,1,0,9,9,9,9,10,10,10,9,9,9,9,9,0,1,0,0,0,0,9,9,9,20,1,20,9,9,9],[9,9,20,1,20,9,9,13,9,9,9,9,9,13,9,10,0,0,1,20,20,9,9,9,9,9,9,9,9,9,9,9],[9,9,0,1,9,9,9,9,10,10,10,9,9,9,9,10,20,20,1,9,9,9,9,9,13,9,9,9,9,9,9,9],[9,0,0,1,24,9,9,9,0,0,0,10,10,9,9,9,0,0,1,9,9,9,0,9,9,10,10,26,0,9,9,9],[9,0,0,19,0,26,0,0,0,20,20,0,0,10,9,9,0,0,1,9,0,20,20,9,9,0,24,0,24,0,9,9],[9,20,20,0,24,1,1,1,1,1,1,20,20,0,10,9,9,0,1,9,1,1,1,1,1,1,1,19,0,0,9,9],[9,9,0,0,0,9,0,0,9,9,0,0,0,9,9,9,9,9,9,9,0,0,20,20,0,0,0,0,0,9,9,9],[9,9,9,0,9,9,9,9,9,9,9,9,9,9,9,13,9,9,9,9,9,9,0,0,9,9,0,9,9,9,9,9]],owners:[{location:{x:3,y:1},player:0},{location:{x:5,y:1},player:0},{location:{x:6,y:1},player:0},{location:{x:2,y:2},player:0},{location:{x:4,y:2},player:0},{location:{x:3,y:3},player:0},{location:{x:6,y:3},player:0},{location:{x:7,y:3},player:0},{location:{x:2,y:11},player:1},{location:{x:4,y:11},player:1},{location:{x:4,y:13},player:1},{location:{x:3,y:14},player:1},{location:{x:5,y:14},player:1},{location:{x:1,y:15},player:1},{location:{x:2,y:15},player:1},{location:{x:4,y:15},player:1},{location:{x:19,y:2},player:2},{location:{x:20,y:2},player:2},{location:{x:26,y:2},player:2},{location:{x:20,y:3},player:2},{location:{x:21,y:3},player:2},{location:{x:25,y:3},player:2},{location:{x:27,y:3},player:2},{location:{x:26,y:4},player:2},{location:{x:27,y:13},player:3},{location:{x:21,y:14},player:3},{location:{x:22,y:14},player:3},{location:{x:26,y:14},player:3},{location:{x:28,y:14},player:3},{location:{x:27,y:15},player:3},{location:{x:22,y:16},player:3},{location:{x:23,y:16},player:3}],predeploy:[]},{name:"T25: Land's End",size:{width:32,height:27},players:2,map:[[0,2,2,2,1,2,3,3,2,2,0,0,0,2,2,3,3,3,3,3,3,3,0,0,2,0,0,0,0,0,0,0],[0,0,0,2,1,0,2,3,3,2,0,20,0,24,0,2,3,3,3,3,0,0,20,20,0,2,0,0,2,2,2,0],[0,0,0,0,1,0,2,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,0,0,2,2],[0,0,0,0,1,20,0,2,3,3,1,0,0,0,0,0,3,3,24,0,0,0,0,20,0,0,1,0,0,0,0,2],[0,2,0,20,1,0,0,0,0,0,1,0,0,9,9,9,3,3,0,0,0,0,0,0,20,0,24,0,0,20,0,2],[0,2,2,0,1,25,0,2,20,20,1,0,9,9,9,9,9,9,0,2,0,20,20,0,2,24,19,24,0,0,0,2],[9,0,0,24,1,1,1,1,1,1,1,2,9,9,9,9,9,9,9,9,2,2,0,2,0,0,24,0,0,0,2,2],[9,9,0,0,2,0,0,0,2,3,1,0,9,9,9,13,9,9,9,9,9,9,0,0,0,25,0,25,0,0,2,2],[9,9,9,0,2,2,20,20,2,3,1,0,24,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,2,2,2],[9,9,9,0,0,2,2,2,2,3,1,20,3,0,0,9,9,9,13,9,9,9,9,9,10,0,0,0,2,9,9,2],[9,9,9,9,0,0,0,2,2,2,1,1,1,1,0,3,9,9,9,9,9,9,9,9,9,10,10,10,2,0,2,2],[9,9,9,9,9,0,0,0,2,2,3,3,3,1,0,3,0,0,9,9,13,9,9,9,9,9,9,9,9,0,0,0],[9,9,9,9,9,9,0,0,0,2,20,3,3,1,20,3,3,0,0,9,9,9,9,9,9,13,9,9,9,9,2,0],[9,9,9,9,9,9,9,0,0,0,2,2,3,1,1,1,20,0,0,0,9,9,9,13,9,9,9,9,9,9,0,2],[9,9,9,9,9,9,9,9,9,0,0,2,2,20,3,3,0,20,0,24,0,9,9,9,9,9,9,9,9,9,9,2],[9,9,9,9,9,9,9,9,9,9,0,0,0,2,2,2,0,0,24,0,24,9,9,10,9,9,9,9,9,9,9,0],[9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,2,2,2,0,24,0,0,0,0,10,10,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,2,2,2,2,0,25,0,0,2,10,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,2,2,2,0,0,0,2,0,19,10,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,20,23,2,0,2,2,0,0,0,2,10,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,2,0,10,10,0,2,10,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,2,2,9,9,10,10,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,2,2,0,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,2,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9]],owners:[{location:{x:3,y:4},player:0},{location:{x:3,y:6},player:0},{location:{x:14,y:12},player:0},{location:{x:16,y:13},player:0},{location:{x:17,y:14},player:0},{location:{x:19,y:14},player:0},{location:{x:18,y:15},player:0},{location:{x:20,y:15},player:0},{location:{x:19,y:16},player:0},{location:{x:26,y:18},player:0},{location:{x:27,y:2},player:1},{location:{x:18,y:3},player:1},{location:{x:23,y:3},player:1},{location:{x:24,y:4},player:1},{location:{x:26,y:4},player:1},{location:{x:29,y:4},player:1},{location:{x:21,y:5},player:1},{location:{x:22,y:5},player:1},{location:{x:25,y:5},player:1},{location:{x:26,y:5},player:1},{location:{x:27,y:5},player:1},{location:{x:26,y:6},player:1},{location:{x:25,y:7},player:1},{location:{x:27,y:7},player:1}],predeploy:[]},{name:"T26: Bounty River",size:{width:28,height:22},players:2,map:[[3,0,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,3,3,3,3,3,3,3,3,0,0],[3,0,1,20,3,3,0,0,3,3,0,20,24,20,1,1,1,1,1,1,1,1,1,1,1,1,20,20],[3,0,24,10,10,9,9,9,9,9,10,10,9,26,3,3,3,2,2,2,10,10,10,10,0,1,0,0],[2,26,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,26,0,0],[3,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,24,19,24],[3,9,9,9,26,2,0,3,10,10,3,3,3,2,10,10,0,2,3,9,9,9,9,9,9,26,24,2],[3,9,9,9,0,24,0,3,0,0,0,0,0,2,2,0,0,0,2,3,9,9,9,9,10,0,2,3],[3,9,9,0,3,20,0,20,0,0,0,3,3,20,24,0,0,20,0,24,0,10,10,10,0,0,0,0],[3,9,9,2,3,0,0,0,2,3,3,9,3,3,0,9,9,9,3,0,20,0,24,0,0,0,0,0],[3,9,9,0,2,0,20,2,9,9,9,9,9,9,9,9,9,9,9,9,9,9,3,3,2,0,0,2],[3,9,9,9,10,10,10,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,3,3,3,2,2],[2,9,9,9,9,9,9,9,9,9,9,10,10,9,9,9,9,9,9,9,9,9,9,9,9,3,0,2],[2,20,9,9,9,9,9,9,9,3,3,2,0,26,2,2,2,10,10,10,10,9,9,9,9,9,0,2],[0,0,24,0,9,9,9,9,3,3,3,0,0,1,1,1,24,2,2,2,3,3,9,9,9,9,9,0],[0,0,0,24,10,10,3,3,3,3,3,20,20,1,2,3,0,2,0,0,0,20,3,3,9,9,9,9],[3,0,24,1,1,1,1,1,2,2,3,3,3,1,3,3,3,0,0,0,20,0,3,3,3,9,9,9],[3,24,1,10,10,10,0,1,1,1,1,1,1,1,0,20,3,3,0,20,0,0,26,3,3,9,9,9],[0,0,26,9,9,9,9,3,3,2,3,3,3,0,0,10,10,3,3,3,10,10,9,9,9,9,9,26],[0,19,1,10,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0],[0,0,26,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,24,0],[0,0,0,10,10,10,10,3,0,0,3,10,10,3,0,0,3,3,10,2,3,3,10,10,10,0,0,3],[0,0,0,20,24,0,0,0,2,2,0,20,20,0,0,0,0,0,2,2,0,0,20,20,0,0,3,3]],owners:[{location:{x:1,y:12},player:0},{location:{x:2,y:13},player:0},{location:{x:3,y:14},player:0},{location:{x:11,y:14},player:0},{location:{x:2,y:15},player:0},{location:{x:1,y:16},player:0},{location:{x:2,y:17},player:0},{location:{x:1,y:18},player:0},{location:{x:2,y:19},player:0},{location:{x:3,y:21},player:0},{location:{x:4,y:21},player:0},{location:{x:12,y:1},player:1},{location:{x:26,y:1},player:1},{location:{x:27,y:1},player:1},{location:{x:25,y:3},player:1},{location:{x:25,y:4},player:1},{location:{x:26,y:4},player:1},{location:{x:27,y:4},player:1},{location:{x:25,y:5},player:1},{location:{x:26,y:5},player:1},{location:{x:17,y:7},player:1},{location:{x:19,y:7},player:1},{location:{x:20,y:8},player:1},{location:{x:22,y:8},player:1}],predeploy:[]},{name:"T27: Time Map",size:{width:10,height:10},players:4,map:[[20,1,1,1,20,1,1,1,1,20],[1,23,23,23,23,23,23,23,22,1],[1,23,19,1,1,1,1,19,23,1],[1,23,1,23,23,23,23,1,23,1],[1,23,1,23,20,20,23,1,23,20],[20,23,1,23,20,20,23,1,23,1],[1,23,1,23,23,23,23,1,23,1],[1,23,19,1,1,1,1,19,23,1],[1,22,23,23,23,23,23,23,23,1],[20,1,1,1,1,20,1,1,1,20]],owners:[{location:{x:0,y:0},player:0},{location:{x:5,y:4},player:0},{location:{x:9,y:4},player:0},{location:{x:2,y:7},player:0},{location:{x:9,y:0},player:1},{location:{x:2,y:2},player:1},{location:{x:5,y:5},player:1},{location:{x:1,y:8},player:1},{location:{x:5,y:9},player:1},{location:{x:7,y:2},player:2},{location:{x:0,y:5},player:2},{location:{x:4,y:5},player:2},{location:{x:9,y:9},player:2},{location:{x:4,y:0},player:3},{location:{x:8,y:1},player:3},{location:{x:4,y:4},player:3},{location:{x:7,y:7},player:3},{location:{x:0,y:9},player:3}],predeploy:[{location:{x:0,y:6},serial:1,player:0},{location:{x:1,y:6},serial:1,player:0},{location:{x:1,y:7},serial:1,player:0},{location:{x:2,y:7},serial:1,player:0},{location:{x:2,y:8},serial:1,player:0},{location:{x:3,y:8},serial:1,player:0},{location:{x:3,y:9},serial:1,player:0},{location:{x:0,y:3},serial:8,player:1},{location:{x:1,y:3},serial:8,player:1},{location:{x:2,y:3},serial:8,player:1},{location:{x:3,y:3},serial:8,player:1},{location:{x:3,y:2},serial:8,player:1},{location:{x:3,y:1},serial:8,player:1},{location:{x:3,y:0},serial:8,player:1},{location:{x:2,y:1},serial:8,player:1},{location:{x:2,y:2},serial:8,player:1},{location:{x:1,y:2},serial:8,player:1},{location:{x:9,y:3},serial:1,player:2},{location:{x:8,y:3},serial:1,player:2},{location:{x:8,y:2},serial:1,player:2},{location:{x:7,y:2},serial:1,player:2},{location:{x:7,y:1},serial:1,player:2},{location:{x:6,y:1},serial:1,player:2},{location:{x:6,y:0},serial:1,player:2},{location:{x:9,y:6},serial:8,player:3},{location:{x:8,y:6},serial:8,player:3},{location:{x:7,y:6},serial:8,player:3},{location:{x:6,y:6},serial:8,player:3},{location:{x:6,y:7},serial:8,player:3},{location:{x:6,y:8},serial:8,player:3},{location:{x:6,y:9},serial:8,player:3},{location:{x:7,y:8},serial:8,player:3},{location:{x:7,y:7},serial:8,player:3},{location:{x:8,y:7},serial:8,player:3}]},{name:"T30: Destiny Ocean",size:{width:19,height:19},players:2,map:[[13,13,13,13,13,13,13,9,3,3,3,3,3,3,3,3,3,3,3],[13,13,9,9,10,9,13,9,10,0,20,3,24,1,1,1,0,3,3],[13,9,13,10,20,10,9,9,10,0,0,3,0,0,0,1,19,0,3],[13,13,9,9,10,9,9,10,0,20,20,16,0,10,0,1,0,0,3],[13,9,10,9,9,13,9,10,0,20,28,16,9,9,10,1,1,0,3],[13,10,20,10,9,13,9,9,10,10,9,16,9,9,10,0,1,0,3],[13,9,10,9,9,10,9,9,9,13,12,15,9,9,10,0,1,0,3],[9,9,9,9,10,20,10,9,10,9,9,9,12,12,9,26,26,4,3],[9,10,9,13,9,10,9,9,20,20,20,9,12,12,9,9,9,4,3],[3,0,10,9,9,13,9,20,20,0,20,20,9,12,12,9,10,0,3],[3,4,9,9,9,12,9,9,20,20,20,9,9,10,9,13,9,10,9],[3,4,26,26,9,12,12,9,9,9,10,9,10,20,10,9,9,9,13],[3,0,1,0,10,9,9,15,9,13,9,9,9,10,9,9,10,9,13],[3,1,1,0,10,9,9,16,9,10,10,9,9,13,9,10,20,10,13],[3,1,0,0,10,9,9,16,28,20,0,10,9,13,9,9,10,9,13],[3,1,1,1,0,10,0,16,20,0,20,10,9,9,10,9,9,13,13],[3,1,19,1,0,0,0,3,0,0,10,9,9,10,20,10,13,9,13],[3,3,1,1,0,24,0,3,0,20,10,9,13,9,10,9,9,13,13],[3,3,3,3,3,3,3,3,3,3,3,9,13,13,13,13,13,13,13]],owners:[{location:{x:10,y:1},player:0},{location:{x:10,y:3},player:0},{location:{x:11,y:9},player:0},{location:{x:2,y:11},player:0},{location:{x:3,y:11},player:0},{location:{x:8,y:14},player:0},{location:{x:2,y:16},player:0},{location:{x:5,y:17},player:0},{location:{x:12,y:1},player:1},{location:{x:16,y:2},player:1},{location:{x:10,y:4},player:1},{location:{x:15,y:7},player:1},{location:{x:16,y:7},player:1},{location:{x:7,y:9},player:1},{location:{x:9,y:17},player:1}],predeploy:[]},{name:"T31: Comb Map",size:{width:30,height:20},players:4,map:[[2,1,0,24,0,24,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2],[0,1,20,0,19,1,1,2,2,2,3,3,3,3,3,3,3,3,20,2,3,2,3,3,3,3,20,2,3,2],[1,1,1,1,1,1,20,3,2,2,2,3,3,2,20,3,25,2,3,2,2,2,2,2,2,2,2,2,2,2],[0,1,20,0,0,20,0,0,3,2,2,2,2,2,3,3,2,2,2,3,2,2,3,3,3,0,0,0,3,0],[1,1,1,1,1,1,1,0,0,3,3,3,3,3,3,3,3,2,2,3,2,2,2,3,0,20,0,0,0,0],[9,0,0,0,0,2,1,1,1,1,1,0,0,2,2,0,2,3,2,2,3,2,2,0,3,3,24,0,3,0],[9,9,9,9,0,0,0,0,26,26,1,0,3,3,2,2,2,0,2,20,2,2,2,3,0,0,0,19,3,25],[9,9,9,9,9,0,0,9,9,9,0,9,9,3,3,0,2,0,2,3,3,2,3,0,0,0,0,0,0,0],[9,9,9,9,9,9,0,9,9,0,0,9,9,9,3,3,2,2,24,20,3,2,3,0,3,3,0,20,9,9],[9,9,9,9,9,9,9,9,9,0,9,9,0,0,9,3,3,3,20,20,3,2,2,3,3,9,9,9,9,2],[9,9,9,9,9,9,9,9,9,9,9,9,9,0,9,9,26,0,2,2,3,2,3,9,9,9,3,3,3,3],[9,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,2,2,9,9,9,9,3,3,3,9,9,9],[9,0,26,26,9,9,9,9,9,0,9,9,9,13,9,9,9,9,10,10,9,9,3,3,9,9,9,9,9,13],[9,0,0,0,0,9,9,9,0,0,0,9,9,9,13,13,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[24,2,0,19,0,24,9,24,0,0,0,0,9,9,13,9,9,9,9,9,9,13,9,9,1,9,9,9,9,9],[0,0,0,0,20,0,9,0,2,20,0,0,0,6,6,6,0,9,9,9,9,9,9,9,9,9,13,9,9,9],[2,0,0,0,0,10,9,9,2,9,9,9,9,9,9,9,0,6,6,0,9,1,9,9,9,9,9,9,9,9],[0,0,0,0,0,10,9,9,9,9,0,0,2,0,9,9,0,9,9,0,0,0,9,9,9,26,26,26,1,1],[0,0,0,0,2,10,10,10,0,0,0,0,0,0,0,9,0,9,9,9,9,0,0,0,0,0,0,0,0,1],[0,20,0,0,0,0,0,0,0,20,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,19,0,24,1,1]],owners:[{location:{x:3,y:0},player:0},{location:{x:5,y:0},player:0},{location:{x:2,y:1},player:0},{location:{x:4,y:1},player:0},{location:{x:6,y:2},player:0},{location:{x:2,y:3},player:0},{location:{x:5,y:3},player:0},{location:{x:19,y:8},player:0},{location:{x:18,y:9},player:0},{location:{x:19,y:9},player:0},{location:{x:8,y:6},player:1},{location:{x:9,y:6},player:1},{location:{x:2,y:12},player:1},{location:{x:3,y:12},player:1},{location:{x:3,y:14},player:1},{location:{x:5,y:14},player:1},{location:{x:4,y:15},player:1},{location:{x:25,y:4},player:2},{location:{x:26,y:5},player:2},{location:{x:27,y:6},player:2},{location:{x:29,y:6},player:2},{location:{x:27,y:8},player:2},{location:{x:25,y:17},player:3},{location:{x:26,y:17},player:3},{location:{x:27,y:17},player:3},{location:{x:25,y:19},player:3},{location:{x:27,y:19},player:3}],predeploy:[{location:{x:19,y:8},serial:9,player:0},{location:{x:19,y:9},serial:9,player:0},{location:{x:1,y:12},serial:1,player:1},{location:{x:1,y:13},serial:1,player:1},{location:{x:2,y:13},serial:1,player:1},{location:{x:3,y:13},serial:1,player:1},{location:{x:4,y:13},serial:1,player:1},{location:{x:2,y:14},serial:7,player:1},{location:{x:4,y:14},serial:7,player:1},{location:{x:3,y:15},serial:7,player:1},{location:{x:3,y:12},serial:22,player:1},{location:{x:29,y:6},serial:15,player:2},{location:{x:17,y:0},serial:2,player:2},{location:{x:16,y:0},serial:2,player:2},{location:{x:15,y:0},serial:2,player:2},{location:{x:14,y:0},serial:2,player:2},{location:{x:13,y:0},serial:2,player:2},{location:{x:12,y:0},serial:2,player:2},{location:{x:10,y:3},serial:7,player:2},{location:{x:10,y:2},serial:7,player:2},{location:{x:22,y:16},serial:22,player:3},{location:{x:24,y:16},serial:22,player:3},{location:{x:26,y:16},serial:22,player:3},{location:{x:23,y:16},serial:24,player:3},{location:{x:25,y:16},serial:24,player:3},{location:{x:23,y:15},serial:25,player:3},{location:{x:25,y:15},serial:25,player:3},{location:{x:27,y:17},serial:26,player:3}]},{name:"T35: Center River",size:{width:16,height:13},players:2,map:[[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[3,3,0,0,0,2,2,8,2,0,0,20,0,20,3,3],[3,0,0,0,2,2,0,6,1,1,1,1,1,0,0,3],[3,0,2,0,0,0,8,8,8,8,0,0,1,20,0,3],[3,2,19,2,0,20,8,20,20,8,20,0,20,20,24,3],[3,0,2,1,1,1,6,0,3,8,20,0,1,24,0,3],[3,0,20,1,0,20,8,0,20,8,0,0,1,0,0,3],[3,24,20,20,0,0,8,20,0,6,1,1,1,0,0,3],[3,0,24,0,0,20,8,8,20,8,20,1,0,2,0,3],[3,0,1,0,0,0,0,8,8,8,0,1,2,19,2,3],[3,0,1,0,0,0,0,20,8,2,20,1,0,2,0,3],[3,3,20,20,0,0,2,0,6,1,1,1,0,0,3,3],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]],owners:[{location:{x:2,y:4},player:0},{location:{x:10,y:4},player:0},{location:{x:10,y:5},player:0},{location:{x:2,y:6},player:0},{location:{x:1,y:7},player:0},{location:{x:3,y:7},player:0},{location:{x:2,y:8},player:0},{location:{x:13,y:3},player:1},{location:{x:5,y:4},player:1},{location:{x:12,y:4},player:1},{location:{x:14,y:4},player:1},{location:{x:13,y:5},player:1},{location:{x:5,y:6},player:1},{location:{x:13,y:9},player:1}],predeploy:[]}],Ng=[{name:"AW2: Traitor River",size:{width:40,height:28},players:4,map:[[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,8,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,2,8,2,2,9,9,9,0,0,0,0,0,20,0,8,2,20,20,24,20,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9],[9,9,9,2,2,2,8,2,0,0,9,9,0,0,0,0,0,0,20,8,2,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,9],[9,9,0,0,0,2,8,2,0,0,0,0,0,24,0,0,20,0,2,8,2,0,0,0,0,0,0,0,2,0,0,0,0,0,9,9,9,9,9,9],[9,0,0,0,0,2,8,2,20,24,2,0,24,19,24,0,2,0,2,8,2,2,2,0,2,0,20,0,0,24,0,0,0,0,0,9,9,9,9,9],[0,0,0,0,0,2,8,0,0,0,0,0,0,0,0,0,0,0,2,8,8,8,8,3,3,0,0,0,24,19,24,0,0,0,2,0,0,9,9,9],[0,0,0,0,0,0,8,3,0,0,2,2,0,24,1,1,1,1,1,1,1,1,6,1,1,1,1,1,24,0,0,0,2,2,2,2,0,0,9,9],[0,0,20,20,1,20,8,3,3,3,3,0,0,1,0,0,0,0,0,2,2,3,8,3,3,3,3,3,1,0,0,0,0,2,2,2,2,0,0,9],[0,0,0,2,1,3,8,3,3,3,3,3,3,1,0,20,20,2,2,3,3,3,8,3,3,3,3,3,1,2,20,0,2,2,9,9,2,0,0,9],[0,0,0,2,1,3,8,8,8,8,8,8,3,1,0,0,2,2,3,3,3,3,8,3,3,3,3,3,1,0,0,0,0,2,2,2,2,0,0,9],[0,0,0,0,1,3,3,3,3,3,3,8,3,1,3,3,3,3,3,3,3,3,8,8,8,8,8,3,1,3,0,0,20,0,2,2,0,0,9,9],[0,0,0,20,1,2,3,3,3,3,3,8,3,1,3,3,3,3,3,3,3,3,0,2,2,2,8,3,1,3,2,0,0,0,0,0,0,9,9,9],[0,0,0,0,1,0,3,3,3,3,3,8,3,1,3,3,3,3,3,3,0,0,20,9,9,2,8,3,1,3,2,0,0,0,0,0,9,9,9,9],[0,0,0,0,1,20,0,3,3,3,3,8,8,6,8,8,8,3,3,0,24,0,9,9,9,8,8,8,6,8,8,8,8,8,8,8,9,9,9,9],[0,0,0,20,1,2,2,2,3,3,3,3,3,1,3,3,8,3,3,20,0,9,9,9,9,3,3,3,1,3,0,0,0,2,2,2,9,9,9,9],[9,0,0,0,1,0,0,2,2,3,3,3,3,1,3,3,8,3,3,3,3,9,9,9,9,3,3,3,1,2,20,0,0,0,0,2,2,9,9,9],[9,0,0,0,1,0,0,0,0,2,2,3,3,1,3,3,8,8,8,8,8,9,9,9,0,3,3,3,1,0,24,0,0,0,0,2,2,2,9,9],[9,9,0,0,1,24,0,0,0,0,0,2,2,1,3,3,3,3,3,8,3,9,9,3,3,3,3,2,1,0,0,0,0,2,2,2,2,0,0,0],[9,9,9,0,1,1,1,1,1,1,1,1,2,1,3,3,3,3,3,8,3,3,3,3,3,2,2,0,1,0,0,0,2,2,2,2,2,2,0,0],[9,9,9,9,0,0,0,0,0,0,0,1,0,24,1,1,1,1,1,6,1,1,1,1,1,1,1,1,24,0,0,0,2,2,2,2,2,2,20,0],[9,9,9,9,9,9,0,0,0,0,0,24,0,0,0,0,0,0,0,8,0,0,0,0,2,0,0,0,0,0,24,0,2,2,9,9,2,2,2,0],[9,9,9,9,9,9,9,9,9,0,24,0,24,0,20,20,20,0,0,8,2,20,20,20,0,0,0,0,24,0,0,24,0,2,2,2,2,2,0,0],[9,9,9,9,9,9,9,9,9,0,0,19,0,0,0,0,0,0,2,8,2,0,0,0,0,0,0,0,0,19,0,0,9,9,2,2,2,0,0,0],[9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,0,0,2,8,2,0,0,0,0,0,0,0,0,0,0,0,9,9,2,0,0,0,9,9],[9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,0,2,2,8,2,2,0,0,0,0,0,0,3,3,2,2,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,2,2,2,8,2,2,2,0,20,0,2,3,3,3,3,9,9,9,9,9,9,9,9,9]],owners:[{location:{x:13,y:5},player:0},{location:{x:12,y:6},player:0},{location:{x:13,y:6},player:0},{location:{x:14,y:6},player:0},{location:{x:13,y:8},player:0},{location:{x:29,y:6},player:1},{location:{x:28,y:7},player:1},{location:{x:29,y:7},player:1},{location:{x:30,y:7},player:1},{location:{x:28,y:8},player:1},{location:{x:28,y:21},player:2},{location:{x:30,y:22},player:2},{location:{x:28,y:23},player:2},{location:{x:31,y:23},player:2},{location:{x:29,y:24},player:2},{location:{x:13,y:21},player:3},{location:{x:11,y:22},player:3},{location:{x:10,y:23},player:3},{location:{x:12,y:23},player:3},{location:{x:11,y:24},player:3}],predeploy:[]},{name:"Deer Harbor",size:{width:32,height:30},players:2,map:[[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,9,9,0,0,0,0,3,3,3,3,3,3],[3,3,0,0,0,0,0,0,1,1,1,1,1,1,1,2,2,0,0,2,9,9,9,20,20,1,0,3,3,3,3,3],[3,0,24,25,25,1,1,1,1,2,2,2,2,2,1,0,0,20,20,9,9,9,9,9,0,1,0,0,0,3,3,3],[3,24,19,24,0,9,9,9,1,1,1,0,0,1,1,20,20,1,10,9,9,9,9,9,0,1,0,0,0,3,3,3],[3,0,24,1,26,9,9,9,9,9,1,20,20,1,9,9,9,9,9,9,9,9,10,0,0,1,27,0,0,0,3,3],[3,0,0,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,20,20,1,0,20,20,0,3,3],[3,20,20,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,1,1,1,1,0,0,3],[3,0,1,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,0,0,0,1,1,0,0,1,0,0,3],[3,20,1,2,2,1,1,1,9,9,9,9,9,9,2,2,9,9,9,9,10,0,20,20,1,0,3,3,1,20,0,3],[3,1,0,0,0,2,2,1,1,10,9,9,10,0,0,9,9,9,9,9,9,0,1,1,1,0,0,0,1,0,0,3],[3,1,20,20,0,2,2,2,1,10,9,9,10,20,0,10,9,9,9,9,0,0,1,0,1,0,8,8,7,8,8,8],[3,1,2,2,2,2,2,1,1,10,9,9,9,2,9,9,9,9,10,0,1,1,1,0,1,0,8,0,1,0,0,3],[3,1,2,2,2,2,1,1,9,9,9,9,9,9,9,9,9,9,9,0,1,0,0,0,1,8,8,0,1,0,0,3],[3,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,0,0,0,0,1,0,8,8,7,8,0,0,1,1,1,3],[3,0,0,0,1,0,10,9,9,9,9,9,9,9,9,9,28,20,20,1,1,0,8,0,1,0,0,0,0,0,1,3],[3,20,20,20,1,0,10,9,9,9,9,9,9,9,9,9,0,0,0,1,0,0,8,0,1,1,1,20,20,20,1,3],[3,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,8,8,8,7,8,8,8,0,0,1,3,3,0,0,1,3],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,3],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,2,0,1,1,1,1,0,3,1,9,9,9,9,1,3],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,2,0,0,0,1,3,3,1,9,9,9,9,1,3],[9,9,0,9,9,9,10,10,9,9,9,9,9,9,9,9,9,9,2,20,20,20,1,3,0,1,0,0,0,0,1,3],[9,9,28,9,9,10,0,0,10,10,9,9,9,9,9,9,9,9,9,9,2,2,1,1,0,1,2,2,2,2,0,3],[9,9,1,9,9,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,2,2,20,20,1,1,1,1,24,25,3],[0,0,1,0,0,0,0,0,20,0,0,0,0,9,9,9,9,9,9,9,9,9,9,0,0,0,0,0,24,19,24,3],[0,0,1,0,0,0,0,20,1,20,1,0,0,9,9,9,9,9,9,9,9,9,9,9,9,0,0,25,0,24,3,3],[20,20,1,0,0,0,0,1,0,0,1,1,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,26,0,3,3],[0,0,1,1,1,27,20,1,0,0,0,1,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,3],[3,0,0,0,1,0,0,0,0,9,9,1,20,20,1,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,3],[3,3,3,0,1,20,20,0,0,9,9,0,0,0,1,1,20,20,0,0,0,9,9,9,9,9,9,9,9,9,9,3],[3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3]],owners:[{location:{x:2,y:2},player:0},{location:{x:3,y:2},player:0},{location:{x:4,y:2},player:0},{location:{x:1,y:3},player:0},{location:{x:2,y:3},player:0},{location:{x:3,y:3},player:0},{location:{x:2,y:4},player:0},{location:{x:4,y:4},player:0},{location:{x:29,y:22},player:1},{location:{x:30,y:22},player:1},{location:{x:28,y:23},player:1},{location:{x:29,y:23},player:1},{location:{x:30,y:23},player:1},{location:{x:27,y:24},player:1},{location:{x:29,y:24},player:1},{location:{x:28,y:25},player:1}],predeploy:[]},{name:"Shark Strait",size:{width:37,height:30},players:2,map:[[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,3,3,3,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,20,0,0,0,0,27,20,0,20,0,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,27,20,20,0,0,20,0,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,10,10,10,10,9,9,9,9,9,9,10,10,9,0,0,28,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,9,9,9,9,9,9],[9,9,9,10,0,2,20,20,20,2,20,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,9,9,9,9,9,9],[9,9,9,10,0,2,2,2,0,2,2,2,0,0,9,9,9,9,9,13,9,9,9,9,9,9,9,0,0,20,20,0,0,9,9,9,9],[9,9,9,9,0,0,2,2,20,1,1,1,20,20,2,2,0,9,9,9,9,9,9,9,9,0,0,0,0,0,0,3,3,0,9,9,9],[9,9,9,0,20,20,2,0,1,2,2,2,2,1,1,1,28,9,9,9,10,10,9,0,0,20,0,0,3,3,3,0,0,0,0,9,9],[9,9,2,20,1,1,1,20,1,0,3,3,0,1,0,0,2,9,9,9,0,0,0,20,0,0,3,3,0,0,0,0,20,0,0,10,9],[9,9,0,2,1,2,0,2,1,20,3,3,20,1,20,20,2,9,9,9,0,0,0,0,0,3,0,0,2,2,0,20,0,3,0,10,9],[9,9,26,24,1,0,25,0,1,1,1,1,1,1,0,2,9,9,9,0,0,20,0,0,3,1,1,1,1,1,1,1,0,0,0,10,9],[9,9,2,2,24,25,2,20,1,0,0,0,2,1,20,2,9,9,9,0,3,0,0,3,1,1,0,0,0,2,2,1,0,20,0,9,9],[9,9,0,24,19,24,2,0,1,9,9,9,2,1,1,1,9,9,9,0,3,27,0,0,1,0,3,0,20,0,0,1,0,0,9,9,9],[9,9,26,0,24,0,2,20,1,9,9,9,2,2,0,1,6,6,6,1,1,1,0,3,1,0,3,0,0,3,25,1,25,0,9,9,9],[9,9,9,25,1,25,2,2,1,0,0,0,2,0,3,1,9,9,9,0,0,1,0,3,1,0,3,0,0,24,0,24,0,26,9,9,9],[9,9,9,2,1,1,1,1,1,1,1,2,0,2,2,1,9,9,9,0,0,1,0,3,1,0,3,0,0,0,24,19,24,9,9,9,9],[9,9,9,2,0,2,1,2,0,2,1,1,20,1,1,1,9,9,9,0,3,1,1,1,1,0,3,0,0,25,0,24,0,9,9,9,9],[9,9,9,9,20,2,1,0,20,0,2,2,2,0,2,2,9,9,9,0,3,0,0,3,0,0,3,0,2,2,25,0,26,9,9,9,9],[9,9,9,9,2,0,1,20,0,3,0,0,2,27,2,2,9,9,9,0,3,0,0,3,0,0,0,0,0,0,0,0,0,0,9,9,9],[9,9,9,10,0,20,1,0,3,0,20,20,2,0,1,1,6,6,6,0,0,0,0,0,0,20,0,0,3,3,3,3,3,0,9,9,9],[9,9,9,10,0,2,1,2,2,2,3,2,2,3,1,0,9,9,9,0,3,0,0,0,3,0,0,0,2,2,2,2,2,9,9,9,9],[9,9,9,10,0,2,1,1,0,2,2,2,0,2,1,20,9,9,9,9,9,28,20,0,0,3,0,20,2,2,0,2,2,9,9,9,9],[9,9,9,10,0,0,2,1,20,1,1,1,20,1,1,2,9,9,9,9,9,9,9,0,0,0,3,2,2,2,20,2,9,9,9,9,9],[9,9,9,9,9,20,0,0,2,2,0,0,2,2,2,9,9,9,9,13,9,9,9,10,9,0,0,0,2,2,2,9,9,9,9,9,9],[9,9,9,9,9,9,9,20,0,2,20,20,2,9,9,9,9,9,9,9,9,9,9,9,9,9,9,20,0,0,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,28,0,0,0,9,9,9,9,9,9,10,10,10,10,9,9,9,9,9,10,10,10,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,10,10,9,9,9,9,9,9,9,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,13,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,20,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,2,27,20,20,20,0,27,2,2,2,9,9,9,9,9,9,9,9,9,9,9]],owners:[{location:{x:4,y:8},player:0},{location:{x:3,y:9},player:0},{location:{x:2,y:11},player:0},{location:{x:3,y:11},player:0},{location:{x:6,y:11},player:0},{location:{x:4,y:12},player:0},{location:{x:5,y:12},player:0},{location:{x:7,y:12},player:0},{location:{x:3,y:13},player:0},{location:{x:4,y:13},player:0},{location:{x:5,y:13},player:0},{location:{x:2,y:14},player:0},{location:{x:4,y:14},player:0},{location:{x:7,y:14},player:0},{location:{x:3,y:15},player:0},{location:{x:5,y:15},player:0},{location:{x:4,y:18},player:0},{location:{x:32,y:9},player:1},{location:{x:31,y:10},player:1},{location:{x:33,y:12},player:1},{location:{x:28,y:13},player:1},{location:{x:30,y:14},player:1},{location:{x:32,y:14},player:1},{location:{x:29,y:15},player:1},{location:{x:31,y:15},player:1},{location:{x:33,y:15},player:1},{location:{x:30,y:16},player:1},{location:{x:31,y:16},player:1},{location:{x:32,y:16},player:1},{location:{x:29,y:17},player:1},{location:{x:31,y:17},player:1},{location:{x:30,y:18},player:1},{location:{x:32,y:18},player:1}],predeploy:[{location:{x:17,y:2},serial:0,player:1},{location:{x:20,y:3},serial:0,player:1},{location:{x:25,y:7},serial:0,player:1},{location:{x:22,y:9},serial:15,player:1},{location:{x:20,y:9},serial:14,player:1},{location:{x:21,y:18},serial:14,player:1},{location:{x:23,y:18},serial:15,player:1},{location:{x:23,y:23},serial:0,player:1},{location:{x:27,y:24},serial:0,player:1},{location:{x:20,y:28},serial:0,player:1},{location:{x:19,y:12},serial:13,player:1},{location:{x:19,y:18},serial:13,player:1},{location:{x:19,y:15},serial:11,player:1},{location:{x:18,y:14},serial:11,player:1},{location:{x:19,y:19},serial:11,player:1},{location:{x:18,y:20},serial:11,player:1},{location:{x:19,y:21},serial:8,player:1},{location:{x:16,y:20},serial:8,player:1},{location:{x:16,y:14},serial:8,player:1},{location:{x:19,y:13},serial:8,player:1}]},{name:"Mermaid",size:{width:20,height:20},players:2,map:[[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,2,2,2,2,2,2,2,2,9,9,9,9,9],[9,9,9,9,9,9,9,2,2,2,2,9,6,9,2,2,9,9,9,9],[9,9,9,9,9,9,9,20,20,1,20,9,0,9,9,2,2,9,9,9],[9,9,9,9,9,9,9,20,20,1,0,9,9,0,9,20,24,0,9,9],[9,9,9,9,9,9,9,9,24,1,1,1,1,1,6,1,19,2,9,9],[9,9,9,9,9,9,9,1,1,1,3,3,0,9,9,20,24,2,9,9],[9,9,9,9,9,9,1,1,3,1,3,3,9,9,2,2,2,2,9,9],[9,9,9,9,9,1,1,3,3,1,1,1,9,2,2,2,2,9,9,9],[9,9,9,9,9,1,9,9,9,0,0,1,9,9,9,9,9,9,9,9],[9,9,6,6,6,6,9,9,9,2,2,1,9,9,9,9,9,9,9,9],[9,10,1,10,9,9,9,9,20,2,2,1,9,9,9,9,2,9,9,9],[9,10,1,10,9,9,9,9,20,24,2,1,9,9,9,24,9,9,9,9],[8,8,1,1,24,9,9,9,20,2,2,1,1,1,1,1,19,9,9,9],[10,8,8,1,1,24,9,9,9,9,2,2,2,20,20,24,9,9,9,9],[10,20,8,4,1,1,24,9,9,9,9,9,6,9,9,9,2,9,9,9],[10,20,8,8,8,1,1,10,9,9,9,9,1,9,9,9,9,9,9,3],[2,8,8,8,8,20,1,1,10,9,0,1,1,20,0,3,9,3,3,3],[8,8,2,20,8,8,20,1,1,1,1,1,20,20,3,3,3,3,3,3]],owners:[{location:{x:15,y:5},player:0},{location:{x:16,y:5},player:0},{location:{x:16,y:6},player:0},{location:{x:15,y:7},player:0},{location:{x:16,y:7},player:0},{location:{x:15,y:13},player:1},{location:{x:16,y:14},player:1},{location:{x:13,y:15},player:1},{location:{x:14,y:15},player:1},{location:{x:15,y:15},player:1}],predeploy:[]},{name:"Split Island",size:{width:20,height:20},players:2,map:[[12,12,12,12,9,9,9,9,9,9,9,9,9,9,9,9,9,9,12,12],[12,12,9,9,9,12,9,9,9,10,10,10,10,10,10,9,9,9,9,9],[9,9,9,9,9,9,6,6,6,1,1,1,1,1,1,24,26,9,9,12],[12,9,9,12,9,9,6,9,9,20,0,2,20,25,24,19,25,9,9,9],[9,9,9,9,9,2,1,9,9,9,10,20,2,0,20,1,24,0,9,9],[9,12,9,9,1,1,1,1,9,9,9,10,1,1,1,1,0,20,9,9],[9,9,9,9,1,0,20,1,0,20,9,9,6,9,2,2,10,10,9,12],[9,9,0,1,1,2,0,1,2,0,2,9,6,9,10,10,9,9,9,9],[9,9,20,1,2,0,0,1,20,0,0,20,1,9,9,9,9,20,9,9],[9,9,2,1,20,2,2,1,1,1,1,1,1,1,1,1,1,2,9,9],[9,10,0,1,3,2,2,20,2,2,20,2,0,20,0,2,1,0,9,9],[9,10,20,1,2,3,2,2,2,2,2,3,2,2,2,0,1,20,9,12],[9,10,0,1,0,2,2,3,3,2,2,2,3,3,3,20,1,9,9,9],[9,10,2,1,0,0,2,2,2,2,3,3,3,3,1,1,1,9,9,9],[9,9,9,1,20,25,2,25,2,0,2,3,1,1,1,10,9,9,9,9],[9,9,9,1,1,1,1,1,1,1,1,1,1,20,10,9,9,12,9,9],[9,12,9,9,2,24,19,24,0,20,0,2,10,10,9,9,9,9,9,12],[9,9,9,9,9,26,24,0,20,9,9,9,9,9,9,12,9,9,9,9],[12,9,9,9,9,9,9,9,9,9,9,9,12,9,9,9,9,9,12,12],[12,12,9,12,9,9,9,9,9,9,12,9,9,9,12,9,9,12,12,12]],owners:[{location:{x:4,y:14},player:0},{location:{x:5,y:14},player:0},{location:{x:7,y:14},player:0},{location:{x:5,y:16},player:0},{location:{x:6,y:16},player:0},{location:{x:7,y:16},player:0},{location:{x:9,y:16},player:0},{location:{x:5,y:17},player:0},{location:{x:6,y:17},player:0},{location:{x:8,y:17},player:0},{location:{x:15,y:2},player:1},{location:{x:16,y:2},player:1},{location:{x:12,y:3},player:1},{location:{x:13,y:3},player:1},{location:{x:14,y:3},player:1},{location:{x:15,y:3},player:1},{location:{x:16,y:3},player:1},{location:{x:14,y:4},player:1},{location:{x:16,y:4},player:1},{location:{x:17,y:5},player:1}],predeploy:[]},{name:"Scissor Basin",size:{width:20,height:20},players:2,map:[[3,3,4,4,0,4,24,0,25,4,3,3,3,8,8,3,8,3,8,8],[0,4,4,3,3,0,0,19,0,0,3,3,8,8,3,3,8,8,8,3],[4,3,4,3,3,4,0,0,24,0,4,3,8,3,3,3,3,3,3,3],[0,4,0,3,3,3,4,0,0,4,4,8,8,3,3,3,3,3,0,20],[4,3,3,3,3,3,3,3,4,4,0,8,3,20,3,3,3,0,20,0],[20,3,3,3,3,3,3,3,3,0,0,7,4,0,0,3,4,0,0,8],[3,3,3,4,0,0,0,4,4,4,0,8,0,4,4,3,3,8,7,8],[3,3,0,0,3,0,4,20,20,20,8,8,4,24,8,8,8,8,0,20],[3,0,0,24,0,3,3,8,8,8,8,8,8,7,8,3,3,3,20,0],[3,20,8,7,8,8,8,8,8,3,3,2,8,4,3,3,3,3,2,2],[8,8,8,24,0,0,20,0,3,20,20,20,8,2,3,2,0,24,3,3],[3,3,20,2,2,0,0,0,0,2,2,2,8,2,0,20,3,0,2,2],[8,3,3,3,3,3,2,0,2,0,0,0,7,0,0,0,3,3,3,2],[3,3,3,3,3,3,3,3,0,0,8,8,8,2,3,0,2,3,3,2],[3,2,2,3,3,2,3,3,2,8,8,3,2,2,3,3,0,0,2,2],[2,2,2,0,0,2,2,8,8,8,3,0,0,2,20,2,0,2,2,3],[4,2,0,0,0,0,8,8,0,0,0,0,0,0,2,2,2,0,3,3],[2,24,2,2,3,2,7,2,2,0,0,0,0,0,0,2,2,3,3,3],[0,2,19,3,3,0,8,3,2,2,2,2,0,2,3,3,3,3,8,8],[3,25,2,24,0,0,8,8,8,3,3,3,3,3,3,3,3,8,8,20]],owners:[{location:{x:6,y:0},player:0},{location:{x:8,y:0},player:0},{location:{x:7,y:1},player:0},{location:{x:8,y:2},player:0},{location:{x:13,y:4},player:0},{location:{x:1,y:9},player:0},{location:{x:6,y:10},player:1},{location:{x:2,y:11},player:1},{location:{x:15,y:11},player:1},{location:{x:14,y:15},player:1},{location:{x:1,y:17},player:1},{location:{x:2,y:18},player:1},{location:{x:1,y:19},player:1},{location:{x:3,y:19},player:1}],predeploy:[]},{name:"Antipode Map",size:{width:26,height:22},players:2,map:[[11,11,11,11,11,11,11,11,9,9,9,9,9,9,9,9,9,9,9,11,11,11,11,11,11,11],[11,11,11,11,11,11,11,9,9,9,9,9,9,9,9,9,9,9,9,11,11,11,11,11,11,11],[11,11,11,11,11,9,9,9,13,9,9,9,9,9,9,9,9,9,9,9,11,11,11,11,11,11],[11,11,11,9,9,9,9,9,9,9,9,0,9,2,9,9,9,0,9,9,9,11,11,11,11,11],[11,11,11,9,9,9,9,9,20,0,9,2,0,0,9,13,9,20,9,9,9,9,11,11,11,11],[11,9,9,9,13,9,1,1,1,1,1,1,1,10,9,9,9,2,0,9,9,9,9,11,11,11],[9,9,9,9,9,10,1,2,3,20,1,20,1,1,1,10,10,20,0,10,9,9,9,9,9,11],[9,9,9,9,10,1,1,1,1,1,1,2,20,20,1,1,1,1,3,0,0,10,9,13,9,9],[9,9,9,1,1,1,0,20,1,2,2,20,3,3,1,20,0,1,3,3,20,0,10,9,9,9],[9,9,10,1,3,0,2,2,1,20,3,3,3,1,1,1,4,1,1,1,1,1,1,9,9,9],[9,9,0,1,3,3,3,2,1,3,3,3,20,1,20,1,4,20,1,4,3,0,1,0,9,9],[9,9,24,1,2,3,3,3,1,1,3,1,1,1,4,1,1,4,1,4,0,0,1,20,9,9],[9,9,20,1,1,3,3,3,2,1,1,1,0,4,3,4,1,4,1,0,3,0,1,20,9,9],[9,9,9,20,1,2,2,20,2,0,1,0,4,20,4,4,1,2,1,2,3,1,1,24,9,9],[9,9,9,19,1,20,2,1,1,1,20,1,1,1,1,1,20,4,20,2,3,1,20,9,9,9],[9,9,9,20,1,1,1,1,10,9,9,9,10,4,4,4,1,2,1,3,3,1,19,9,9,9],[9,9,9,26,24,26,9,9,9,9,9,9,9,9,4,10,1,1,1,3,2,1,20,9,9,9],[11,9,9,9,9,9,9,9,13,9,9,9,9,9,9,9,10,1,1,1,1,24,26,9,9,9],[11,11,9,9,9,9,9,9,9,9,9,9,9,9,9,13,9,10,0,0,26,9,9,9,9,9],[11,11,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11],[11,11,11,9,9,9,9,9,11,11,11,11,11,9,9,9,9,9,9,9,9,9,9,9,9,11],[11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,9,9,9,9,9,9,9,9,9,11,11]],owners:[{location:{x:23,y:11},player:0},{location:{x:23,y:12},player:0},{location:{x:23,y:13},player:0},{location:{x:22,y:14},player:0},{location:{x:22,y:15},player:0},{location:{x:22,y:16},player:0},{location:{x:21,y:17},player:0},{location:{x:22,y:17},player:0},{location:{x:20,y:18},player:0},{location:{x:2,y:11},player:1},{location:{x:2,y:12},player:1},{location:{x:3,y:13},player:1},{location:{x:13,y:13},player:1},{location:{x:3,y:14},player:1},{location:{x:5,y:14},player:1},{location:{x:3,y:15},player:1},{location:{x:3,y:16},player:1},{location:{x:4,y:16},player:1},{location:{x:5,y:16},player:1}],predeploy:[]},{name:"Port Mouth",size:{width:30,height:20},players:3,map:[[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,0,0,0,0,2,20,2,2,0,10],[9,9,9,9,9,1,1,1,6,1,1,1,1,26,2,10,10,0,9,9,10,9,9,9,26,3,2,20,3,9],[9,9,9,20,24,1,2,10,9,10,2,20,0,3,2,10,10,1,10,10,10,9,9,9,9,9,0,2,9,9],[9,9,26,20,19,1,20,9,9,10,2,3,0,2,2,9,9,1,2,3,20,2,2,10,9,9,9,9,9,9],[9,9,3,2,2,1,24,10,10,10,0,0,0,3,20,9,9,1,20,0,0,2,0,10,9,9,9,9,9,9],[9,9,9,2,0,1,3,3,0,20,3,3,1,1,1,10,10,1,1,1,3,3,3,10,10,9,9,9,13,9],[9,9,9,9,3,1,20,2,0,3,3,3,1,0,24,10,10,2,0,1,3,3,2,2,24,26,9,9,9,9],[9,9,9,9,9,1,1,1,1,1,1,1,1,9,9,9,9,20,2,1,2,20,0,2,19,20,9,9,9,9],[13,9,9,9,9,1,20,0,0,2,1,3,0,9,9,9,9,2,3,1,1,1,1,1,1,2,9,9,9,9],[9,9,3,20,1,1,2,0,2,24,1,9,9,9,13,9,9,3,3,1,10,10,10,3,24,20,9,9,9,9],[9,9,20,2,1,0,2,9,9,9,6,9,9,9,9,9,9,3,3,1,10,9,9,9,9,9,9,9,9,9],[9,9,9,9,26,9,9,9,9,9,6,9,9,9,24,2,3,3,20,1,10,9,9,9,9,9,9,9,9,9],[10,10,9,10,1,9,9,9,9,9,1,3,2,1,1,1,1,1,1,1,10,9,9,9,9,9,9,13,9,9],[2,2,9,10,1,1,1,1,1,1,1,1,1,1,0,2,2,20,2,26,9,9,9,9,9,9,9,9,9,9],[20,26,9,9,20,2,0,3,2,20,2,1,3,3,3,10,10,10,9,9,9,9,9,26,2,3,9,9,9,9],[2,2,9,9,9,9,10,10,10,10,1,1,20,3,3,10,9,9,9,9,9,9,3,2,20,2,9,9,9,9],[3,2,2,9,9,9,9,9,9,9,1,24,2,0,3,10,9,9,9,9,10,2,20,2,0,9,9,9,9,9],[3,20,2,9,9,9,9,9,9,9,1,19,24,20,2,10,9,9,9,9,10,0,0,3,10,9,9,13,9,9],[9,3,3,3,9,13,9,9,9,9,1,26,9,9,9,9,9,9,13,9,10,0,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9]],owners:[{location:{x:24,y:6},player:0},{location:{x:25,y:6},player:0},{location:{x:24,y:7},player:0},{location:{x:24,y:9},player:0},{location:{x:11,y:16},player:1},{location:{x:11,y:17},player:1},{location:{x:12,y:17},player:1},{location:{x:11,y:18},player:1},{location:{x:4,y:2},player:2},{location:{x:2,y:3},player:2},{location:{x:4,y:3},player:2},{location:{x:6,y:4},player:2}],predeploy:[]}],Fg=[{name:"Double-Blackhole Pond",size:{width:30,height:20},players:4,map:[[3,2,0,20,1,1,1,6,1,1,1,20,2,2,24,3,3,2,3,8,2,0,3,3,2,20,0,2,3,8],[3,24,2,1,1,2,8,8,2,0,1,1,19,1,1,0,2,3,8,8,0,24,2,0,1,1,1,1,2,8],[2,1,1,1,0,20,8,3,0,2,20,0,24,2,1,1,1,2,8,2,0,1,1,1,1,8,8,6,8,8],[0,1,2,3,2,8,8,8,8,8,8,2,0,0,20,0,1,1,6,1,1,1,0,2,8,8,20,1,0,3],[2,1,8,8,8,8,2,3,2,20,8,8,8,8,0,2,1,0,8,8,20,2,3,3,8,20,0,1,20,2],[8,6,8,2,3,2,3,0,2,2,0,2,20,8,8,24,1,2,20,8,0,10,3,8,8,0,24,19,0,3],[2,1,1,1,2,3,25,2,1,1,1,1,0,3,8,1,1,3,0,8,2,10,2,8,2,0,0,1,2,3],[0,20,2,1,1,3,8,8,6,8,8,1,2,8,8,1,0,0,2,8,3,20,8,8,3,20,1,1,24,2],[3,2,0,8,6,8,8,1,1,0,8,1,1,8,1,1,2,20,9,9,9,3,8,20,0,2,1,8,8,8],[3,0,8,8,1,1,1,1,20,9,9,9,1,6,1,3,8,8,9,9,9,8,8,2,24,1,1,8,3,2],[2,3,8,1,1,24,2,8,8,9,9,9,8,8,3,1,6,1,9,9,9,20,1,1,1,1,8,8,0,3],[8,8,8,1,2,0,20,8,3,9,9,9,20,2,1,1,8,1,1,8,0,1,1,8,8,6,8,0,2,3],[2,24,1,1,20,3,8,8,20,3,8,2,0,0,1,8,8,2,1,8,8,6,8,8,3,1,1,2,20,0],[3,2,1,0,0,2,8,2,10,2,8,0,3,1,1,8,3,0,1,1,1,1,2,25,3,2,1,1,1,2],[3,0,19,24,0,8,8,3,10,0,8,20,2,1,24,8,8,20,2,0,2,2,0,3,2,3,2,8,6,8],[2,20,1,0,20,8,3,3,2,20,8,8,0,1,2,0,8,8,8,8,20,2,3,2,8,8,8,8,1,2],[3,0,1,20,8,8,2,0,1,1,1,6,1,1,0,20,0,0,2,8,8,8,8,8,8,2,3,2,1,0],[8,8,6,8,8,1,1,1,1,0,2,8,2,1,1,1,2,24,0,20,2,0,3,8,20,0,1,1,1,2],[8,2,1,1,1,1,0,2,24,0,8,8,3,2,0,1,1,19,1,1,0,2,8,8,2,1,1,2,24,3],[8,3,2,0,20,2,3,3,0,2,8,3,2,3,3,24,2,2,20,1,1,1,6,1,1,1,20,0,2,3]],owners:[{location:{x:11,y:0},player:0},{location:{x:14,y:0},player:0},{location:{x:12,y:1},player:0},{location:{x:10,y:2},player:0},{location:{x:12,y:2},player:0},{location:{x:14,y:3},player:0},{location:{x:15,y:16},player:1},{location:{x:17,y:17},player:1},{location:{x:19,y:17},player:1},{location:{x:17,y:18},player:1},{location:{x:15,y:19},player:1},{location:{x:18,y:19},player:1},{location:{x:1,y:12},player:2},{location:{x:4,y:12},player:2},{location:{x:2,y:14},player:2},{location:{x:3,y:14},player:2},{location:{x:1,y:15},player:2},{location:{x:3,y:16},player:2},{location:{x:26,y:3},player:3},{location:{x:28,y:4},player:3},{location:{x:26,y:5},player:3},{location:{x:27,y:5},player:3},{location:{x:25,y:7},player:3},{location:{x:28,y:7},player:3}],predeploy:[]},{name:"Brewer's Star",size:{width:33,height:33},players:4,map:[[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,0,0,3,9,9,9,20,0,10,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,3,0,20,0,3,10,9,9,10,0,20,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,3,0,25,20,0,0,10,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,10,20,9,0,0,20,0,2,2,20,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,10,0,10,9,0,20,2,1,1,1,0,0,0,20,0,0,0,9,3,0,24,19,9,9,9,9,9,9],[9,9,9,9,9,20,10,9,10,0,2,1,1,20,1,1,1,1,0,0,0,20,3,0,0,20,24,9,9,9,9,9,9],[9,9,9,9,9,9,9,10,20,0,1,1,0,2,2,0,20,1,1,1,1,2,2,20,25,0,0,9,9,9,9,9,9],[9,9,9,9,9,0,0,0,0,1,1,20,0,2,0,2,0,0,0,20,1,1,1,1,20,0,3,9,9,9,9,9,9],[9,9,9,3,3,0,20,2,1,1,0,0,2,0,26,9,10,10,3,0,2,2,20,1,2,3,9,9,9,9,9,9,9],[9,19,24,0,0,20,2,1,1,20,0,3,10,9,9,9,9,9,9,2,0,0,2,1,2,20,0,9,9,9,9,9,9],[9,24,0,20,25,0,1,1,0,0,2,10,9,9,0,26,0,9,9,9,26,0,2,1,1,0,0,9,9,20,9,9,9],[9,9,3,0,20,2,1,20,2,2,0,9,9,0,0,20,0,0,0,26,9,2,0,20,1,0,0,9,9,0,10,9,9],[9,9,9,3,0,2,1,1,2,0,26,9,0,0,0,2,2,2,20,0,9,9,3,0,1,0,20,9,9,10,0,9,9],[9,9,9,10,0,20,0,1,0,2,9,9,26,20,2,2,0,2,2,0,9,9,10,0,1,1,0,0,9,9,20,9,9],[9,9,9,9,10,0,0,1,20,0,10,9,0,0,2,0,21,0,2,0,0,9,10,0,20,1,0,0,10,9,9,9,9],[9,9,20,9,9,0,0,1,1,0,10,9,9,0,2,2,0,2,2,20,26,9,9,2,0,1,0,20,0,10,9,9,9],[9,9,0,10,9,9,20,0,1,0,3,9,9,0,20,2,2,2,0,0,0,9,26,0,2,1,1,2,0,3,9,9,9],[9,9,10,0,9,9,0,0,1,20,0,2,9,26,0,0,0,20,0,0,9,9,0,2,2,20,1,2,20,0,3,9,9],[9,9,9,20,9,9,0,0,1,1,2,0,26,9,9,9,0,26,0,9,9,10,2,0,0,1,1,0,25,20,0,24,9],[9,9,9,9,9,9,0,20,2,1,2,0,0,2,9,9,9,9,9,9,10,3,0,20,1,1,2,20,0,0,24,19,9],[9,9,9,9,9,9,9,3,2,1,20,2,2,0,3,10,10,9,26,0,2,0,0,1,1,2,20,0,3,3,9,9,9],[9,9,9,9,9,9,3,0,20,1,1,1,1,20,0,0,0,2,0,2,0,20,1,1,0,0,0,0,9,9,9,9,9],[9,9,9,9,9,9,0,0,25,20,2,2,1,1,1,1,20,0,2,2,0,1,1,0,20,10,9,9,9,9,9,9,9],[9,9,9,9,9,9,24,20,0,0,3,20,0,0,0,1,1,1,1,20,1,1,2,0,10,9,10,20,9,9,9,9,9],[9,9,9,9,9,9,19,24,0,3,9,0,0,0,20,0,0,0,1,1,1,2,20,0,9,10,0,10,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,20,2,2,0,20,0,0,9,20,10,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,0,0,20,25,0,3,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,20,0,10,9,9,10,3,0,20,0,3,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,10,0,20,9,9,9,3,0,0,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,9,9,9,9,9,9,9,9,9,9,9],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9]],owners:[{location:{x:6,y:25},player:0},{location:{x:6,y:26},player:0},{location:{x:7,y:26},player:0},{location:{x:25,y:6},player:1},{location:{x:26,y:6},player:1},{location:{x:26,y:7},player:1},{location:{x:1,y:11},player:2},{location:{x:2,y:11},player:2},{location:{x:1,y:12},player:2},{location:{x:31,y:20},player:3},{location:{x:30,y:21},player:3},{location:{x:31,y:21},player:3}],predeploy:[]}];function Bg(t){return function(t){if(Array.isArray(t))return Ug(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ug(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ug(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ug(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Gg(t,e){return{fontName:t,fontSize:e}}(Ig||(Ig={})).fromCriteria=function(t){return[].concat(Bg(zI.developmentMode&&Mg||[]),Bg(Dg),Bg(Lg),Bg(Ng),Bg(Fg),Bg(zI.developmentMode?jg:[]))};var Xg={title:Gg("font-title",10),scriptOutlined:Gg("font-map-ui",14),smallScriptOutlined:Gg("font-small-ui",12),script:Gg("font-script",10),list:Gg("font-table-header",6),menu:Gg("font-menu",12),dayCounter:Gg("font-day-ui",24),playerSplash:Gg("font-player-splash",35),tectac:Gg("TecTacRegular",8)},n=cm.HSV,Hg=l1.freezeObject({white:n(0,0,100),black:n(0,0,0),carbon1:n(0,0,10),carbon2:n(0,0,20),carbon3:n(0,0,30),grey1:n(0,0,40),grey2:n(0,0,50),grey3:n(0,0,60),cerebral_grey1:n(0,0,70),cerebral_grey2:n(0,0,80),cerebral_grey3:n(0,0,90),gale_force1:n(200,30,30),gale_force2:n(215,25,35),cloudless:n(220,15,100),encore:n(220,15,50),caribbean_green:n(166,100,80),terrestrial:n(170,65,40),blister_pearl:n(170,35,100),blueprint:n(200,54,48),pelati:n(0,80,100),standing_ovation:n(220,5,75),asian_violet:n(220,6,54),light_slipper_satin:n(220,5,85),boerewors:n(350,68,58),hibiscus_petal:n(0,29,93),pepper_jelly:n(350,80,80),regal_destiny:n(220,68,54),maximum_blue_purple:n(240,29,93),janitor:n(220,80,80),tarnished_brass:n(48,68,50),master_key:n(48,38,87),lemon_ginger:n(48,68,58),grass_daisy:n(48,80,80),gulfweed:n(130,68,58),weekend_gardener:n(130,30,90),green_envy:n(130,80,70),black_dahlia:n(300,10,30),decorative_iris:n(300,10,50)});function zg(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function Vg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zg(Object(n),!0).forEach(function(t){Yg(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zg(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Wg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yg(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var qg=function(){function o(t){function n(t){return void 0!==t?t:0}function e(t,e){void 0!==e&&(t.left=n(e.left),t.right=n(e.right),t.top=n(e.top),t.bottom=n(e.bottom))}!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),Yg(this,"_width",0),Yg(this,"_height",0),Yg(this,"minWidth",0),Yg(this,"minHeight",0),Yg(this,"margin",{left:0,right:0,top:0,bottom:0}),Yg(this,"border",{left:0,right:0,top:0,bottom:0}),Yg(this,"padding",{left:0,right:0,top:0,bottom:0}),Yg(this,"children",[]),this._width=n(t.width),this._height=n(t.height),this.minWidth=n(t.minWidth),this.minHeight=n(t.minHeight),e(this.margin,t.margin),e(this.border,t.border),e(this.padding,t.padding),this.children=t.children||[]}var t,e,n;return t=o,(e=[{key:"merge",value:function(e){function t(){var t=e||{};return{width:t.width,height:t.height,minWidth:t.minWidth,minHeight:t.minHeight,margin:t.margin,border:t.border,padding:t.padding}}var n=t(),r=t(),i=Vg(Vg({},r),n);return i.margin=Vg(Vg({},r.margin),n.margin),i.border=Vg(Vg({},r.border),n.border),i.padding=Vg(Vg({},r.padding),n.padding),new o(i)}},{key:"width",get:function(){var t=this.children.map(function(t){return t.containerBox().width}).reduce(function(t,e){return Math.max(t,e)},0);return Math.max(this._width,t,this.minWidth)},set:function(t){this._width=t}},{key:"height",get:function(){var t=this.children.map(function(t){return t.containerBox().height}).reduce(function(t,e){return t+e},0);return Math.max(this._height,t,this.minHeight)},set:function(t){this._height=t}},{key:"elementWidth",get:function(){return this.containerBox().width}},{key:"elementHeight",get:function(){return this.containerBox().height}},{key:"buildRect",value:function(t,e){var n=t.map(function(t){return t.left}).reduce(function(t,e){return t+e},0),r=t.map(function(t){return t.top}).reduce(function(t,e){return t+e},0),t=e.map(function(t){return t.left+t.right}).reduce(function(t,e){return t+e},0)+this.width,e=e.map(function(t){return t.top+t.bottom}).reduce(function(t,e){return t+e},0)+this.height;return new pe(n,r,t,e)}},{key:"contentBox",value:function(){return this.buildRect([this.margin,this.border,this.padding],[])}},{key:"borderInnerBox",value:function(){return this.buildRect([this.margin,this.border],[this.padding])}},{key:"borderOuterBox",value:function(){return this.buildRect([this.margin],[this.border,this.padding])}},{key:"containerBox",value:function(){return this.buildRect([],[this.margin,this.border,this.padding])}}])&&Wg(t.prototype,e),n&&Wg(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function Kg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zg(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Qg=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Zg(this,"_track",0),Zg(this,"min",void 0),Zg(this,"max",void 0),Zg(this,"granularity",void 0),Zg(this,"outputFunction",void 0),Zg(this,"outputPrecision",void 0),Zg(this,"incrementFactor",void 0),Zg(this,"looping",void 0),Zg(this,"maxInclusive",void 0),Zg(this,"bouncing",void 0),this.min=t.min||0,this.max=t.max||1,this._track=this.min,this.granularity=Math.abs(t.granularity||.1),this.outputFunction=t.shape||function(t){return t},this.outputPrecision=Math.abs(t.outputPrecision||0),this.incrementFactor=t.incrementFactor||1,this.looping=t.looping||!1,this.maxInclusive=t.maxInclusive||!1,this.bouncing=t.bouncing||!1,this.track=t.track||this.min,O1.assert(this.min<this.max,"Slider was given conflicting min/max values: min=".concat(this.min,", max=").concat(this.max))}var t,n,r;return t=e,(n=[{key:"output",get:function(){return this.applyGrain(this.outputFunction(this._track),this.outputPrecision)}},{key:"range",get:function(){return this.max-this.min}},{key:"equalsMax",value:function(){return this._track==this.max}},{key:"equalsMin",value:function(){return this._track==this.min}},{key:"equalsBoundary",value:function(){return this.equalsMax()||this.equalsMin()}},{key:"track",get:function(){return this._track},set:function(t){var e;this._track="max"===t?this.max:"min"===t?this.min:t,this.looping?(e=this.decimal(),t=this.maxInclusive?this.range+this.granularity:this.range,this._track=this.min+t*(e-Math.floor(e))):this.bouncing&&this.equalsBoundary()&&(this.incrementFactor=-this.incrementFactor),this._track=this.applyGrain(this._track,this.granularity),this._track=l1.confine(this._track,this.min,this.max)}},{key:"tracknum",get:function(){return this._track},set:function(t){this.track=t}},{key:"decimal",value:function(){return 0!==this.range?(this._track-this.min)/this.range:0}},{key:"setDecimal",value:function(t){t=t*this.range+this.min,this.track=t}},{key:"setToMin",value:function(){this._track=this.min}},{key:"setToMax",value:function(){this._track=this.max}},{key:"setToExtreme",value:function(){var t;0!==this.incrementFactor&&(t=Math.sign(this.incrementFactor)<0?"min":"max",this.track=t)}},{key:"setByProportion",value:function(t){this.track=t*this.range+this.min}},{key:"increment",value:function(){this.tracknum+=this.granularity*this.incrementFactor*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)}},{key:"decrement",value:function(){this.tracknum-=this.granularity*this.incrementFactor*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)}},{key:"applyGrain",value:function(t,e){if(0===e)return t;t/=e,t=Math.round(t);return t*=e}}])&&Kg(t.prototype,n),r&&Kg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function $g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Jg(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var tb=function(){function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length?arguments[1]:void 0,n=2<arguments.length?arguments[2]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),Jg(this,"_active",!1),Jg(this,"_firstIntervalComplete",!1),Jg(this,"_pulses",0),Jg(this,"clock",0),Jg(this,"_interval",void 0),Jg(this,"firstInterval",void 0),Jg(this,"action",void 0),Jg(this,"context",void 0);t="number"!=typeof t?t:{interval:t};this._interval=t.interval,this.firstInterval=t.firstInterval||this._interval,this.action=e,this.context=n||null,zI.scene.ticker.add(this.update,this)}var t,e,n;return t=r,(e=[{key:"active",get:function(){return this._active}},{key:"firstIntervalComplete",get:function(){return this._firstIntervalComplete}},{key:"pulseCount",get:function(){return this._pulses}},{key:"interval",get:function(){return this._interval},set:function(t){var e=this.firstInterval===this._interval;this.firstInterval=e?t:this.firstInterval,this._interval=t}},{key:"frequency",get:function(){return 60/this._interval},set:function(t){this._interval=60/t}},{key:"destroy",value:function(){zI.scene.ticker.remove(this.update,this)}},{key:"update",value:function(){var t;this.active&&(t=this._firstIntervalComplete?this._interval:this.firstInterval,this.clock+=zI.delta,this.clock>t&&(this.clock-=t,this._firstIntervalComplete=!0,this._pulses++,this.action.call(this.context)))}},{key:"start",value:function(){this._active=!0}},{key:"startReset",value:function(){this.reset(),this.start()}},{key:"stop",value:function(){this._active=!1,this.reset()}},{key:"reset",value:function(){this.clock=0,this._firstIntervalComplete=!1,this._pulses=0}}])&&$g(t.prototype,e),n&&$g(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function eb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nb(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var rb=function(){function n(t){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),nb(this,"sprite",new T.Container),nb(this,"settings",{thickness:2,color:Hg.caribbean_green,motionFrames:3,pulseFrameInterval:3}),nb(this,"goalPose",new T.Rectangle),nb(this,"lastPose",new T.Rectangle),nb(this,"motionSlider",new Qg({track:"max",granularity:1/this.settings.motionFrames,shape:function(t){return Math.sqrt(t)}})),nb(this,"animSlider",new Qg({max:3,track:"max",granularity:1/this.settings.pulseFrameInterval,shape:function(t){return Math.floor(t)}})),nb(this,"animPulsar",new tb({firstInterval:20,interval:40},function(){e.animSlider.track="min"},this)),null!=t&&t.addChild(this.sprite),this.animPulsar.start(),zI.scene.ticker.add(this.update,this)}var t,e,r;return t=n,(e=[{key:"rect",get:function(){return this.goalPose},set:function(t){this.lastPose=this.goalPose,this.goalPose=t,this.motionSlider.track="min"}},{key:"destroy",value:function(){this.sprite.destroy(),this.animPulsar.destroy(),zI.scene.ticker.remove(this.update,this)}},{key:"update",value:function(){this.motionSlider.increment(),this.animSlider.increment(),this.updateFrame()}},{key:"updateFrame",value:function(){var t,e,n,r,i;this.sprite.visible&&(e=new Tm(this.goalPose),r=new Tm(this.goalPose.width,this.goalPose.height),n=new Tm(this.lastPose),i=new Tm(this.lastPose.width,this.lastPose.height),t=e.subtract(n).multiply(this.motionSlider.output).add(n),e=r.subtract(i).multiply(this.motionSlider.output).add(i),n=[1,2,1,0][this.animSlider.output],r=this.settings.thickness,(i=new T.Graphics).beginFill(this.settings.color),i.drawRect(t.x-r+n,t.y-r+n,e.x+2*r-2*n,e.y+2*r-2*n),i.endFill(),i.beginHole(),i.drawRect(t.x+n,t.y+n,e.x-2*n,e.y-2*n),i.endHole(),this.sprite.removeChildren(),this.sprite.addChild(i))}},{key:"skipMotion",value:function(){this.motionSlider.track="max",this.animSlider.track="max",this.animPulsar.reset()}}])&&eb(t.prototype,e),r&&eb(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}();function ib(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ob=function(){function r(){var t,e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),t=this,e="container",n=new T.Container,e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,zI.scene.ticker.add(this.update,this)}var t,e,n;return t=r,(e=[{key:"destroy",value:function(){this.container.destroy({children:!0}),zI.scene.ticker.remove(this.update,this)}},{key:"update",value:function(){}},{key:"arrangeChildren",value:function(){}},{key:"show",value:function(){this.container.visible=!0}},{key:"hide",value:function(){this.container.visible=!1}}])&&ib(t.prototype,e),n&&ib(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function ab(t){return(ab="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ub(){return(ub="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=fb(t)););return t}(t,e);if(r){e=Object.getOwnPropertyDescriptor(r,e);return e.get?e.get.call(arguments.length<3?t:n):e.value}}).apply(this,arguments)}function cb(t,e){return(cb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function lb(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=fb(n);return function(t,e){{if(e&&("object"===ab(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return hb(t)}(this,r?(t=fb(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function hb(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fb(t){return(fb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pb(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var db=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cb(t,e)}(i,ob);var t,e,n,r=lb(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),pb(hb(e=r.call(this)),"bgSprite",new T.Sprite),pb(hb(e),"lampSprite",new T.Sprite),pb(hb(e),"timer",void 0),e.bgSprite.texture=t.background,e.lampSprite.texture=t.lamp,e.lampSprite.anchor.set(.5),e.lampSprite.position.set(e.bgSprite.width/2,e.bgSprite.height/2),e.lampSprite.alpha=0,e.container.addChild(e.bgSprite,e.lampSprite),e}return t=i,(e=[{key:"destroy",value:function(){var t;ub(fb(i.prototype),"destroy",this).call(this),null!==(t=this.timer)&&void 0!==t&&t.destroy()}},{key:"lampOn",value:function(){var t;null!==(t=this.timer)&&void 0!==t&&t.destroy(),this.timer=Wm.tween(.05,this.lampSprite,{alpha:1})}},{key:"lampOff",value:function(){var t;null!==(t=this.timer)&&void 0!==t&&t.destroy(),this.timer=Wm.tween(.05,this.lampSprite,{alpha:0})}},{key:"skip",value:function(){var t;null!==(t=this.timer)&&void 0!==t&&t.skip()}}])&&sb(t.prototype,e),n&&sb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function yb(t){return(yb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vb(){return(vb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=xb(t)););return t}(t,e);if(r){e=Object.getOwnPropertyDescriptor(r,e);return e.get?e.get.call(arguments.length<3?t:n):e.value}}).apply(this,arguments)}function gb(t,e){return(gb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function bb(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=xb(n);return function(t,e){{if(e&&("object"===yb(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return _b(t)}(this,r?(t=xb(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function _b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xb(t){return(xb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wb(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Tb=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gb(t,e)}(i,ob);var t,e,n,r=bb(i);function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),wb(_b(n=r.call(this)),"sprite",new T.Sprite),wb(_b(n),"textureSet",void 0),wb(_b(n),"pointer",new Em(n.sprite)),wb(_b(n),"disabled",!1),wb(_b(n),"triggerIndicatorLight",void 0),n.textureSet=t,n.sprite.texture=n.textureSet.enabled,n.container.addChild(n.sprite),n.triggerIndicatorLight=e,n}return t=i,(e=[{key:"destroy",value:function(){vb(xb(i.prototype),"destroy",this).call(this),this.sprite.destroy({children:!0}),this.pointer.destroy(),this.triggerIndicatorLight=void 0}},{key:"update",value:function(){vb(xb(i.prototype),"update",this).call(this);var t,e=this.sprite,n=this.pointer,r=this.textureSet;this.disabled?e.texture=r.disabled:(t=this.triggerIndicatorLight&&this.triggerIndicatorLight(),e.texture=n.button.down?r.depressed:n.pointerOver||t?r.hovered:r.enabled)}}])&&mb(t.prototype,e),n&&mb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function Ob(t){return(Ob="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sb(t,e){return(Sb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Eb(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=kb(n);return function(t,e){{if(e&&("object"===Ob(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return Pb(t)}(this,r?(t=kb(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function Pb(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kb(t){return(kb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Rb,Ab,Cb,Ib,Mb=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sb(t,e)}(a,Tb);var o=Eb(a);function a(t,e){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),n=o.call(this,e),r=Pb(n),i=void 0,(e="facing")in r?Object.defineProperty(r,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[e]=i,n.facing=t,n.facing===Ov.Right&&(n.sprite.anchor.x=1,n.sprite.scale.x=-1),n}return a}();function jb(t){return(jb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Db(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Lb(t,e){return(Lb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Nb(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=Bb(n);return function(t,e){{if(e&&("object"===jb(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return Fb(t)}(this,r?(t=Bb(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function Fb(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bb(t){return(Bb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ub(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xb(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n=Rb=Rb||{},(Ab||(Ab=n.FieldUI||(n.FieldUI={}))).buttonPrompt=function(){},(Cb=Cb=Cb||(n.CommandMenu||(n.CommandMenu={}))).menuButton=function(){},Cb.menu=function(){},(Ib=Ib=Ib||(n.TroopConstructionMenu||(n.TroopConstructionMenu={}))).fundsCalculator=function(){return new(function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lb(t,e)}(i,ob);var t,e,n,r=Nb(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),Ub(Fb(t=r.call(this)),"leftNum",new T.BitmapText("",Xg.list)),Ub(Fb(t),"rightNum",new T.BitmapText("",Xg.list));var e=new T.Graphics;e.beginFill(Hg.gale_force1).drawRect(0,0,124,14).endFill().beginFill(cm.adjustHSV(Hg.gale_force1,0,.5,1.5)).drawRect(16,3,45,8).drawRect(74,3,45,8).endFill().beginFill(Hg.black,1/3).drawRect(0,0,3,14).drawRect(121,0,3,14).drawRect(3,0,118,1).drawRect(3,13,118,1).endFill().lineStyle(1,cm.adjustHSV(Hg.gale_force1,0,.5,2),1).moveTo(63,7).lineTo(71,7).lineTo(69,5).moveTo(71,7).lineTo(69,9).endFill();var n=zI.scene.getSpritesheet("UISpritesheet").textures["icon-funds.png"],n=new T.Sprite(n);return n.anchor.set(0,.5),n.position.set(7,7),t.leftNum.anchor.set(1,.5),t.leftNum.position.set(60,8),t.rightNum.anchor.set(1,.5),t.rightNum.position.set(118,8),t.container.addChild(e,n,t.leftNum,t.rightNum),t}return t=i,(e=[{key:"setValues",value:function(t,e){this.leftNum.text="".concat(t),this.rightNum.text="".concat(e)}}])&&Db(t.prototype,e),n&&Db(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}())},Ib.pageIndicatorLamp=function(){var t=new T.Graphics,e=Hg.gale_force1,n=cm.adjustHSV(Hg.caribbean_green,0,.7,.9);return t.beginFill(e).drawRect(0,0,10,3).endFill(),e=zI.renderer.generateTexture(t),t.clear().beginFill(n).drawRect(1,1,8,1).endFill(),t=zI.renderer.generateTexture(t),new db({background:e,lamp:t})},Ib.pageChangeButton=function(t){function e(t,e){var n=new T.Graphics;return n.beginFill(e).drawRect(0,0,28,14).endFill(),n.beginFill(t).drawRect(3,1,24,12).endFill(),n.lineStyle(2,e,1).moveTo(16.5,2).lineTo(11.5,7).lineTo(16.5,12).endFill(),zI.renderer.generateTexture(n)}var n=[0,.75,.55],r=cm.adjustHSV(Hg.caribbean_green,0,.55,.65),i=cm.adjustHSV.apply(cm,[r].concat(n)),o=cm.adjustHSV(r,0,1,1.2),a=cm.adjustHSV.apply(cm,[o].concat(n)),s=cm.adjustHSV(r,0,1,1.1),u=cm.adjustHSV.apply(cm,[s].concat(n)),c=cm.adjustHSV(r,0,0,1),n=cm.adjustHSV.apply(cm,[c].concat(n)),i=e(r,i),n=e(c,n),a=e(o,a),u=e(s,u);return new Mb(t,{enabled:i,disabled:n,hovered:a,depressed:u})};var Hb=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Xb(this,"container",new T.Container),Xb(this,"leftButton",Rb.TroopConstructionMenu.pageChangeButton(Ov.Left)),Xb(this,"rightButton",Rb.TroopConstructionMenu.pageChangeButton(Ov.Right)),Xb(this,"pageLampBar",new T.Container),Xb(this,"pageLamps",[]),this.container.addChild(this.leftButton.container,this.rightButton.container,this.pageLampBar)}var e,n,r;return e=t,(n=[{key:"destroy",value:function(){this.container.destroy({children:!0})}},{key:"build",value:function(t,n,e){if(t<=1)this.container.visible=!1;else{if(this.container.visible=!0,t<this.pageLamps.length)this.pageLamps.splice(t).forEach(function(t){return t.destroy()});else for(;t>this.pageLamps.length;){var r=this.pageLamps.length,i=Rb.TroopConstructionMenu.pageIndicatorLamp();i.container.x=r*(i.container.width+1),this.pageLampBar.addChild(i.container),this.pageLamps.push(i)}this.pageLamps.forEach(function(t,e){e===n?t.lampOn():t.lampOff()}),e=null!==e&&void 0!==e?e:0;var o=Math.max(this.leftButton.container.width+this.pageLampBar.width+4,e-this.rightButton.container.width),e=(o-this.leftButton.container.width)/2+this.leftButton.container.width-this.pageLampBar.width/2;this.pageLampBar.x=e,this.rightButton.container.x=o}}}])&&Gb(e.prototype,n),r&&Gb(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function zb(t){return function(t){if(Array.isArray(t))return Vb(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Vb(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vb(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vb(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Wb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yb(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var qb=function(){function i(t,e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),Yb(this,"cursorGraphic",void 0),Yb(this,"stateTextures",void 0),Yb(this,"listItemProps",new qg({minWidth:40,height:Xg.menu.fontSize+2,margin:{left:3,right:3,top:1,bottom:1},border:{left:1,right:1,top:1,bottom:1},padding:{left:2,right:2}})),Yb(this,"palette",{unselected:{background:Hg.gale_force1,primary:Hg.gale_force2,light:Hg.cloudless,dark:Hg.black},selected:{background:Hg.gale_force1,primary:Hg.terrestrial,light:Hg.black,dark:Hg.blister_pearl},disabled:{background:Hg.carbon2,primary:Hg.carbon3,light:Hg.black,dark:Hg.cerebral_grey2}}),Yb(this,"fadeInSlider",new Qg({granularity:.5,shape:function(t){return Math.sqrt(t)}})),Yb(this,"menuPointer",void 0),Yb(this,"pagesBar",new Hb),Yb(this,"menu",void 0),Yb(this,"gui",new T.Container),Yb(this,"menuGui",new T.Container),this.menu=t,this.menu.on("move-cursor",this.onCursorMove,this),this.menu.on("change-page",this.onPageChange,this),e.addChild(this.gui),this.gui.addChild(this.menuGui,this.pagesBar.container),this.cursorGraphic=new rb(this.gui),this.buildTextures(),this.buildListItems(),this.onFirstBuild(),this.gui.zIndex=1e3,this.menuPointer=new Em(this.gui),this.pagesBar.leftButton.triggerIndicatorLight=function(){return r.menu.gamepad.button.dpadLeft.down},this.pagesBar.rightButton.triggerIndicatorLight=function(){return r.menu.gamepad.button.dpadRight.down},zI.scene.ticker.add(this.update,this)}var t,e,n;return t=i,(e=[{key:"getPointerSelection",value:function(){var t=this.listItemProps.elementHeight,e=this.menuPointer.pointerLocation().y,t=Math.floor(e/t);return l1.validIndex(t,this.menu.pageItems.length)?t:void 0}},{key:"destroy",value:function(){this.menuPointer.destroy(),this.gui.destroy({children:!0}),this.menu.destroy(),this.pagesBar.destroy(),this.cursorGraphic.destroy(),this.stateTextures&&Object.values(this.stateTextures).forEach(function(t){return t.destroy()}),zI.scene.ticker.remove(this.update,this)}},{key:"update",value:function(){var t;this.fadeInSlider.increment(),this.gui.alpha=this.fadeInSlider.output,this.menuPointer.pointerMoved&&this.menuPointer.pointerOver&&(void 0!==(t=this.getPointerSelection())&&this.menu.selectedIndex!==t&&this.menu.setCursor(t)),this.pagesBar.leftButton.pointer.clicked()?this.menu.setCursor(this.menu.selectedIndex,this.menu.pageIndex-1):this.pagesBar.rightButton.pointer.clicked()&&this.menu.setCursor(this.menu.selectedIndex,this.menu.pageIndex+1)}},{key:"show",value:function(){this.fadeInSlider.incrementFactor=1,this.menu.enableInput(),this.menuPointer.enabled=!0,this.cursorGraphic.skipMotion()}},{key:"hide",value:function(){this.fadeInSlider.incrementFactor=-1,this.menu.disableInput(),this.menuPointer.enabled=!1}},{key:"setPosition",value:function(t){this.gui.position.set(t.x,t.y)}},{key:"graphicalWidth",get:function(){return this.gui.width}},{key:"graphicalHeight",get:function(){return this.gui.height}},{key:"hidden",get:function(){return!this.gui.visible}},{key:"setListItems",value:function(t){this.menu.setListItems(t),this.buildTextures(),this.buildListItems(),this.updateFrames(),this.cursorGraphic.skipMotion()}},{key:"onCursorMove",value:function(){this.updateFrames();var t=this.listItemProps.containerBox();this.cursorGraphic.rect=new T.Rectangle(t.x,t.height*this.menu.selectedIndex,t.width,t.height)}},{key:"onFirstBuild",value:function(){this.updateFrames(),this.onCursorMove(),this.cursorGraphic.skipMotion()}},{key:"onPageChange",value:function(){this.buildListItems(),this.updateFrames()}},{key:"getContentWidth",value:function(){var t=this.menu.listItems;if(0===t.length)return this.listItemProps.minWidth;var n=new T.BitmapText("",Xg.menu),t=t.map(function(t){var e=t.key,t=e.icon,e=e.title;n.text=e;t=t&&0<t.width?t.width+2:0;return n.textWidth+t});return Math.max.apply(Math,zb(t).concat([this.listItemProps.minWidth]))}},{key:"buildTextures",value:function(){var t=this.palette,e=this.stateTextures,o=this.listItemProps;function n(t){var e=new T.Graphics,n=o.borderInnerBox(),r=o.borderOuterBox(),i=o.containerBox();return e.beginFill(t.background),e.drawRect(i.x,i.y,i.width,i.height),e.beginFill(t.primary),e.drawRect(n.x,n.y,n.width,n.height),e.beginFill(t.dark,.5),e.drawRect(r.x,r.y+r.height,r.width,-o.border.bottom),e.drawRect(r.x+r.width,r.y,-o.border.right,r.height),e.beginFill(t.light,.25),e.drawRect(r.x,r.y,o.border.left,r.height),e.drawRect(r.x,r.y,r.width,o.border.top),e.endFill(),zI.renderer.generateTexture(e,{scaleMode:T.SCALE_MODES.NEAREST})}o.width=this.getContentWidth(),e&&Object.values(e).forEach(function(t){return t.destroy()}),this.stateTextures={enabled:n(t.unselected),disabled:n(t.disabled),selected:n(t.selected)}}},{key:"buildListItems",value:function(){var i=this,t=this.menu,e=this.listItemProps,o=e.contentBox(),a=e.containerBox();if(this.menuGui.children.forEach(function(t){return t.destroy()}),this.menuGui.removeChildren(),t.pageItems.forEach(function(t,e){var n=new T.Sprite;n.position.y=a.height*e;var r=t.key,e=r.icon,t=r.title;e&&e.position.set(o.x,0);r=new T.BitmapText(t,Xg.menu),t=e?e.width+2:0;r.position.set(o.x+t+.5*(o.width-t),o.y+1),r.anchor.set(.5,0),e&&n.addChild(e),n.addChild(r),i.menuGui.addChild(n)}),1<t.totalPages)for(var n=t.pageItems.length;n<t.pageLength;n++){var r=new T.Sprite(null===(r=this.stateTextures)||void 0===r?void 0:r.disabled);r.position.y=a.height*n,this.menuGui.addChild(r)}this.pagesBar.build(t.totalPages,t.pageIndex,a.width),this.pagesBar.container.position.set(a.width/2-this.pagesBar.container.width/2,a.height*t.pageLength+3)}},{key:"updateFrames",value:function(){var n=this,r=this.stateTextures,i=this.menuGui.children;r&&this.menu.pageItems.forEach(function(t,e){e>=i.length||((e=i[e]).texture=t.disabled?r.disabled:n.menu.selectedOption===t?r.selected:r.enabled,e.children[0].tint=t.disabled?8947848:16777215)})}}])&&Wb(t.prototype,e),n&&Wb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function Kb(t){return(Kb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zb(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $b(){return($b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=n9(t)););return t}(t,e);if(r){e=Object.getOwnPropertyDescriptor(r,e);return e.get?e.get.call(arguments.length<3?t:n):e.value}}).apply(this,arguments)}function Jb(t,e){return(Jb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function t9(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=n9(n);return function(t,e){{if(e&&("object"===Kb(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return e9(t)}(this,r?(t=n9(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function e9(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n9(t){return(n9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Yb(qb,"CursorSettings",{animFrames:3,interval:45});var r9,i9=(r9=function(){return function t(){Zb(this,t)}}(),function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jb(t,e)}(u,r9);var t,e,n,s=t9(u);function u(){var t;Zb(this,u);for(var e,n,r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=e9(t),r=[],(n="observers")in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return t=u,(e=[{key:"destroy",value:function(){var t;null!==(t=$b(n9(u.prototype),"destroy",this))&&void 0!==t&&t.call(this),this.clearListeners()}},{key:"on",value:function(t,e,n){this.observers.push({callback:e,context:n,event:t})}},{key:"addListener",value:function(e,n,t){this.observers.some(function(t){return t.callback===e&&t.context===n})||this.observers.push({callback:e,context:n,event:t})}},{key:"removeListener",value:function(e,n){this.observers=this.observers.filter(function(t){return t.callback!==e||t.context!==n})}},{key:"removeListenerFromEvent",value:function(e,n,r){this.observers=this.observers.filter(function(t){return t.event!==e||t.callback!==n||t.context!==r})}},{key:"removeListenerContext",value:function(e){this.observers=this.observers.filter(function(t){return t.context!==e})}},{key:"clearListeners",value:function(e){this.observers=e?this.observers.filter(function(t){return t.event!==e}):[]}},{key:"updateListeners",value:function(e){this.observers.filter(function(t){return t.event===e}).forEach(function(t){return t.callback.call(t.context)})}}])&&Qb(t.prototype,e),n&&Qb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}());function o9(t){return(o9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a9(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function s9(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a9(Object(n),!0).forEach(function(t){p9(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a9(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function u9(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c9(t,e){return(c9=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function l9(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=f9(n);return function(t,e){{if(e&&("object"===o9(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return h9(t)}(this,r?(t=f9(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function h9(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f9(t){return(f9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p9(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d9=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c9(t,e)}(a,i9);var t,e,n,o=l9(a);function a(t,e){var n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),p9(h9(i=o.call(this)),"settings",{pageLength:0,pagePadding:0,extendPages:!1}),p9(h9(i),"gamepad",void 0),p9(h9(i),"_listReal",void 0),p9(h9(i),"_listSieve",void 0),p9(h9(i),"_listPage",void 0),p9(h9(i),"_inputEnabled",!0),p9(h9(i),"cursor",void 0),p9(h9(i),"pageCursor",void 0),p9(h9(i),"view",void 0),p9(h9(i),"movementPulsar",void 0),i.settings=s9(s9({},i.settings),e),i.gamepad=t,i.setListItems((null==e?void 0:e.listItems)||[]),zI.scene.ticker.add(i.update,h9(i)),i.movementPulsar=new tb({firstInterval:(null==e||null===(n=e.cursorSettings)||void 0===n?void 0:n.firstFrameInterval)||20,interval:(null==e||null===(r=e.cursorSettings)||void 0===r?void 0:r.frameInterval)||6},i.triggerCursorMovement,h9(i)),i}return t=a,(e=[{key:"pageLength",get:function(){return this.settings.pageLength||this._listSieve.length}},{key:"pagePadding",get:function(){return this.settings.pagePadding}},{key:"extendPages",get:function(){return this.settings.extendPages}},{key:"pageIndex",get:function(){return this.pageCursor.output}},{key:"totalPages",get:function(){return this.pageCursor.max}},{key:"destroy",value:function(){this.clearListeners(),zI.scene.ticker.remove(this.update,this)}},{key:"update",value:function(){this.updateCursor()}},{key:"updateCursor",value:function(){var t;this.inputEnabled&&([(t=this.gamepad.button).dpadUp,t.dpadDown,t.dpadLeft,t.dpadRight].some(function(t){return t.pressed})&&(this.triggerCursorMovement(),this.movementPulsar.start()),this.gamepad.axis.dpad.returned&&this.movementPulsar.stop())}},{key:"triggerCursorMovement",value:function(){var t=this.cursor,e=this.pageCursor,n=this.gamepad,r=this.view,i=n.axis.dpad,n=i.point;i.framePoint.notEqual(Tm.Origin)&&(this.movementPulsar.reset(),n=i.framePoint),t.increment(n.y),0!==n.x&&(e.increment(n.x),this.setPage()),t.output<r.index+r.padding&&(r.index=this.cursor.output-r.padding),t.output>r.index+r.length-r.padding&&(r.index=t.output-r.length+r.padding),0!==n.y&&this.updateListeners("move-cursor"),0!==n.x&&(this.updateListeners("change-page"),this.updateListeners("move-cursor"))}},{key:"resetCursor",value:function(){this.setCursor(0,0)}},{key:"setCursor",value:function(t,e){this.pageCursor.track=null!=e?e:this.pageCursor.track,this.setPage(),this.cursor.track=t,this.updateListeners("change-page"),this.updateListeners("move-cursor")}},{key:"enableInput",value:function(){this._inputEnabled=!0}},{key:"disableInput",value:function(){this._inputEnabled=!1,this.movementPulsar.stop()}},{key:"inputEnabled",get:function(){return this._inputEnabled}},{key:"pageItems",get:function(){var t=Math.max,e=Math.min,n=this.view,r=n.index,n=n.length,r=e(t(r,0),this._listPage.length-n);return this._listPage.slice(r,r+n)}},{key:"listItems",get:function(){return this._listSieve}},{key:"setListItems",value:function(t){this._listReal=t,this.retriggerListItems()}},{key:"retriggerListItems",value:function(){this._listReal.forEach(function(t){return t.retrigger()}),this._listSieve=this._listReal.filter(function(t){return t.included});var t=Math.ceil(this._listSieve.length/this.pageLength),e=this.pageCursor?Math.min(this.pageCursor.output,t):0;this.pageCursor=new Qg({max:t,track:e,granularity:1,looping:!0}),this.setPage()}},{key:"setPage",value:function(){var t=this.pageCursor.output*this.pageLength,e=Math.min(t+this.pageLength,this._listSieve.length);this._listPage=this._listSieve.slice(t,e);t=this.cursor?Math.min(this.cursor.output,e-t-1):0;this.cursor=new Qg({max:this._listPage.length,track:t,granularity:1,looping:!0}),this.view={index:0,length:this.cursor.max,padding:0}}},{key:"selectedIndex",get:function(){return this.cursor.output}},{key:"selectedOption",get:function(){return this._listPage[this.selectedIndex]}},{key:"selectedValue",get:function(){return this.selectedOption.value}}])&&u9(t.prototype,e),n&&u9(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}();function y9(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m9(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var v9=function(){function r(t,e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),m9(this,"key",void 0),m9(this,"value",void 0),m9(this,"triggerInclude",function(){return!0}),m9(this,"triggerDisable",function(){return!1}),m9(this,"_included",!0),m9(this,"_disabled",!1),this.key=t,this.value=e,this.triggerInclude=(null==n?void 0:n.triggerInclude)||this.triggerInclude,this.triggerDisable=(null==n?void 0:n.triggerDisable)||this.triggerDisable}var t,e,n;return t=r,(e=[{key:"included",get:function(){return this._included}},{key:"disabled",get:function(){return this._disabled}},{key:"retrigger",value:function(){this._included=this.triggerInclude(),this._disabled=this.triggerDisable()}}])&&y9(t.prototype,e),n&&y9(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function g9(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return b9(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b9(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b9(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _9(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function x9(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w9,T9=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),x9(this,"gamepad",void 0),x9(this,"stagePointer",void 0),x9(this,"mapMenu",void 0),x9(this,"battleSettingsMenu",void 0),x9(this,"userPrompt",new T.BitmapText("",Xg.list)),this.gamepad=new Fm,this.stagePointer=new Em(zI.scene.visualLayers.stage),this.stagePointer.enabled=!0;var t=new T.Sprite(T.Texture.EMPTY);t.width=zI.display.renderWidth,t.height=zI.display.renderHeight,zI.scene.visualLayers.stage.addChild(t),this.userPrompt.anchor.set(.5,0),this.userPrompt.x=zI.display.renderWidth/2,this.userPrompt.y=4,zI.scene.visualLayers.hud.addChild(this.userPrompt),this.mapMenu=new qb(new d9(this.gamepad,{listItems:Ig.fromCriteria().map(function(t){return new v9({title:t.name},t)}),pageLength:8}),zI.scene.visualLayers.hud),this.mapMenu.setPosition(new Tm(zI.display.renderWidth/2-this.mapMenu.graphicalWidth/2,zI.display.renderHeight/2-this.mapMenu.graphicalHeight/2));this.battleSettingsMenu=new qb(new d9(this.gamepad,{listItems:[["Normal Battle",{}],["Fog of War Battle",{fogOfWar:!0}]].map(function(t){var e=g9(t,2),t=e[0],e=e[1];return new v9({title:t},e)}),pageLength:8}),zI.scene.visualLayers.hud),this.battleSettingsMenu.setPosition(new Tm(zI.display.renderWidth/2-this.battleSettingsMenu.graphicalWidth/2,zI.display.renderHeight/2-this.battleSettingsMenu.graphicalHeight/2))}var t,n,r;return t=e,(n=[{key:"update",value:function(){this.gamepad.update()}},{key:"suspendInteractivity",value:function(){return!1}},{key:"resetAssets",value:function(){this.mapMenu.hide(),this.battleSettingsMenu.hide(),this.userPrompt.text=""}},{key:"destroy",value:function(){this.mapMenu.destroy(),this.battleSettingsMenu.destroy(),this.stagePointer.destroy()}}])&&_9(t.prototype,n),r&&_9(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function O9(t){return[Tm.Origin,Tm.Up,Tm.Right,Tm.Down,Tm.Left][t]}function S9(n){var t=w9,r=[Tm.Origin,Tm.Up,Tm.Right,Tm.Down,Tm.Left];return[t.None,t.North,t.East,t.South,t.West].find(function(t,e){return r[e].equal(n)})||t.None}function E9(t){return 0==t.length?Tm.Origin:t.map(O9).reduce(function(t,e){return t.add(e)})}(T_=T_=T_||{})[T_.None=0]="None",T_[T_.Up=1]="Up",T_[T_.Right=2]="Right",T_[T_.Down=3]="Down",T_[T_.Left=4]="Left",(T_=w9=w9||{})[T_.None=0]="None",T_[T_.North=1]="North",T_[T_.East=2]="East",T_[T_.South=3]="South",T_[T_.West=4]="West";var P9,k9=32,R9=0;function A9(t){O1.assert(t.shift+t.width<k9,"BitIO cannot make use of more than ".concat(k9," bits of information."))}function C9(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function I9(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}(T_=P9=P9||{}).Generate=function(t,e){return e={shift:R9=void 0!==e?e:R9,width:t},R9+=t,A9(e),e},T_.ReadBits=function(t,e){A9(e);var n=e.shift,e=e.width;return t>>n&Math.pow(2,e)-1},T_.WriteBits=function(t,e,n){A9(n);var r=n.shift,n=n.width,n=Math.pow(2,n)-1;return t&=~(n<<r),t+=(e&n)<<r},T_.GetBoolean=function(t,e){return 0<P9.ReadBits(t,e)};var M9=function(){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),I9(this,"map",void 0),I9(this,"x",void 0),I9(this,"y",void 0),I9(this,"_terrain",void 0),I9(this,"_unit",void 0),I9(this,"overlayPanel",new T.Sprite),I9(this,"overlayArrow",new T.Sprite),I9(this,"showSpotlight",!1),I9(this,"displayInfo",0),this.x=e,this.y=n,this.terrain=new Tg.Void,this.map=t}var t,e,n;return t=r,(e=[{key:"boardLocation",get:function(){return new Tm(this.x,this.y)}},{key:"terrain",get:function(){return this._terrain},set:function(t){this._terrain=t}},{key:"unit",get:function(){return this._unit},set:function(t){var e=this._unit;this._unit=t,this._unit&&Fv("top",this.y,"unit").addChild(this._unit.sprite),e&&Fv("top",this.y,"unit").removeChild(e.sprite),this._unit!==e&&(this.hideUnit=!1)}},{key:"destroy",value:function(){this.terrain.destroy(),this.unit&&this.unit.destroy(),this.map=void 0,zI.scene.ticker.remove(this.autoUpdateOverlayPanelTexture,this)}},{key:"autoUpdateOverlayPanelTexture",value:function(){zI.frameCount%3==0&&this.updateOverlayPanelTexture()}},{key:"updateOverlayPanelTexture",value:function(){this.overlayPanel.visible&&(this.overlayPanel.texture=this.showSpotlight?this.terrain.getOverlayTexture(this.terrain.shapeId):tg.getWhitemask(this.terrain.shapeId))}},{key:"finalize",value:function(t){var e=zI.display.standardLength,e={x:this.x*e,y:this.y*e,z:y2.calculateZIndex({x:this.x,y:this.y})};this.terrain.init(t,e),Fv("top",this.y,"glass-tile").addChild(this.overlayPanel),this.overlayPanel.position.set(e.x,e.y),this.overlayPanel.anchor.set(0,.5),zI.scene.ticker.add(this.autoUpdateOverlayPanelTexture,this),Fv("ui").addChild(this.overlayArrow),this.overlayArrow.position.set(e.x,e.y),this.overlayArrow.zIndex=10,this.updateHighlight()}},{key:"displayInfoSet",value:function(t,e){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];this.displayInfo=P9.WriteBits(this.displayInfo,t,e),n&&(this.updateHighlight(),this.updateArrows())}},{key:"moveFlag",get:function(){var t=r.bitmask.moveable;return P9.GetBoolean(this.displayInfo,t)},set:function(t){var e=r.bitmask.moveable;this.displayInfoSet(~~t,e)}},{key:"attackFlag",get:function(){var t=r.bitmask.attackable;return P9.GetBoolean(this.displayInfo,t)},set:function(t){var e=r.bitmask.attackable;this.displayInfoSet(~~t,e)}},{key:"targetFlag",get:function(){var t=r.bitmask.targetable;return P9.GetBoolean(this.displayInfo,t)},set:function(t){var e=r.bitmask.targetable;this.displayInfoSet(~~t,e)}},{key:"dangerFlag",get:function(){var t=r.bitmask.dangerous;return P9.GetBoolean(this.displayInfo,t)},set:function(t){var e=r.bitmask.dangerous;this.displayInfoSet(~~t,e)}},{key:"hiddenFlag",get:function(){var t=r.bitmask.hidden;return P9.GetBoolean(this.displayInfo,t)},set:function(t){var e=r.bitmask.hidden;this.displayInfoSet(~~t,e)}},{key:"hideUnit",get:function(){var t=r.bitmask.hideUnit;return P9.GetBoolean(this.displayInfo,t)},set:function(t){var e=r.bitmask.hideUnit;this.displayInfoSet(~~t,e)}},{key:"arrowFrom",get:function(){var t=r.bitmask.arrowFrom;return P9.ReadBits(this.displayInfo,t)},set:function(t){var e=r.bitmask.arrowFrom;this.displayInfoSet(t,e)}},{key:"arrowTo",get:function(){var t=r.bitmask.arrowTo;return P9.ReadBits(this.displayInfo,t)},set:function(t){var e=r.bitmask.arrowTo;this.displayInfoSet(t,e)}},{key:"showDropArrow",get:function(){var t=r.bitmask.showDropArrow;return P9.GetBoolean(this.displayInfo,t)},set:function(t){var e=r.bitmask.showDropArrow;this.displayInfoSet(~~t,e)}},{key:"value",get:function(){var t=r.bitmask.temp;return P9.ReadBits(this.displayInfo,t)-1},set:function(t){var e=r.bitmask.temp;this.displayInfoSet(t+1,e,!1)}},{key:"flag",get:function(){var t=r.bitmask.tempFlag;return P9.GetBoolean(this.displayInfo,t)},set:function(t){var e=r.bitmask.tempFlag;this.displayInfoSet(~~t,e,!1)}},{key:"visited",get:function(){var t=r.bitmask.visitedFlag;return P9.GetBoolean(this.displayInfo,t)},set:function(t){var e=r.bitmask.visitedFlag;this.displayInfoSet(~~t,e,!1)}},{key:"updateHighlight",value:function(){var t,e,n=this;this.terrain&&(t={natural:{color:16777215,alpha:.5,mode:T.BLEND_MODES.NORMAL,spotlight:!1},green:{color:4508842,alpha:.5,mode:T.BLEND_MODES.NORMAL,spotlight:!0},red:{color:16737894,alpha:.55,mode:T.BLEND_MODES.NORMAL,spotlight:!0},maroon:{color:16742399,alpha:.5,mode:T.BLEND_MODES.NORMAL,spotlight:!0},grey:{color:2236962,alpha:.25,mode:T.BLEND_MODES.MULTIPLY,spotlight:!1},darkgrey:{color:0,alpha:.4,mode:T.BLEND_MODES.MULTIPLY,spotlight:!1},shape:{color:16777215,alpha:1,mode:T.BLEND_MODES.NORMAL,spotlight:!1}},this.overlayPanel.visible=!(e=function(t){n.overlayPanel.tint=t.color,n.overlayPanel.alpha=t.alpha,n.overlayPanel.blendMode=t.mode,n.overlayPanel.visible=!0,n.showSpotlight=t.spotlight}),this.moveFlag?e(t.green):this.attackFlag?e(t.red):this.targetFlag?e(t.green):this.dangerFlag?e(t.maroon):this.hiddenFlag&&e(t.darkgrey),this.updateOverlayPanelTexture(),this.terrain instanceof cg&&(this.terrain.hidden=this.hiddenFlag),this.unit&&(this.unit.visible=this.unitVisible()))}},{key:"updateArrows",value:function(){var t=zI.scene.getSpritesheet("UISpritesheet");this.overlayArrow.visible=!1;var e=["0","0","0","0"],n=this.arrowFrom-1,r=this.arrowTo-1,i=(2+n)%e.length;this.arrowFrom!==w9.None&&(e[n]="1"),this.arrowTo!==w9.None&&(e[r]="1"),this.arrowTo===w9.None&&(e[i]="2");i=(e=this.showDropArrow?e.map(function(t){return"2"===t?"1":t}):e).join("");"0000"!==i&&(e=this.showDropArrow?"drop-overlay":"MovementArrow/movement-arrow",this.overlayArrow.texture=t.textures["".concat(e,"-").concat(i,".png")],this.overlayArrow.visible=!0)}},{key:"clearValues",value:function(t){var e=t.tempVals,n=t.colorFlags,t=t.arrowPaths;e&&(this.value=-1,this.flag=!1,this.visited=!1),n&&(this.moveFlag=!1,this.attackFlag=!1,this.targetFlag=!1),t&&(this.arrowFrom=0,this.arrowTo=0,this.showDropArrow=!1)}},{key:"neighbors",get:function(){return this.map.neighborsAt(this.boardLocation)}},{key:"neighboringTerrain",get:function(){return this.map.neighboringTerrainAt(this.boardLocation)}},{key:"occupiable",value:function(t){var e=this.traversable(t),n=!this.unit||this.unit===t,t=!this.unitVisible();return e&&(n||t)}},{key:"traversable",value:function(t){var e=0<this.terrain.getMovementCost(t.moveType),n=!this.unit||this.unit.faction===t.faction,t=!this.unitVisible();return e&&(n||t)}},{key:"targetable",value:function(n){var r=this;if(this.terrain.type===Tg.Void)return!1;function t(t){var e=t.armorTypes.some(function(t){return n.canTargetArmor(t)}),t=t.moveTypes.some(function(t){return 0<r.terrain.getMovementCost(t)});return e&&t}var e={armorTypes:[gv.Infantry],moveTypes:[vv.Infantry,vv.Mech]},i={armorTypes:[gv.Vehicle],moveTypes:[vv.Tread,vv.TireA,vv.TireB]},o={armorTypes:[gv.Air,gv.Heli],moveTypes:[vv.Air]},a={armorTypes:[gv.Ship,gv.Sub],moveTypes:[vv.Ship,vv.Transport]};return this.unit&&this.unitVisible()&&this.unit.faction!==n.faction?n.canTarget(this.unit):n.isIndirect||n.canTarget(this.terrain)||t(e)||t(i)||t(o)||t(a)}},{key:"attackable",value:function(t){return this.unit&&this.unitVisible()?t.canTarget(this.unit):t.canTarget(this.terrain)}},{key:"unitVisible",value:function(){return!this.hiddenFlag&&!this.hideUnit}}])&&C9(t.prototype,e),n&&C9(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function j9(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}I9(M9,"directionLength",3),I9(M9,"tempLength",4),I9(M9,"bitmask",l1.freezeObject({moveable:P9.Generate(1,0),attackable:P9.Generate(1),targetable:P9.Generate(1),dangerous:P9.Generate(1),hidden:P9.Generate(1),hideUnit:P9.Generate(1),arrowFrom:P9.Generate(M9.directionLength),arrowTo:P9.Generate(M9.directionLength),showDropArrow:P9.Generate(1),temp:P9.Generate(M9.tempLength),tempFlag:P9.Generate(1),visitedFlag:P9.Generate(1)}));var D9=function(){function p(t,e,n){var r,i,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),o=void 0,(i="grid")in(r=this)?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o;function a(t){return l1.validIndex(t.x,s.x)&&l1.validIndex(t.y,s.y)}var s=new Tm(Object.keys(t).length,Object.keys(t[0]).length),u=e.add(-1,-1),c=e.add(1,1);null==n&&(a(u)&&a(c)||console.error("The limits of this 3x3 matrix [".concat(u.toString(),",").concat(c.toString(),"] exceed the limits of its source map [").concat(Tm.Origin.toString(),",").concat(s.toString(),"]; no fill was given to compensate.")));this.grid=[null,null,null,null,null,null,null,null,null];for(var l=0,h=u.x;h<=c.x;h++)for(var f=u.y;f<=c.y;f++)this.grid[l]=null==n||a(new Tm(h,f))?t[h][f]:n,l++}var t,e,n;return t=p,(e=[{key:"upleft",get:function(){return this.grid[0]}},{key:"left",get:function(){return this.grid[1]}},{key:"downleft",get:function(){return this.grid[2]}},{key:"up",get:function(){return this.grid[3]}},{key:"center",get:function(){return this.grid[4]}},{key:"down",get:function(){return this.grid[5]}},{key:"upright",get:function(){return this.grid[6]}},{key:"right",get:function(){return this.grid[7]}},{key:"downright",get:function(){return this.grid[8]}},{key:"list",get:function(){return this.grid.slice()}},{key:"surrounding",get:function(){var t=this.grid;return[t[0],t[1],t[2],t[3],t[5],t[6],t[7],t[8]]}},{key:"orthogonals",get:function(){var t=this.grid;return[t[1],t[3],t[5],t[7]]}},{key:"diagonals",get:function(){var t=this.grid;return[t[0],t[20],t[6],t[8]]}},{key:"topside",get:function(){var t=this.grid;return[t[0],t[3],t[6]]}},{key:"rightside",get:function(){var t=this.grid;return[t[6],t[7],t[8]]}},{key:"bottomside",get:function(){var t=this.grid;return[t[2],t[6],t[8]]}},{key:"leftside",get:function(){var t=this.grid;return[t[0],t[1],t[2]]}},{key:"map",value:function(e){var t=this.grid.map(function(t){return e(t)});return new p([[t[0],t[1],t[2]],[t[3],t[4],t[5]],[t[6],t[7],t[8]]],new Tm(1,1))}},{key:"sum",value:function(n){return this.grid.reduce(function(t,e){return t+Number(n(e))},0)}}])&&j9(t.prototype,e),n&&j9(t,n),Object.defineProperty(t,"prototype",{writable:!1}),p}();function L9(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function N9(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var F9=function(){function i(t,e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),N9(this,"map",void 0),N9(this,"_points",void 0),N9(this,"_movePoints",void 0),N9(this,"_moveType",void 0),this.map=t,this._points=[e],this._movePoints=n,this._moveType=r}var t,e,n;return t=i,(e=[{key:"point",get:function(){return this._points[this._points.length-1]}},{key:"path",get:function(){return this._points.slice()}},{key:"square",get:function(){return this.map.squareAt(this.point)}},{key:"movePoints",get:function(){return this._movePoints}},{key:"relativeMoveDir",value:function(t){var e=!1,t=this.point.add(O9(t));return-1==this.findPoint(t)&&(this._points.push(t),this._movePoints-=this.square.terrain.getMovementCost(this._moveType),e=!0),e}},{key:"relativeMoveUndo",value:function(){var t=!1;return 1<this._points.length&&(this._movePoints+=this.square.terrain.getMovementCost(this._moveType),this._points.pop(),t=!0),t}},{key:"moveDir",value:function(t){var e=this.clone();return e.relativeMoveDir(t)?e:this}},{key:"buildExistingTrack",value:function(){for(var t=!0,e=this.clone();t;)t=e.relativeMoveDir(e.square.arrowTo);return e}},{key:"findPoint",value:function(e){return this._points.findIndex(function(t){return t.equal(e)})}},{key:"shortenPath",value:function(t){for(var e=!0,n=this.clone();0<t&&e;)e=n.relativeMoveUndo(),t--;return n}},{key:"shortenToIndex",value:function(t){t=this._points.length-1-t;return this.shortenPath(t)}},{key:"clone",value:function(){var t=new i(this.map,this.point,this._movePoints,this._moveType);return t._points=this._points.slice(),t}}])&&L9(t.prototype,e),n&&L9(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function B9(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function U9(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var G9,X9="QueueSearch";(T_=G9=G9||{})[T_.DepthFirst=0]="DepthFirst",T_[T_.BreadthFirst=1]="BreadthFirst";var H9=function(){function e(t){if(!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),U9(this,"resultNode",null),U9(this,"name",void 0),U9(this,"startTime",Date.now()),U9(this,"endTime",void 0),U9(this,"warningTimerLimit",void 0),U9(this,"warningPosted",!1),U9(this,"mode",void 0),U9(this,"staccatoSearch",void 0),U9(this,"handleNode",void 0),U9(this,"queue",void 0),U9(this,"_finished",!1),this.mode=t.searchMode,this.queue=[t.firstNode],this.staccatoSearch=t.staccatoSearch||!1,this.warningTimerLimit=t.warningTimer||1e3,this.name="".concat(t.owner,":").concat(t.process),this.handleNode=t.nodeHandler,!this.staccatoSearch)for(;!this.finished;)this.handleNextNode()}var t,n,r;return t=e,(n=[{key:"elapsedTime",get:function(){return this.endTime?this.endTime-this.startTime:Date.now()-this.startTime}},{key:"finished",get:function(){return this._finished}},{key:"handleNextNode",value:function(){var n,t,e,r=this;this.finished||(n="HandleNode",0<=this.warningTimerLimit&&(e=function(t){var e=r.name||"Nameless";O1.log(X9,n,{message:"Search algorithm '".concat(e,"': ").concat(t),warn:!0})},!this.warningPosted&&this.elapsedTime>=this.warningTimerLimit&&(e("Exceeded an expected completion time of ".concat(this.elapsedTime,"ms.")),this.warningPosted=!0),this.elapsedTime>=2*this.warningTimerLimit&&(e("Search took extroardinarily long. Assuming loop failure; aborting."),this.endSearch())),this.mode==G9.BreadthFirst?t=this.queue.shift():this.mode==G9.DepthFirst&&(t=this.queue.pop()),null!=t?"break"==(e=this.handleNode(t))?(this.resultNode=t,this.endSearch()):null!=e&&(this.queue=this.queue.concat(e)):this.endSearch())}},{key:"update",value:function(t){if(this.staccatoSearch){var e,n;t&&(e=null!=t.repeat?t.repeat:e,n=null!=t.duration?t.duration:n),null==e&&null==n&&(e=100);for(var r=0,i=Date.now();(null==n||Date.now()-i<n)&&!this.finished&&(null==e||r<e);)this.handleNextNode(),++r}}},{key:"endSearch",value:function(){this._finished=!0,this.endTime=Date.now();var t=this.name||"Nameless";O1.log(X9,"Finish",{message:"Search algorithm '".concat(t,"': Ended with execution time ").concat(this.elapsedTime,"ms"),warn:this.warningPosted})}}])&&B9(t.prototype,n),r&&B9(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function z9(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return V9(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V9(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}function V9(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function W9(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Y9(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}U9(H9,"SearchMode",G9);var q9=function(){function o(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),Y9(this,"_map",void 0),Y9(this,"_origin",void 0),Y9(this,"_pointsList",null),this._map=t,this._origin=e}var t,e,n;return t=o,(e=[{key:"onMap",value:function(t){t=t.add(this.origin);return l1.validIndex(t.x,this.width)&&l1.validIndex(t.y,this.height)}},{key:"get",value:function(t){var e=t.add(this.origin);return!!this.onMap(t)&&this._map[e.x][e.y]}},{key:"origin",get:function(){return this._origin.clone()}},{key:"rect",get:function(){var t=this._origin;return new T.Rectangle(-t.x,-t.y,this.width,this.height)}},{key:"width",get:function(){return this._map.length}},{key:"height",get:function(){return this._map[0].length}},{key:"points",get:function(){if(!this._pointsList){this._pointsList=[];for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++)this._map[t][e]&&this._pointsList.push(new Tm(t,e).subtract(this.origin))}return this._pointsList.slice()}},{key:"extremity",value:function(t){var e=new D9(this._map,t,!1),t=e.orthogonals.some(function(t){return 0==t});return 1==e.center&&t}},{key:"mapCopy",value:function(){return this._map.slice().map(function(t){return t.slice()})}},{key:"fill",value:function(t){var a=this,s=this.mapCopy();return function t(e){var n=e.add(a.origin);if(a.onMap(e)&&!s[n.x][n.y]){s[n.x][n.y]=!0;var r,i=z9(Tm.Cardinals);try{for(i.s();!(r=i.n()).done;){var o=r.value;t(e.add(o))}}catch(t){i.e(t)}finally{i.f()}}}(t),new o(s,this.origin)}},{key:"flipHorz",value:function(){var t=this.mapCopy();return t.reverse(),new o(t,this.origin)}},{key:"flipVert",value:function(){return new o(this.mapCopy().map(function(t){return t.reverse()}),this.origin)}},{key:"_rotate90",value:function(){for(var t=new Array(this.height),e=0;e<this.height;e++)t[e]=new Array(this.width);for(var n=this.height-1,r=0;r<this.width;r++)for(var i=0;i<this.height;i++)t[r][i]=this._map[n-i][r];return new o(t,new Tm(n-this.origin.y,this.origin.x))}},{key:"rotate90",value:function(t){(t%=4)<0&&(t+=4);var e=this;return t%2==1&&(e=e._rotate90()),e=2==t?e.flipHorz().flipVert():e}}])&&W9(t.prototype,e),n&&W9(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();var K9={};function Z9(t){var e={min:Math.max(-1,t.min),max:Math.max(-1,t.max)},t="".concat(e.min,"-").concat(e.max);return K9[t]||(K9[t]=function(t,e){if(t<0||e<0)return new q9([[]],new Tm);for(var n=2*e+1,r=Math.floor(n/2),i=new Tm(r,r),o=l1.Array2D(n,n,!1),a=0;a<n;a++)for(var s=0;s<n;s++){var u=i.manhattanDistance(a,s);l1.within(u,t,e)&&(o[a][s]=!0)}return new q9(o,i)}(e.min,e.max)),K9[t]}function Q9(t){return(Q9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $9(t){return function(t){if(Array.isArray(t))return e2(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||t2(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J9(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=t2(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}function t2(t,e){if(t){if("string"==typeof t)return e2(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e2(t,e):void 0}}function e2(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function n2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r2(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i2(n){var r=u2();return function(){var t,e=l2(n);return function(t,e){{if(e&&("object"===Q9(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return o2(t)}(this,r?(t=l2(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function o2(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a2(t){var n="function"==typeof Map?new Map:void 0;return function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return s2(t,arguments,l2(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),c2(e,t)}(t)}function s2(t,e,n){return(s2=u2()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);r=new(Function.bind.apply(t,r));return n&&c2(r,n.prototype),r}).apply(null,arguments)}function u2(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function c2(t,e){return(c2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function l2(t){return(l2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h2(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f2="WarMap",p2=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c2(t,e)}(o,a2(Error));var i=i2(o);function o(){var t;r2(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return h2(o2(t=i.call.apply(i,[this].concat(n))),"name","MapValidationError"),t}return o}();function d2(t){return"Attempting to access invalid grid location: (".concat(t.x,", ").concat(t.y,")")}var y2=function(){function r(t){if(r2(this,r),h2(this,"name",void 0),h2(this,"board",[]),O1.log(f2,"Construction",{message:"Building game board from map data."}),this.name=t.name,Iv.Init(),Fv("ui").sortableChildren=!0,!this.validateMapData(t))throw new p2("map '".concat(t.name,"' did not validate."));var e=t.size,n=e.width,e=e.height;this.constructMap(n,e);n*=zI.display.standardLength,e*=zI.display.standardLength;this.setupBoardMask(n,e),Yv.addSeaLayer(n,e),this.buildMapContents(t),this.forceLegalTiles(),this.configureMap(),this.initializeMap(),Iv.FreezeStaticLayers(),Yv.startPaletteAnimation(),Yv.startSpotlightFilter(),O1.log(f2,"Construction",{message:"Finished building game board from map data.\n".concat(this.logString())})}var t,e,n;return t=r,n=[{key:"calculateZIndex",value:function(t){return-t.x}}],(e=[{key:"squares",get:function(){return this.board.flat()}},{key:"squaresFrom",value:function(e,t){var n=this;return t.points.map(function(t){return t.add(e)}).filter(function(t){return n.validPoint(t)}).map(function(t){return n.squareAt(t)})}},{key:"destroy",value:function(){Yv.removeSeaLayer(),Yv.stopPaletteAnimation(),Iv.Destroy(),O1.log(f2,"Destruction")}},{key:"setupBoardMask",value:function(t,e){var n=zI.display.standardLength,r=new T.Graphics;r.beginFill(16777215),r.drawRect(0,-n,t,e+n),Fv("top").mask=r,zI.scene.visualLayers.stage.addChild(r)}},{key:"constructMap",value:function(t,e){t+=2,e+=2,this.board=[];for(var n=0;n<t;n++){this.board[n]=[];for(var r=0;r<e;r++)this.board[n][r]=new M9(this,n-1,r-1),0!=n&&n!=t-1&&0!=r&&r!=e-1||(this.board[n][r].terrain=new Tg.Void)}}},{key:"generateMap",value:function(){for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++)this.squareAt({x:t,y:e}).terrain=new Tg.Plain;for(var n=2;n<this.width-2;n++)for(var r=2;r<this.height-2;r++)if(Math.random()<.035)for(var i=-1;i<=1;i++)for(var o=-1;o<=1;o++)this.squareAt({x:i+n,y:o+r}).terrain=new Tg.Sea;this.generateTile(Tg.Sea,[.02,.6,.7,.5,.6,.7,.7,.7,.7],1,.1),this.generateTile(Tg.Mountain,[.1,.15,.15,.15,.25,.3,.4,.4,.4],.4,1),this.generateTile(Tg.Wood,[.08,.3,.3,.2,.2,.2,.2,.2,.2],.4,1),this.generateTile(Tg.HQ,[.01,.01,.01,.01,.01,.01,.01,.01,.01],.3,1),this.generateTile(Tg.City,[.05,.05,.05,.05,.05,.05,.05,.05,.05],.3,1),this.generateTile(Tg.Factory,[.03,.03,.03,.03,.03,.03,.03,.03,.03],.3,1),this.generateTile(Tg.Airport,[.03,.03,.03,.03,.03,.03,.03,.03,.03],.3,1),this.generateTile(Tg.Port,[.01,.01,.01,.01,.01,.01,.01,.01,.01],.3,1),this.generateTile(Tg.Radar,[.01,.01,.01,.01,.01,.01,.01,.01,.01],.3,1),this.generateTile(Tg.ComTower,[.01,.01,.01,.01,.01,.01,.01,.01,.01],.3,1),this.generateTile(Tg.Silo,[.01,.01,.01,.01,.01,.01,.01,.01,.01],.3,1),this.generateTile(Tg.TempAirpt,[.01,.01,.01,.01,.01,.01,.01,.01,.01],.3,1),this.generateTile(Tg.TempPort,[.01,.01,.01,.01,.01,.01,.01,.01,.01],.3,1),this.generateTile(Tg.Ruins,[.03,.05,.05,.05,.05,.05,.05,.05,.05],.3,1),this.generateTile(Tg.Wasteland,[.05,.15,.15,.15,.25,.3,.4,.4,.4],.4,1),this.generateTile(Tg.Road,[.1,.98,.9,.7,.4,.05,.05,.05,.05],.4,.35),this.generateTile(Tg.River,[.05,.95,.8,.6,.4,.05,.05,.05,.05],.4,.35),this.generateTile(Tg.Bridge,[.03,.95,.6,.3,.1,.05,.05,.05,.05],.4,.35),this.generateTile(Tg.Fire,[.02,.02,.02,.02,.02,.02,.02,.02,.02],.3,1),this.generateTile(Tg.Beach,[.1,.7,.9,.5,.2,.2,.2,.2,.2],.4,.7),this.generateTile(Tg.Mist,[.03,.5,.7,.5,.5,.2,.2,.2,.2],.3,.7),this.generateTile(Tg.RoughSea,[.2,.2,.2,.1,.05,.05,.05,.05,.05],.3,.7),this.generateTile(Tg.Reef,[.2,.2,.2,.05,.05,.05,.05,.05,.05],.3,1),this.generateTile(Tg.Meteor,[.01,.01,.01,.01,.01,.01,.01,.01,.01],.3,1),this.generateTile(Tg.Plasma,[.02,.8,.6,.02,.02,.02,.02,.02,.02],.3,.3)}},{key:"validateMapData",value:function(e){return e.map.length===e.size.height&&e.map.every(function(t){return t.length===e.size.width})}},{key:"buildMapContents",value:function(r){for(var i=this,o=0;o<this.height;o++)for(var t=0;t<this.width;t++)!function(t){var e=r.map[o][t],n=new Tm(t,o),t=Object.values(Tg).find(function(t){return t.serial===e});if(!t)throw new Error("Terrain serial '".concat(e,"' does not exist."));i.squareAt(n).terrain=new t}(t)}},{key:"generateTile",value:function(s,u,c,l){for(var h=[],t=0;t<this.width;t++)for(var e=0;e<this.height;e++)h.push({x:t,y:e});for(var n=0;n<h.length;n++){var r,i=Math.floor(Math.random()*h.length),o=Math.floor(Math.random()*h.length);i!=o&&(r=h[i],h[i]=h[o],h[o]=r)}function a(t,e){for(var n=0;n<h.length;n++){var r=h[n],i=t.neighboringTerrainAt(r),o=t.squareAt(r).terrain,a=new s(o);s!=i.center.type&&0!=a.legalPlacement(i)&&(o=i.surrounding.filter(function(t){return t.type==s}).length,o=u[o],i.left.type!=s&&i.right.type!=s&&i.up.type!=s&&i.down.type!=s&&(o*=l),a.landTile!=i.center.landTile&&s!=Tg.Sea&&(o*=.05),i.center.type!=Tg.Plain&&i.center.type!=Tg.Sea&&(o*=c),o*=e,Math.random()<o&&(t.squareAt(r).terrain=a))}}a(this,1),a(this,.7)}},{key:"forceLegalTiles",value:function(){for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++){var n={x:t,y:e},r=this.neighboringTerrainAt(n);0==r.center.legalPlacement(r)&&(this.squareAt(n).terrain=new(r.center.landTile?Tg.Plain:Tg.Sea))}}},{key:"configureMap",value:function(){for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++){var n={x:t,y:e},r=this.squareAt(n);(r.terrain.landTile||r.terrain.shallowWaterSourceTile)&&this.neighboringTerrainAt(n).surrounding.forEach(function(t){t.shallowWater=!0})}}},{key:"initializeMap",value:function(){for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++){var n=this.neighboringTerrainAt({x:t,y:e});this.squareAt({x:t,y:e}).finalize(n)}Iv.SortLayer("top")}},{key:"softChangeTile",value:function(n,t,e){var r=this;function i(t){var e="Failed to change ".concat(n.toString());O1.log(f2,"ChangeTile",{message:e,reason:t,warn:!0})}if(!this.validPoint(n))return i("tile does not exist: out of bounds"),!1;var o=this.squareAt(n),t=t===Tg.Plain?new Tg.Plain(o.terrain,null==e?void 0:e.noPrevTileCosmetics):new t(o.terrain);if(!t.legalPlacement(o.neighboringTerrain))return i("terrain '".concat(t.name,"' placement is not legal")),!1;o.terrain.destroy(),o.terrain=t,o.flag=!0,o.neighbors.surrounding.filter(function(t){return t.terrain.type!==Tg.Void}).forEach(function(t){t.flag=!0,t.terrain.legalPlacement(t.neighboringTerrain)||r.softChangeTile(t.boardLocation,t.terrain.baseType)}),o.unit&&!o.traversable(o.unit)&&null!==(a=o.unit)&&void 0!==a&&a.destroy();var a=new q9(l1.Array2D(5,5,!0),new Tm(2,2));return this.squaresFrom(n,a).filter(function(t){return!t.terrain.shallowWaterSourceTile}).forEach(function(t){var e=t.terrain;t.terrain=new t.terrain.type(t.terrain),t.terrain.faction=e.faction,t.flag=!0,e.destroy()}),!0}},{key:"rebuildFlaggedTiles",value:function(){var t,e=J9(this.squares);try{for(e.s();!(t=e.n()).done;){var n=t.value;!0===n.flag&&n.finalize(n.neighboringTerrain)}}catch(t){e.e(t)}finally{e.f()}Iv.RerenderStaticLayers()}},{key:"changeTile",value:function(t,e){return this.clearTemporaryValues(),this.softChangeTile(t,e,{noPrevTileCosmetics:!0}),this.configureMap(),this.rebuildFlaggedTiles(),this.squareAt(t)}},{key:"bucketFill",value:function(t,n,r){var o=this;this.clearTemporaryValues();var a=this.squareAt(t).terrain.type,s=this.squareAt(t).terrain.faction;this.validPoint(t)&&(a!==n||r&&s!==r)&&(new H9({owner:f2,process:"BucketFill",firstNode:t,searchMode:H9.SearchMode.BreadthFirst,nodeHandler:function(e){if(!o.softChangeTile(e,n,{noPrevTileCosmetics:!0}))return null;var t=o.squareAt(e);return r&&t.terrain.building&&(t.terrain.faction=r),Tm.Cardinals.map(function(t){return t.add(e)}).filter(function(t){if(!o.validPoint(t))return!1;var e=o.squareAt(t),n=!e.visited,r=e.terrain.type===a,i=!e.terrain.building,t=e.terrain.faction===s;return e.visited=!0,n&&r&&(i||t)})}}),this.configureMap(),this.rebuildFlaggedTiles())}},{key:"demolishTile",value:function(t){var r=this;return this.clearTemporaryValues(),new H9({owner:f2,process:"DominoDemolish",firstNode:t,searchMode:H9.SearchMode.BreadthFirst,nodeHandler:function(t){var e=r.squareAt(t),n=e.terrain.dominoTypes,t=r.softChangeTile(t,e.terrain.baseType);return e.visited=!0,t?e.neighbors.orthogonals.filter(function(t){return!t.visited&&n.includes(t.terrain.type)}).map(function(t){return t.boardLocation}):null}}),this.configureMap(),this.rebuildFlaggedTiles(),this.squareAt(t)}},{key:"changeTileset",value:function(t){}},{key:"trueWidth",get:function(){return this.board?Object.keys(this.board).length:0}},{key:"trueHeight",get:function(){return this.board&&this.board[0]?Object.keys(this.board[0]).length:0}},{key:"width",get:function(){return this.trueWidth?this.trueWidth-2:0}},{key:"height",get:function(){return this.trueHeight?this.trueHeight-2:0}},{key:"squareAt",value:function(t){t=new Tm(t).add(1,1).merge(function(t,e){return l1.clamp(t,0,e-1)},this.trueWidth,this.trueHeight);return this.board[t.x][t.y]}},{key:"squareFromWorldPoint",value:function(t){var e=zI.display.standardLength;return this.squareAt(t.apply(function(t){return Math.floor(t/e)}))}},{key:"neighborsAt",value:function(t){if(!this.validPoint(t))throw new Error(d2(t));t={x:t.x+1,y:t.y+1};return new D9(this.board,new Tm(t))}},{key:"neighboringTerrainAt",value:function(t){return this.neighborsAt(t).map(function(t){return t.terrain})}},{key:"pathIterableFrom",value:function(o){var a=this;return h2({},Symbol.iterator,regeneratorRuntime.mark(function t(){var e,n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=0,n=o.clone(),r=a.squareAt(n),i=r.arrowTo;case 4:if(i)return t.next=7,r;t.next=15;break;case 7:if(n=n.add(O9(i)),r=a.squareAt(n),i=r.arrowTo,200<++e)throw"Inferred path might be looping indefinitely; exceeded ".concat(200," steps.");t.next=13;break;case 13:t.next=4;break;case 15:case"end":return t.stop()}},t)}))}},{key:"pathFrom",value:function(t){var e,n=[],r=J9(this.pathIterableFrom(t));try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push(i.arrowTo)}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"travelCostForPath",value:function(t,e,n){var r,i=new F9(this,t,0,n),o=J9(e);try{for(o.s();!(r=o.n()).done;)var a=r.value,i=i.moveDir(a)}catch(t){o.e(t)}finally{o.f()}return Math.abs(i.movePoints)}},{key:"placeUnit",value:function(t,e){if(!this.validPoint(e))throw new Error(d2(e));this.validPoint(t.boardLocation)&&this.removeUnit(t.boardLocation),(this.squareAt(e).unit=t).boardLocation=new Tm(e)}},{key:"removeUnit",value:function(t){!this.validPoint(t)||(t=this.squareAt(t)).unit&&(t.unit.boardLocation=new Tm(-1,-1),t.unit=void 0)}},{key:"moveUnit",value:function(t,e){if(!this.validPoint(t))throw new Error(d2(t));if(!this.validPoint(e))throw new Error(d2(e));var n=this.squareAt(t).unit;return null!=n&&(!!this.squareAt(e).occupiable(n)&&(this.removeUnit(t),this.placeUnit(n,e),!0))}},{key:"destroyUnit",value:function(t){if(!this.validPoint(t))throw new Error(d2(t));t=this.squareAt(t);t.unit&&t.unit.destroy()}},{key:"validPoint",value:function(t){return 0<=t.x&&t.x<this.width&&0<=t.y&&t.y<this.height}},{key:"clearTemporaryValues",value:function(){var e={tempVals:!0};this.squares.forEach(function(t){return t.clearValues(e)})}},{key:"clearTileOverlay",value:function(){var e={tempVals:!0,colorFlags:!0};this.squares.forEach(function(t){return t.clearValues(e)})}},{key:"clearTileArrows",value:function(){var e={arrowPaths:!0};this.squares.forEach(function(t){return t.clearValues(e)})}},{key:"clearMovementMap",value:function(){var e={tempVals:!0,colorFlags:!0,arrowPaths:!0};this.squares.forEach(function(t){return t.clearValues(e)})}},{key:"hideSightMap",value:function(){this.board.forEach(function(t){t.forEach(function(t){return t.hiddenFlag=!0})})}},{key:"revealSightMapLocation",value:function(n,t,e){var r=this,i=this.squareAt(n),i=(null==e?void 0:e.appliedVision(i))||i.terrain.vision,o=e?1:0,a=t.officer.CoPowerInEffect;Z9({min:0,max:i}).points.forEach(function(t){var e=n.add(t);r.validPoint(e)&&(t=r.squareAt(e),e=n.manhattanDistance(e),t.terrain.conceals&&!(a||e<=o)||(t.hiddenFlag=!1))})}},{key:"hideSightMapRegion",value:function(e,t){var n=this;t.points.forEach(function(t){t=e.add(t);n.validPoint(t)&&(n.squareAt(t).hiddenFlag=!0)})}},{key:"travelEvaluationFunction",value:function(t,e){var n=e.square.terrain.type!=Tg.Void,r=0<=e.movePoints,t=e.square.traversable(t),e=e.square.value<e.movePoints;return n&&r&&t&&e}},{key:"generateColorMap",value:function(r){var i=this,t=new F9(this,new Tm(r.boardLocation),r.movementPoints,r.moveType);O1.assert(this.validPoint(t.point),"Given unit is located at ".concat(t.point.toString(),", an invalid board loation.")),this.clearTileOverlay();new H9({owner:f2,process:"GenerateColorMap",firstNode:t,searchMode:H9.SearchMode.BreadthFirst,nodeHandler:function(e){var n,t=null;return i.travelEvaluationFunction(r,e)&&(t=(t=[w9.North,w9.West,w9.South,w9.East].map(function(t){return e.moveDir(t)})).filter(function(t){return t.point.notEqual(e.point)}),e.square.moveFlag=!0,e.square.value=e.movePoints,e.square.occupiable(r)&&(r.canMoveAndAttack||e.point.equal(r.boardLocation))&&(n=e.point,r.rangeMap.points.map(function(t){return t.add(n)}).filter(function(t){return i.validPoint(t)}).forEach(function(t){t=i.squareAt(t);t.flag||(t.attackFlag=t.targetable(r),t.flag=!0)}))),t}})}},{key:"squareOfInfluence",value:function(t){var e=t.movementPoints+t.range.max,n={x:l1.clamp(t.boardLocation.x-e,0,this.width-1),y:l1.clamp(t.boardLocation.y-e,0,this.height-1)},r=l1.clamp(t.boardLocation.x+e+1,0,this.width),e=l1.clamp(t.boardLocation.y+e+1,0,this.height);return new T.Rectangle(n.x,n.y,r-n.x,e-n.y)}},{key:"generateMovementMap",value:function(t){this.generateColorMap(t);for(var e=this.squareOfInfluence(t),n=0;n<e.height;n++)for(var r=0;r<e.width;r++){var i=this.squareAt(new Tm(r+e.x,n+e.y));i.attackable(t)||(i.attackFlag=!1)}}},{key:"generateAttackRangeMap",value:function(t){this.generateColorMap(t);for(var e=this.squareOfInfluence(t),n=0;n<e.height;n++)for(var r=0;r<e.width;r++)this.squareAt({x:r+e.x,y:n+e.y}).moveFlag=!1}},{key:"recalculatePathToPoint",value:function(r,i,t){var n=this,e=this.squareAt(i);if(e.moveFlag||e.attackFlag){var o=e.attackFlag,e=Z9({min:0,max:0}),a=t||Z9({min:1,max:1}),s=r.canMoveAndAttack&&o?a:e;O1.assert(this.validPoint(r.boardLocation),"Given unit is located at ".concat(new Tm(r.boardLocation).toString(),", an invalid board location.")),O1.assert(this.validPoint(i),"Given destination is located at ".concat(new Tm(i).toString(),", an invalid board location."));var u=(u=new F9(this,new Tm(r.boardLocation),r.movementPoints,r.moveType)).buildExistingTrack(),c=function(t){var e=r.boardLocation.equal(i),n=t.point.equal(r.boardLocation)&&o?a:s,t=new Tm(i).subtract(t.point);return n.get(t)||e},l=function(t){var e=c(t),t=t.square.occupiable(r);return e&&(t||!o)},t=u.path.length-1,e=[t,t-1,1,0],h=null,t=u.path.findIndex(function(t){return t.equal(i)});if(-1!=t&&(u=u.shortenToIndex(t)),!c(u)||o&&!u.square.occupiable(r)){var f,p=J9(e);try{for(p.s();!(f=p.n()).done;){var d=f.value;if(this.clearTemporaryValues(),u=u.shortenToIndex(d),(h=new H9({owner:f2,process:"RepathTravelArrow",firstNode:u,searchMode:H9.SearchMode.BreadthFirst,nodeHandler:function(e){var t=null;if(n.travelEvaluationFunction(r,e)){t=[w9.North,w9.West,w9.South,w9.East].map(function(t){return e.moveDir(t)});if(t=t.filter(function(t){return t.point.notEqual(e.point)}),e.square.moveFlag=!0,e.square.value=e.movePoints,(e.point.equal(i)||e.square.occupiable(r))&&c(e))return"break"}return t}})).resultNode&&l(h.resultNode)){u=h.resultNode;break}}}catch(t){p.e(t)}finally{p.f()}}O1.assert(l(u),"Could not find a path to the given destination."),this.clearTileArrows();for(var y=1;y<u.path.length;y++){var m=u.path[y],v=u.path[y-1];this.squareAt(v).arrowTo=S9(m.subtract(v)),this.squareAt(m).arrowFrom=S9(v.subtract(m))}}}},{key:"generateMapData",value:function(t){var n,r=this,e=this.width,i=this.height,o={name:"unnamed",size:{width:e,height:i},players:t.length,map:l1.Array2D(i,e,function(t,e){return r.squareAt({x:e,y:t}).terrain.type.serial}),owners:[],predeploy:[]},a=J9(t);try{for(a.s();!(n=a.n()).done;)!function(){var e=n.value,t=e.capturePoints.map(function(t){return{location:t.toPrimitive(),player:e.playerNumber}});o.owners=o.owners.concat(t);t=e.unitsOnMap.map(function(t){return{location:t.boardLocation.toPrimitive(),serial:t.type.serial,player:e.playerNumber}});o.predeploy=o.predeploy.concat(t)}()}catch(t){a.e(t)}finally{a.f()}return o}},{key:"generateMapDataString",value:function(t){function e(t){return t.toString().padStart(2," ")}t=this.generateMapData(t);return["{",'  "name": "'.concat(t.name,'",'),'  "size": { "width": '.concat(t.size.width,', "height": ').concat(t.size.height," },"),'  "players": '.concat(t.players,","),'  "map": ['].concat($9(t.map.map(function(t){return"    [".concat(t.map(e),"],")})),["  ],",'  "owners": ['],$9(t.owners.map(function(t){return'    {"location": {"x": '.concat(e(t.location.x),', "y": ').concat(e(t.location.y),'}, "player": ').concat(t.player,"},")})),["  ],",'  "predeploy": ['],$9(t.predeploy.map(function(t){return'    {"location": {"x": '.concat(e(t.location.x),', "y": ').concat(e(t.location.y),'}, "serial": ').concat(e(t.serial),', "player": ').concat(t.player,"},")})),["  ],","},"]).join("\n")}},{key:"logString",value:function(){var t=[];t.push("w=".concat(this.width," h=").concat(this.height," tiles=").concat(this.squares.length));for(var e=0;e<this.height;e++){for(var n=[],r=0;r<this.width;r++)n.push("".concat(this.squareAt({x:r,y:e}).terrain.name.slice(0,2)," "));t.push(n.join(""))}return t.join("\n")}}])&&n2(t.prototype,e),n&&n2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function m2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v2(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g2=function(){function i(t,e){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),v2(this,"_object",null),v2(this,"_pos",new T.ObservablePoint(this.updateObjectPosition,this,0,0)),v2(this,"_zIndex",0),v2(this,"_rotation",0),v2(this,"_scale",new T.ObservablePoint(this.updateObjectScale,this,1,1)),v2(this,"scale",(n=this,{get x(){return n._scale.x},set x(t){n._scale.x=t},get y(){return n._scale.y},set y(t){n._scale.y=t},set:function(t){n._scale.set(t,t)}})),v2(this,"exact",(r=this,{get x(){return(r.object||r).x},get y(){return(r.object||r).y},get z(){return(r.object||r).zIndex}})),this.position=t||Tm.Origin,this.object=e||null}var t,e,n;return t=i,(e=[{key:"destroy",value:function(){this.object=null}},{key:"object",get:function(){return this._object},set:function(t){(this._object=t)&&this.updateObjectTransform()}},{key:"x",get:function(){return this._pos.x},set:function(t){this._pos.x=t}},{key:"y",get:function(){return this._pos.y},set:function(t){this._pos.y=t}},{key:"z",get:function(){return this.zIndex},set:function(t){this.zIndex=t}},{key:"zIndex",get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.updateObjectPosition()}},{key:"position",get:function(){return new Tm(this._pos)},set:function(t){this._pos.set(t.x,t.y)}},{key:"pos3D",get:function(){return{x:this._pos.x,y:this._pos.y,z:this.zIndex}},set:function(t){this._pos.set(t.x,t.y),this.z=t.z}},{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.updateObjectRotation()}},{key:"updateObjectTransform",value:function(){this.updateObjectPosition(),this.updateObjectRotation(),this.updateObjectScale()}},{key:"updateObjectPosition",value:function(){var t;null!=this.object&&((t=this.object).x=Math.floor(this.x),t.y=Math.floor(this.y),t.zIndex=Math.floor(this.z))}},{key:"updateObjectRotation",value:function(){null!=this.object&&(this.object.rotation=this.rotation)}},{key:"updateObjectScale",value:function(){var t;null!=this.object&&((t=this.object).scale.x=this.scale.x,t.scale.y=this.scale.y,t.width=Math.floor(t.width),t.height=Math.floor(t.height))}},{key:"copyFrom",value:function(t){this._pos.copyFrom(t._pos),this._rotation=t._rotation,this._scale.copyFrom(t._scale),this.updateObjectTransform()}}])&&m2(t.prototype,e),n&&m2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function b2(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(t,e)||x2(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _2(t){return function(t){if(Array.isArray(t))return w2(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||x2(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x2(t,e){if(t){if("string"==typeof t)return w2(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w2(t,e):void 0}}function w2(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function T2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function O2(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var S2=function(){function u(t,e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),O2(this,"x",0),O2(this,"y",0),O2(this,"width",0),O2(this,"height",0),this.set(t,e,n,r)}var t,e,n;return t=u,n=[{key:"Empty",get:function(){return new u}}],(e=[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}},{key:"topleft",get:function(){return new Tm(this.left,this.top)}},{key:"topright",get:function(){return new Tm(this.right,this.top)}},{key:"bottomleft",get:function(){return new Tm(this.left,this.bottom)}},{key:"bottomright",get:function(){return new Tm(this.right,this.bottom)}},{key:"center",get:function(){return this.getPointByProportion(new Tm(.5))}},{key:"set",value:function(){var t,e,n,r,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,u=i;return[(r=u).x,r.y,r.width,r.height].every(function(t){return"number"==typeof t})?(t=u.x,e=u.y,r=u.width,n=u.height,Object.assign(this,{x:t,y:e,width:r,height:n})):"number"==typeof(n=u).x&&"number"==typeof n.y?Object.assign(this,{x:u.x,y:u.y,width:o,height:a}):Object.assign(this,{x:i,y:o,width:a,height:s}),this}},{key:"setEdges",value:function(t,e,n,r){var i=Math.max,o=Math.min;return this.x=o(t,e),this.width=i(t,e)-this.x,this.y=o(n,r),this.height=i(n,r)-this.y,this}},{key:"move",value:function(t,e){e=new Tm(t,e).add(this);return new u(e.x,e.y,this.width,this.height)}},{key:"adjustSize",value:function(t,e){e=new Tm(t,e).add(this.bottomright);return new u(this.x,this.y,e.x,e.y)}},{key:"apply",value:function(t){return new u(t(this.x),t(this.y),t(this.width),t(this.height))}},{key:"applyEdges",value:function(t){var e=t(this.x),n=t(this.y);return new u(e,n,t(this.right)-e,t(this.bottom)-n)}},{key:"applyCoordinates",value:function(t){return new u(t(this.x),t(this.y),this.width,this.height)}},{key:"applyDimensions",value:function(t){return new u(this.x,this.y,t(this.width),t(this.height))}},{key:"clone",value:function(){return new u(this)}},{key:"equal",value:function(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}},{key:"notEqual",value:function(t){return!this.equal(t)}},{key:"pad",value:function(t,e,n){var r=Math.max;e=e||t,n=n||new Tm(.5);t=r(this.width+t,0),e=r(this.height+e,0);return new u(this.x+(t-this.width)*n.x,this.y+(e-this.height)*n.y,t,e)}},{key:"fit",value:function(){for(var t=Math.max,e=Math.min,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=r.map(function(t){return new u(t)}),a=e.apply(void 0,_2(o.map(function(t){return t.left}))),s=t.apply(void 0,_2(o.map(function(t){return t.right})))-a,e=e.apply(void 0,_2(o.map(function(t){return t.top})));return new u(a,e,s,t.apply(void 0,_2(o.map(function(t){return t.bottom})))-e)}},{key:"enlarge",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.fit.apply(this,[this].concat(e))}},{key:"contains",value:function(t){t=new u(t);return this.left<=t.left&&this.right>=t.right&&this.top<=t.top&&this.bottom>=t.bottom}},{key:"aspectRatio",get:function(){return this.width/this.height}},{key:"setWidthByAR",value:function(t){return new u(this.x,this.y,this.height*t,this.height)}},{key:"setHeightByAR",value:function(t){return new u(this.x,this.y,this.width,this.width*t)}},{key:"area",get:function(){return this.width*this.height}},{key:"truncateOut",value:function(){var t=Math.floor,e=Math.ceil;return new u(t(this.x),t(this.y),e(this.width),e(this.height))}},{key:"truncateIn",value:function(){var t=Math.floor,e=Math.ceil;return new u(e(this.x),e(this.y),t(this.width),t(this.height))}},{key:"intersects",value:function(t){return this.getIntersection(t).notEqual(u.Empty)}},{key:"getIntersection",value:function(t){var e=Math.min,n=Math.max,r=n(this.left,t.left),i=n(this.top,t.top),n=e(this.right,t.right),t=e(this.bottom,t.bottom);return r<n&&i<t?new u(r,i,n-r,t-i):u.Empty}},{key:"getPointByProportion",value:function(t){return new Tm(this.left+t.x*this.width,this.top+t.y*this.height)}},{key:"minimumDistanceTo",value:function(t){var e=Math.abs,n=this.left,r=this.right,i=this.top,o=this.bottom;return new Tm(e(l1.displacementFromRange(t.x,n,r)),e(l1.displacementFromRange(t.y,i,o))).magnitude()}},{key:"toString",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=b2([this.top,this.left,this.bottom,this.right,this.width,this.height].map(function(t){return t.toFixed(e)}),6),n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],t=t[5];return"[".concat(r," ").concat(n," ").concat(o," ").concat(i,", ").concat(a,"w ").concat(t,"h]")}}])&&T2(t.prototype,e),n&&T2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}();function E2(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return P2(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P2(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}function P2(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function k2(i,t){var e,o=new T.Graphics,n=E2((i=i.fill(new Tm)).points);try{var r=function(){var n=e.value,r=[];[w9.North,w9.South,w9.West,w9.East].forEach(function(t){var e=O9(t);i.get(n.add(e))||r.push(t)}),function(i,o,a,t){var e=Hg.white,n=Hg.blueprint,r={};r[w9.North]=new S2(0,-1,t,1),r[w9.South]=new S2(0,t,t,1),r[w9.East]=new S2(t,0,1,t),r[w9.West]=new S2(-1,0,1,t);var s={};function u(t){var e,n=E2(a);try{for(n.s();!(e=n.n()).done;){var r=t[e.value];r.x+=o.x,r.y+=o.y,i.drawRect(r.x,r.y,r.width,r.height)}}catch(t){n.e(t)}finally{n.f()}}s[w9.North]=new S2(0,0,t,1),s[w9.South]=new S2(0,t,t,-1),s[w9.East]=new S2(t,0,-1,t),s[w9.West]=new S2(0,0,1,t),o=o.multiply(t),i.beginFill(e),u(r),i.endFill(),i.beginFill(n),u(s),i.endFill()}(o,n,r,t)};for(n.s();!(e=n.n()).done;)r()}catch(t){n.e(t)}finally{n.f()}return o}function R2(t){return(R2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function C2(t,e){return(C2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function I2(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=j2(n);return function(t,e){{if(e&&("object"===R2(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return M2(t)}(this,r?(t=j2(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function M2(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j2(t){return(j2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function D2(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var L2=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C2(t,e)}(i,i9);var t,e,n,r=I2(i);function i(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),D2(M2(n=r.call(this)),"animPulsar",new tb(i.settings.animPulseInterval,n.triggerAnimation,M2(n))),D2(M2(n),"movementPulsar",new tb({firstInterval:i.settings.moveFirst,interval:i.settings.moveRepeat},n.triggerMovement,M2(n))),D2(M2(n),"cursorGraphics",void 0),D2(M2(n),"slideAnimSlider",new Qg({granularity:1/i.settings.moveRepeat})),D2(M2(n),"_mode","point"),D2(M2(n),"_areaReticle",void 0),D2(M2(n),"controlsEnabled",!0),D2(M2(n),"_boardLocation",new Tm),D2(M2(n),"lastPos",new Tm),D2(M2(n),"transform",new g2(new Tm(n.boardLocation))),D2(M2(n),"map",void 0),D2(M2(n),"controller",void 0),D2(M2(n),"spriteLayer",new T.Container),D2(M2(n),"cursorSprite",void 0),D2(M2(n),"pointerSprite",void 0),D2(M2(n),"reticleSprite",void 0),D2(M2(n),"areaOfEffectLayer",new T.Container),n.map=t,n.controller=e;e=zI.loader.resources[i.spritesheet].spritesheet;return n.cursorGraphics={selector:e.animations["MapCursor/mapcursor"],targetSelector:e.animations["MapCursor/targetcursor"],arrowPointer:e.animations["MapCursor/mapcursor-arrow"],constructPointer:e.animations["MapCursor/mapcursor-wrench"],banPointer:e.animations["MapCursor/mapcursor-wrong"]},n.cursorSprite=new Bf(n.cursorGraphics.selector),n.cursorSprite.animationSpeed=i.settings.animSpeed,n.cursorSprite.loop=!1,n.pointerSprite=new Bf(n.cursorGraphics.arrowPointer),n.pointerSprite.animationSpeed=i.settings.animSpeed,n.pointerSprite.loop=!1,n.reticleSprite=new Bf(n.cursorGraphics.targetSelector),n.reticleSprite.animationSpeed=i.settings.reticleSpeed,n.reticleSprite.loop=!0,n.reticleSprite.visible=!1,n.reticleSprite.play(),n.spriteLayer.addChild(n.cursorSprite,n.pointerSprite,n.reticleSprite,n.areaOfEffectLayer),n.transform.object=n.spriteLayer,n.transform.z=100,Fv("ui").addChild(n.spriteLayer),n.animPulsar.start(),zI.scene.ticker.add(n.updateInput,M2(n)),zI.scene.ticker.add(n.updateGameWorldPosition,M2(n)),n}return t=i,(e=[{key:"mode",get:function(){return this._mode},set:function(t){var e="target"===t,n=this.cursorGraphics,n="build"===t?n.constructPointer:"ban"===t?n.banPointer:n.arrowPointer;this.pointerSprite.textures=n,this.pointerSprite.visible=!e,this.cursorSprite.visible=!e,this.reticleSprite.visible=e,this._mode=t}},{key:"regionMap",get:function(){return this._areaReticle},set:function(t){this._areaReticle=t,this.areaOfEffectLayer.removeChildren(),this._areaReticle&&(t=zI.display.standardLength,this.areaOfEffectLayer.addChild(k2(this._areaReticle,t)))}},{key:"showAreaOfEffectMap",get:function(){return this.areaOfEffectLayer.visible},set:function(t){this.areaOfEffectLayer.visible=t}},{key:"position",get:function(){return new Tm(this.transform.exact)}},{key:"boardLocation",get:function(){return this._boardLocation.clone()}},{key:"coordinateLimits",get:function(){return new Tm(this.map.width-1,this.map.height-1)}},{key:"destroy",value:function(){this.clearListeners(),this.transform.destroy(),this.animPulsar.destroy(),this.movementPulsar.destroy(),this.spriteLayer.destroy({children:!0}),zI.scene.ticker.remove(this.updateInput,this),this.mapRef=null,this.controller=null}},{key:"resetSettings",value:function(){this.mode="point",this.regionMap=void 0,this.showAreaOfEffectMap=!0}},{key:"hide",value:function(){this.disable(),this.spriteLayer.visible=!1}},{key:"show",value:function(){this.enable(),this.spriteLayer.visible=!0}},{key:"hidden",get:function(){return!this.spriteLayer.visible}},{key:"disable",value:function(){this.controlsEnabled=!1,this.movementPulsar.stop()}},{key:"enable",value:function(){this.controlsEnabled=!0}},{key:"enabled",get:function(){return this.controlsEnabled}},{key:"triggerAnimation",value:function(){this.cursorSprite.gotoAndPlay(0),this.pointerSprite.gotoAndPlay(0)}},{key:"triggerMovement",value:function(){var t;this.controller.axis.dpad.framePoint.notEqual(Tm.Origin)||(t=new Tm(this.controller.axis.dpad.point),this.move(t))}},{key:"updateInput",value:function(){var t,e,n,r,i;this.controlsEnabled&&(t=this.controller.axis.dpad,e=[(r=this.controller.button).dpadUp,r.dpadDown,r.dpadLeft,r.dpadRight].some(function(t){return t.pressed||t.released}),n=t.roaming&&!this.movementPulsar.active,e&&(i=n?t.point:t.framePoint,this.move(i)),r=this.map.squareAt(this._boardLocation),i=this.map.squareAt(this._boardLocation.add(t.point)),r=r.moveFlag&&!i.moveFlag,i=this.movementPulsar.firstIntervalComplete,r&&i&&this.movementPulsar.reset(),(e||n)&&this.movementPulsar.startReset(),t.returned&&this.movementPulsar.stop())}},{key:"updateGameWorldPosition",value:function(){var t;this.boardLocation.equal(this.lastPos)||(this.slideAnimSlider.track!=this.slideAnimSlider.max?this.slideAnimSlider.increment():this.lastPos.set(this.boardLocation),t=zI.display.standardLength,t=this.boardLocation.subtract(this.lastPos).multiply(t).multiply(this.slideAnimSlider.output).add(this.lastPos.multiply(t)),this.transform.position=t)}},{key:"setCursorLocation",value:function(t){this._boardLocation.set(t),this.updateListeners("move"),zI.diagnosticLayer.cursorPos=this._boardLocation.toString()}},{key:"animateTo",value:function(t){var e=t.clamp(this.coordinateLimits),t=new Tm(this.transform).multiply(1/16);this.lastPos.set(t),this.setCursorLocation(e),this.slideAnimSlider.setToMin()}},{key:"teleportTo",value:function(t){t=t.clamp(this.coordinateLimits);this.lastPos.set(-1,-1),this.slideAnimSlider.setToMax(),this.setCursorLocation(t),this.updateGameWorldPosition()}},{key:"moveTo",value:function(t){var e=t.clamp(this.coordinateLimits),t=this._boardLocation.distance(e);0!=t&&(t<2?this.animateTo(e):this.teleportTo(e))}},{key:"move",value:function(t){t=this._boardLocation.add(t);this.moveTo(t)}}])&&A2(t.prototype,e),n&&A2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function N2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function F2(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}D2(L2,"spritesheet","UISpritesheet"),D2(L2,"settings",{animSpeed:.4,reticleSpeed:.25,animPulseInterval:40,moveFirst:15,moveRepeat:3});var B2=function(){function n(t){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),F2(this,"sheet",zI.scene.resources.UISpritesheet.spritesheet),F2(this,"width",void 0),F2(this,"height",void 0),F2(this,"visualBoundaryWidth",void 0),F2(this,"enabled",!0),F2(this,"show",!0),F2(this,"showOnLeftSide",!0),F2(this,"slideSpeed",.15),F2(this,"holdToOpenSlider",new Qg({max:1,granularity:this.slideSpeed,shape:this.shapeFunction})),F2(this,"sideChangeSlider",new Qg({min:0,max:1,granularity:this.slideSpeed/2,shape:function(t){return 2*e.shapeFunction(t)-1}})),F2(this,"slideDistance",void 0),F2(this,"stickOutDistance",void 0),F2(this,"opacitySlider",new Qg({granularity:.5,shape:function(t){return Math.sqrt(t)}})),F2(this,"displayContainer",new T.Container),F2(this,"mask",null),console.assert(Boolean(this.sheet),"UI spritesheet does not exist. Do not initialize SlidingWindow before loading assets."),this.displayContainer.y=t.verticalDistance||0,this.width=t.width,this.height=t.height,this.slideDistance=this.width,this.stickOutDistance=t.stickOutDistance||0,this.visualBoundaryWidth=t.visualBoundaryWidth||zI.display.renderWidth,this.show=0!=t.show,this.showOnLeftSide=!1,this.positionWindow({skip:!0}),zI.hud.addChild(this.displayContainer),zI.scene.ticker.add(this.update,this)}var t,e,r;return t=n,(e=[{key:"shapeFunction",value:function(t){return 1-(0,Math.pow)((0,Math.cos)(Math.PI*t/2),2)}},{key:"destroy",value:function(){this.displayContainer.destroy({children:!0})}},{key:"setVisible",value:function(){this.opacitySlider.incrementFactor=1}},{key:"setInvisible",value:function(){this.opacitySlider.incrementFactor=-1}},{key:"positionWindow",value:function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{skip:!1}).skip&&this.skipSlideAnimation();var t=this.slideDistance-this.stickOutDistance,e=-t*this.sideChangeSlider.output,n=t-t*this.holdToOpenSlider.output;this.onLeftSide&&(n=-n),this.mask&&(this.mask.x=this.onLeftSide?this.width:-this.width);t=this.onLeftSide?-t:this.visualBoundaryWidth-this.stickOutDistance;t+=e,this.displayContainer.x=t+=n}},{key:"update",value:function(){this.holdToOpenSlider.incrementFactor=this.show?1:-1,this.sideChangeSlider.incrementFactor=this.showOnLeftSide?-1:1,this.holdToOpenSlider.increment(),this.sideChangeSlider.increment(),this.opacitySlider.increment(),this.positionWindow(),this.displayContainer.alpha=this.opacitySlider.output}},{key:"refreshable",get:function(){var t=this.sideChangeSlider.output<.1&&-.1<this.sideChangeSlider.output,e=this.sideChangeSlider.track==this.sideChangeSlider.min&&this.showOnLeftSide,n=this.sideChangeSlider.track==this.sideChangeSlider.max&&!this.showOnLeftSide,e=e||n,n=this.opacitySlider.equalsBoundary();return t||e&&n}},{key:"onLeftSide",get:function(){var t=(this.sideChangeSlider.min+this.sideChangeSlider.max)/2;return this.sideChangeSlider.track<t}},{key:"skipSlideAnimation",value:function(){this.holdToOpenSlider.track=this.show?this.holdToOpenSlider.max:this.holdToOpenSlider.min,this.sideChangeSlider.track=this.showOnLeftSide?this.sideChangeSlider.min:this.sideChangeSlider.max}}])&&N2(t.prototype,e),r&&N2(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}();function U2(t){var e=new T.Graphics,n=t.offset?t.offset.x:0,r=t.offset?t.offset.y:0;return e.beginFill(t.color,t.alpha),e.drawRect(n,r,t.width,t.height),e.endFill(),t.border&&(e.beginFill(t.border.color,t.alpha),e.drawRect(n,r,t.width,t.border.top),e.drawRect(n,r+t.height,t.width,-t.border.bottom),e.drawRect(n,r,t.border.left,t.height),e.drawRect(n+t.width,r,-t.border.right,t.height),e.endFill()),e.zIndex=-1,e}F2(B2,"stdLength",4),F2(B2,"stdWidth",88);var G2=100,X2=20,H2=3;function z2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function V2(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var W2=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),V2(this,"container",void 0),V2(this,"transparency",new Qg({granularity:1/3,track:"min",incrementFactor:-1})),zI.scene.ticker.add(this.updateTransparency,this)}var e,n,r;return e=t,(n=[{key:"destroy",value:function(){zI.scene.ticker.remove(this.updateTransparency,this)}},{key:"updateTransparency",value:function(){this.transparency.increment(),this.container.alpha=this.transparency.output}},{key:"show",value:function(){this.transparency.incrementFactor=1}},{key:"hide",value:function(){this.transparency.incrementFactor=-1}}])&&z2(e.prototype,n),r&&z2(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Y2(t){return(Y2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function q2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function K2(t,e){return(K2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Z2(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=$2(n);return function(t,e){{if(e&&("object"===Y2(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return Q2(t)}(this,r?(t=$2(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function Q2(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $2(t){return($2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function J2(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var t_=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&K2(t,e)}(i,W2);var t,e,n,r=Z2(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),J2(Q2(t=r.call(this)),"container",new T.Container),J2(Q2(t),"window",void 0),J2(Q2(t),"damageNumber",void 0),J2(Q2(t),"colorModes",{safe:[0,1,.45],normal:[0,1,1],caution:[1,1,.31],danger:[1,.29,.31]}),J2(Q2(t),"colorFilter",new f.ColorReplaceFilter([0,0,0],t.colorModes.safe)),J2(Q2(t),"shimmer",new Qg({max:2,granularity:.1,shape:function(t){return.333*Math.floor(3*(1-t%1))}})),J2(Q2(t),"shimmerPulsar",new tb({firstInterval:45,interval:90},function(){t.shimmer.track="min"},Q2(t))),J2(Q2(t),"verticalOscillate",new Qg({max:2,granularity:1,looping:!0})),J2(Q2(t),"motionPulsar",new tb(20,function(){t.verticalOscillate.decrement(),t.window.y=-t.verticalOscillate.output,t.damageNumber.y=5-t.verticalOscillate.output},Q2(t))),J2(Q2(t),"_mode","safe");var e=zI.scene.resources.UISpritesheet.spritesheet;return t.window=new T.Sprite(e.textures["damage-forecast-pane.png"]),t.window.filters=[t.colorFilter],t.damageNumber=new T.BitmapText("",Xg.scriptOutlined),t.damageNumber.position.set(23,5),t.damageNumber.anchor.set(1,0),t.container.addChild(t.window,t.damageNumber),t.setForecastDamage(0),t.mode="safe",t.motionPulsar.start(),t.shimmerPulsar.start(),zI.scene.ticker.add(t.update,Q2(t)),t}return t=i,(e=[{key:"damage",get:function(){return this.damageNumber.text}},{key:"setForecastDamage",value:function(t){this.damageNumber.text=l1.clamp(t,0,999).toString()}},{key:"mode",get:function(){return this._mode},set:function(t){if(!Object.keys(this.colorModes).includes(t))throw new Error("Color mode '".concat(t,"' does not exist in filters repository."));this.setColor(),this._mode=t,this.shimmer.track="max",this.shimmerPulsar.reset()}},{key:"destroy",value:function(){this.container.destroy({children:!0}),this.motionPulsar.destroy(),this.shimmerPulsar.destroy(),zI.scene.ticker.remove(this.update,this)}},{key:"update",value:function(){this.shimmer.increment(),this.setColor()}},{key:"setColor",value:function(){var e=this.shimmer.equalsMax()?0:this.shimmer.output,t=this.colorModes[this.mode].map(function(t){return t+.8*(1-t)*e});this.colorFilter.newColor=t}}])&&q2(t.prototype,e),n&&q2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function e_(t){return(e_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r_(){return(r_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s_(t)););return t}(t,e);if(r){e=Object.getOwnPropertyDescriptor(r,e);return e.get?e.get.call(arguments.length<3?t:n):e.value}}).apply(this,arguments)}function i_(t,e){return(i_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function o_(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=s_(n);return function(t,e){{if(e&&("object"===e_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return a_(t)}(this,r?(t=s_(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function a_(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s_(t){return(s_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u_(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c_=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i_(t,e)}(i,B2);var t,e,n,r=o_(i);function i(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),u_(a_(e=r.call(this,t)),"starSize",8),u_(a_(e),"thumbnail",new T.Container),u_(a_(e),"name",new T.BitmapText("",Xg.scriptOutlined)),u_(a_(e),"defenseStars",new T.TilingSprite(e.sheet.textures["icon-star-empty.png"],4*e.starSize,e.starSize)),u_(a_(e),"defenseStarsFill",new T.TilingSprite(e.sheet.textures["icon-star-full.png"],0,e.starSize)),u_(a_(e),"buildingIcon",new T.Sprite(e.sheet.textures["icon-capture.png"])),u_(a_(e),"heartIcon",new T.Sprite(e.sheet.textures["icon-heart.png"])),u_(a_(e),"numberMeterText",new T.BitmapText("",Xg.scriptOutlined)),u_(a_(e),"damageForecast",void 0),u_(a_(e),"_showDamageForecast",!1);t=U2({width:88,height:24,color:0,alpha:.5});return e.thumbnail.x=e.thumbnail.y=4,e.name.x=24,e.name.y=3,e.defenseStars.x=24,e.defenseStars.y=16,e.defenseStars.addChild(e.defenseStarsFill),e.buildingIcon.x=60,e.buildingIcon.y=16,e.numberMeterText.x=85,e.numberMeterText.y=13,e.numberMeterText.anchor.x=1,e.heartIcon.x=e.buildingIcon.x,e.heartIcon.y=e.buildingIcon.y,e.heartIcon.visible=!1,e.damageForecast=new t_,e.damageForecast.container.position.set(0,-24),e.displayContainer.addChild(t),e.displayContainer.addChild(e.thumbnail,e.name),e.displayContainer.addChild(e.defenseStars,e.buildingIcon,e.heartIcon,e.numberMeterText),e.displayContainer.addChild(e.damageForecast.container),e}return t=i,(e=[{key:"destroy",value:function(){r_(s_(i.prototype),"destroy",this).call(this),this.damageForecast.destroy()}},{key:"positionWindow",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{skip:!1};r_(s_(i.prototype),"positionWindow",this).call(this,t),this.damageForecast&&(this.damageForecast.container.x=this.onLeftSide?this.displayContainer.width-this.damageForecast.container.width-2:2)}},{key:"setThumbnail",value:function(t){this.thumbnail.removeChildren(),this.thumbnail.addChild(t)}},{key:"setName",value:function(t){this.name.text=t}},{key:"setDefenseMeter",value:function(t){t=l1.confine(t,0,4);this.defenseStarsFill.width=this.starSize*t}},{key:"setCaptureMeter",value:function(t){t=l1.confine(t,0,20),this.numberMeterText.text=t.toString(),this.buildingIcon.visible=!0,this.heartIcon.visible=!1,this.numberMeterText.visible=!0}},{key:"setHPMeter",value:function(t){t=l1.confine(t,0,99),this.numberMeterText.text=t.toString(),this.heartIcon.visible=!0,this.buildingIcon.visible=!1,this.numberMeterText.visible=!0}},{key:"hideCaptureMeter",value:function(){this.heartIcon.visible=!1,this.buildingIcon.visible=!1,this.numberMeterText.visible=!1}},{key:"setDamageForecast",value:function(t){void 0!==t?(this.damageForecast.setForecastDamage(Math.round(t)),this.damageForecast.mode="safe",this.retriggerDamageForecastVisibility()):this.damageForecast.hide()}},{key:"retriggerDamageForecastVisibility",value:function(){this._showDamageForecast?this.damageForecast.show():this.damageForecast.hide()}},{key:"inspectTerrain",value:function(t,e){var n,r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this.setName(t.name),this.setThumbnail(t.preview),this.setDefenseMeter(t.defenseRating),t.building?this.setCaptureMeter(X2-(null!==(n=null==e?void 0:e.capture)&&void 0!==n?n:0)):t.damageable?this.setHPMeter(t.value):this.hideCaptureMeter(),this._showDamageForecast=r&&!Boolean(e)&&t.damageable,this.retriggerDamageForecastVisibility()}}])&&n_(t.prototype,e),n&&n_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function l_(t){return(l_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f_(){return(f_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=m_(t)););return t}(t,e);if(r){e=Object.getOwnPropertyDescriptor(r,e);return e.get?e.get.call(arguments.length<3?t:n):e.value}}).apply(this,arguments)}function p_(t,e){return(p_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function d_(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=m_(n);return function(t,e){{if(e&&("object"===l_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return y_(t)}(this,r?(t=m_(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function y_(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m_(t){return(m_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v_(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g_=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p_(t,e)}(i,B2);var t,e,n,r=d_(i);function i(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),v_(y_(e=r.call(this,t)),"unitToDisplay",!1),v_(y_(e),"ammoIcon",e.sheet.textures["icon-ammo.png"]),v_(y_(e),"materialsIcon",e.sheet.textures["icon-material.png"]),v_(y_(e),"thumbnail",new T.Container),v_(y_(e),"name",new T.BitmapText("",Xg.scriptOutlined)),v_(y_(e),"hpMeter",new T.Sprite(e.sheet.textures["icon-heart.png"])),v_(y_(e),"hpMeterText",new T.BitmapText("",Xg.scriptOutlined)),v_(y_(e),"gasMeter",new T.Sprite(e.sheet.textures["icon-gas.png"])),v_(y_(e),"gasMeterText",new T.BitmapText("",Xg.scriptOutlined)),v_(y_(e),"ammoMeter",new T.Sprite(e.sheet.textures["icon-ammo.png"])),v_(y_(e),"ammoMeterText",new T.BitmapText("",Xg.scriptOutlined)),v_(y_(e),"firstLoad",new T.Graphics),v_(y_(e),"secondLoad",new T.Graphics),v_(y_(e),"damageForecast",void 0);t=U2({width:88,height:24,color:0,alpha:.5});return e.thumbnail.x=e.thumbnail.y=4,e.name.x=24,e.name.y=3,e.hpMeter.x=24,e.hpMeter.y=16,e.gasMeter.x=48,e.gasMeter.y=16,e.ammoMeter.x=71,e.ammoMeter.y=16,e.hpMeter.addChild(e.hpMeterText),e.gasMeter.addChild(e.gasMeterText),e.ammoMeter.addChild(e.ammoMeterText),e.hpMeterText.x=22,e.hpMeterText.y=-3,e.gasMeterText.x=22,e.gasMeterText.y=-3,e.ammoMeterText.x=15,e.ammoMeterText.y=-3,e.hpMeterText.anchor.x=1,e.gasMeterText.anchor.x=1,e.ammoMeterText.anchor.x=1,e.firstLoad=U2({offset:{x:-1,y:-1},width:18,height:17,color:0,alpha:.5}),e.firstLoad.x=2,e.firstLoad.y=-17,e.secondLoad=U2({offset:{x:-1,y:-1},width:18,height:17,color:0,alpha:.5}),e.secondLoad.x=20,e.secondLoad.y=-17,e.damageForecast=new t_,e.damageForecast.container.position.set(0,-24),e.displayContainer.addChild(t),e.displayContainer.addChild(e.thumbnail,e.name),e.displayContainer.addChild(e.hpMeter,e.gasMeter,e.ammoMeter),e.displayContainer.addChild(e.firstLoad,e.secondLoad),e.displayContainer.addChild(e.damageForecast.container),e}return t=i,(e=[{key:"destroy",value:function(){f_(m_(i.prototype),"destroy",this).call(this),this.damageForecast.destroy()}},{key:"setVisible",value:function(){this.opacitySlider.incrementFactor=this.unitToDisplay?1:-1}},{key:"positionWindow",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{skip:!1};f_(m_(i.prototype),"positionWindow",this).call(this,t),this.firstLoad&&(this.firstLoad.x=this.onLeftSide?2:70,this.secondLoad.x=this.onLeftSide?21:51),this.damageForecast&&(this.damageForecast.container.x=this.onLeftSide?this.displayContainer.width-this.damageForecast.container.width-2:2)}},{key:"setThumbnail",value:function(t){this.thumbnail.removeChildren(),this.thumbnail.addChild(t)}},{key:"setName",value:function(t){this.name.text=t}},{key:"setHPMeterValue",value:function(t){this.hpMeterText.text=t.toString()}},{key:"setGasMeterValue",value:function(t){this.gasMeterText.text=t.toString()}},{key:"setAmmoMeterValue",value:function(t,e){this.ammoMeterText.text=0==e?"_":t.toString().slice(0,2),this.ammoMeter.texture=this.ammoIcon}},{key:"setMaterialMeterValue",value:function(t){this.ammoMeterText.text=t.toString().slice(0,2),this.ammoMeter.texture=this.materialsIcon}},{key:"setFirstLoadUnit",value:function(t){this.firstLoad.removeChildren(),this.firstLoad.visible=Boolean(t),t&&this.firstLoad.addChild(t)}},{key:"setSecondLoadUnit",value:function(t){this.secondLoad.removeChildren(),this.secondLoad.visible=Boolean(t),t&&this.secondLoad.addChild(t)}},{key:"setDamageForecast",value:function(t,e){void 0!==t&&void 0!==e?(t=Math.round(t),e=Math.round(e),this.damageForecast.setForecastDamage(t),this.damageForecast.mode=e<10?"safe":e<20?"normal":e<50?"caution":"danger",this.damageForecast.show()):this.damageForecast.hide()}},{key:"inspectUnit",value:function(t){this.unitToDisplay=Boolean(t),t&&(this.setThumbnail(t.preview),this.setName(t.name),this.setHPMeterValue(t.displayHP),this.setGasMeterValue(t.gas),t.materialsInsteadOfAmmo?this.setMaterialMeterValue(t.ammo):this.setAmmoMeterValue(t.ammo,t.maxAmmo),this.setFirstLoadUnit(0<t.cargo.length?t.cargo[0].cargoPreview:null),this.setSecondLoadUnit(1<t.cargo.length?t.cargo[1].cargoPreview:null))}}])&&h_(t.prototype,e),n&&h_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(),b_={CoWindow:{background:Hg.standing_ovation,white_tintdown:Hg.asian_violet},propertyCapture:{meter:Hg.light_slipper_satin,tint:Hg.white},turnStartSplash:{presenceBackground:Hg.standing_ovation},paletteSwap:{}},__={CoWindow:{background:Hg.boerewors,white_tintdown:Hg.hibiscus_petal},propertyCapture:{meter:Hg.pepper_jelly,tint:Hg.hibiscus_petal},turnStartSplash:{presenceBackground:Hg.boerewors},paletteSwap:{}},x_={CoWindow:{background:Hg.regal_destiny,white_tintdown:Hg.maximum_blue_purple},propertyCapture:{meter:Hg.janitor,tint:Hg.maximum_blue_purple},turnStartSplash:{presenceBackground:Hg.regal_destiny},paletteSwap:{}},w_={CoWindow:{background:Hg.tarnished_brass,white_tintdown:Hg.master_key},propertyCapture:{meter:Hg.grass_daisy,tint:Hg.master_key},turnStartSplash:{presenceBackground:Hg.lemon_ginger},paletteSwap:{}},T_={CoWindow:{background:Hg.gulfweed,white_tintdown:Hg.weekend_gardener},propertyCapture:{meter:Hg.green_envy,tint:Hg.weekend_gardener},turnStartSplash:{presenceBackground:Hg.gulfweed},paletteSwap:{}},O_={CoWindow:{background:Hg.black_dahlia,white_tintdown:Hg.cerebral_grey1},propertyCapture:{meter:Hg.decorative_iris,tint:Hg.cerebral_grey1},turnStartSplash:{presenceBackground:Hg.black_dahlia},paletteSwap:{}};l1.freezeObject({neutral:b_,red:__,blue:x_,yellow:w_,green:T_,black:O_});function S_(t){return[b_,b_,__,x_,w_,O_][t]}function E_(t){return(E_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k_(t,e){return(k_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function R_(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=C_(n);return function(t,e){{if(e&&("object"===E_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return A_(t)}(this,r?(t=C_(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function A_(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C_(t){return(C_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function I_(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var M_=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&k_(t,e)}(u,B2);var t,e,n,s=R_(u);function u(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),I_(A_(n=s.call(this,t)),"player",void 0),I_(A_(n),"commanderImage",void 0),I_(A_(n),"powerMeter1",new T.Sprite(n.sheet.textures["power-meter.png"])),I_(A_(n),"powerMeter1Fill",new T.TilingSprite(n.sheet.textures["power-meter-full.png"],0,4)),I_(A_(n),"powerMeter2",new T.Sprite(n.sheet.textures["power-meter.png"])),I_(A_(n),"powerMeter2Fill",new T.TilingSprite(n.sheet.textures["power-meter-full.png"],0,4)),I_(A_(n),"insignia",void 0),I_(A_(n),"cityIcon",new T.Sprite(n.sheet.textures["icon-building-large.png"])),I_(A_(n),"funds",new T.Sprite(n.sheet.textures["icon-funds.png"])),I_(A_(n),"fundsText",new T.BitmapText("",Xg.scriptOutlined)),I_(A_(n),"armyCountText",new T.BitmapText("",Xg.scriptOutlined)),I_(A_(n),"cityCountText",new T.BitmapText("",Xg.scriptOutlined));var r=(n.player=e).faction;if([xv.None,xv.Neutral].includes(r))throw new RangeError("CO Window ".concat(e.playerNumber,": Cannot set faction to ").concat(Ev[r]));var i,o=S_(r).CoWindow,a=U2({width:88,height:31,color:o.background,alpha:1,border:{color:Hg.gale_force1,top:1,bottom:1,left:2,right:2}});return n.commanderImage=(i=new T.Graphics,t=e.officer.eyeshot,r=t.width,t=t.height,i.beginFill(o.white_tintdown,.3),i.drawRect(4,0,r-4,t),i.beginFill(o.white_tintdown,.15),i.drawRect(3,0,1,t),i.endFill(),i.addChild(e.officer.eyeshot),i),n.commanderImage.x=40,n.commanderImage.y=1,n.powerMeter1.x=42,n.powerMeter1.y=16,n.powerMeter1.addChild(n.powerMeter1Fill),n.powerMeter1Fill.x=21,n.powerMeter2.x=64,n.powerMeter2.y=n.powerMeter1.y,n.powerMeter2.addChild(n.powerMeter2Fill),n.powerMeter2Fill.x=21,n.insignia=e.officer.insignia,n.insignia.x=4,n.insignia.y=1,n.insignia.tint=o.white_tintdown,n.insignia.alpha=.8,n.cityIcon.x=4,n.cityIcon.y=16,n.cityIcon.tint=o.white_tintdown,n.cityIcon.alpha=.8,n.funds.x=22,n.funds.y=21,n.funds.addChild(n.fundsText),n.fundsText.x=62,n.fundsText.y=-3,n.fundsText.anchor.x=1,n.armyCountText.x=39,n.armyCountText.y=0,n.armyCountText.anchor.x=1,n.cityCountText.x=39,n.cityCountText.y=9,n.cityCountText.anchor.x=1,n.displayContainer.addChild(a),n.displayContainer.addChild(n.commanderImage,n.powerMeter1,n.powerMeter2),n.displayContainer.addChild(n.insignia,n.cityIcon),n.displayContainer.addChild(n.funds,n.armyCountText,n.cityCountText),n}return t=u,(e=[{key:"setPowerMeterValue",value:function(t){function e(t){return t*=3,t+=2,t*=-1}var n=l1.clamp(t,0,6),t=l1.clamp(t-6,0,6);this.powerMeter2Fill.width=e(n),this.powerMeter1Fill.width=e(t)}},{key:"setFundsValue",value:function(t){this.fundsText.text=t.toString().slice(-7)}},{key:"setArmyCountValue",value:function(t){this.armyCountText.text=t.toString().slice(-2)}},{key:"setCityCountValue",value:function(t){this.cityCountText.text=t.toString().slice(-2)}},{key:"inspectKnownPlayer",value:function(){this.setPowerMeterValue(this.player.powerMeterSegments),this.setFundsValue(this.player.funds),this.setArmyCountValue(this.player.units.length),this.setCityCountValue(this.player.propertyCount)}}])&&P_(t.prototype,e),n&&P_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}();function j_(t){return(j_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function D_(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(t,e)||N_(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L_(t){return function(t){if(Array.isArray(t))return F_(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||N_(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N_(t,e){if(t){if("string"==typeof t)return F_(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F_(t,e):void 0}}function F_(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function B_(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function G_(t,e,n){return e&&U_(t.prototype,e),n&&U_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function X_(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&H_(t,e)}function H_(t,e){return(H_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function z_(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=W_(n);return function(t,e){{if(e&&("object"===j_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return V_(t)}(this,r?(t=W_(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function V_(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function W_(t){return(W_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Y_(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q_(t){B_(this,q_),Y_(this,"container",new T.Container),this.container.position.set(t.x,t.y)}var K_=function(){X_(i,B2);var r=z_(i);function i(t){var e;B_(this,i),Y_(V_(e=r.call(this,t)),"gamepad",void 0),Y_(V_(e),"terrain",void 0),Y_(V_(e),"unit",void 0),Y_(V_(e),"_useShopTabSlider",!1),Y_(V_(e),"tabSlider",new Qg({max:3,granularity:1,looping:!0,shape:function(t){return e.unit?t:0}})),Y_(V_(e),"shopTabSlider",new Qg({max:2,granularity:1,looping:!0,shape:function(t){return e.unit?t+1:0}})),Y_(V_(e),"tabIconTerrain",new Q_(new Tm(66,11),e.sheet.textures["icon-panel-terrain.png"])),Y_(V_(e),"tabIconUnit",new Q_(new Tm(72,11),e.sheet.textures["icon-panel-unit.png"])),Y_(V_(e),"tabIconBattle",new Q_(new Tm(78,11),e.sheet.textures["icon-panel-battle.png"])),Y_(V_(e),"header",new $_(new Tm(5,4))),Y_(V_(e),"illustration",new tx(new Tm(8,18))),Y_(V_(e),"description",new J_(new Tm(8,62),e.width-16)),Y_(V_(e),"income",new ex(new Tm(8,119),new T.Sprite(e.sheet.textures["icon-funds.png"]))),Y_(V_(e),"repairType",new sx(new Tm(46,120))),Y_(V_(e),"moveCostTable",new ux(new Tm(8,130))),Y_(V_(e),"unitMoveType",new nx(new Tm(8,126),new T.Sprite(e.sheet.textures["icon-stats-movetype.png"]))),Y_(V_(e),"unitArmorType",new nx(new Tm(46,126),new T.Sprite(e.sheet.textures["icon-stats-armortype.png"]))),Y_(V_(e),"unitGas",new ox(new Tm(8,138),"Gas")),Y_(V_(e),"unitAmmo",new ox(new Tm(8,146),"Amu")),Y_(V_(e),"unitMobility",new ox(new Tm(8,154),"Mob")),Y_(V_(e),"unitVision",new ox(new Tm(46,138),"Vis")),Y_(V_(e),"unitRange",new ax(new Tm(46,146),"Rng")),Y_(V_(e),"damageHeuristicTable",new ix(new Tm(8,62),{boost:e.sheet.textures["icon-stats-boost.png"],depress:e.sheet.textures["icon-stats-depress.png"],none:T.Texture.EMPTY}));var n=U2({width:88,height:165,color:0,alpha:.5});return e.mask=U2({width:88,height:165,color:16777215,alpha:1}),e.mask.x=e.showOnLeftSide?t.width:-t.width,(t=e.displayContainer).addChild.apply(t,[n,e.mask].concat(L_([e.tabIconTerrain,e.tabIconUnit,e.tabIconBattle,e.illustration,e.header,e.description,e.income,e.repairType,e.moveCostTable,e.unitMoveType,e.unitArmorType,e.unitGas,e.unitAmmo,e.unitMobility,e.unitVision,e.unitRange,e.damageHeuristicTable].map(function(t){return t.container})))),zI.scene.ticker.add(e.getInput,V_(e)),e}return G_(i,[{key:"visible",get:function(){return this.displayContainer.visible},set:function(t){this.displayContainer.visible=t}},{key:"useShopTabSlider",get:function(){return this._useShopTabSlider},set:function(t){this._useShopTabSlider=t,this._useShopTabSlider?this.shopTabSlider.track=0<this.tabSlider.track?this.tabSlider.track-1:0:this.tabSlider.track=2===this.shopTabSlider.output?this.shopTabSlider.output:this.tabSlider.track}},{key:"destroy",value:function(){this.gamepad=void 0,zI.scene.ticker.remove(this.getInput,this)}},{key:"getInput",value:function(){var t;null!==(t=this.gamepad)&&void 0!==t&&t.button.X.pressed&&((this.useShopTabSlider?this.shopTabSlider:this.tabSlider).increment(),this.inspectTile(this.terrain,this.unit))}},{key:"inspectTile",value:function(t,e){this.terrain=t,this.unit=e;var n=this.useShopTabSlider?this.shopTabSlider:this.tabSlider,r=0<n.output,i=2===n.output;this.tabIconTerrain.active=!this.useShopTabSlider,this.tabIconUnit.active=Boolean(e),this.tabIconBattle.active=Boolean(e),this.header.text=(e&&r?e:t).name,this.description.text=(e&&r?e:t).description,this.illustration.setIllustration(t,e,r),this.illustration.focusUnit=r,this.illustration.spendUnit=(null==e?void 0:e.spent)||!1;n=t.generatesIncome?1e3:0;this.income.setValue(n),this.repairType.setState(t.repairType),this.moveCostTable.setTable(t),[this.income,this.repairType,this.moveCostTable].forEach(function(t){return t.container.visible=!r}),this.unitMoveType.text=e?["Inftry","Mech","TireA","TireB","Tread","Air","Ship","Trpt"][e.moveType]:"",this.unitArmorType.text=e?Tv(e.armorType):"",this.unitGas.setValue(null==e?void 0:e.maxGas),this.unitAmmo.setValue(null==e?void 0:e.maxAmmo),this.unitAmmo.setLabel(null!=e&&e.materialsInsteadOfAmmo?"Mtl":"Amu"),this.unitMobility.setValue(null==e?void 0:e.maxMovementPoints),this.unitVision.setValue(null==e?void 0:e.vision),this.unitRange.setRange(null==e?void 0:e.range),[this.unitMoveType,this.unitArmorType,this.unitGas,this.unitAmmo,this.unitMobility,this.unitVision,this.unitRange].forEach(function(t){return t.container.visible=r&&!i}),this.description.container.visible=!i,this.damageHeuristicTable.setHeuristics(e),[this.damageHeuristicTable].forEach(function(t){return t.container.visible=i})}}]),i}(),Z_=function(){X_(r,q_);var n=z_(r);function r(t,e){return B_(this,r),Y_(V_(t=n.call(this,t)),"elem",void 0),t.elem=new Ll("",e),t.container.addChild(t.elem),t}return G_(r,[{key:"text",get:function(){return this.elem.text},set:function(t){this.elem.text=t}}]),r}(),Q_=function(){X_(r,q_);var n=z_(r);function r(t,e){return B_(this,r),Y_(V_(t=n.call(this,t)),"icon",new T.Sprite),Y_(V_(t),"darkTint",8947848),t.icon.texture=e,t.container.addChild(t.icon),t}return G_(r,[{key:"active",get:function(){return this.icon.tint===this.darkTint},set:function(t){this.icon.tint=t?16777215:this.darkTint}}]),r}(),$_=function(){X_(n,Z_);var e=z_(n);function n(t){return B_(this,n),e.call(this,t,Xg.title)}return n}(),J_=function(){X_(r,Z_);var n=z_(r);function r(t,e){return B_(this,r),(t=n.call(this,t,Xg.script)).elem.maxWidth=e,t}return G_(r,[{key:"text",set:function(t){this.elem.text=t.replace(/\//g,"")}}]),r}(),tx=function(){function e(t){B_(this,e),Y_(this,"container",new T.Container),Y_(this,"land",new T.Container),Y_(this,"unit",new T.Container),Y_(this,"popfilter",new f.AdjustmentFilter({contrast:1.3,saturation:1.2})),Y_(this,"landUnpopFilter",new f.AdjustmentFilter({gamma:.85,contrast:1.15,saturation:1.1})),this.container.position.set(t.x,t.y)}return G_(e,[{key:"focusUnit",get:function(){return 1===this.unit.alpha},set:function(t){this.unit.filters=t?[this.popfilter]:null,this.land.filters=t?[this.landUnpopFilter]:[this.popfilter]}},{key:"spendUnit",get:function(){return 8947848===this.unit.tint},set:function(t){this.unit.tint=t?12303291:16777215}},{key:"setIllustration",value:function(t,e,n){var r=Sg.infoPortraitSheet,i=new T.Sprite(r.textures["sky-landscape.png"]),r=e&&e.unitClass===_v.Air,i=r&&n?i:t.illustration,t=new T.Container,e=(!r||n)&&(null==e?void 0:e.illustration)||t;return e!==t&&(t=-1===e.scale.x,e.x=t?2*e.width/3+4:e.width/3-4,e.y=+e.height/3-1,e.scale.set(.65*e.scale.x,.65)),this.land=i,this.unit=e,this.focusUnit=!1,this.spendUnit=!1,this.container.removeChildren(),this.container.addChild(this.land,this.unit),this}}]),e}(),ex=function(){X_(r,Z_);var n=z_(r);function r(t,e){return B_(this,r),(t=n.call(this,t,Xg.list)).elem.position.set(34,1),t.elem.anchor.set(1,0),t.container.addChild(e),t}return G_(r,[{key:"setValue",value:function(t){this.text=t.toString().slice(0,4),"0"===this.text&&(this.text="-")}}]),r}(),nx=function(){X_(r,Z_);var n=z_(r);function r(t,e){return B_(this,r),(t=n.call(this,t,Xg.list)).elem.text="GET HEIGHT",t.elem.position.set(e.width+2+.5*(34-e.width),e.height-t.elem.height),t.elem.anchor.set(.5,0),t.container.addChild(e),t}return r}(),rx=function(){X_(i,Z_);var r=z_(i);function i(t,e,n){return B_(this,i),Y_(V_(t=r.call(this,t,Xg.list)),"textures",void 0),Y_(V_(t),"value",new T.Sprite),t.elem.text=e,t.value.position.set(33,0),t.value.anchor.set(1,0),t.container.addChild(t.value),t.textures=n,t}return G_(i,[{key:"setHeuristic",value:function(t){t=l1.clamp(t,0,2);var e=this.textures,n=e.boost,r=e.depress,e=e.none;this.value.texture=[e,r,n][t]}}]),i}(),ix=function(){X_(s,q_);var a=z_(s);function s(t,n){var r;B_(this,s),Y_(V_(r=a.call(this,t)),"elems",{});var e=gv.Infantry,i=gv.Vehicle,o=gv.Air,t=gv.Heli;return[e,i,gv.Ship,o,t,gv.Sub].map(Tv).forEach(function(t,e){e=new Tm(3<=e?36:0,3<=e?8*(e-3):8*e);r.elems[t]=new rx(e,t,n),r.container.addChild(r.elems[t].container)}),r}return G_(s,[{key:"setHeuristics",value:function(n){var t,e,r,i,o=this;n&&(t=gv.Infantry,e=gv.Vehicle,r=gv.Air,i=gv.Heli,[t,e,gv.Ship,r,i,gv.Sub].forEach(function(t){var e=Tv(t),t=n.getIdealAttackHeuristic(t);o.elems[e].setHeuristic(t)}))}}]),s}(),ox=function(){X_(r,Z_);var n=z_(r);function r(t,e){B_(this,r),Y_(V_(t=n.call(this,t,Xg.list)),"label",void 0),t.elem.position.set(35,1),t.elem.anchor.set(1,0),t.label=new Ll(e,Xg.list),t.label.position.set(1);e=U2({width:17,height:8,color:0,alpha:.35});return e.addChild(t.label),t.container.addChild(e),t}return G_(r,[{key:"setValue",value:function(t){this.text=(null==t?void 0:t.toString().slice(0,2))||"0","0"===this.text&&(this.text="-")}},{key:"setLabel",value:function(t){this.label.text=t}}]),r}(),ax=function(){X_(e,ox);var t=z_(e);function e(){return B_(this,e),t.apply(this,arguments)}return G_(e,[{key:"setRange",value:function(t){!t||t.min<1||t.max<1?this.text="-":t.min===t.max?this.text="".concat(t.min):this.text="".concat(t.min,"-").concat(t.max)}}]),e}(),sx=function(){X_(n,q_);var e=z_(n);function n(t){B_(this,n),Y_(V_(t=e.call(this,t)),"rep",new Ll("Rep",Xg.list)),Y_(V_(t),"typeG",new Ll("G",Xg.list)),Y_(V_(t),"typeN",new Ll("N",Xg.list)),Y_(V_(t),"typeA",new Ll("A",Xg.list));return t.typeG.x=18,t.typeN.x=24,t.typeA.x=30,t.container.addChild(t.rep,t.typeG,t.typeN,t.typeA),t}return G_(n,[{key:"setState",value:function(t){var e=14540253;this.typeG.tint=t===_v.Ground?e:8947848,this.typeN.tint=t===_v.Naval?e:8947848,this.typeA.tint=t===_v.Air?e:8947848}}]),n}(),ux=function(){X_(n,q_);var e=z_(n);function n(t){var r;B_(this,n),Y_(V_(r=e.call(this,t)),"table",{infantry:{label:new Ll("Inf",Xg.list),value:new Ll("",Xg.list)},tireA:{label:new Ll("TireA",Xg.list),value:new Ll("",Xg.list)},tireB:{label:new Ll("TireB",Xg.list),value:new Ll("",Xg.list)},ship:{label:new Ll("Ship",Xg.list),value:new Ll("",Xg.list)},mech:{label:new Ll("Mech",Xg.list),value:new Ll("",Xg.list)},tread:{label:new Ll("Tank",Xg.list),value:new Ll("",Xg.list)},air:{label:new Ll("Air",Xg.list),value:new Ll("",Xg.list)},transport:{label:new Ll("Trpt",Xg.list),value:new Ll("",Xg.list)}});var t=Object.values(r.table),i=Math.ceil(t.length/2);return t.forEach(function(t,e){var n=e<i?0:38,e=e%i*8;t.label.position.set(n,e),t.value.position.set(34+n,e),t.value.anchor.set(1,0),r.container.addChild(t.label,t.value)}),r}return G_(n,[{key:"setTable",value:function(t){var n=this;Object.entries(t.movementCost).forEach(function(t){var e=D_(t,2),t=e[0],e=e[1],t=n.table[t];t&&(t.value.text=0===(e=e)?"-":e.toString().slice(0,1))})}}]),n}();function cx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lx(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var hx=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),lx(this,"container",new T.Container),lx(this,"labelBack",new T.Graphics),lx(this,"label",new T.BitmapText("D",Xg.dayCounter)),lx(this,"textBack",new T.Graphics),lx(this,"text",new T.BitmapText("0",Xg.dayCounter)),lx(this,"_count",0),this.labelBack.addChild(this.label),this.textBack.addChild(this.text),this.container.addChild(this.textBack,this.labelBack),this.container.scale.set(.5),this.rebuildGraphics()}var e,n,r;return e=t,(n=[{key:"destroy",value:function(){this.container.destroy({children:!0})}},{key:"count",get:function(){return this._count},set:function(t){this._count=t,this.text.text=String(this._count),this.rebuildGraphics()}},{key:"rebuildGraphics",value:function(){this.createBackground(this.textBack,this.text),this.createBackground(this.labelBack,this.label),this.textBack.y=this.labelBack.height-2}},{key:"createBackground",value:function(t,e){var n=Hg.gale_force1,r=Hg.black,i="1"===e.text[0]?1:0;e.position.set(1+i,0);i=Math.max(e.width,13)+2+i,e=e.height;t.clear(),t.beginFill(r),t.drawRect(2,2,i,e),t.endFill(),t.beginFill(n),t.drawRect(0,0,i,e),t.endFill()}}])&&cx(e.prototype,n),r&&cx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function fx(t){return(fx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function px(t){return function(t){if(Array.isArray(t))return dx(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return dx(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dx(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dx(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function yx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mx(t,e){return(mx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function vx(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=bx(n);return function(t,e){{if(e&&("object"===fx(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return gx(t)}(this,r?(t=bx(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function gx(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bx(t){return(bx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _x(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var xx=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mx(t,e)}(i,W2);var t,e,n,r=vx(i);function i(){var t,e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),_x(gx(e=r.call(this)),"container",new T.Container),_x(gx(e),"dayCounter",new hx),(t=e.container).addChild.apply(t,px([e.dayCounter].map(function(t){return t.container}))),zI.hud.addChild(e.container),e}return t=i,(e=[{key:"destroy",value:function(){this.dayCounter.destroy(),this.container.destroy({children:!0})}}])&&yx(t.prototype,e),n&&yx(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function wx(t){return function(t){if(Array.isArray(t))return Tx(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Tx(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tx(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tx(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ox(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function Sx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ox(Object(n),!0).forEach(function(t){Px(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ox(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ex(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Px(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var kx={AlwaysShow:{width:88,height:24},DefaultHide:{width:88,height:24,show:!1},DrawerHide:{width:88,height:24,show:!1,stickOutDistance:2}},Rx=function(){function r(t){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),Px(this,"gamepad",void 0),Px(this,"cursor",void 0),Px(this,"camera",void 0),Px(this,"map",void 0),Px(this,"players",void 0),Px(this,"_battleForecast",void 0),Px(this,"commandersSlider",new Qg({granularity:.2})),Px(this,"playerInfo",{idealOrder:[],windows:[]}),Px(this,"windows",{detailedInfo:new K_(Sx(Sx({},kx.DefaultHide),{},{verticalDistance:1})),unitInfo:new g_(Sx(Sx({},kx.AlwaysShow),{},{verticalDistance:142})),terrainInfo:new c_(Sx(Sx({},kx.AlwaysShow),{},{verticalDistance:167}))}),Px(this,"hudIndicators",new xx),Px(this,"forceOpenDetailWindow",!1),Px(this,"screenSide","auto"),Px(this,"_visible",!1),this.gamepad=t.gamepad,this.cursor=t.cursor,this.camera=t.camera,this.map=t.map,this.players=t.players,this.players.all.forEach(function(t){t=new M_(kx.DrawerHide,t);e.playerInfo.idealOrder.push(t)}),this.playerInfo.windows=this.playerInfo.idealOrder,this.updatePlayerWindowOrder(),this.windows.detailedInfo.gamepad=this.gamepad;var n=this.windows.detailedInfo.mask;this.windows.unitInfo.displayContainer.mask=n,this.playerInfo.windows.forEach(function(t){return t.displayContainer.mask=n}),zI.scene.ticker.add(this.update,this),this.inspectListenerCallback()}var t,e,n;return t=r,(e=[{key:"battleForecast",get:function(){return this._battleForecast},set:function(t){this._battleForecast=t,this.windows.unitInfo.setDamageForecast(null==t?void 0:t.damage,null==t?void 0:t.counter),this.windows.terrainInfo.setDamageForecast(null==t?void 0:t.damage)}},{key:"destroy",value:function(){this.allWindows.forEach(function(t){return t.destroy()}),this.hudIndicators.destroy()}},{key:"resetSettings",value:function(){this.screenSide="auto",this.forceOpenDetailWindow=!1}},{key:"allWindows",get:function(){return[].concat(wx(Object.values(this.windows)),wx(this.playerInfo.windows))}},{key:"setWindowVisibility",value:function(e){this.allWindows.forEach(function(t){e?t.setVisible():t.setInvisible()})}},{key:"hide",value:function(){this._visible=!1,this.setWindowVisibility(!1),this.hudIndicators.hide()}},{key:"show",value:function(){this._visible=!0,this.setWindowVisibility(!0),this.hudIndicators.show()}},{key:"retriggerWindowVisibility",value:function(){this.setWindowVisibility(this._visible)}},{key:"update",value:function(){var n=this,t=zI.display.standardLength,e=this.windows.terrainInfo.showOnLeftSide?-3:2,r=this.camera.transform.worldRect(),r=Math.floor(r.center.x/t)+e,t=this.gamepad.button.rightTrigger.down,e=this.gamepad.button.leftTrigger.down,r=this.cursor.boardLocation.x>r,i="auto"===this.screenSide?r:"left"===this.screenSide;this.allWindows.forEach(function(t){t.showOnLeftSide=i}),this.windows.detailedInfo.show=t||this.forceOpenDetailWindow,this.commandersSlider.increment(e?1:-1),this.playerInfo.windows.forEach(function(t,e){t.show=n.commandersSlider.output>=[0,.1,.45,1][e]}),this.pushHudIndicators()}},{key:"inspectListenerCallback",value:function(){var t=this;zI.workOrders.send(function(){if(t.windows.terrainInfo.refreshable)return t.inspectTile(t.map.squareAt(t.cursor.boardLocation)),!0},this)}},{key:"inspectTile",value:function(t,e){var n=t.unitVisible()?t.unit:void 0,n=e||n;this.windows.terrainInfo.inspectTerrain(t.terrain,n,t.attackFlag),this.windows.unitInfo.inspectUnit(n),this.windows.detailedInfo.inspectTile(t.terrain,n),this.retriggerWindowVisibility()}},{key:"inspectPlayers",value:function(){this.playerInfo.windows.forEach(function(t){t.inspectKnownPlayer()})}},{key:"updatePlayerWindowOrder",value:function(){var e=this,t=this.players.all.findIndex(function(t){return t===e.players.current});this.playerInfo.windows=[].concat(wx(this.playerInfo.idealOrder.slice(t)),wx(this.playerInfo.idealOrder.slice(0,t))),this.playerInfo.windows.forEach(function(t,e){t.displayContainer.y=0===e?1:33+30*(e-1)})}},{key:"setDayCounter",value:function(t){this.hudIndicators.dayCounter.count=t}},{key:"skipAnimations",value:function(){this.update(),this.inspectTile(this.map.squareAt(this.cursor.boardLocation)),this.allWindows.forEach(function(t){return t.positionWindow({skip:!0})}),this.pushHudIndicators()}},{key:"pushHudIndicators",value:function(){var t=this.windows.terrainInfo.displayContainer,t=this.windows.terrainInfo.onLeftSide?t.x+t.width+2:2;this.hudIndicators.container.position.set(t,1)}}])&&Ex(t.prototype,e),n&&Ex(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function Ax(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Cx(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ix=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Cx(this,"transform",new g2),Cx(this,"_started",!1),Cx(this,"tileSize",zI.display.standardLength),Cx(this,"startPoint",new Tm(0,0)),Cx(this,"curPoint",new Tm(0,0)),Cx(this,"nextMove",new Tm(0,0)),Cx(this,"directions",void 0),Cx(this,"directionIndex",0),Cx(this,"moveSlider",new Qg({granularity:1/6})),Cx(this,"car",new T.Container),Cx(this,"sprite",void 0),Cx(this,"leftFacing",!1),Cx(this,"movementSpriteSet",void 0),this.directions=[],this.movementSpriteSet={up:[],down:[],left:[]};var t=zI.scene.resources.UnitSpritesheet.spritesheet.animations["infantry/rubinelle/red/left"];this.sprite=new T.AnimatedSprite(t),this.car.addChild(this.sprite),Fv("ui").addChild(this.car),this.transform.object=this.car,this.transform.zIndex=11,this.hide()}var t,n,r;return t=e,(n=[{key:"started",get:function(){return this._started}},{key:"destroy",value:function(){this.stop(),this.car.destroy({children:!0})}},{key:"hide",value:function(){this.car.visible=!1}},{key:"show",value:function(){this.car.visible=!0}},{key:"buildNewAnimation",value:function(t,e){this.startPoint=e||t.boardLocation,this.directions=[],this.leftFacing=t.reverseFacing,this.movementSpriteSet=t.movementAnimations,this.sprite.textures=this.movementSpriteSet.left;t=t.soldierUnit?6.25:4;this.sprite.animationSpeed=1/t,this.reset()}},{key:"finished",get:function(){return this.directionIndex>=this.directions.length}},{key:"reset",value:function(){this.curPoint=this.startPoint,this.directionIndex=-1,this.prepareNextInstruction(),this.setFacing(this.leftFacing?w9.West:w9.East),this.updateWorldPosition(),this.stop()}},{key:"start",value:function(){this._started||(this.show(),this._started=!0,this.directionIndex--,this.prepareNextInstruction(),zI.scene.ticker.add(this.update,this))}},{key:"stop",value:function(){this._started=!1,zI.scene.ticker.remove(this.update,this)}},{key:"skip",value:function(){for(;!this.finished;)this.curPoint=this.curPoint.add(this.nextMove),this.prepareNextInstruction();this.updateWorldPosition()}},{key:"update",value:function(){this.finished||(this.moveSlider.increment(),this.moveSlider.track==this.moveSlider.max&&(this.moveSlider.track=this.moveSlider.min,this.curPoint=this.curPoint.add(this.nextMove),this.prepareNextInstruction()),this.updateWorldPosition())}},{key:"updateWorldPosition",value:function(){this.transform.x=(this.curPoint.x+this.nextMove.x*this.moveSlider.output)*this.tileSize,this.transform.y=(this.curPoint.y+this.nextMove.y*this.moveSlider.output)*this.tileSize}},{key:"prepareNextInstruction",value:function(){var t,e;this.directionIndex++,this.finished?this.nextMove=new Tm:(t=this.directions[this.directionIndex],e=0!=this.directionIndex?this.directions[this.directionIndex-1]:-1,this.nextMove=O9(t),0!=this.directionIndex&&t==e||this.setFacing(t))}},{key:"setFacing",value:function(t){switch(this.sprite.scale.x=1,this.sprite.x=0,t){case w9.North:this.sprite.textures=this.movementSpriteSet.up;break;case w9.South:this.sprite.textures=this.movementSpriteSet.down;break;case w9.East:this.sprite.textures=this.movementSpriteSet.left,this.sprite.scale.x=-1,this.sprite.x=this.tileSize;break;case w9.West:this.sprite.textures=this.movementSpriteSet.left}this.sprite.play()}}])&&Ax(t.prototype,n),r&&Ax(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Mx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jx(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Dx=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),jx(this,"active",void 0),jx(this,"assets",void 0),this.assets=t,this.active=this.defaultEnabled()}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){this.assets=void 0}},{key:"update",value:function(){this.active&&this.updateScript()}},{key:"enable",value:function(){this.active||(this.enableScript(),this.active=!0)}},{key:"disable",value:function(){this.active&&(this.disableScript(),this.active=!1)}}])&&Mx(t.prototype,n),r&&Mx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Lx(t){return(Lx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Fx(t,e){return(Fx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Bx(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=Gx(n);return function(t,e){{if(e&&("object"===Lx(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return Ux(t)}(this,r?(t=Gx(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function Ux(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gx(t){return(Gx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xx(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Hx=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fx(t,e)}(o,Dx);var t,e,n,i=Bx(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Xx(Ux(t=i.call.apply(i,[this].concat(n))),"zoomOutTiles",[0,10,24]),Xx(Ux(t),"zoomSlider",new Qg({max:t.zoomOutTiles.length,granularity:1,looping:!0})),t}return t=o,(e=[{key:"defaultEnabled",value:function(){return!0}},{key:"enableScript",value:function(){}},{key:"updateScript",value:function(){var t,e=this.assets,n=e.gamepad,r=e.camera;n.button.Y.pressed&&(this.zoomSlider.increment(),t=this.zoomOutTiles[this.zoomSlider.output],e=zI.display.standardLength,n=zI.display.renderWidth,r.transform.zoomToPoint(n/(n+t*e),r.getFocalPoint()))}},{key:"disableScript",value:function(){}}])&&Nx(t.prototype,e),n&&Nx(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function zx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vx(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wx(){return{attack:10,defense:10,range:0,move:0,vision:0}}var Yx=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Vx(this,"type",void 0),Vx(this,"name",void 0),Vx(this,"allegiance",void 0),Vx(this,"nationality",void 0),Vx(this,"CoZone",void 0),Vx(this,"_illustration",void 0),Vx(this,"_eyeshot",void 0),Vx(this,"_insignia",void 0),Vx(this,"_insigniaSplash",void 0),Vx(this,"_insigniaIcon",void 0),Vx(this,"unitStatTable",{}),Vx(this,"CoPowerInEffect",!1)}var e,n,r;return e=t,(n=[{key:"serial",get:function(){return this.type.serial}},{key:"illustration",get:function(){return this._illustration}},{key:"eyeshot",get:function(){return this._eyeshot}},{key:"insignia",get:function(){return this._insignia}},{key:"insigniaSplash",get:function(){return this._insigniaSplash}},{key:"insigniaIcon",get:function(){return this._insigniaIcon}},{key:"init",value:function(){var t=zI.scene.resources.CoSpritesheet.spritesheet,e=zI.scene.resources.UISpritesheet.spritesheet,n=this.name.toLowerCase(),r=this.allegiance.toLowerCase().replace(" ","-");return this._illustration=new T.Sprite(t.textures["".concat(n,"-p").concat(0,"-full.png")]),this._eyeshot=new T.Sprite(t.textures["".concat(n,"-p").concat(0,"-eyes.png")]),this._insignia=new T.Sprite(e.textures["insignia-".concat(r,".png")]),this._insigniaSplash=e.textures["insignia-".concat(r,"-large.png")],this._insigniaIcon=e.textures["icon-team-red.png"],this}}])&&zx(e.prototype,n),r&&zx(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function qx(t){return(qx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kx(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qx(t,e,n){return e&&Zx(t.prototype,e),n&&Zx(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function $x(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jx(t,e)}function Jx(t,e){return(Jx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function tw(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=nw(n);return function(t,e){{if(e&&("object"===qx(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return ew(t)}(this,r?(t=nw(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function ew(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nw(t){return(nw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rw(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Vx(Yx,"serial",-1);var iw,ow=hg(-1);function aw(t){return(aw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sw(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function uw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cw(n){var r=pw();return function(){var t,e=yw(n);return function(t,e){{if(e&&("object"===aw(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return lw(t)}(this,r?(t=yw(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function lw(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hw(t){var n="function"==typeof Map?new Map:void 0;return function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return fw(t,arguments,yw(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),dw(e,t)}(t)}function fw(t,e,n){return(fw=pw()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);r=new(Function.bind.apply(t,r));return n&&dw(r,n.prototype),r}).apply(null,arguments)}function pw(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function dw(t,e){return(dw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function yw(t){return(yw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mw(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}!function(t){var e=function(){$x(o,Yx);var i=tw(o);function o(){var t;Kx(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rw(ew(t=i.call.apply(i,[this].concat(n))),"type",o),rw(ew(t),"name","Void"),rw(ew(t),"allegiance","None"),rw(ew(t),"nationality","rubinelle"),rw(ew(t),"CoZone",0),t}return Qx(o,[{key:"getBonusStats",value:Wx}]),o}();rw(e,"serial",ow.next().value),t.Void=e;e=function(){$x(o,Yx);var i=tw(o);function o(){var t;Kx(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rw(ew(t=i.call.apply(i,[this].concat(n))),"type",o),rw(ew(t),"name","None"),rw(ew(t),"allegiance","None"),rw(ew(t),"nationality","rubinelle"),rw(ew(t),"CoZone",0),t}return Qx(o,[{key:"getBonusStats",value:function(t){return Wx()}}]),o}();rw(e,"serial",ow.next().value),t.None=e;e=function(){$x(o,Yx);var i=tw(o);function o(){var t;Kx(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rw(ew(t=i.call.apply(i,[this].concat(n))),"type",o),rw(ew(t),"name","Will"),rw(ew(t),"allegiance","13th Battalion"),rw(ew(t),"nationality","rubinelle"),rw(ew(t),"CoZone",2),t}return Qx(o,[{key:"getBonusStats",value:function(t){var e=Wx();return t.isDirectOnly&&t.unitClass===_v.Ground&&(e.attack+=20,this.CoPowerInEffect&&(e.move+=2)),e}}]),o}();rw(e,"serial",ow.next().value),t.Will=e;e=function(){$x(o,Yx);var i=tw(o);function o(){var t;Kx(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rw(ew(t=i.call.apply(i,[this].concat(n))),"type",o),rw(ew(t),"name","Brenner"),rw(ew(t),"allegiance","13th Battalion"),rw(ew(t),"nationality","rubinelle"),rw(ew(t),"CoZone",3),t}return Qx(o,[{key:"getBonusStats",value:function(t){var e=Wx();return e.defense+=20,e}}]),o}();rw(e,"serial",ow.next().value),t.Brenner=e;e=function(){$x(o,Yx);var i=tw(o);function o(){var t;Kx(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rw(ew(t=i.call.apply(i,[this].concat(n))),"type",o),rw(ew(t),"name","Lin"),rw(ew(t),"allegiance","13th Battalion"),rw(ew(t),"nationality","rubinelle"),rw(ew(t),"CoZone",1),t}return Qx(o,[{key:"getBonusStats",value:function(t){var e=Wx();return t.unitClass===_v.Ground&&(e.attack+=20,e.defense+=20),e}}]),o}();rw(e,"serial",ow.next().value),t.Lin=e;e=function(){$x(o,Yx);var i=tw(o);function o(){var t;Kx(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rw(ew(t=i.call.apply(i,[this].concat(n))),"type",o),rw(ew(t),"name","Isabella"),rw(ew(t),"allegiance","13th Battalion"),rw(ew(t),"nationality","rubinelle"),rw(ew(t),"CoZone",2),t}return Qx(o,[{key:"getBonusStats",value:function(t){var e=Wx();return e.attack+=10,e.defense+=10,e}}]),o}();rw(e,"serial",ow.next().value),t.Isabella=e}(iw=iw||{});var vw=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dw(t,e)}(o,hw(Error));var i=cw(o);function o(){var t;uw(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return mw(lw(t=i.call.apply(i,[this].concat(n))),"name","UnitConstructionError"),t}return o}(),gw=l1.freezeObject({HP:P9.Generate(7,0),ammo:P9.Generate(4),capture:P9.Generate(5),gas:P9.Generate(7),rank:P9.Generate(2),orderable:P9.Generate(1),CoOnBoard:P9.Generate(1),type:P9.Generate(6,0),faction:P9.Generate(3),xCoord:P9.Generate(8),yCoord:P9.Generate(8),reverseFacing:P9.Generate(1)}),bw=function(){function r(){uw(this,r),mw(this,"_sprite",void 0),mw(this,"uiBox",void 0),mw(this,"hpMeter",void 0),mw(this,"previewHpMeter",void 0),mw(this,"statusIcons",void 0),mw(this,"previewStatusIcons",void 0),mw(this,"statusTextures",[]),mw(this,"transparent",!1),mw(this,"transparencySlider",new Qg({max:.7,granularity:.35})),mw(this,"boardPlayer",void 0),mw(this,"conditionInfo",0),mw(this,"stateInfo",0),mw(this,"_CoCouldBoard",!1),mw(this,"_hiding",!1),mw(this,"_cargo",[]),this.x=-1,this.y=-1}var t,e,n;return t=r,(e=[{key:"serial",get:function(){return this.type.serial}},{key:"sprite",get:function(){return this._sprite}},{key:"preview",get:function(){return this.shopPreview(this.faction)}},{key:"cargoPreview",get:function(){var t=this.preview;return t.addChild(this.previewStatusIcons,this.previewHpMeter),t}},{key:"shopPreview",value:function(t,e){var n=this.name.replace(" ","").replace("-","").toLowerCase(),r=Ev[t],t=["rubinelle","lazurian"][t%2],r=this.type==Rw.Infantry||this.type==Rw.Mech||this.type==Rw.Bike?new T.Sprite(Cw.sheet.textures["".concat(n,"/").concat(t,"/").concat(r,"/idle-1.png")]):new T.Sprite(Cw.sheet.textures["".concat(n,"/").concat(r,"/idle-1.png")]);!this.reverseFacing&&e!==Ov.Left||(r.anchor.x=1,r.scale.x=-1);e=new T.Container;return e.addChild(r),e}},{key:"illustration",get:function(){var t=Cw.illustrationSheet,e=this.name.replace(" ","").replace("-","").toLowerCase(),n=this.boardPlayer.officer.nationality,r=Ev[this.boardPlayer.faction],e=new T.Sprite(t.textures["".concat(n,"-").concat(r,"-").concat(e,".png")]);return e.scale.x=this.reverseFacing?1:-1,e.x=this.reverseFacing?0:e.width,e}},{key:"getMinimapIcon",value:function(){var t=zI.scene.texturesFrom("UISpritesheet")["MiniMap/unit-".concat(Ev[this.faction],".png")],t=new T.AnimatedSprite([t,T.Texture.EMPTY]);return t.animationSpeed=.025,t.play(),t}},{key:"movementAnimations",get:function(){var t=this.name.replace(" ","").replace("-","").toLowerCase(),e=Ev[this.faction],n=["rubinelle","lazurian"][this.faction%2],r=this.soldierUnit||this.type==Rw.Bike?function(t,e,n,r){return Cw.sheet.animations["".concat(t,"/").concat(e,"/").concat(n,"/").concat(r)]}:function(t,e,n,r){return Cw.sheet.animations["".concat(t,"/").concat(n,"/").concat(r)]||[T.Texture.EMPTY]},e={up:r(t,n,e,"up"),down:r(t,n,e,"down"),left:r(t,n,e,"left")};return Boolean(e.up)&&Boolean(e.down)&&Boolean(e.left)||O1.ping("Generated set of movement textures is not complete or does not exist. [Up:".concat(Boolean(e.up),", Down:").concat(Boolean(e.down),", Left:").concat(Boolean(e.left),"]")),e}},{key:"adjustedCost",get:function(){return Math.ceil(this.cost*this.hp/G2)}},{key:"vision",get:function(){return 2}},{key:"appliedVision",value:function(t){var e=this.soldierUnit,t=t.terrain.type===Tg.Mountain,e=e&&t?3:0,t=this.boardPlayer.officer.getBonusStats(this).vision;return this.vision+e+t}},{key:"range",get:function(){return{min:1,max:1}}},{key:"rangeMap",get:function(){return 0<this.ammo||""!=this.weapon.secondary.name?Z9(this.range):Z9({min:-1,max:-1})}},{key:"soldierUnit",get:function(){return!1}},{key:"materialsInsteadOfAmmo",get:function(){return!1}},{key:"canMoveAndAttack",get:function(){return!0}},{key:"canResupply",get:function(){return!1}},{key:"ammoCanBeResupplied",get:function(){return!0}},{key:"canResupplyHeldUnits",get:function(){return this.canResupply}},{key:"canHide",get:function(){return!1}},{key:"destroyOnGasEmpty",get:function(){return[_v.Air,_v.Naval].includes(this.unitClass)}},{key:"init",value:function(t){var e=zI.loader.resources.UnitSpritesheet.spritesheet;if(this.boardPlayer=t.boardPlayer,[xv.None,xv.Neutral].includes(t.faction))throw new vw("Cannot ally deployed unit with faction ".concat(Ev[t.faction]));this.faction=t.faction;var n=this.name.replace(" ","").replace("-","").toLowerCase(),r=Ev[this.faction],t=["rubinelle","lazurian"][this.faction%2];return this.type==Rw.Infantry||this.type==Rw.Mech||this.type==Rw.Bike?this._sprite=new T.AnimatedSprite(e.animations["".concat(n,"/").concat(t,"/").concat(r,"/idle")]):this._sprite=new T.AnimatedSprite(e.animations["".concat(n,"/").concat(r,"/idle")]),this.reverseFacing=this.boardPlayer.armyFacing===Ov.Left,this.uiBox=new T.Container,this.hpMeter=new T.BitmapText("",Xg.smallScriptOutlined),this.hpMeter.anchor.set(1),this.hpMeter.x=15,this.hpMeter.y=18,this.uiBox.addChild(this.hpMeter),this.previewHpMeter=new T.BitmapText("",Xg.smallScriptOutlined),this.previewHpMeter.anchor.set(1),this.previewHpMeter.x=15,this.previewHpMeter.y=18,this.statusIcons=new T.Sprite,this.statusIcons.y=8,this.uiBox.addChild(this.statusIcons),this.previewStatusIcons=new T.Sprite,this.previewStatusIcons.y=8,Fv("ui").addChild(this.uiBox),this.stateInfo=P9.WriteBits(this.stateInfo,this.serial,gw.type),this.hp=100,this.ammo=this.maxAmmo,this.gas=this.maxGas,zI.scene.ticker.add(this.update,this),this}},{key:"load",value:function(t,e){this.stateInfo=t,this.conditionInfo=e}},{key:"destroy",value:function(){O1.log("TroopObject","Destroy",{message:"Destroyed ".concat(this.name," at ").concat(this.boardLocation.toString())}),this._cargo.forEach(function(t){return t.destroy()}),this.boardPlayer.unspawnUnit(this),this.boardPlayer=void 0,this.sprite.destroy({children:!0}),this.uiBox.destroy({children:!0}),zI.scene.ticker.remove(this.update,this)}},{key:"faction",get:function(){return P9.ReadBits(this.stateInfo,gw.faction)},set:function(t){this.stateInfo=P9.WriteBits(this.stateInfo,t,gw.faction)}},{key:"hp",get:function(){return P9.ReadBits(this.conditionInfo,gw.HP)},set:function(t){t=l1.clamp(t,0,G2),this.conditionInfo=P9.WriteBits(this.conditionInfo,t,gw.HP),this.hp<=90?(this.hpMeter.text=this.displayHP.toString(),this.previewHpMeter.text=this.displayHP.toString()):(this.hpMeter.text="",this.previewHpMeter.text="")}},{key:"repairable",get:function(){return this.hp<G2}},{key:"displayHP",get:function(){return Math.ceil(.1*this.hp)}},{key:"ammo",get:function(){return P9.ReadBits(this.conditionInfo,gw.ammo)},set:function(t){t=l1.clamp(t,0,this.maxAmmo),this.conditionInfo=P9.WriteBits(this.conditionInfo,t,gw.ammo),this.rebuildStatusIcons()}},{key:"lowAmmo",get:function(){if(0==this.maxAmmo)return!1;var t=.5*this.maxAmmo;return this.ammo<=t}},{key:"attackReady",get:function(){var t=""!=this.weapon.primary.name,e=""!=this.weapon.secondary.name,n=0<this.ammo&&!this.materialsInsteadOfAmmo;return t&&n||e}},{key:"movementPoints",get:function(){return this.gas<this.maxMovementPoints?this.gas:this.maxMovementPoints}},{key:"isDirect",get:function(){return l1.within(1,this.range.min,this.range.max)}},{key:"isDirectOnly",get:function(){return 1===this.range.max}},{key:"isIndirect",get:function(){return 1<this.range.max}},{key:"capture",get:function(){return P9.ReadBits(this.conditionInfo,gw.capture)},set:function(t){t=l1.clamp(t,0,X2),this.conditionInfo=P9.WriteBits(this.conditionInfo,t,gw.capture),this.rebuildStatusIcons()}},{key:"capturing",get:function(){return 0<this.capture}},{key:"gas",get:function(){return P9.ReadBits(this.conditionInfo,gw.gas)},set:function(t){t=l1.clamp(t,0,this.maxGas),this.conditionInfo=P9.WriteBits(this.conditionInfo,t,gw.gas),this.rebuildStatusIcons()}},{key:"lowGas",get:function(){var t=this.maxGas/2;return this.gas<=t}},{key:"rank",get:function(){return this.CoOnBoard?H2:P9.ReadBits(this.conditionInfo,gw.rank)},set:function(t){t=l1.clamp(t,0,H2),this.conditionInfo=P9.WriteBits(this.conditionInfo,t,gw.rank),this.rebuildStatusIcons()}},{key:"orderable",get:function(){return P9.GetBoolean(this.conditionInfo,gw.orderable)},set:function(t){this.conditionInfo=P9.WriteBits(this.conditionInfo,~~t,gw.orderable)}},{key:"CoOnBoard",get:function(){return P9.GetBoolean(this.conditionInfo,gw.CoOnBoard)},set:function(t){this.conditionInfo=P9.WriteBits(this.conditionInfo,~~t,gw.CoOnBoard),this.rebuildStatusIcons()}},{key:"CoCouldBoard",get:function(){return this._CoCouldBoard},set:function(t){this._CoCouldBoard=t,this.rebuildStatusIcons()}},{key:"CoUnitIsCargo",get:function(){return 0!==this._cargo.length&&this._cargo.some(function(t){return t.CoOnBoard||t.CoUnitIsCargo})}},{key:"nonCoUnitIsCargo",get:function(){return 0!==this._cargo.length&&this._cargo.some(function(t){return!t.CoOnBoard})}},{key:"withinCoZone",get:function(){return this.boardPlayer.withinCoRange(this.boardLocation)}},{key:"spent",get:function(){return!this.orderable&&this.sprite.tint===r.TintShade},set:function(e){this.sprite.tint=e?r.TintShade:16777215,this.uiBox.children.forEach(function(t){t.tint&&(t.tint=e?r.TintShade:16777215)}),e&&(this.orderable=!1)}},{key:"visible",get:function(){return this.sprite.visible},set:function(t){this.sprite.visible=t,this.uiBox.visible=t}},{key:"hiding",get:function(){return this._hiding},set:function(t){this._hiding=t,this.rebuildStatusIcons()}},{key:"visibleToPlayer",value:function(e,t){var n=t&&t.orthogonals.some(function(t){return(null===(t=t.unit)||void 0===t?void 0:t.faction)===e.faction}),t=this.faction===e.faction;return!this.hiding||n||t}},{key:"statusApplied",get:function(){return 0<this.statusTextures.length}},{key:"x",get:function(){return P9.ReadBits(this.stateInfo,gw.xCoord)},set:function(t){this.stateInfo=P9.WriteBits(this.stateInfo,t,gw.xCoord)}},{key:"y",get:function(){return P9.ReadBits(this.stateInfo,gw.yCoord)},set:function(t){this.stateInfo=P9.WriteBits(this.stateInfo,t,gw.yCoord)}},{key:"boardLocation",get:function(){return new Tm(this.x,this.y)},set:function(t){t.notEqual(this.boardLocation)&&this.stopCapturing(),this.x=t.x,this.y=t.y,r.transform.x=this.x*zI.display.standardLength,r.transform.y=this.y*zI.display.standardLength,r.transform.scale.x=1,r.transform.object=this.uiBox,r.transform.object=this.sprite,this.reverseFacing&&(r.transform.scale.x=-1,r.transform.x+=16),r.transform.object=null,this.uiBox.zIndex=-1}},{key:"onMap",get:function(){return this.boardLocation.notEqual(new Tm(255,255))}},{key:"reverseFacing",get:function(){return P9.GetBoolean(this.stateInfo,gw.reverseFacing)},set:function(t){this.stateInfo=P9.WriteBits(this.stateInfo,~~t,gw.reverseFacing)}},{key:"update",value:function(){this.setCurrentAnimationFrame(),this.setCurrentStatusIcon(),this.setTransparencySlider()}},{key:"setCurrentAnimationFrame",value:function(){var t=Math.floor(zI.frameCount/12)%this.sprite.totalFrames;this.sprite.texture=this.sprite.textures[t]}},{key:"rebuildStatusIcons",value:function(){var e=zI.scene.resources.UISpritesheet.spritesheet,t=Ev[this.faction],n=[{name:"icon-co-badge.png",condition:this.CoOnBoard},{name:"icon-co-badge-faded.png",condition:this.CoCouldBoard,blink:!1},{name:"icon-co-badge-folded.png",condition:this.CoUnitIsCargo},{name:"icon-level-".concat(this.rank,".png"),condition:0<this.rank&&!this.CoOnBoard},{name:"icon-low-gas-".concat(t,".png"),condition:this.lowGas},{name:"icon-low-ammo-".concat(t,".png"),condition:this.lowAmmo&&!this.materialsInsteadOfAmmo},{name:"icon-low-material-".concat(t,".png"),condition:this.lowAmmo&&this.materialsInsteadOfAmmo},{name:"icon-capturing-".concat(t,".png"),condition:this.capturing},{name:"icon-boarded-".concat(t,".png"),condition:0<this._cargo.length&&!this.CoUnitIsCargo},{name:"icon-hidden-".concat(t,".png"),condition:this.hiding}].filter(function(t){return t.condition}),t=n.map(function(t){return e.textures[t.name]});1===n.length&&n[0].blink&&t.push(T.Texture.EMPTY),this.statusTextures=t,this.setCurrentStatusIcon()}},{key:"setCurrentStatusIcon",value:function(){var t=Math.floor(zI.frameCount/50)%this.statusTextures.length;0<this.statusTextures.length?(t=this.statusTextures[t],this.statusIcons.texture=t,this.previewStatusIcons.texture=t):(this.statusIcons.texture=null,this.previewStatusIcons.texture=null)}},{key:"setTransparencySlider",value:function(){var t=this.transparent?1:-1;this.transparencySlider.increment(t),this.sprite.alpha=1-this.transparencySlider.output,this.uiBox.alpha=1-1.15*this.transparencySlider.output}},{key:"captureBuilding",value:function(){var t=Math.ceil(.1*this.hp);this.capture+=t,this.capture=l1.confine(this.capture,0,X2)}},{key:"buildingCaptured",value:function(){return this.capture==X2}},{key:"stopCapturing",value:function(){this.capture=0}},{key:"resuppliable",value:function(t){var e=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{strict:!0}).strict,n=this.gas<this.maxGas,r=this.ammo<this.maxAmmo&&this.ammoCanBeResupplied,i=!0===(null==t?void 0:t.canResupply),o=(null==t?void 0:t.faction)===this.faction;return(n||r||!e)&&(!t||i&&o&&t!==this)}},{key:"resupply",value:function(){this.gas=this.maxGas,this.ammoCanBeResupplied&&(this.ammo=this.maxAmmo)}},{key:"resupplyHeldUnits",value:function(){if(this.canResupplyHeldUnits){var t=this._cargo.some(function(t){return t.resuppliable()});return this._cargo.forEach(function(t){return t.resupply()}),t}return!1}},{key:"expendMaintainanceGas",value:function(){this.unitClass===_v.Air||this.type===Rw.Submarine&&this.hiding?this.gas-=5:this.unitClass===_v.Naval&&(this.gas-=2)}},{key:"mergeable",value:function(t){var e=this.type===t.type,n=this.faction===t.faction,r=this.repairable||t.repairable,i=0===this.cargo.length&&0===t.cargo.length;return this!==t&&e&&n&&r&&i}},{key:"boardable",value:function(t){return!1}},{key:"unloadPosition",value:function(t){return!1}},{key:"getIdealAttackHeuristic",value:function(t){var e=this.getAttackHeuristic(this.weapon.primary,t),t=this.getAttackHeuristic(this.weapon.secondary,t);return Math.max(e,t)}},{key:"getAttackHeuristic",value:function(e,n){try{return e.targetMap[n]}catch(t){return O1.print("UnitObject.getAttackHeuristic()  ","Armor Type: ",n,"Attack: ",e,t),0}}},{key:"getAttackBaseDamage",value:function(e,n){try{return e.damageMap[n]}catch(t){return O1.print("UnitObject.getAttackBaseDamage()  ","Attack: ",e,"Unit Serial: ",n,t),0}}},{key:"attackMethodFor",value:function(t){var e=2,n=2;return t instanceof r&&(e=this.getAttackHeuristic(this.weapon.primary,t.armorType),n=this.getAttackHeuristic(this.weapon.secondary,t.armorType)),0<e&&0<this.ammo?bv.Primary:0<n?bv.Secondary:bv.None}},{key:"canTarget",value:function(t){var e=t instanceof r?t:void 0,n=t instanceof tg?t:void 0,t=this.attackMethodFor(t)!==bv.None,e=Boolean(e&&this.faction!==e.faction),n=Boolean(n&&n.damageable);return t&&(e||n)}},{key:"canCounterAttack",value:function(t,e){var n=this.canTarget(t),t=1==this.range.min,e=new Tm(this.boardLocation).manhattanDistance(e);return n&&t&&1==e}},{key:"canTargetArmor",value:function(t){var e=this.getAttackHeuristic(this.weapon.primary,t),t=this.getAttackHeuristic(this.weapon.secondary,t);return 0<e&&0<this.ammo||0<t}},{key:"baseDamage",value:function(t){var e=this.getAttackBaseDamage(this.weapon.primary,t.serial),t=this.getAttackBaseDamage(this.weapon.secondary,t.serial);return 0<e&&0<this.ammo?e:t}},{key:"cargo",get:function(){return this._cargo.slice()}},{key:"loadUnit",value:function(t){this._cargo.push(t),this.rebuildStatusIcons()}},{key:"unloadUnit",value:function(n){if(!l1.within(n,0,this._cargo.length-1))throw new Error("Can't unload unit at index ".concat(n));var t=this._cargo[n];return this._cargo=this._cargo.filter(function(t,e){return e!==n}),this.rebuildStatusIcons(),t}}])&&sw(t.prototype,e),n&&sw(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function _w(t){return(_w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ww(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Tw(t,e,n){return e&&ww(t.prototype,e),n&&ww(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ow(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sw(t,e)}function Sw(t,e){return(Sw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ew(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=Pw(n);return function(t,e){{if(e&&("object"===_w(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=Pw(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function Pw(t){return(Pw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kw(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mw(bw,"transform",new g2),mw(bw,"TintShade",8947848),mw(bw,"serial",-1);var Rw,Aw=hg(),Cw={spritesheet:"UnitSpritesheet",illustrationSpritesheet:"UnitIllustrationSpritesheet",get sheet(){return zI.scene.resources[Cw.spritesheet].spritesheet},get illustrationSheet(){return zI.scene.resources[Cw.illustrationSpritesheet].spritesheet}};function Iw(t){return(Iw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mw(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dw(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gw(t,e)}function Lw(n){var r=Uw();return function(){var t,e=Xw(n);return function(t,e){{if(e&&("object"===Iw(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return Nw(t)}(this,r?(t=Xw(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function Nw(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fw(t){var n="function"==typeof Map?new Map:void 0;return(Fw=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return Bw(t,arguments,Xw(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Gw(e,t)})(t)}function Bw(t,e,n){return(Bw=Uw()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);r=new(Function.bind.apply(t,r));return n&&Gw(r,n.prototype),r}).apply(null,arguments)}function Uw(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Gw(t,e){return(Gw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Xw(t){return(Xw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hw(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}!function(t){var e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Infantry"}},{key:"shortName",get:function(){return"Inftry"}},{key:"description",get:function(){return"The cheapest unit. They can /capture/ bases. /+3 to vision when/ on mountains."}},{key:"cost",get:function(){return 1500}},{key:"maxGas",get:function(){return 99}},{key:"maxAmmo",get:function(){return 0}},{key:"maxMovementPoints",get:function(){return 3}},{key:"vision",get:function(){return 2}},{key:"soldierUnit",get:function(){return!0}},{key:"unitClass",get:function(){return _v.Ground}},{key:"moveType",get:function(){return vv.Infantry}},{key:"armorType",get:function(){return gv.Infantry}},{key:"weapon",get:function(){return{primary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},secondary:{name:"Machine Gun",targetMap:[2,1,0,1,0,0],damageMap:[55,45,45,12,10,3,5,5,1,10,30,20,20,14,0,0,0,0,0,8,30,0,0,0,0,0,0,0,1]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Infantry=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Mech"}},{key:"shortName",get:function(){return"Mech"}},{key:"description",get:function(){return"High attack power. They can /capture/ bases. /+3 to vision when/ on mountains."}},{key:"cost",get:function(){return 2500}},{key:"maxGas",get:function(){return 70}},{key:"maxAmmo",get:function(){return 3}},{key:"maxMovementPoints",get:function(){return 2}},{key:"vision",get:function(){return 2}},{key:"soldierUnit",get:function(){return!0}},{key:"unitClass",get:function(){return _v.Ground}},{key:"moveType",get:function(){return vv.Mech}},{key:"armorType",get:function(){return gv.Infantry}},{key:"weapon",get:function(){return{primary:{name:"Bazooka",targetMap:[0,2,0,0,0,0],damageMap:[0,0,0,85,80,55,55,25,15,70,55,85,85,75,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15]},secondary:{name:"Machine Gun",targetMap:[2,1,0,1,0,0],damageMap:[65,55,55,18,15,5,8,5,1,15,35,35,35,20,0,0,0,0,0,12,35,0,0,0,0,0,0,0,2]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Mech=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Bike"}},{key:"shortName",get:function(){return"Bike"}},{key:"description",get:function(){return"An infantry unit with high mobility. They can /capture/ bases."}},{key:"cost",get:function(){return 2500}},{key:"maxGas",get:function(){return 70}},{key:"maxAmmo",get:function(){return 0}},{key:"maxMovementPoints",get:function(){return 5}},{key:"vision",get:function(){return 2}},{key:"soldierUnit",get:function(){return!0}},{key:"unitClass",get:function(){return _v.Ground}},{key:"moveType",get:function(){return vv.TireA}},{key:"armorType",get:function(){return gv.Infantry}},{key:"weapon",get:function(){return{primary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},secondary:{name:"Machine Gun",targetMap:[2,1,0,1,0,0],damageMap:[65,55,55,18,15,5,8,5,1,15,35,35,35,20,0,0,0,0,0,12,35,0,0,0,0,0,0,0,2]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Bike=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Recon"}},{key:"shortName",get:function(){return"Recon"}},{key:"description",get:function(){return"Good movement and vision. They are strong against infantry."}},{key:"cost",get:function(){return 4e3}},{key:"maxGas",get:function(){return 80}},{key:"maxAmmo",get:function(){return 0}},{key:"maxMovementPoints",get:function(){return 8}},{key:"vision",get:function(){return 5}},{key:"unitClass",get:function(){return _v.Ground}},{key:"moveType",get:function(){return vv.TireA}},{key:"armorType",get:function(){return gv.Vehicle}},{key:"weapon",get:function(){return{primary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},secondary:{name:"Machine Gun",targetMap:[2,1,0,1,0,0],damageMap:[75,65,65,35,30,8,8,5,1,45,25,55,55,45,0,0,0,0,0,18,35,0,0,0,0,0,0,0,3]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Recon=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Flare"}},{key:"shortName",get:function(){return"Flare"}},{key:"description",get:function(){return"Flares fire bright /rockets/ that reveal a /13-square area/ in Fog of War."}},{key:"cost",get:function(){return 5e3}},{key:"maxGas",get:function(){return 60}},{key:"maxAmmo",get:function(){return 3}},{key:"maxMovementPoints",get:function(){return 5}},{key:"vision",get:function(){return 2}},{key:"materialsInsteadOfAmmo",get:function(){return!0}},{key:"unitClass",get:function(){return _v.Ground}},{key:"moveType",get:function(){return vv.Tread}},{key:"armorType",get:function(){return gv.Vehicle}},{key:"weapon",get:function(){return{primary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},secondary:{name:"Machine Gun",targetMap:[2,1,0,1,0,0],damageMap:[80,70,70,60,50,45,10,5,1,45,25,55,55,45,0,0,0,0,0,18,35,0,0,0,0,0,0,0,5]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Flare=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Anti-Air"}},{key:"shortName",get:function(){return"Anti-Air"}},{key:"description",get:function(){return"A specialized anti-air unit that can also attack ground forces."}},{key:"cost",get:function(){return 7e3}},{key:"maxGas",get:function(){return 60}},{key:"maxAmmo",get:function(){return 9}},{key:"maxMovementPoints",get:function(){return 6}},{key:"vision",get:function(){return 3}},{key:"unitClass",get:function(){return _v.Ground}},{key:"moveType",get:function(){return vv.Tread}},{key:"armorType",get:function(){return gv.Vehicle}},{key:"weapon",get:function(){return{primary:{name:"Vulcan Gun",targetMap:[2,1,2,2,0,0],damageMap:[105,105,105,60,50,45,15,10,5,50,25,55,55,50,70,70,70,75,75,105,120,120,0,0,0,0,0,0,10]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.AntiAir=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Tank"}},{key:"shortName",get:function(){return"Tank"}},{key:"description",get:function(){return"High movement and a low production cost make these units quite useful."}},{key:"cost",get:function(){return 7e3}},{key:"maxGas",get:function(){return 70}},{key:"maxAmmo",get:function(){return 6}},{key:"maxMovementPoints",get:function(){return 6}},{key:"vision",get:function(){return 3}},{key:"unitClass",get:function(){return _v.Ground}},{key:"moveType",get:function(){return vv.Tread}},{key:"armorType",get:function(){return gv.Vehicle}},{key:"weapon",get:function(){return{primary:{name:"Tank Gun",targetMap:[0,2,0,0,1,0],damageMap:[0,0,0,85,80,75,55,35,20,70,30,85,85,75,0,0,0,0,0,0,0,0,8,8,9,9,18,55,20]},secondary:{name:"Machine Gun",targetMap:[2,1,0,1,0,0],damageMap:[75,70,70,40,35,8,8,5,1,45,5,55,55,45,0,0,0,0,0,18,40,0,0,0,0,0,0,0,5]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Tank=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Md Tank"}},{key:"shortName",get:function(){return"M Tank"}},{key:"description",get:function(){return"A strong tank with better attack and defense than standard tanks."}},{key:"cost",get:function(){return 12e3}},{key:"maxGas",get:function(){return 50}},{key:"maxAmmo",get:function(){return 5}},{key:"maxMovementPoints",get:function(){return 5}},{key:"vision",get:function(){return 2}},{key:"unitClass",get:function(){return _v.Ground}},{key:"moveType",get:function(){return vv.Tread}},{key:"armorType",get:function(){return gv.Vehicle}},{key:"weapon",get:function(){return{primary:{name:"Hvy Tk Gun",targetMap:[0,2,0,0,1,0],damageMap:[0,0,0,95,90,90,70,55,35,85,35,90,90,90,0,0,0,0,0,0,0,0,10,10,12,12,22,55,35]},secondary:{name:"Machine Gun",targetMap:[2,1,0,1,0,0],damageMap:[90,80,80,40,35,8,8,5,1,45,5,60,60,45,0,0,0,0,0,24,40,0,0,0,0,0,0,0,5]}}}}]),e}();kw(e,"serial",Aw.next().value),t.MdTank=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"War Tank"}},{key:"shortName",get:function(){return"W Tank"}},{key:"description",get:function(){return"The strongest tank in terms of both attack and defense."}},{key:"cost",get:function(){return 16e3}},{key:"maxGas",get:function(){return 50}},{key:"maxAmmo",get:function(){return 5}},{key:"maxMovementPoints",get:function(){return 4}},{key:"vision",get:function(){return 2}},{key:"unitClass",get:function(){return _v.Ground}},{key:"moveType",get:function(){return vv.Tread}},{key:"armorType",get:function(){return gv.Vehicle}},{key:"weapon",get:function(){return{primary:{name:"Mega Gun",targetMap:[0,2,0,0,1,0],damageMap:[0,0,0,105,105,105,85,75,55,105,40,105,105,105,0,0,0,0,0,0,0,0,12,12,14,14,28,65,55]},secondary:{name:"Machine Gun",targetMap:[2,1,0,1,0,0],damageMap:[105,95,95,45,40,10,10,10,1,45,5,65,65,45,0,0,0,0,0,35,45,0,0,0,0,0,0,0,8]}}}}]),e}();kw(e,"serial",Aw.next().value),t.WarTank=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Artillery"}},{key:"shortName",get:function(){return"Artlry"}},{key:"description",get:function(){return"An indirect attacker. This unit can move or attack during a turn, but not both."}},{key:"cost",get:function(){return 6e3}},{key:"maxGas",get:function(){return 50}},{key:"maxAmmo",get:function(){return 6}},{key:"maxMovementPoints",get:function(){return 5}},{key:"vision",get:function(){return 3}},{key:"range",get:function(){return{min:2,max:3}}},{key:"canMoveAndAttack",get:function(){return!1}},{key:"unitClass",get:function(){return _v.Ground}},{key:"moveType",get:function(){return vv.Tread}},{key:"armorType",get:function(){return gv.Vehicle}},{key:"weapon",get:function(){return{primary:{name:"Cannon",targetMap:[2,2,0,0,1,0],damageMap:[90,85,85,80,75,65,60,45,35,75,55,80,80,70,0,0,0,0,0,0,0,0,45,45,55,55,65,100,45]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Artillery=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Anti-Tank"}},{key:"shortName",get:function(){return"Anti-Tk"}},{key:"description",get:function(){return"An indirect attacker that can /counter-attack/ when under direct fire."}},{key:"cost",get:function(){return 11e3}},{key:"maxGas",get:function(){return 50}},{key:"maxAmmo",get:function(){return 6}},{key:"maxMovementPoints",get:function(){return 4}},{key:"vision",get:function(){return 2}},{key:"range",get:function(){return{min:1,max:3}}},{key:"canMoveAndAttack",get:function(){return!1}},{key:"unitClass",get:function(){return _v.Ground}},{key:"moveType",get:function(){return vv.TireB}},{key:"armorType",get:function(){return gv.Vehicle}},{key:"weapon",get:function(){return{primary:{name:"Cannon",targetMap:[2,2,0,1,0,0],damageMap:[75,65,65,75,75,75,75,65,55,65,55,70,70,65,0,0,0,0,0,45,55,0,0,0,0,0,0,0,55]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.AntiTank=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Rockets"}},{key:"shortName",get:function(){return"Rocket"}},{key:"description",get:function(){return"A powerful indirect attacker with a wide range."}},{key:"cost",get:function(){return 15e3}},{key:"maxGas",get:function(){return 50}},{key:"maxAmmo",get:function(){return 5}},{key:"maxMovementPoints",get:function(){return 5}},{key:"vision",get:function(){return 3}},{key:"range",get:function(){return{min:3,max:5}}},{key:"canMoveAndAttack",get:function(){return!1}},{key:"unitClass",get:function(){return _v.Ground}},{key:"moveType",get:function(){return vv.TireA}},{key:"armorType",get:function(){return gv.Vehicle}},{key:"weapon",get:function(){return{primary:{name:"Rocket",targetMap:[2,2,0,0,2,0],damageMap:[95,90,90,90,85,75,70,55,45,80,65,85,85,80,0,0,0,0,0,0,0,0,55,55,65,65,75,105,55]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Rockets=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Missiles"}},{key:"shortName",get:function(){return"Missile"}},{key:"description",get:function(){return"An indirect attacker that can only strike airborne targets."}},{key:"cost",get:function(){return 12e3}},{key:"maxGas",get:function(){return 50}},{key:"maxAmmo",get:function(){return 5}},{key:"maxMovementPoints",get:function(){return 5}},{key:"vision",get:function(){return 6}},{key:"range",get:function(){return{min:3,max:7}}},{key:"canMoveAndAttack",get:function(){return!1}},{key:"unitClass",get:function(){return _v.Ground}},{key:"moveType",get:function(){return vv.TireA}},{key:"armorType",get:function(){return gv.Vehicle}},{key:"weapon",get:function(){return{primary:{name:"Anti-Air Msl",targetMap:[0,0,2,2,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,100,100,100,100,120,120,120,0,0,0,0,0,0,0]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Missiles=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Rig"}},{key:"shortName",get:function(){return"Rig"}},{key:"description",get:function(){return"/Carries 1/ infantry or mech unit. Can also /supply/ units and /build/ temp airports//ports."}},{key:"cost",get:function(){return 5e3}},{key:"maxGas",get:function(){return 99}},{key:"maxAmmo",get:function(){return 1}},{key:"maxMovementPoints",get:function(){return 6}},{key:"vision",get:function(){return 1}},{key:"range",get:function(){return{min:-1,max:-1}}},{key:"materialsInsteadOfAmmo",get:function(){return!0}},{key:"ammoCanBeResupplied",get:function(){return!1}},{key:"canMoveAndAttack",get:function(){return!1}},{key:"canResupply",get:function(){return!0}},{key:"boardable",value:function(t){var e=[Rw.Infantry,Rw.Mech],n=1<=this._cargo.length,r=!t,t=e.includes(null==t?void 0:t.type);return!n&&(t||r)}},{key:"unloadPosition",value:function(t){return!0}},{key:"unitClass",get:function(){return _v.Ground}},{key:"moveType",get:function(){return vv.Tread}},{key:"armorType",get:function(){return gv.Vehicle}},{key:"weapon",get:function(){return{primary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Rig=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Fighter"}},{key:"shortName",get:function(){return"Fighter"}},{key:"description",get:function(){return"A mobile aircraft that can attack other airborne units."}},{key:"cost",get:function(){return 2e4}},{key:"maxGas",get:function(){return 99}},{key:"maxAmmo",get:function(){return 6}},{key:"maxMovementPoints",get:function(){return 9}},{key:"vision",get:function(){return 5}},{key:"unitClass",get:function(){return _v.Air}},{key:"moveType",get:function(){return vv.Air}},{key:"armorType",get:function(){return gv.Air}},{key:"weapon",get:function(){return{primary:{name:"Anti-Air Msl",targetMap:[0,0,2,2,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,65,65,80,65,120,120,120,0,0,0,0,0,0,0]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Fighter=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Bomber"}},{key:"shortName",get:function(){return"Bomber"}},{key:"description",get:function(){return"A massively powerful plane that can attack both ground and naval units."}},{key:"cost",get:function(){return 2e4}},{key:"maxGas",get:function(){return 99}},{key:"maxAmmo",get:function(){return 6}},{key:"maxMovementPoints",get:function(){return 7}},{key:"vision",get:function(){return 3}},{key:"unitClass",get:function(){return _v.Air}},{key:"moveType",get:function(){return vv.Air}},{key:"armorType",get:function(){return gv.Air}},{key:"weapon",get:function(){return{primary:{name:"Bomb",targetMap:[2,2,0,0,2,0],damageMap:[115,110,110,105,105,85,105,95,75,105,80,105,95,105,0,0,0,0,0,0,0,0,85,85,95,50,95,120,90]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Bomber=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Stealth"}},{key:"shortName",get:function(){return"Stealth"}},{key:"description",get:function(){return"A powerful air unit that can /cloak/ and remain hidden until found by adjacent enemy units."}},{key:"cost",get:function(){return 22e3}},{key:"maxGas",get:function(){return 60}},{key:"maxAmmo",get:function(){return 6}},{key:"maxMovementPoints",get:function(){return 6}},{key:"vision",get:function(){return 3}},{key:"unitClass",get:function(){return _v.Air}},{key:"moveType",get:function(){return vv.Air}},{key:"armorType",get:function(){return gv.Air}},{key:"canHide",get:function(){return!0}},{key:"weapon",get:function(){return{primary:{name:"Omni-Msl",targetMap:[2,2,2,2,2,0],damageMap:[95,90,90,85,80,50,75,70,55,75,55,85,75,85,45,55,55,65,55,85,95,105,45,65,55,40,85,105,70]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Stealth=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Duster"}},{key:"shortName",get:function(){return"Duster"}},{key:"description",get:function(){return"A somewhat powerful plane that can attack both ground and air units."}},{key:"cost",get:function(){return 13e3}},{key:"maxGas",get:function(){return 99}},{key:"maxAmmo",get:function(){return 9}},{key:"maxMovementPoints",get:function(){return 8}},{key:"vision",get:function(){return 4}},{key:"unitClass",get:function(){return _v.Air}},{key:"moveType",get:function(){return vv.Air}},{key:"armorType",get:function(){return gv.Air}},{key:"weapon",get:function(){return{primary:{name:"Machine Gun",targetMap:[1,1,1,2,0,0],damageMap:[55,45,45,18,15,5,8,5,1,15,5,20,20,15,40,45,45,55,45,75,90,95,0,0,0,0,0,0,5]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Duster=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Sea Plane"}},{key:"shortName",get:function(){return"Seapl"}},{key:"description",get:function(){return"A plane produced at sea by carriers. It can attack any unit."}},{key:"cost",get:function(){return 15e3}},{key:"maxGas",get:function(){return 40}},{key:"maxAmmo",get:function(){return 3}},{key:"maxMovementPoints",get:function(){return 7}},{key:"vision",get:function(){return 4}},{key:"unitClass",get:function(){return _v.Air}},{key:"moveType",get:function(){return vv.Air}},{key:"armorType",get:function(){return gv.Air}},{key:"weapon",get:function(){return{primary:{name:"Missiles",targetMap:[2,2,2,2,2,0],damageMap:[90,85,85,80,80,45,75,65,55,70,50,80,70,75,45,55,55,65,55,85,95,95,45,65,55,40,85,105,55]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.SeaPlane=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"B Copter"}},{key:"shortName",get:function(){return"B Cptr"}},{key:"description",get:function(){return"An air unit that can attack ground and naval units, as well as other helicopters."}},{key:"cost",get:function(){return 9e3}},{key:"maxGas",get:function(){return 99}},{key:"maxAmmo",get:function(){return 6}},{key:"maxMovementPoints",get:function(){return 6}},{key:"vision",get:function(){return 3}},{key:"unitClass",get:function(){return _v.Air}},{key:"moveType",get:function(){return vv.Air}},{key:"armorType",get:function(){return gv.Heli}},{key:"weapon",get:function(){return{primary:{name:"Air-Gnd Msl",targetMap:[0,2,0,0,1,0],damageMap:[0,0,0,75,75,10,70,45,35,65,20,75,55,70,0,0,0,0,0,0,0,0,25,25,25,5,25,85,20]},secondary:{name:"Machine Gun",targetMap:[2,1,0,2,0,0],damageMap:[75,65,65,30,30,1,8,8,1,25,1,35,25,20,0,0,0,0,0,65,85,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.BCopter=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"T Copter"}},{key:"shortName",get:function(){return"T Cptr"}},{key:"description",get:function(){return"An air unit that can /carry 1/ infantry or mech unit, but has no attack capabilities."}},{key:"cost",get:function(){return 5e3}},{key:"maxGas",get:function(){return 99}},{key:"maxAmmo",get:function(){return 0}},{key:"maxMovementPoints",get:function(){return 6}},{key:"vision",get:function(){return 2}},{key:"range",get:function(){return{min:-1,max:-1}}},{key:"canMoveAndAttack",get:function(){return!1}},{key:"boardable",value:function(t){var e=[Rw.Infantry,Rw.Mech],n=1<=this._cargo.length,r=!t,t=e.includes(null==t?void 0:t.type);return!n&&(t||r)}},{key:"unloadPosition",value:function(t){var e=[Tg.Beach,Tg.Port,Tg.TempPort];return t.landTile||e.includes(t.type)}},{key:"resupplyHeldUnits",value:function(){return!1}},{key:"unitClass",get:function(){return _v.Air}},{key:"moveType",get:function(){return vv.Air}},{key:"armorType",get:function(){return gv.Heli}},{key:"weapon",get:function(){return{primary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.TCopter=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Seeker"}},{key:"shortName",get:function(){return"Seeker"}},{key:"description",get:function(){return"An unmanned aerial unit. This unit can /explode/ at will, damaging all units within 3 spaces."}},{key:"cost",get:function(){return 25e3}},{key:"maxGas",get:function(){return 45}},{key:"maxAmmo",get:function(){return 0}},{key:"maxMovementPoints",get:function(){return 7}},{key:"vision",get:function(){return 1}},{key:"range",get:function(){return{min:0,max:0}}},{key:"unitClass",get:function(){return _v.Air}},{key:"moveType",get:function(){return vv.Air}},{key:"armorType",get:function(){return gv.Air}},{key:"weapon",get:function(){return{primary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Seeker=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Battleship"}},{key:"shortName",get:function(){return"B Ship"}},{key:"description",get:function(){return"An extremely strong naval unit that can /launch indirect attacks after moving/."}},{key:"cost",get:function(){return 25e3}},{key:"maxGas",get:function(){return 99}},{key:"maxAmmo",get:function(){return 6}},{key:"maxMovementPoints",get:function(){return 5}},{key:"vision",get:function(){return 3}},{key:"range",get:function(){return{min:3,max:5}}},{key:"unitClass",get:function(){return _v.Naval}},{key:"moveType",get:function(){return vv.Ship}},{key:"armorType",get:function(){return gv.Ship}},{key:"weapon",get:function(){return{primary:{name:"Cannon",targetMap:[2,2,0,0,2,0],damageMap:[75,70,70,70,70,65,65,50,40,70,55,75,75,65,0,0,0,0,0,0,0,0,45,50,65,65,75,95,55]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Battleship=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Carrier"}},{key:"shortName",get:function(){return"Carrier"}},{key:"description",get:function(){return"A naval unit that can /carry 2/ air units and /produce/ seaplanes."}},{key:"cost",get:function(){return 28e3}},{key:"maxGas",get:function(){return 99}},{key:"maxAmmo",get:function(){return 4}},{key:"maxMovementPoints",get:function(){return 5}},{key:"vision",get:function(){return 4}},{key:"materialsInsteadOfAmmo",get:function(){return!0}},{key:"ammoCanBeResupplied",get:function(){return!1}},{key:"canResupplyHeldUnits",get:function(){return!0}},{key:"boardable",value:function(t){var e=2<=this._cargo.length,n=(null==t?void 0:t.unitClass)===_v.Air;return!e&&(n||!t)}},{key:"unloadPosition",value:function(t){return!0}},{key:"unitClass",get:function(){return _v.Naval}},{key:"moveType",get:function(){return vv.Ship}},{key:"armorType",get:function(){return gv.Ship}},{key:"weapon",get:function(){return{primary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},secondary:{name:"AA Gun",targetMap:[0,0,1,1,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,35,35,35,40,40,45,55,55,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Carrier=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Submarine"}},{key:"shortName",get:function(){return"Sub"}},{key:"description",get:function(){return"After /diving/, they remain hidden unless found by adjacent enemy units."}},{key:"cost",get:function(){return 2e4}},{key:"maxGas",get:function(){return 70}},{key:"maxAmmo",get:function(){return 6}},{key:"maxMovementPoints",get:function(){return 6}},{key:"vision",get:function(){return 5}},{key:"unitClass",get:function(){return _v.Naval}},{key:"moveType",get:function(){return vv.Ship}},{key:"armorType",get:function(){return gv.Sub}},{key:"canHide",get:function(){return!0}},{key:"weapon",get:function(){return{primary:{name:"Torpedo",targetMap:[0,0,0,0,2,2],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,110,55,20,85,120,55]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Submarine=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Cruiser"}},{key:"shortName",get:function(){return"Cruiser"}},{key:"description",get:function(){return"Cruisers are strong against subs and air units, and can /carry 2 copter units/."}},{key:"cost",get:function(){return 16e3}},{key:"maxGas",get:function(){return 99}},{key:"maxAmmo",get:function(){return 9}},{key:"maxMovementPoints",get:function(){return 6}},{key:"vision",get:function(){return 5}},{key:"canResupplyHeldUnits",get:function(){return!0}},{key:"boardable",value:function(t){var e=2<=this._cargo.length,n=!t,t=[Rw.BCopter,Rw.TCopter].includes(null==t?void 0:t.type);return!e&&(t||n)}},{key:"unloadPosition",value:function(t){return!0}},{key:"unitClass",get:function(){return _v.Naval}},{key:"moveType",get:function(){return vv.Ship}},{key:"armorType",get:function(){return gv.Ship}},{key:"weapon",get:function(){return{primary:{name:"Anti-Ship Msl",targetMap:[0,0,0,0,1,2],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,38,38,95,28,40,85,35]},secondary:{name:"AA Gun",targetMap:[0,0,2,2,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,105,105,105,105,105,120,120,120,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Cruiser=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Lander"}},{key:"shortName",get:function(){return"Lander"}},{key:"description",get:function(){return"Landers can /carry 2 ground units/. If the lander sinks, the units vanish."}},{key:"cost",get:function(){return 1e4}},{key:"maxGas",get:function(){return 99}},{key:"maxAmmo",get:function(){return 0}},{key:"maxMovementPoints",get:function(){return 6}},{key:"vision",get:function(){return 1}},{key:"range",get:function(){return{min:-1,max:-1}}},{key:"canMoveAndAttack",get:function(){return!1}},{key:"boardable",value:function(t){var e=2<=this._cargo.length,n=(null==t?void 0:t.unitClass)===_v.Ground;return!e&&(n||!t)}},{key:"unloadPosition",value:function(t){return[Tg.Beach,Tg.Port,Tg.TempPort].includes(t.type)}},{key:"unitClass",get:function(){return _v.Naval}},{key:"moveType",get:function(){return vv.Transport}},{key:"armorType",get:function(){return gv.Ship}},{key:"weapon",get:function(){return{primary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.Lander=e;e=function(){Ow(e,bw);var t=Ew(e);function e(){return xw(this,e),t.apply(this,arguments)}return Tw(e,[{key:"type",get:function(){return e}},{key:"name",get:function(){return"Gun Boat"}},{key:"shortName",get:function(){return"G Boat"}},{key:"description",get:function(){return"A unit that can /carry 1/ foot soldier and attack other naval units."}},{key:"cost",get:function(){return 6e3}},{key:"maxGas",get:function(){return 99}},{key:"maxAmmo",get:function(){return 1}},{key:"maxMovementPoints",get:function(){return 7}},{key:"vision",get:function(){return 2}},{key:"boardable",value:function(t){var e=1<=this._cargo.length,n=null==t?void 0:t.soldierUnit;return!e&&(n||!t)}},{key:"unloadPosition",value:function(t){return[Tg.Beach,Tg.Port,Tg.TempPort].includes(t.type)}},{key:"unitClass",get:function(){return _v.Naval}},{key:"moveType",get:function(){return vv.Transport}},{key:"armorType",get:function(){return gv.Ship}},{key:"weapon",get:function(){return{primary:{name:"Anti-Ship Msl",targetMap:[0,0,0,0,1,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,40,40,40,55,75,20]},secondary:{name:"",targetMap:[0,0,0,0,0,0],damageMap:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}}}]),e}();kw(e,"serial",Aw.next().value),t.GunBoat=e}(Rw=Rw||{});var zw=function(){Dw(o,Fw(Error));var i=Lw(o);function o(){var t;jw(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Hw(Nw(t=i.call.apply(i,[this].concat(n))),"name","BoardPlayerConstructionError"),t}return o}(),Vw=function(){Dw(o,Fw(Error));var i=Lw(o);function o(){var t;jw(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Hw(Nw(t=i.call.apply(i,[this].concat(n))),"name","SpawnUnitError"),t}return o}(),Ww=function(){function a(e){var t,n=this;if(jw(this,a),Hw(this,"map",void 0),Hw(this,"scenario",void 0),Hw(this,"playerNumber",void 0),Hw(this,"faction",void 0),Hw(this,"neverHQ",void 0),Hw(this,"armyFacing",void 0),Hw(this,"officer",void 0),Hw(this,"capturePoints",[]),Hw(this,"powerMeter",void 0),Hw(this,"funds",void 0),Hw(this,"armyDeployed",void 0),Hw(this,"units",[]),Hw(this,"lastCursorPosition",void 0),Hw(this,"_CoUnitTurnDelay",0),this.map=e.map,this.scenario=e.scenario,this.playerNumber=e.playerNumber,this.faction=e.faction,this.powerMeter=new Qg({max:600,granularity:1}),this.funds=e.funds||0,!l1.within(this.playerNumber,0,3))throw new zw("Cannot set player number to ".concat(this.playerNumber,": must be in range [0,3]."));if(this.armyFacing=this.playerNumber%2==0?Ov.Right:Ov.Left,![xv.Red,xv.Blue,xv.Yellow,xv.Black].includes(this.faction))throw new zw("Cannot set player-object faction to ".concat(this.faction,": not a Faction color."));var r=Object.values(iw).find(function(t){return t.serial===e.officerSerial});if(!r)throw new zw("Cannot set commanding officer: CO serial ".concat(e.officerSerial," not found."));this.officer=(new r).init(),e.capturePoints.forEach(function(t){var e=n.map.squareAt(t).terrain;if(e.faction!==xv.None&&e.faction!==xv.Neutral)throw new zw("Cannot set ownership of property already owned.\n".concat(Ev[n.faction]," taking ownership of ").concat(t.toString()," ").concat(e.name," Tile owned by ").concat(Ev[e.faction]));e.faction=n.faction}),null!==(t=e.unitSpawns)&&void 0!==t&&t.forEach(function(t){return n.spawnUnit(t)}),this.scanCapturedProperties(),this.armyDeployed=0<this.units.length,this.neverHQ=0===this.HQs.length;var i=this.scenario.spawnMap.map(function(t){return t.type}),r=this.capturePoints.filter(function(t){return i.includes(n.map.squareAt(t).terrain.type)});if(0===r.length&&0===this.units.length)throw new zw("BoardPlayer object #".concat(this.playerNumber," has no means of playing."));var o=(null===(t=this.HQs[0])||void 0===t?void 0:t.boardLocation)||r[0]||(null===(o=this.units[0])||void 0===o?void 0:o.boardLocation)||new Tm(this.map.width/2,this.map.height/2).trunc();this.lastCursorPosition=o}var t,e,n;return t=a,(e=[{key:"CoUnitTurnDelay",get:function(){return this._CoUnitTurnDelay},set:function(t){this._CoUnitTurnDelay=0<t?t:0}},{key:"destroy",value:function(){this.map=void 0,this.units=void 0}},{key:"HQs",get:function(){var e=this;return this.capturePoints.map(function(t){return e.map.squareAt(t)}).filter(function(t){return t.terrain.type===Tg.HQ})}},{key:"unitsOnMap",get:function(){return this.units.filter(function(t){return t.onMap})}},{key:"propertyCount",get:function(){return this.capturePoints.length}},{key:"fungiblePropertyCount",get:function(){var e=this;return this.capturePoints.filter(function(t){return e.map.squareAt(t).terrain.generatesIncome}).length}},{key:"comTowerCount",get:function(){var e=this;return this.capturePoints.filter(function(t){return e.map.squareAt(t).terrain.type===Tg.ComTower}).length}},{key:"deployCount",get:function(){return this.units.length}},{key:"defeated",get:function(){var t=!this.neverHQ&&0===this.HQs.length,e=this.armyDeployed&&0===this.deployCount;return t||e}},{key:"activateAllUnits",value:function(){this.units.forEach(function(t){t.orderable=!0})}},{key:"deactivateAllUnits",value:function(){this.units.forEach(function(t){t.orderable=!1})}},{key:"spawnUnit",value:function(t){var e=t.location,n=t.serial,r=t.hp,i=t.ammo,o=t.gas,a=t.capture,s=t.spent,u=Object.values(Rw).find(function(t){return t.serial===n});if(!u)throw new Vw("Could not spawn predeploy: Unit serial ".concat(n," not found."));function c(t){return void 0!==t?t:""}O1.log("BoardPlayer","SpawnUnit",{message:"".concat(u.name," ser=").concat(n," at ").concat(new Tm(e).toString(),": hp=").concat(c(r)," ap=").concat(c(i)," gas=").concat(c(o)," cap=").concat(c(a)," spent=").concat(c(s))});s=new u;s.init({faction:this.faction,boardPlayer:this});u=this.map.squareAt(e);if(u.unit&&!u.unit.boardable(s))throw new Vw("Could not spawn unit: '".concat(u.unit.name,"' at location ").concat(e.toString()," already occupied or unable to hold new '").concat(s.name,"' as cargo."));if(!u.unit&&!u.occupiable(s))throw new Vw("Could not spawn unit: location ".concat(e.toString()," not occupiable by '").concat(s.name,"'."));return u.unit?u.unit.loadUnit(s):this.map.placeUnit(s,e),this.units.push(s),t.hp&&(s.hp=t.hp),t.gas&&(s.gas=t.gas),t.ammo&&(s.ammo=t.ammo),t.capture&&(s.capture=t.capture),s.spent=null!==(t=t.spent)&&void 0!==t&&t,s.hiding=s.canHide,this.armyDeployed=!0,s}},{key:"unspawnUnit",value:function(e){return this.units=this.units.filter(function(t){return t!==e}),this.map.removeUnit(e.boardLocation),e.CoOnBoard&&this.handleCoUnitDestroyed(),e}},{key:"scanCapturedProperties",value:function(){this.capturePoints=[];for(var t=0;t<this.map.height;t++)for(var e=0;e<this.map.width;e++)this.map.squareAt({x:e,y:t}).terrain.faction===this.faction&&this.capturePoints.push(new Tm(e,t))}},{key:"collectFunds",value:function(){this.funds+=1e3*this.fungiblePropertyCount}},{key:"canAfford",value:function(t){return this.funds>=t}},{key:"expendFunds",value:function(t){this.funds-=t,this.funds=Math.max(this.funds,0)}},{key:"getCoUnit",value:function(){return this.units.find(function(t){return t.CoOnBoard})}},{key:"canSpawnCO",get:function(){return!this.getCoUnit()&&this.CoUnitTurnDelay<=0}},{key:"setCoBoardableIndicators",value:function(){var c=this,l=this.map,h=this.scenario;this.clearCoBoardableIndicators(),this.unitsOnMap.forEach(function(t){var e=l.squareAt(t.boardLocation),n=h.spawnMap.find(function(t){return t.type===e.terrain.type}),r=(null==n?void 0:n.units.includes(t.type))||!1,i=e.terrain.faction===c.faction,o=e.terrain.type===Tg.HQ&&h.CoLoadableFromHQ,a=t.unitClass===_v.Ground,s=t.orderable,u=c.canSpawnCO,n=t.adjustedCost<=c.funds;t.CoCouldBoard=s&&n&&u&&(i&&(r||o&&a))})}},{key:"clearCoBoardableIndicators",value:function(){this.units.forEach(function(t){return t.CoCouldBoard=!1})}},{key:"handleCoUnitDestroyed",value:function(){this.CoUnitTurnDelay=1,this.powerMeter.track="min"}},{key:"withinCoRange",value:function(t){var e=this.getCoUnit();if(!e)return!1;var n=Z9({min:0,max:this.officer.CoZone+this.powerMeterLevel}),e=t.subtract(e.boardLocation);return n.get(e)}},{key:"increasePowerMeter",value:function(t){this.powerMeter.increment(t)}},{key:"resetPowerMeter",value:function(){this.powerMeter.track="min"}},{key:"powerMeterSegments",get:function(){return Math.floor(this.powerMeter.output/50)}},{key:"powerMeterLevel",get:function(){return Math.floor(this.powerMeter.output/50/6)}},{key:"logString",value:function(){return"p".concat(this.playerNumber," faction=").concat(this.faction," defeated=").concat(this.defeated," cap=").concat(this.propertyCount," hq=").concat(this.HQs.length," neverHQ=").concat(this.neverHQ," troop=").concat(this.deployCount," neverTroop=").concat(!this.armyDeployed)}}])&&Mw(t.prototype,e),n&&Mw(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}();function Yw(t){return(Yw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qw(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kw(t,e){return(Kw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Zw(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=$w(n);return function(t,e){{if(e&&("object"===Yw(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return Qw(t)}(this,r?(t=$w(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function Qw(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $w(t){return($w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jw(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var tT=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Kw(t,e)}(o,Dx);var t,e,n,r=Zw(o);function o(t){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),Jw(Qw(i=r.call(this,t)),"nextUnitButton",void 0),Jw(Qw(i),"nextBaseButton",void 0),Jw(Qw(i),"unitLocations",void 0),Jw(Qw(i),"baseLocations",void 0),Jw(Qw(i),"unitSelect",void 0),Jw(Qw(i),"baseSelect",void 0),Jw(Qw(i),"holdPulsar",new tb({interval:8,firstInterval:20},function(){var t,e=i.assets.mapCursor,n=Qw(i),r=n.nextUnitButton,n=n.nextBaseButton;r.down?(t=i.unitLocations[i.unitSelect.output],i.unitSelect.increment()):n.down&&(t=i.baseLocations[i.baseSelect.output],i.baseSelect.increment()),t&&e.teleportTo(t)},Qw(i)));t=i.assets.gamepad;i.nextUnitButton=t.button.leftBumper,i.nextBaseButton=t.button.rightBumper;t=new Qg({max:1,granularity:1,looping:!0});return i.unitSelect=t,i.baseSelect=t,i}return t=o,(e=[{key:"defaultEnabled",value:function(){return!1}},{key:"enableScript",value:function(){var t=this.assets,e=t.map,n=t.players,t=t.scenario,n=n.current,r=Object.values(t.spawnMap).map(function(t){return t.type});this.baseLocations=n.capturePoints.filter(function(t){return r.includes(e.squareAt(t).terrain.type)&&(!e.squareAt(t).unit||(null===(t=e.squareAt(t).unit)||void 0===t?void 0:t.orderable))}),this.baseSelect=new Qg({max:this.baseLocations.length,track:(null===(t=this.baseSelect)||void 0===t?void 0:t.track)||0,granularity:1,looping:!0}),this.unitLocations=n.units.filter(function(t){return t.orderable&&t.onMap}).map(function(t){return t.boardLocation}),this.unitSelect=new Qg({max:this.unitLocations.length,track:(null===(n=this.unitSelect)||void 0===n?void 0:n.track)||0,granularity:1,looping:!0})}},{key:"updateScript",value:function(){var i=this.assets.mapCursor,t=this.nextUnitButton,e=this.nextBaseButton,o=this.holdPulsar,n=this.unitLocations,r=this.unitSelect,a=this.baseLocations,s=this.baseSelect;function u(t,e,n){function r(){return e[n.output]}t.pressed&&0!==e.length&&!o.active&&(t=r().equal(i.boardLocation),n.increment(Number(t)),i.teleportTo(r()),o.start())}u(t,n,r),u(e,a,s),o.active&&t.up&&e.up&&o.stop()}},{key:"disableScript",value:function(){this.holdPulsar.stop()}},{key:"resetIndex",value:function(){this.unitSelect.track="min",this.baseSelect.track="min"}}])&&qw(t.prototype,e),n&&qw(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function eT(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nT(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var rT=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),nT(this,"players",void 0),nT(this,"currentIdx",void 0),nT(this,"_day",1),this.players=t,this.currentIdx=new Qg({max:this.players.length,granularity:1,looping:!0})}var t,n,r;return t=e,(n=[{key:"all",get:function(){return this.players}},{key:"allUnits",get:function(){return this.players.map(function(t){return t.units}).flat()}},{key:"allUnitsOnMap",get:function(){return this.players.map(function(t){return t.unitsOnMap}).flat()}},{key:"current",get:function(){return this.players[this.currentIdx.output]}},{key:"perspective",get:function(){return this.players[this.currentIdx.output]}},{key:"perspectivesTurn",get:function(){return this.current===this.perspective?this.perspective:void 0}},{key:"day",get:function(){return this._day}},{key:"firstTurn",get:function(){return 1===this._day&&this.currentIdx.equalsMin()}},{key:"increment",value:function(){this.currentIdx.output===this.players.length-1&&this._day++,this.currentIdx.increment()}},{key:"playerWon",value:function(e){var t=!e.defeated,n=this.players.filter(function(t){return t!==e}).every(function(t){return t.defeated});return t&&n}},{key:"playerLost",value:function(t){return t.defeated}},{key:"playersStillActive",get:function(){return this.all.filter(function(t){return!t.defeated}).length}},{key:"winnerFound",value:function(){return 1===this.playersStillActive}}])&&eT(t.prototype,n),r&&eT(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function iT(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oT(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var T_=function(){function n(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),oT(this,"type",void 0),oT(this,"_units",void 0),this.type=t,this._units=e}var t,e,r;return t=n,(e=[{key:"units",get:function(){return this._units.slice()}}])&&iT(t.prototype,e),r&&iT(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}(),aT=[new T_(Tg.Factory,[Rw.Infantry,Rw.Mech,Rw.Bike,Rw.Recon,Rw.Flare,Rw.AntiAir,Rw.Tank,Rw.MdTank,Rw.WarTank,Rw.Artillery,Rw.AntiTank,Rw.Rockets,Rw.Missiles,Rw.Rig]),new T_(Tg.Airport,[Rw.Fighter,Rw.Bomber,Rw.Stealth,Rw.Seeker,Rw.Duster,Rw.BCopter,Rw.TCopter]),new T_(Tg.Port,[Rw.Carrier,Rw.Battleship,Rw.Submarine,Rw.Cruiser,Rw.Lander,Rw.GunBoat]),new T_(Rw.Carrier,[Rw.SeaPlane])];function sT(t){return(sT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uT(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return cT(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cT(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cT(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function lT(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hT(){return(hT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=yT(t)););return t}(t,e);if(r){e=Object.getOwnPropertyDescriptor(r,e);return e.get?e.get.call(arguments.length<3?t:n):e.value}}).apply(this,arguments)}function fT(t,e){return(fT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function pT(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=yT(n);return function(t,e){{if(e&&("object"===sT(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return dT(t)}(this,r?(t=yT(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function dT(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yT(t){return(yT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mT(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var vT=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fT(t,e)}(o,qb);var t,e,n,i=pT(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return mT(dT(t=i.call.apply(i,[this].concat(n))),"listItemProps",new qg({minWidth:112,height:16,margin:{left:3,right:3},border:{left:1,right:1,bottom:1},padding:{left:2,right:2}})),mT(dT(t),"palette",{background:Hg.gale_force1,primary:Hg.gale_force2,light:Hg.cloudless,dark:Hg.black}),mT(dT(t),"stateTextures",void 0),t}return t=o,(e=[{key:"onCursorMove",value:function(){hT(yT(o.prototype),"onCursorMove",this).call(this),this.cursorGraphic.rect.y+=2}},{key:"buildTextures",value:function(){var t=this.palette,e=this.listItemProps;this.stateTextures&&Object.values(this.stateTextures).forEach(function(t){return t.destroy()});var n=e.contentBox(),r=e.borderOuterBox(),i=e.containerBox(),o=new T.Graphics;o.beginFill(t.background),o.drawRect(i.x,i.y,i.width,i.height),o.beginFill(t.dark,.35),o.drawRect(i.x,i.y,i.width,i.height),o.beginFill(t.primary),o.drawRect(r.x,i.y,r.width,i.height),o.beginFill(t.dark,.35),o.drawRect(n.x,n.y+n.height,n.width,-e.border.bottom),o.endFill();n=zI.renderer.generateTexture(o,{scaleMode:T.SCALE_MODES.NEAREST});o.clear(),o.beginFill(t.background),o.drawRect(i.x,i.y,i.width,2),o.beginFill(t.dark,.35),o.drawRect(i.x,i.y,i.width,2),o.beginFill(t.primary),o.drawRect(r.x,i.y+1,r.width,1);e=zI.renderer.generateTexture(o,{scaleMode:T.SCALE_MODES.NEAREST});o.clear(),o.beginFill(t.background),o.drawRect(i.x,i.y,i.width,2),o.beginFill(t.dark,.35),o.drawRect(i.x,i.y,i.width,2),o.beginFill(t.primary),o.drawRect(r.x,i.y,r.width,1);o=zI.renderer.generateTexture(o,{scaleMode:T.SCALE_MODES.NEAREST});this.stateTextures={item:n,topCap:e,bottomCap:o}}},{key:"buildListItems",value:function(){var i=this,t=this.menu,o=this.stateTextures,e=this.listItemProps,a=e.contentBox(),s=e.containerBox();this.menuGui.children.forEach(function(t){return t.destroy()}),this.menuGui.removeChildren(),t.pageItems.forEach(function(t,e){var n=new T.Sprite(o.item);n.position.y=s.height*e+2;var r=t.key,e=r.icon,t=r.title,r=r.cost;e.position.set(a.x+2,a.y);t=new T.BitmapText(t,Xg.list);t.position.set(a.x+23,a.y+.6*a.height),t.anchor.set(0,.5);r=new T.BitmapText(r.toString(),Xg.list);r.position.set(a.x+a.width-r.width,a.y+.6*a.height),r.anchor.set(0,.5),n.addChild(e,t,r),i.menuGui.addChild(n)});for(var n=t.pageItems.length;n<t.pageLength;n++){var r=new T.Sprite(this.stateTextures.item);r.position.y=s.height*n+2,this.menuGui.addChild(r)}var u=new T.Sprite(o.topCap),e=new T.Sprite(o.bottomCap);e.y=s.height*t.pageLength+2,this.menuGui.addChild(u,e),this.pagesBar.build(t.totalPages,t.pageIndex,s.width),this.pagesBar.container.position.set(s.width/2-this.pagesBar.container.width/2,s.height*t.pageLength+4+1)}},{key:"updateFrames",value:function(){var i=this.menuGui.children;this.menu.pageItems.forEach(function(t,e){var n,r;e>=i.length||(n=(r=uT(i[e].children,3))[0],e=r[1],r=r[2],t.disabled?(n.children[0].tint=8947848,e.alpha=.35,r.alpha=.35):(n.children[0].tint=16777215,e.alpha=1,r.alpha=1))})}}])&&lT(t.prototype,e),n&&lT(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function gT(t){return function(t){if(Array.isArray(t))return bT(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return bT(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bT(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bT(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xT=function(){function r(){var t,e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),n=[],(e="list")in(t=this)?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}var t,e,n;return t=r,(e=[{key:"destroy",value:function(){this.assets=void 0}},{key:"current",get:function(){if(0<this.list.length)return this.list[0]}},{key:"boardLocation",get:function(){var t=this.current;if(t)return t[0].location}},{key:"eventsInQueue",get:function(){return 0<this.list.length}},{key:"batchPlaying",get:function(){var t;return(null===(t=this.current)||void 0===t?void 0:t.some(function(t){return t.playing}))||!1}},{key:"batchFinished",get:function(){var t;return(null===(t=this.current)||void 0===t?void 0:t.every(function(t){return t.finished}))||!1}},{key:"schedule",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n.filter(function(t){return!1!==t}).map(function(t){return Array.isArray(t)?t:[t]}).filter(function(t){return 0<t.length});0<i.length&&(t=this.list).push.apply(t,gT(i))}},{key:"batchPlay",value:function(){this.current&&this.current.forEach(function(t){return t.play()})}},{key:"next",value:function(){this.list.shift()}}])&&_T(t.prototype,e),n&&_T(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}();function wT(t){return(wT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function TT(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function OT(t,e){return(OT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ST(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=PT(n);return function(t,e){{if(e&&("object"===wT(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return ET(t)}(this,r?(t=PT(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function ET(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PT(t){return(PT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kT(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var RT=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&OT(t,e)}(i,Dx);var t,e,n,r=ST(i);function i(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),kT(ET(n=r.call(this,t)),"nextUnitButton",void 0),kT(ET(n),"unitLocations",void 0),kT(ET(n),"unitSelect",void 0),kT(ET(n),"holdPulsar",new tb({interval:8,firstInterval:20},function(){var t,e=n.assets.mapCursor;ET(n).nextUnitButton.down&&(t=n.unitLocations[n.unitSelect.output],n.unitSelect.increment()),t&&e.teleportTo(t)},ET(n)));t=n.assets.gamepad;n.nextUnitButton=t.button.leftBumper;t=new Qg({max:1,granularity:1,looping:!0});return n.unitSelect=t,n}return t=i,(e=[{key:"defaultEnabled",value:function(){return!1}},{key:"enableScript",value:function(){var t=this.assets,e=t.map,t=t.players;this.unitLocations=t.allUnits.filter(function(t){return t.onMap&&e.squareAt(t.boardLocation).attackFlag}).map(function(t){return t.boardLocation}),this.unitSelect=new Qg({max:this.unitLocations.length,track:(null===(t=this.unitSelect)||void 0===t?void 0:t.track)||0,granularity:1,looping:!0})}},{key:"updateScript",value:function(){var t=this.assets.mapCursor,e=this.unitSelect,n=this.unitLocations,r=this.holdPulsar,i=this.nextUnitButton;i.pressed&&0!==n.length&&(t.teleportTo(n[e.output]),e.increment(),r.start()),r.active&&i.up&&r.stop()}},{key:"disableScript",value:function(){this.holdPulsar.stop()}},{key:"resetIndex",value:function(){this.unitSelect.track="min"}}])&&TT(t.prototype,e),n&&TT(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function AT(t){return(AT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function CT(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function IT(t,e){return(IT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function MT(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=DT(n);return function(t,e){{if(e&&("object"===AT(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return jT(t)}(this,r?(t=DT(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function jT(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function DT(t){return(DT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function LT(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var NT=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&IT(t,e)}(o,Dx);var t,e,n,i=MT(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return LT(jT(t=i.call.apply(i,[this].concat(n))),"focalSwap",void 0),LT(jT(t),"cameraLead",Tm.Origin),LT(jT(t),"lastInput",Tm.Origin),LT(jT(t),"virtualCursorPos",Tm.Origin),LT(jT(t),"lastInputWasPointer",!1),LT(jT(t),"initialCameraPosition",Tm.Origin),t}return t=o,(e=[{key:"defaultEnabled",value:function(){return!1}},{key:"enableScript",value:function(){var t=this.assets,e=t.camera,t=t.mapCursor;this.lastInput.set(0,0),this.virtualCursorPos.set(t.boardLocation),this.lastInputWasPointer=!1;t=e.transform.worldRect();this.initialCameraPosition.set(new Tm(t)),this.cameraLead.set(t.center),this.focalSwap=e.focalTarget,e.focalTarget={position:this.cameraLead}}},{key:"updateScript",value:function(){var t=this.assets,e=t.camera,n=t.gamepad.axis.dpad;this.updateLastCameraTravelVector(n.point),n.roaming&&(this.lastInputWasPointer=!1);t=e.transform.subjectRect();e.doneTraveling&&(e=3*zI.display.standardLength,this.cameraLead.set(t.center.x+(t.width/2+e)*n.point.x,t.center.y+(t.height/2+e)*n.point.y),this.clampCameraLead())}},{key:"disableScript",value:function(){this.assets.camera.focalTarget=this.focalSwap}},{key:"clampCameraLead",value:function(){var t=this.assets.map,e=zI.display.standardLength,e=new Tm(t.width-1,t.height-1).multiply(e);this.cameraLead.set(this.cameraLead.clamp(e))}},{key:"updateLastCameraTravelVector",value:function(t){this.lastInput.set((0!==t.x?t:this.lastInput).x,(0!==t.y?t:this.lastInput).y)}},{key:"toPointerPosition",value:function(t){var e=zI.display.standardLength;this.virtualCursorPos.set(t.multiply(1/e).round()),this.lastInputWasPointer=!0,this.cameraLead.set(t),this.clampCameraLead()}},{key:"finalCursorPosition",value:function(){var t=this.assets.camera,e=zI.display.standardLength,n=this.lastInput,r=t.transform.subjectRect();if(this.lastInputWasPointer)return this.virtualCursorPos;function i(t,e){return[Math.floor,Math.round,Math.ceil][Math.sign(e)+1](t)}t=new Tm(r);t.x=i(t.x/e,n.x),t.y=i(t.y/e,n.y);r=t.add(i(r.width/e,-n.x),i(r.height/e,-n.y)),e=this.virtualCursorPos.clone();return e.x=[t.x,e.x,r.x][Math.sign(n.x)+1],e.y=[t.y,e.y,r.y][Math.sign(n.y)+1],e}}])&&CT(t.prototype,e),n&&CT(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function FT(t){return(FT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function BT(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function UT(t,e){return(UT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function GT(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=XT(n);return function(t,e){{if(e&&("object"===FT(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=XT(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function XT(t){return(XT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var HT=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&UT(t,e)}(i,Dx);var t,e,n,r=GT(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"defaultEnabled",value:function(){return!1}},{key:"setUnitsTransparent",value:function(n){var t=this.assets,e=t.gamepad,r=t.allInPlayUnits,i=t.players,o=e.button.leftTrigger.down,a=e.button.rightTrigger.down;r.forEach(function(t){var e=t.faction===i.current.faction&&t.statusApplied;t.transparent=n&&!o&&!(a&&e)})}},{key:"enableScript",value:function(){this.setUnitsTransparent(!0)}},{key:"updateScript",value:function(){var t=this.assets.gamepad.button,e=t.leftTrigger,t=t.rightTrigger;(e.changed||t.changed)&&this.setUnitsTransparent(!0)}},{key:"disableScript",value:function(){this.setUnitsTransparent(!1)}}])&&BT(t.prototype,e),n&&BT(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function zT(t){return(zT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function VT(n){var r=KT();return function(){var t,e=QT(n);return function(t,e){{if(e&&("object"===zT(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return WT(t)}(this,r?(t=QT(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function WT(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function YT(t){var n="function"==typeof Map?new Map:void 0;return function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return qT(t,arguments,QT(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),ZT(e,t)}(t)}function qT(t,e,n){return(qT=KT()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);r=new(Function.bind.apply(t,r));return n&&ZT(r,n.prototype),r}).apply(null,arguments)}function KT(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function ZT(t,e){return(ZT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function QT(t){return(QT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $T=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ZT(t,e)}(u,YT(Error));var s=VT(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e,n,r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=WT(t),r="ValueError",(n="name")in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return u}();function JT(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tO(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var eO=function(){function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.left,n=t.right,r=t.top,t=t.bottom;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),tO(this,"left",void 0),tO(this,"right",void 0),tO(this,"top",void 0),tO(this,"bottom",void 0),this.left=e||0,this.right=n||0,this.top=r||0,this.bottom=t||0}var t,e,n;return t=i,(e=[{key:"equal",value:function(t){return this.left===t.left&&this.right===t.right&&this.top===t.top&&this.bottom===t.bottom}},{key:"add",value:function(t){return new i({left:this.left+t.left,right:this.right+t.right,top:this.top+t.top,bottom:this.bottom+t.bottom})}},{key:"subtract",value:function(t){return new i({left:this.left-t.left,right:this.right-t.right,top:this.top-t.top,bottom:this.bottom-t.bottom})}},{key:"toString",value:function(){var t=this.top,e=this.left,n=this.bottom,r=this.right;return"".concat(e," ").concat(t," ").concat(r," ").concat(n)}}])&&JT(t.prototype,e),n&&JT(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function nO(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return rO(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rO(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rO(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function iO(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oO(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aO(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sO(){oO(this,sO),aO(this,"position",new Tm),aO(this,"zoom",0),aO(this,"border",new eO)}var uO,cO=function(){function e(t){oO(this,e),aO(this,"camera",void 0),aO(this,"baseWidth",zI.display.renderWidth),aO(this,"baseHeight",zI.display.renderHeight),aO(this,"position",new Tm),aO(this,"_zoom",1),aO(this,"border",new eO),aO(this,"applyZoomToBorder",!1),this.camera=t}var t,n,r;return t=e,(n=[{key:"zoom",get:function(){return this._zoom},set:function(t){if(t<=0)throw new $T("Cannot set property 'zoom' to <= 0.");this._zoom=t}},{key:"zoomToPoint",value:function(t,e){var n=this._zoom,r=t;this._zoom=r;var i=this.position,o=i.x,t=i.y,i=e.x,e=e.y;this.position.set(i-(i-o)*n/r,e-(e-t)*n/r)}},{key:"subjectInFrame",get:function(){var t=this.subjectRect(),e=this.camera.focalTarget;return!e||t.contains(e.position)}},{key:"destroy",value:function(){this.camera=void 0}},{key:"worldRect",value:function(){var t=this.position,e=this.baseWidth,n=this.baseHeight,r=this.zoom;return new S2(t.x,t.y,e/r,n/r)}},{key:"subjectRect",value:function(){var e=this,t=this.border,n=t.left,r=t.right,i=t.top,o=t.bottom,a=this.worldRect();return this.applyZoomToBorder&&(n=(t=nO([n,r,i,o].map(function(t){return t/e.zoom}),4))[0],r=t[1],i=t[2],o=t[3]),new S2(a.x+n,a.y+i,a.width-n-r,a.height-i-o)}},{key:"clone",value:function(){var t=new e(this.camera);return t.position.set(this.position),t.zoom=this.zoom,t.border=this.border,t.applyZoomToBorder=this.applyZoomToBorder,t}},{key:"equal",value:function(t){var e=this.worldRect().equal(t.worldRect()),n=this.zoom===t.zoom,t=this.border.equal(t.border);return e&&n&&t}},{key:"notEqual",value:function(t){return!this.equal(t)}},{key:"vectorFrom",value:function(t){var e=this.worldRect(),n=t.worldRect(),r=new sO;return r.position=e.topleft.subtract(n.topleft),r.zoom=this.zoom-t.zoom,r.border=this.border.subtract(t.border),r}},{key:"addVector",value:function(t){var e=this.clone();return e.position=e.position.add(t.position),e.zoom+=t.zoom,e.border=e.border.add(t.border),e}},{key:"toString",value:function(){return"zoom=".concat(this.zoom," view=").concat(this.worldRect().toString()," focus=").concat(this.subjectRect().toString())}}])&&iO(t.prototype,n),r&&iO(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function lO(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hO(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}(T_=uO=uO||{})[T_.Camera=-100]="Camera",T_[T_.Utility=-99]="Utility",T_[T_.General=0]="General",T_[T_.ProxyInput=1]="ProxyInput",T_[T_.Input=2]="Input";var fO=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),hO(this,"_focalTarget",void 0),hO(this,"_transform",new cO(this)),hO(this,"hiddenTransforms",{actual:new cO(this),offset:new sO,render:new cO(this)}),hO(this,"algorithms",{}),hO(this,"stage",void 0),this.stage=t,zI.scene.ticker.add(this.update,this,uO.Camera)}var t,n,r;return t=e,(n=[{key:"focalTarget",get:function(){return this._focalTarget},set:function(t){var e=t?"Now observing object at ".concat(new Tm(t.position).toString()):"Now observing no object.";O1.log("Camera","ChangeFocalObject",{message:e}),this._focalTarget=t}},{key:"transform",get:function(){return this._transform},set:function(t){O1.log("Camera","MoveTarget",{message:"Moving transform target to ".concat(t.toString())}),this._transform=t}},{key:"subjectInView",get:function(){var t=this.hiddenTransforms.actual.subjectRect(),e=this.getFocalPoint();return t.contains(e)}},{key:"doneTraveling",get:function(){return this.hiddenTransforms.actual.equal(this._transform)}},{key:"currentTransform",value:function(){return this.hiddenTransforms.actual.clone()}},{key:"renderTransform",value:function(){return this.hiddenTransforms.render.clone()}},{key:"destroy",value:function(){zI.scene.ticker.remove(this.update,this),O1.log("Camera","Destruct",{message:"Camera object destroyed."})}},{key:"teleportToDestination",value:function(){var t;null!==(t=this.algorithms.destination)&&void 0!==t&&t.update(this._transform,this.getFocalPoint(),this),this.hiddenTransforms.actual=this._transform.clone(),this.update()}},{key:"update",value:function(){var t=this.algorithms,e=t.destinationCorrection,n=t.destination,r=t.travel,i=t.displacement,t=this.hiddenTransforms,n=n?n.update(this._transform,this.getFocalPoint(),this):this._transform;(n=e?e(this._transform):this._transform).notEqual(this._transform)&&(this.transform=n),t.actual=r?r.update(t.actual,this._transform,this.getFocalPoint()):this._transform.clone(),zI.frameCount%60*5==0&&O1.log("Camera","UpdatePosition",{message:"target-transform=".concat(t.actual.toString()," focal=").concat(this.getFocalPoint().toString()," follow-mode=").concat(null===(r=this.algorithms.travel)||void 0===r?void 0:r.name)}),t.offset=(null==i?void 0:i.get())||new sO,t.render=t.actual.addVector(t.offset);i=t.render.worldRect(),t=t.render.zoom;this.stage.position.set(-i.x*t,-i.y*t),this.stage.scale.set(t)}},{key:"getFocalPoint",value:function(){var t=null!==(t=this.algorithms.focalCorrection)&&void 0!==t?t:function(t){return t};return this._focalTarget?t(new Tm(this._focalTarget.position),this._transform):this.hiddenTransforms.actual.worldRect().center}}])&&lO(t.prototype,n),r&&lO(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),pO=l1.confirmType()({ScreenPush:{lastTravelVector:new Tm,quantize:function(t,e){var n=[Math.floor,function(t){return t},Math.ceil][(0,Math.sign)(e)+1],e=zI.display.standardLength;return n(t/e)*e},update:function(t,e,n){var r=t.clone(),i=t.subjectRect(),o=new Tm(l1.displacementFromRange(e.x,i.left,i.right),l1.displacementFromRange(e.y,i.top,i.bottom));t.position=t.position.add(o);var a=t.subjectRect(),i=n.currentTransform().subjectRect(),o=t.border,n=l1.within(e.x,i.left,i.right)?this.quantize(a.x,this.lastTravelVector.x)-o.left:t.position.x,o=l1.within(e.y,i.top,i.bottom)?this.quantize(a.y,this.lastTravelVector.y)-o.top:t.position.y;t.position.set(n,o);r=t.vectorFrom(r);return this.lastTravelVector.set((0!==r.position.x?r.position:this.lastTravelVector).x,(0!==r.position.y?r.position:this.lastTravelVector).y),t}}}),dO=l1.confirmType()({Instant:{name:"Instant",update:function(t,e,n){return e}},Linear:{name:"Linear",update:function(e,n,t){var r=Math.abs;e.border=n.border;var i=.075*Math.log(n.zoom+1),o=n.zoom-e.zoom,i=l1.clamp(o,-i,i);0!==i&&e.zoomToPoint(e.zoom+i,t);var a=r(i)/r(o),o=zI.display.standardLength,s=Math.floor(.75*o),o=e.clone();o.zoomToPoint(n.zoom,t);o=new Tm(n.worldRect()).subtract(new Tm(o.worldRect())).apply(function(t){return n.zoom===e.zoom?l1.clamp(t,-s,s):t*a});return e.position=e.position.add(o),e}}});function yO(t){return(yO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mO(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vO(t,e){return(vO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function gO(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=_O(n);return function(t,e){{if(e&&("object"===yO(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return bO(t)}(this,r?(t=_O(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function bO(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _O(t){return(_O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xO(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var wO=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vO(t,e)}(i,Dx);var t,e,n,r=gO(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),xO(bO(e=r.call(this,t)),"stagePointer",void 0),xO(bO(e),"map",void 0),xO(bO(e),"mapCursor",void 0),xO(bO(e),"onMoveCursor",void 0),xO(bO(e),"_operatingCursor",!1),xO(bO(e),"_affirmIntent",!1),xO(bO(e),"_affirmIntentLocation",new Tm),xO(bO(e),"_cancelIntent",!1),xO(bO(e),"mode","any"),xO(bO(e),"affirmOnPointerDrag",!1),xO(bO(e),"affirmOnRelease",!1),xO(bO(e),"affirmOnDragRelease",!1),e.stagePointer=t.stagePointer,e.map=t.map,e.mapCursor=t.mapCursor,e}return t=i,(e=[{key:"defaultEnabled",value:function(){return!1}},{key:"operatingCursor",get:function(){return this._operatingCursor}},{key:"affirmIntent",get:function(){return this._affirmIntent}},{key:"affirmIntentLocation",value:function(){return this._affirmIntentLocation.clone()}},{key:"cancelIntent",get:function(){return"highlighted"===this.mode&&this._cancelIntent}},{key:"enableScript",value:function(){}},{key:"disableScript",value:function(){this.onMoveCursor=void 0,this._operatingCursor=!1,this._affirmIntent=!1,this._affirmIntentLocation.set(0,0),this._cancelIntent=!1,this.mode="any",this.affirmOnPointerDrag=!1,this.affirmOnRelease=!1,this.affirmOnDragRelease=!1}},{key:"updateScript",value:function(){function t(t){return t.moveFlag||t.attackFlag||t.targetFlag}var e=this.map,n=this.mapCursor,r=this.stagePointer,i=r.button,o=r.clicked(),a=e.squareFromWorldPoint(r.pointerLocation()),s=e.squareFromWorldPoint(r.pointerPressedLocation()),u=(a.boardLocation.equal(s.boardLocation),a.boardLocation.equal(n.boardLocation)),c="any"===this.mode||t(a),l=a.terrain.type!==Tg.Void,h=i.down&&l&&!u&&c,f=i.up,e=o&&u&&!this.operatingCursor,l=r.pointerDragging&&this.affirmOnPointerDrag,c=i.released&&this.affirmOnRelease,u=r.pointerDragStopped&&this.affirmOnDragRelease;h&&(i.pressed||r.pointerIn?n.moveTo(a.boardLocation):n.animateTo(a.boardLocation),this.onMoveCursor&&this.onMoveCursor(n.boardLocation),this._operatingCursor=!0),f&&(this._operatingCursor=!1),this._affirmIntent=e||l||c||u,this._affirmIntentLocation.set((l?s:a).boardLocation),this._cancelIntent="highlighted"===this.mode&&o&&!t(a)}}])&&mO(t.prototype,e),n&&mO(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function TO(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return OO(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?OO(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}function OO(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function SO(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function EO(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var PO=function(){function c(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),EO(this,"map",void 0),EO(this,"camera",void 0),EO(this,"clickController",void 0),EO(this,"container",new T.Container),EO(this,"iconContainer",new T.Container),EO(this,"terrainIcons",[]),EO(this,"troopIconContainer",new T.Container),EO(this,"cameraRect",new T.Graphics),EO(this,"viewModeText",new T.BitmapText("",Xg.smallScriptOutlined)),EO(this,"animationTimers",[]),EO(this,"_fogOfWarOpacity",1),EO(this,"_troopMode","blink"),this.map=t,this.camera=e,this.clickController=new Em(this.iconContainer),this.rebuildContents(),this.container.addChild(this.iconContainer,this.troopIconContainer,this.cameraRect,this.viewModeText),this.container.addChildAt(c.BuildBackground(this.iconContainer),0),zI.scene.ticker.add(this.update,this)}var t,e,n;return t=c,n=[{key:"BuildPreview",value:function(o){for(var a=new T.Container,t=function(i){for(var t=0;t<o.size.height;t++)(function(e){var n=o.map[e][i],t=Object.values(Tg).find(function(t){return t.serial===n});if(!t)return O1.log("Minimap","BuildPreview",{message:"Terrain type matching serial '".concat(n,"' doesn't exist.")});var r=new t,t=o.owners.find(function(t){return new Te(i,e).equals(t.location)});t&&(r.faction=t.player);r=r.getMinimapIcon();r.position.set(i*r.width,e*r.height),a.addChild(r)})(t)},e=0;e<o.size.width;e++)t(e);var n,r=TO(o.predeploy);try{for(r.s();!(n=r.n()).done;){var i=n.value,s=new Rw.Infantry;s.faction=i.player;var u=s.getMinimapIcon();a.addChild(u),s.destroy()}}catch(t){r.e(t)}finally{r.f()}return a.addChildAt(c.BuildBackground(a),0),a}},{key:"BuildBackground",value:function(t){var e=new T.Graphics;return e.beginFill(Hg.gale_force2),e.drawRect(-3,-1,t.width+6,t.height+2),e.endFill(),e}}],(e=[{key:"mapWidth",get:function(){return this.iconContainer.width}},{key:"mapHeight",get:function(){return this.iconContainer.height}},{key:"fogLightness",get:function(){return this._fogOfWarOpacity},set:function(t){this._fogOfWarOpacity=t;var e,n=cm.HSV(0,0,100*t),r=TO(this.terrainIcons);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.fog&&(i.spr.tint=n)}}catch(t){r.e(t)}finally{r.f()}}},{key:"destroy",value:function(){this.map=void 0,this.camera=void 0,this.clickController.destroy(),this.container.destroy({children:!0}),this.animationTimers.forEach(function(t){return t.destroy()}),zI.scene.ticker.remove(this.update,this)}},{key:"update",value:function(){!0===this.container.visible&&this.rebuildCameraRect()}},{key:"rebuildContents",value:function(){this.iconContainer.removeChildren().forEach(function(t){return t.destroy()}),this.troopIconContainer.removeChildren().forEach(function(t){return t.destroy()}),this.terrainIcons=[];for(var t=0;t<this.map.width;t++)for(var e=0;e<this.map.height;e++){var n,r=this.map.squareAt(new Te(t,e)),i=r.terrain.getMinimapIcon(),o=null===(a=r.unit)||void 0===a?void 0:a.getMinimapIcon(),a=i.width,a=new Te(t*a,e*a);i.position.set(a.x,a.y),this.iconContainer.addChild(i),this.terrainIcons.push({fog:r.hiddenFlag,spr:i}),o&&null!==(n=r.unit)&&void 0!==n&&n.visible&&(o.position.set(a.x,a.y),o.tint=r.unit.spent?Hg.cerebral_grey1:Hg.white,o.stop(),this.troopIconContainer.addChild(o))}this.rebuildCameraRect(),this.troopMode="blink"}},{key:"rebuildCameraRect",value:function(){var t=this.iconContainer,e=t.width,n=t.height,r=this.camera.currentTransform().worldRect().apply(function(t){return t/16*4}),i=l1.clamp(r.left,0,e),t=l1.clamp(r.top,0,n),e=l1.clamp(r.right,0,e)-i,r=l1.clamp(r.bottom,0,n)-t,n=this.cameraRect;n.clear(),n.lineStyle({width:1,color:Hg.pelati}),n.drawRect(i,t,e,r)}},{key:"show",value:function(){this.container.visible=!0}},{key:"hide",value:function(){this.container.visible=!1}},{key:"troopMode",get:function(){return this._troopMode},set:function(t){var e=this;this._troopMode=t,this.animationTimers.forEach(function(t){return t.destroy()}),this.animationTimers=[];var n=lm.quart.inOut,r=lm.quart.out,i="";({blink:function(){i="Map",e.animationTimers.push(Wm.tween(.65,e.troopIconContainer,{alpha:1},n).at("end").tween(.65,e.troopIconContainer,{alpha:.35},n).loop(),Wm.tween(.65,e,{fogLightness:.7},r),Wm.wait(5.2).tween(.125,e,{fogLightness:.65},n).wait().tween(.125,e,{fogLightness:.7},n).wait().tween(.125,e,{fogLightness:.65},n).wait().tween(.125,e,{fogLightness:.7},n).loop())},on:function(){i="Troop",e.animationTimers.push(Wm.tween(.65,e.troopIconContainer,{alpha:1},r).tween(.65/3,e,{fogLightness:.45}))},off:function(){i="Terrain",e.animationTimers.push(Wm.tween(.65,e.troopIconContainer,{alpha:0},r).tween(.65,e,{fogLightness:1},r))}})[t](),this.viewModeText.text="X ".concat(i," View"),this.viewModeText.anchor.set(1,1),this.viewModeText.position.set(this.iconContainer.width-3,-1)}}])&&SO(t.prototype,e),n&&SO(t,n),Object.defineProperty(t,"prototype",{writable:!1}),c}();function kO(t){return function(t){if(Array.isArray(t))return CO(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||AO(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function RO(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(t,e)||AO(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function AO(t,e){if(t){if("string"==typeof t)return CO(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?CO(t,e):void 0}}function CO(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function IO(t){return(IO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function MO(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function jO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?MO(Object(n),!0).forEach(function(t){LO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):MO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function DO(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function LO(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var NO="BattleSceneAssetController",FO={fogOfWar:!1,weather:yR.Clear,terrainGraphics:pR.Normal,dayLimit:-1,propertiesToWin:-1,startingFunds:0,incomePerTaxableProperty:1e3,rankUp:!0,unitLimit:50,repairHp:20,acquireHqOnCapture:!1,sharedSightMap:!1,CoUnits:!0,CoPowers:!0,CoLoadableFromHQ:!0,rigsInfiniteGas:!0,spawnMap:aT},BO=function(){function a(r,t){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),LO(this,"scenario",void 0),LO(this,"gamepad",void 0),LO(this,"stagePointer",void 0),LO(this,"camera",void 0),LO(this,"map",void 0),LO(this,"minimap",void 0),LO(this,"mapCursor",void 0),LO(this,"uiSystem",void 0),LO(this,"cmdMenu",void 0),LO(this,"shopMenu",void 0),LO(this,"fieldMenu",void 0),LO(this,"boardEvents",new xT),LO(this,"trackCar",void 0),LO(this,"instruction",void 0),LO(this,"scripts",void 0),LO(this,"players",void 0);var e=zI.display.standardLength;this.instruction={},this.resetCommandInstruction(),this.scenario=jO(jO({},FO),t),this.gamepad=new Fm,this.map=new y2(r),this.mapCursor=new L2(this.map,this.gamepad);for(var o=[],n=0;n<r.players;n++)!function(e){var t=r.owners.filter(function(t){return t.player===e}).map(function(t){return new Tm(t.location)}),n=null===(n=r.predeploy)||void 0===n?void 0:n.filter(function(t){return t.player===e}),n=new Ww({playerNumber:e,faction:[xv.Red,xv.Blue,xv.Yellow,xv.Black][e],officerSerial:e+1,map:i.map,scenario:i.scenario,capturePoints:t,unitSpawns:n});o.push(n)}(n);this.players=new rT(o);t=this.players.current.lastCursorPosition;this.mapCursor.teleportTo(t),this.camera=new fO(zI.scene.visualLayers.stage),this.camera.transform.border=new eO({left:2.5*e,right:3.5*e,top:2*e,bottom:3*e});t=this.camera.transform.worldRect();this.camera.transform.position.set((this.map.width*e-t.width)/2,(this.map.height*e-t.height)/2),this.camera.teleportToDestination(),this.camera.focalTarget=this.mapCursor.transform,this.camera.algorithms={destination:pO.ScreenPush,travel:dO.Linear};t=new T.Rectangle(0,0,zI.display.width,zI.display.height);Fv("bottom").filterArea=t,this.minimap=new PO(this.map,this.camera),this.minimap.container.position.set(zI.display.renderWidth/2-this.minimap.mapWidth/2,zI.display.renderHeight/2-this.minimap.mapHeight/2),zI.scene.visualLayers.hud.addChild(this.minimap.container),this.stagePointer=new Em(zI.scene.visualLayers.stage),this.stagePointer.enabled=!0,this.uiSystem=new Rx({gamepad:this.gamepad,cursor:this.mapCursor,camera:this.camera,map:this.map,players:this.players});t=new d9(this.gamepad);this.cmdMenu=new qb(t,Fv("ui"));t=new d9(this.gamepad,{pageLength:7});this.shopMenu=new vT(t,zI.scene.visualLayers.hud);t=new d9(this.gamepad);this.fieldMenu=new qb(t,zI.scene.visualLayers.hud);t=new T.Sprite(zI.scene.resources.background.texture);zI.scene.visualLayers.backdrop.addChild(t);this.mapCursor.on("move",function(){i.uiSystem.inspectListenerCallback()}),this.trackCar=new Ix,Iv.SortLayer("top"),Fv("ui").sortChildren(),this.scripts={cameraZoom:new Hx(this),nextOrderableUnit:new tT(this),nextTargetableUnit:new RT(this),stagePointerInterface:new wO(this),manualMoveCamera:new NT(this),hideUnits:new HT(this)},zI.scene.ticker.add(this.updateControlScripts,this),this.hidePlayerSystems()}var t,e,n;return t=a,(e=[{key:"destroy",value:function(){var r="Destruction";zI.scene.ticker.remove(this.updateControlScripts,this);Object.entries(this).forEach(function(t){var e=RO(t,2),n=e[0],t=e[1];"object"===IO(e=t)&&void 0!==e.destroy&&(O1.log(NO,r,{message:"Requesting destroy for '".concat(n,"'...")}),t.destroy())}),O1.log(NO,r,{message:"Destroying control scripts..."}),Object.values(this.scripts).forEach(function(t){return t.destroy()}),O1.log(NO,r,{message:"Finished destroying assets."})}},{key:"hidePlayerSystems",value:function(){this.minimap.hide(),this.mapCursor.resetSettings(),this.mapCursor.hide(),this.trackCar.hide(),this.uiSystem.resetSettings(),this.uiSystem.hide(),this.uiSystem.battleForecast=void 0,this.cmdMenu.hide(),this.shopMenu.hide(),this.fieldMenu.hide();var t,e=this.scripts;for(t in e){var n=e[t];n.defaultEnabled()?n.enable():n.disable()}this.camera.focalTarget=this.mapCursor,this.camera.algorithms.destination=pO.ScreenPush,this.camera.algorithms.travel=dO.Linear,this.camera.algorithms.displacement=void 0}},{key:"resetCommandInstruction",value:function(){this.instruction.action=void 0,this.instruction.which=void 0,this.instruction.place=void 0,this.instruction.path=void 0,this.instruction.focal=void 0,this.instruction.drop=[]}},{key:"updateControlScripts",value:function(){for(var t in this.scripts)this.scripts[t].update()}},{key:"allInPlayUnits",get:function(){var t,e=this.players.all.map(function(t){return t.units});return e?(t=e[0]).concat.apply(t,kO(e.slice(1))):[]}}])&&DO(t.prototype,e),n&&DO(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}();function UO(t){return(UO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function GO(n){var r=VO();return function(){var t,e=YO(n);return function(t,e){{if(e&&("object"===UO(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return XO(t)}(this,r?(t=YO(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function XO(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function HO(t){var n="function"==typeof Map?new Map:void 0;return function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return zO(t,arguments,YO(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),WO(e,t)}(t)}function zO(t,e,n){return(zO=VO()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);r=new(Function.bind.apply(t,r));return n&&WO(r,n.prototype),r}).apply(null,arguments)}function VO(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function WO(t,e){return(WO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function YO(t){return(YO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qO,KO=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&WO(t,e)}(u,HO(Error));var s=GO(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e,n,r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=XO(t),r="InstructionDataError",(n="name")in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return u}();function ZO(t,e){if(void 0===t)throw new KO("missing data: ".concat(e));return t}function QO(t){return(QO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function JO(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tS(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eS(n){var r=iS();return function(){var t,e=aS(n);return function(t,e){{if(e&&("object"===QO(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=aS(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function nS(t){var n="function"==typeof Map?new Map:void 0;return function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return rS(t,arguments,aS(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),oS(e,t)}(t)}function rS(t,e,n){return(rS=iS()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);r=new(Function.bind.apply(t,r));return n&&oS(r,n.prototype),r}).apply(null,arguments)}function iS(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function oS(t,e){return(oS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function aS(t){return(aS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(t){var l={};function e(t,e){var n=l.assets;if(!n)throw new KO("can't set instruction values before first fill()");n.instruction[e]=t}t.fill=function(t){var e=l={},n=t.instruction,r=t.map,i=n.seed,o=n.action,a=n.which,s=n.place,u=n.path,c=n.drop,n=n.focal;e.assets=t,e.seed=i,e.action=o,e.which=a,e.place=s,e.path=u,e.drop=c,e.focal=n,e.place&&(e.placeTile=r.squareAt(e.place),e.placeTerrain=e.placeTile.terrain,e.actor=e.placeTile.unit,e.path||(e.path=[]),e.goal=E9(e.path).add(e.place),e.goalTile=r.squareAt(e.goal),e.goalTerrain=e.goalTile.terrain,e.underneath=e.goalTile.unit),e.focal&&(e.focalTile=r.squareAt(e.focal),e.focalTerrain=e.focalTile.terrain,e.target=e.focalTile.unit)};t.data={set seed(t){e(t,"seed")},set action(t){e(t,"action")},set which(t){e(t,"which")},set place(t){e(t,"place")},set focal(t){e(t,"focal")},set path(t){e(t,"path")},set drop(t){e(t,"drop")},get assets(){return ZO(l.assets,"scene assets")},get seed(){return ZO(l.seed,"psuedo-random seed")},get action(){return ZO(l.action,"command serial")},get which(){return ZO(l.which,"command serial variant")},get place(){return ZO(l.place,"source location")},get placeTile(){return ZO(l.placeTile,"tile at source location")},get placeTerrain(){return ZO(l.placeTerrain,"terrain at source location")},get actor(){return ZO(l.actor,"actor object")},get path(){return ZO(l.path,"movement path")},get goal(){return ZO(l.goal,"movement terminal")},get goalTile(){return ZO(l.goalTile,"tile at movement terminal")},get goalTerrain(){return ZO(l.goalTerrain,"terrain at movement terminal")},get underneath(){return ZO(l.underneath,"object at movement terminal")},get drop(){return ZO(l.drop,"list of held units to drop")},get focal(){return ZO(l.focal,"target location")},get focalTile(){return ZO(l.focalTile,"tile at target location")},get focalTerrain(){return ZO(l.focalTerrain,"terrain at target location")},get target(){return ZO(l.target,"target object")},get plansToMove(){return this.place.notEqual(this.goal)}}}(qO=qO||{});var sS=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oS(t,e)}(r,nS(Error));var n=eS(r);function r(t,e){return tS(this,r),(e=n.call(this,"".concat(t,"  ").concat(e))).name="StateTransitionError",e}return r}(),uS=function(){function e(t){tS(this,e),JO(this,"battleSystemManager",void 0),JO(this,"assets",void 0),JO(this,"data",qO.data),JO(this,"_exit",0),JO(this,"queueChange",0),JO(this,"destroyed",!1),this.battleSystemManager=t,this.assets=t.controllers}var t,n,r;return t=e,(n=[{key:"exit",get:function(){return this._exit}},{key:"destroy",value:function(){this.onDestroy(),this.destroyed=!0,this.assets=null,this.battleSystemManager=null}},{key:"wake",value:function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).fromRegress,t=void 0!==t&&t;try{this.battleSystemManager.unqueue(this,this.queueChange),this.queueChange=0,qO.fill(this.assets),this.assets.hidePlayerSystems(),t?this.onRegress():this.onAdvance(),this.configureScene()}catch(t){O1.error(t),this.battleSystemManager.failToPreviousState(this),O1.print(this.battleSystemManager.getStackTrace())}}},{key:"failTransition",value:function(t){throw 0===this._exit&&(this._exit=-1),new sS(this.name,t)}},{key:"assertData",value:function(t,e){return null==t&&this.failTransition("Missing data: ".concat(e)),t}},{key:"onDestroy",value:function(){}},{key:"onAdvance",value:function(){}},{key:"onRegress",value:function(){}},{key:"update",value:function(){}},{key:"updateNonInterruptible",value:function(){}},{key:"close",value:function(){}},{key:"prev",value:function(){}},{key:"advance",value:function(){if(this.battleSystemManager.transitioning)console.warn("State ".concat(this.name," tried to advance during transition intent. Are we requesting multiple times?"));else{for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.queueChange=n.length,(t=this.battleSystemManager).advance.apply(t,[this].concat(n))}}},{key:"regress",value:function(){this.battleSystemManager.transitioning?console.warn("State ".concat(this.name," tried to regress during transition intent. Are we requesting multiple times?")):this.battleSystemManager.regress(this)}}])&&$O(t.prototype,n),r&&$O(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function cS(t){return(cS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lS(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hS(t,e){return(hS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function fS(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=dS(n);return function(t,e){{if(e&&("object"===cS(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return pS(t)}(this,r?(t=dS(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function pS(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dS(t){return(dS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var yS,mS,vS=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hS(t,e)}(u,uS);var t,e,n,s=fS(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e,n,r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=pS(t),r={},(n="advanceStates")in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return t=u,(e=[{key:"type",get:function(){return u}},{key:"name",get:function(){return"Null"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!0}},{key:"assert",value:function(){}},{key:"configureScene",value:function(){}},{key:"update",value:function(){}},{key:"prev",value:function(){}}])&&lS(t.prototype,e),n&&lS(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(),gS=l1.confirmType()({ScreenShake:{screenShakeSlider:new Qg,withIntensity:function(t){return this.screenShakeSlider=new Qg({max:t,track:"max",granularity:1/3,shape:function(t){return Math.ceil(.33*t)*(Math.ceil(t)%2==0?1:-1)}}),this},setIntensity:function(t){this.withIntensity(t)},get:function(){var t=new sO;return t.position.y=this.screenShakeSlider.output,this.screenShakeSlider.decrement(),t}}});function bS(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}(yS||(yS={})).progressiveTransparency=function(r){var t,i=new T.AnimatedSprite(r.textures);return i.animationSpeed=null!==(t=r.animationSpeed)&&void 0!==t?t:.25,i.loop=!1,i.onFrameChange=function(){var t=null!==(n=r.easeMethod)&&void 0!==n?n:function(t){return t},e=i.textures.length||1,n=1-(null!==(n=r.alphaFloor)&&void 0!==n?n:.1),e=t(i.currentFrame/e);i.alpha=1-e*n},i.onComplete=function(){i.destroy()},i},(mS||(mS={})).explosion=function(t){return yS.progressiveTransparency({textures:t,animationSpeed:.2,alphaFloor:.35,easeMethod:lm.quad.in})};var xS=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_S(this,"location",void 0),_S(this,"_playing",!1),_S(this,"_finished",!1),this.location=t}var t,n,r;return t=e,(n=[{key:"playing",get:function(){return this._playing&&!this._finished}},{key:"finished",get:function(){return this._finished}},{key:"finish",value:function(){this._finished=!0,this.stop()}},{key:"play",value:function(){var t=this;this._playing=!0,this._finished=!1,this.create(),zI.scene.ticker.add(this.updateWrapper,this),zI.workOrders.send(function(){if(t.finished)return t.stop(),!0})}},{key:"updateWrapper",value:function(){this._finished||this.update()}},{key:"stop",value:function(){this._playing&&(this._playing=!1,this.finish(),this.destroy(),zI.scene.ticker.remove(this.updateWrapper,this))}}])&&bS(t.prototype,n),r&&bS(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function wS(t){return(wS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function TS(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function OS(t,e){return(OS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function SS(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=PS(n);return function(t,e){{if(e&&("object"===wS(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return ES(t)}(this,r?(t=PS(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function ES(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PS(t){return(PS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kS(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var RS=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&OS(t,e)}(i,xS);var t,e,n,r=SS(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),kS(ES(e=r.call(this,t.defender.boardLocation)),"options",void 0),kS(ES(e),"selfSetCameraAlg",!1),e.options=t,e}return t=i,(e=[{key:"create",value:function(){var t,e=this,n=this.options.assets,r=(n.map,n.camera),i=this.options,o=i.attacker,a=i.defender,s=i.damage,n=i.trackCar,i=Math.min(a.hp,s);a.hp-=s,o&&0<o.hp&&(o.attackMethodFor(a)===bv.Primary&&--o.ammo,o.withinCoZone&&o.boardPlayer.increasePowerMeter(i),0===a.hp&&(o.rank+=1)),this.selfSetCameraAlg=void 0===r.algorithms.displacement,this.selfSetCameraAlg&&(r.algorithms.displacement=gS.ScreenShake.withIntensity(6)),0!==i?(o=a.boardLocation.multiply(zI.display.standardLength),(r={})[_v.Ground]="dry",r[_v.Naval]="wet",r[_v.Air]="air",i=r[a.unitClass],r="explosion-".concat(i),i=0===a.hp,r=zI.scene.resources.VFXSpritesheet.spritesheet.animations[i?r:"damage-hit"],t=mS.explosion(r),i||(t.animationSpeed=.5),t.position.set(o.x,o.y),t.play(),t.onComplete=function(){t.destroy(),e.finish()},0===a.hp&&(a.destroy(),null!=n&&n.hide()),Fv("ui").addChild(t)):this.finish()}},{key:"update",value:function(){}},{key:"destroy",value:function(){var t=this.options.assets.camera;this.selfSetCameraAlg&&(t.algorithms.displacement=void 0)}}])&&TS(t.prototype,e),n&&TS(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function AS(t){return(AS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function CS(t,e){return(CS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function IS(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=MS(n);return function(t,e){{if(e&&("object"===AS(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=MS(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function MS(t){return(MS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var jS=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&CS(t,e)}(n,RS);var e=IS(n);function n(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,{defender:t.unit,damage:t.unit.hp,assets:t.assets})}return n}();function DS(t){return(DS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function LS(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function NS(t,e){return(NS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function FS(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=US(n);return function(t,e){{if(e&&("object"===DS(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return BS(t)}(this,r?(t=US(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function BS(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function US(t){return(US=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var GS=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&NS(t,e)}(u,uS);var t,e,n,s=FS(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e,n,r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=BS(t),r=void 0,(n="cursorPosSwap")in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return t=u,(e=[{key:"type",get:function(){return u}},{key:"name",get:function(){return"AnimateEvents"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!0}},{key:"configureScene",value:function(){var t=this.assets,e=t.mapCursor,t=t.trackCar;this.cursorPosSwap=e.boardLocation,t.started&&t.show()}},{key:"update",value:function(){var t=this.assets,e=t.boardEvents,n=t.mapCursor,r=t.camera;e.eventsInQueue?(t=e.boardLocation||n.boardLocation,n.boardLocation.notEqual(t)&&n.teleportTo(new Tm(t)),!r.subjectInView||e.batchPlaying||e.batchFinished?e.batchFinished&&e.next():e.batchPlay()):this.advance()}},{key:"close",value:function(){this.assets.mapCursor.teleportTo(this.cursorPosSwap),this.cursorPosSwap=void 0}}])&&LS(t.prototype,e),n&&LS(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}();function XS(t){return(XS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function HS(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zS(t,e){return(zS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function VS(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=WS(n);return function(t,e){{if(e&&("object"===XS(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=WS(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function WS(t){return(WS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var YS,qS=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zS(t,e)}(i,Wm);var t,e,n,r=VS(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"updateTicker",get:function(){return zI.globalTicker}}])&&HS(t.prototype,e),n&&HS(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function KS(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ZS(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}(T_=YS=YS||{})[T_.Standby=0]="Standby",T_[T_.In=1]="In",T_[T_.Idle=2]="Idle",T_[T_.Out=3]="Out",T_[T_.Tail=4]="Tail",T_[T_.Finished=5]="Finished";var QS,$S=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ZS(this,"phaseIn",void 0),ZS(this,"idleLoop",void 0),ZS(this,"phaseOut",void 0),ZS(this,"destroyLastSceneDuringIdle",!0),ZS(this,"_phase",YS.Standby),ZS(this,"overlayer",void 0),ZS(this,"lastScene",void 0),ZS(this,"nextScene",void 0)}var e,n,r;return e=t,(n=[{key:"destroy",value:function(){}},{key:"phase",get:function(){return this._phase}},{key:"idling",get:function(){return this._phase===YS.Idle}},{key:"busy",get:function(){var t=YS.In,e=YS.Idle,n=YS.Out;return this._phase===t||this._phase===e||this._phase===n}},{key:"finished",get:function(){return this._phase===YS.Finished}},{key:"init",value:function(t,e,n){this.overlayer=t,this.lastScene=e,this.nextScene=n}},{key:"update",value:function(t){function e(t,e){function n(){return i._phase=e}var r=(t={timer:(r=t)instanceof qS?r:void 0,workOrder:r instanceof qS?void 0:r}).timer,t=t.workOrder;r&&!r.started&&(r.at("end").do(n),r.start()),t&&t()&&n()}var i=this;this.phase===YS.In?e(this.phaseIn,YS.Idle):this.phase===YS.Idle?this.idleLoop(t):this.phase!==YS.Out&&this.phase!==YS.Tail||e(this.phaseOut,YS.Finished)}},{key:"start",value:function(){this._phase===YS.Standby&&(this.build(),this._phase=YS.In)}},{key:"loadComplete",value:function(){this._phase===YS.Idle&&(this._phase=YS.Out)}},{key:"releaseBusyStatus",value:function(){this._phase===YS.Out&&(this._phase=YS.Tail)}}])&&KS(e.prototype,n),r&&KS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function JS(t){return(JS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function t3(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e3(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n3(t,e,n){return e&&e3(t.prototype,e),n&&e3(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function r3(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i3(t,e)}function i3(t,e){return(i3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function o3(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=s3(n);return function(t,e){{if(e&&("object"===JS(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return a3(t)}(this,r?(t=s3(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function a3(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s3(t){return(s3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u3(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c3(t){return(c3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l3(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h3(t,e){return(h3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function f3(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=p3(n);return function(t,e){{if(e&&("object"===c3(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=p3(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function p3(t){return(p3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}ZS($S,"Phase",YS),function(t){var e=function(){r3(o,$S);var i=o3(o);function o(){var t;t3(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return u3(a3(t=i.call.apply(i,[this].concat(n))),"phaseIn",new qS),u3(a3(t),"idleLoop",function(){}),u3(a3(t),"phaseOut",new qS),t}return n3(o,[{key:"build",value:function(){}}]),o}();t.None=e;e=function(){r3(o,$S);var i=o3(o);function o(){var t;t3(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return u3(a3(t=i.call.apply(i,[this].concat(n))),"phaseIn",new qS),u3(a3(t),"idleLoop",function(){}),u3(a3(t),"phaseOut",new qS),t}return n3(o,[{key:"build",value:function(){var t=zI.display,e=t.renderWidth,n=t.renderHeight,t=new T.Graphics;t.beginFill(0),t.drawRect(0,0,e,n),t.endFill(),this.overlayer.addChild(t),this.overlayer.alpha=0;this.phaseIn.tween(.15,this.overlayer,{alpha:1}),this.phaseOut.tween(.15,this.overlayer,{alpha:0})}}]),o}();t.BlackFade=e;e=function(){r3(o,$S);var i=o3(o);function o(){var t;t3(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return u3(a3(t=i.call.apply(i,[this].concat(n))),"destroyLastSceneDuringIdle",!1),u3(a3(t),"phaseIn",new qS),u3(a3(t),"idleLoop",function(){}),u3(a3(t),"phaseOut",new qS),t}return n3(o,[{key:"build",value:function(){var t=Math.random,e=Math.trunc,n=zI.display,r=n.renderWidth,n=n.renderHeight;new Tm(e(t()*(r-64)+32),e(t()*(n-64)+32))}}]),o}();t.BurnAway=e}(QS=QS||{});var d3=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h3(t,e)}(i,uS);var t,e,n,r=f3(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"GameEnd"}},{key:"revertible",get:function(){return!1}},{key:"skipOnUndo",get:function(){return!1}},{key:"configureScene",value:function(){zI.transitionToScene(PI,new QS.None)}}])&&l3(t.prototype,e),n&&l3(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function y3(t){return(y3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m3(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v3(t,e){return(v3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function g3(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=b3(n);return function(t,e){{if(e&&("object"===y3(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=b3(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function b3(t){return(b3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _3=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v3(t,e)}(i,uS);var t,e,n,r=g3(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"GameLose"}},{key:"revertible",get:function(){return!1}},{key:"skipOnUndo",get:function(){return!1}},{key:"configureScene",value:function(){var e=this,t=zI.display.renderWidth,n=zI.display.renderHeight,r=new T.Container,i=new T.Graphics;i.beginFill(0,.5),i.drawRect(0,0,t,12),i.endFill();var o=i.clone();o.y=12,i.x=-t,o.x=t,r.addChild(i,o),r.y=n/2,r.pivot.y=r.height/2;n=new T.BitmapText("LOSE",Xg.title);n.anchor.set(.6),n.position.set(t/2,r.height/2),n.alpha=0,r.addChild(n),zI.hud.addChild(r);Wm.at(.15).tween(.2,i,{x:0},lm.sine.inOut).tween(.2,o,{x:0},lm.sine.inOut).wait(.065).tween(.135,n,{alpha:1},lm.sine.inOut).wait().wait(1.3).tween(.2,r,{alpha:.7},lm.sine.inOut).tween(.2,r,{scale:{y:0}}).tween(.2,n,{skew:{x:-1}}).at("end").do(function(t){return e.advance(d3)})}}])&&m3(t.prototype,e),n&&m3(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function x3(t){return(x3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w3(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function T3(t,e){return(T3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function O3(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=S3(n);return function(t,e){{if(e&&("object"===x3(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=S3(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function S3(t){return(S3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var E3=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&T3(t,e)}(i,uS);var t,e,n,r=O3(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"GameWin"}},{key:"revertible",get:function(){return!1}},{key:"skipOnUndo",get:function(){return!1}},{key:"configureScene",value:function(){var e=this,t=zI.display.renderWidth,n=zI.display.renderHeight,r=new T.Container,i=new T.Graphics;i.beginFill(0,.5),i.drawRect(0,0,t,12),i.endFill();var o=i.clone();o.y=12,i.x=-t,o.x=t,r.addChild(i,o),r.y=n/2,r.pivot.y=r.height/2;var a=new T.BitmapText("WIN",Xg.title);a.anchor.set(.6),a.position.set(t/2,r.height/2),a.alpha=0,r.addChild(a);var s=new T.Graphics;s.beginFill(8947848),s.drawRect(0,0,t,n),s.endFill(),s.alpha=0,s.blendMode=T.BLEND_MODES.ADD;var u=new T.Graphics;u.beginFill(16777215),u.drawRect(0,0,t,n),u.endFill(),u.alpha=0,u.blendMode=T.BLEND_MODES.SCREEN,zI.hud.addChild(r,s,u);Wm.at(.15).tween(.2,i,{x:0},lm.sine.inOut).tween(.2,o,{x:0},lm.sine.inOut).wait(.065).tween(.135,a,{alpha:1},lm.sine.inOut).wait().wait(1.3).tween(.2,r,{alpha:.7},lm.sine.inOut).tween(.2,r,{scale:{y:0}}).tween(.2,a,{skew:{x:-1}}).at(1.25).tween(2,s,{alpha:1},lm.sine.in).tween(2,u,{alpha:1},lm.sine.in).at("end").wait(1).do(function(t){return e.advance(d3)})}}])&&w3(t.prototype,e),n&&w3(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function P3(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k3(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function R3(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var A3=function(){function u(){P3(this,u)}var t,e,n;return t=u,n=[{key:"SetSeed",value:function(e){u.Random=function(){var t=e+=1831565813,t=Math.imul(t^t>>>15,1|t);return(((t^=t+Math.imul(t^t>>>7,61|t))^t>>>14)>>>0)/4294967296}}},{key:"AttackPowerBonus",value:function(t,e){var n=Math.ceil,r=t.unit.boardPlayer,i=[0,5,10,20][t.unit.rank],e=n(e*n(t.HP/10+1))-1,n=5*r.comTowerCount;return 100+i+(r.withinCoRange(t.from)?r.officer.getBonusStats(t.unit).attack:0)+e+n}},{key:"DefensePowerBonus",value:function(t){var e=Math.ceil,n=t.unit.boardPlayer,r=3==t.unit.rank?20:0,i=t.square.terrain.defenseRating*e(t.HP/10),e=5*n.comTowerCount;return 100+r+(n.withinCoRange(t.from)?n.officer.getBonusStats(t.unit).defense:0)+i+e}},{key:"NormalAttackFormula",value:function(t,e,n){var r=Math.ceil,i=r(t.HP/10)/10,n=u.AttackPowerBonus(t,n)/u.DefensePowerBonus(e);return r(t.unit.baseDamage(e.unit)*i*n)}},{key:"NormalTerrainAttackFormula",value:function(t,e){var n=Math.ceil,r=n(t.HP/10)/10;return n(110*r*(u.AttackPowerBonus(t,e)/100))}},{key:"NormalAttack",value:function(t,e,n,r,i){u.SetSeed(i);var o=u.NormalAttackFormula,a=new C3(t,e,n),s=new C3(t,r),i=new C3(t,r),e=u.Random(),t=u.Random(),r=o(a,s,.5),e=o(a,s,e),n=s.unit.canCounterAttack(a.unit,n);i.HP=Math.max(i.HP-r,0);i=o(i,a,.5)*Number(n);return s.HP=Math.max(s.HP-e,0),{damage:e,counter:o(s,a,t)*Number(n),estimate:{damage:r,counter:i}}}},{key:"TerrainAttack",value:function(t,e,n,r,i){u.SetSeed(i);i=u.NormalTerrainAttackFormula,t=new C3(t,e,n),e=u.Random(),n=i(t,.5);return{damage:i(t,e),counter:0,estimate:{damage:n,counter:0}}}}],(e=null)&&k3(t.prototype,e),n&&k3(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}();R3(A3,"Random",function(){return O1.error("Called DamageScript.Random() without .SetSeed()"),0});var C3=function t(e,n,r){P3(this,t),R3(this,"unit",void 0),R3(this,"from",void 0),R3(this,"square",void 0),R3(this,"HP",void 0),this.unit=n,this.from=r||n.boardLocation,this.square=e.squareAt(this.from),this.HP=n.hp};function I3(t){return(I3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function M3(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function j3(t,e){return(j3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function D3(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=N3(n);return function(t,e){{if(e&&("object"===I3(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return L3(t)}(this,r?(t=N3(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function L3(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function N3(t){return(N3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var F3,B3=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j3(t,e)}(a,xS);var t,e,n,o=D3(a);function a(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),e=o.call(this,t.location),n=L3(e),i=void 0,(r="options")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e.options=t,e}return t=a,(e=[{key:"ratify",value:function(){var t,e=this.options.actor,n=this.options.assets.players;e.CoOnBoard=!0,e.rank=3,null!==(t=n.perspectivesTurn)&&void 0!==t&&t.setCoBoardableIndicators(),n.current.expendFunds(e.adjustedCost)}},{key:"create",value:function(){var t=this.options.assets.players,e=this.options.location;null!==(t=t.perspectivesTurn)&&void 0!==t&&t.clearCoBoardableIndicators();var t=zI.display.standardLength,e=e.multiply(t).add(t/4,3*t/4),t=zI.scene.texturesFrom("UISpritesheet")["icon-co-badge.png"],n=new T.Sprite(t);n.anchor.set(.5),n.scale.set(1.65),n.alpha=0,n.position.set(e.x,e.y),Fv("ui").addChild(n),Wm.at(.15).tween(.03,n,{alpha:1}).tween(.125,n,{scale:{x:1,y:1}}).at("end").do(this.ratify,this).wait(.35).do(function(t){return n.destroy()}).do(this.finish,this)}},{key:"update",value:function(){}},{key:"destroy",value:function(){}}])&&M3(t.prototype,e),n&&M3(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}();function U3(t){return(U3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function G3(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function X3(t,e){return(X3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function H3(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=V3(n);return function(t,e){{if(e&&("object"===U3(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return z3(t)}(this,r?(t=V3(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function z3(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function V3(t){return(V3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function W3(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}(yR=F3=F3||{}).drawRect=function(t,e,n,r){return t.beginFill(n,null!=r?r:1),t.drawRect(e.x,e.y,e.width,e.height),t.endFill(),t},yR.drawLine=function(t,e,n,r,i){return t};var Y3=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&X3(t,e)}(i,xS);var t,e,n,r=H3(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),W3(z3(e=r.call(this,t.actor.boardLocation)),"options",void 0),W3(z3(e),"illustration",void 0),W3(z3(e),"terrainName",void 0),e.options=t,e.illustration=t.terrain.illustration,e.terrainName=t.terrain.name,e}return t=i,(e=[{key:"captureProperty",value:function(){var t=this.options.assets,e=t.map,n=t.players,r=this.options,t=r.actor,r=r.terrain;t.buildingCaptured()&&(t.stopCapturing(),r.faction=t.faction,e.revealSightMapLocation(t.boardLocation,n.perspective))}},{key:"ratify",value:function(){this.options.actor.captureBuilding(),this.captureProperty()}},{key:"create",value:function(){var n=F3.drawRect,t=this.options,e=t.actor,r=t.terrain,i=this.illustration,o=S_(r.faction).propertyCapture,a=S_(e.faction).propertyCapture,s=o.meter,u=a.meter,t=Hg.gale_force1,c=e.capture;e.captureBuilding();var l=e.capture,r=new S2(0,0,88,61),h=3,f=new S2(r.width-17,r.height-h,16,h-1);i.position.set(1),i.tint=o.tint,i.scale.x=(r.width-3-f.width)/i.width,i.scale.y=(r.height-2-16)/i.height;var p=new T.BitmapText("".concat(l," / 20"),Xg.scriptOutlined);p.anchor.set(.4,.6),p.position.set(i.width/2,i.height/2),p.alpha=0;var d=new T.BitmapText("Captured!",Xg.title);d.anchor.set(.4,.6),d.position.set(i.width/2,i.height/2),d.alpha=0,i.addChild(p,d);o=new T.BitmapText(this.terrainName,Xg.title);o.anchor.set(.4,0),o.position.set(i.width/2+2,i.y+i.height+1);var y=new T.Graphics;n(y,r,t),y.position.set(zI.display.renderWidth/2,zI.display.renderHeight/2),y.pivot.set(y.width/2,y.height/2);for(var m=new T.Graphics,v=0;v<20;v++)n(m,f.move(0,-h*v),s);for(var g=new T.Graphics,b=0;b<c;b++)n(g,f.move(0,-h*b),u);y.addChild(i,o),y.addChild(m,g),zI.hud.addChild(y);for(var _=Wm.wait(),x=.05,w=c;w<l;w++)!function(e){_.wait(x).do(function(t){return n(g,f.move(0,-h*e),u)})}(w);_.at("end").do(function(){e.buildingCaptured()?(i.tint=a.tint,d.alpha=1):p.alpha=1}).do(this.captureProperty,this).wait(.65).do(function(t){return y.destroy({children:!0})}).do(this.finish,this)}},{key:"update",value:function(){}},{key:"destroy",value:function(){}}])&&G3(t.prototype,e),n&&G3(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function q3(t){return(q3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function K3(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Z3(t,e){return(Z3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Q3(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=J3(n);return function(t,e){{if(e&&("object"===q3(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return $3(t)}(this,r?(t=J3(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function $3(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function J3(t){return(J3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var tE=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Z3(t,e)}(a,Y3);var t,e,n,o=Q3(a);function a(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),e=o.call(this,t),n=$3(e),i=void 0,(r="newTerrType")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e.newTerrType=t.terrain.type===Tg.Beach?Tg.TempPort:Tg.TempAirpt,e.illustration=(new e.newTerrType).illustration,e.terrainName=e.newTerrType.name,e}return t=a,(e=[{key:"captureProperty",value:function(){var t=this.options.assets,e=t.map,n=t.players,t=this.options.actor;t.buildingCaptured()&&(t.stopCapturing(),e.changeTile(t.boardLocation,this.newTerrType).terrain.faction=t.faction,e.revealSightMapLocation(t.boardLocation,n.perspective),--t.ammo)}}])&&K3(t.prototype,e),n&&K3(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}();function eE(t){return(eE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rE(t,e){return(rE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function iE(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=aE(n);return function(t,e){{if(e&&("object"===eE(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return oE(t)}(this,r?(t=aE(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function oE(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function aE(t){return(aE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sE(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var uE=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rE(t,e)}(i,xS);var t,e,n,r=iE(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),sE(oE(e=r.call(this,t.location)),"options",void 0),sE(oE(e),"vfx",void 0),e.options=t,e}return t=i,(e=[{key:"ratify",value:function(){var t=this.options.unit;t.hiding=!t.hiding}},{key:"create",value:function(){var t=this.options,e=t.unit,n=t.anim,t=zI.display.standardLength,n=zI.scene.resources.VFXSpritesheet.spritesheet.animations[n];n.push(T.Texture.EMPTY),this.vfx=new T.AnimatedSprite(n);e.boardLocation.multiply(t);this.vfx.animationSpeed=.25,this.vfx.loop=!1,this.vfx.play(),this.ratify(),e.sprite.addChild(this.vfx)}},{key:"update",value:function(){var t=this.vfx.textures.length-1,e=this.vfx.currentFrame;this.vfx.alpha=.8-e/t/2,e===t&&this.finish()}},{key:"destroy",value:function(){var t;null!==(t=this.vfx)&&void 0!==t&&t.destroy(),this.options=void 0}}])&&nE(t.prototype,e),n&&nE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function cE(t){return(cE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lE(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function hE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fE(t,e){return(fE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function pE(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=yE(n);return function(t,e){{if(e&&("object"===cE(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return dE(t)}(this,r?(t=yE(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function dE(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yE(t){return(yE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mE(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var vE=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fE(t,e)}(i,xS);var t,e,n,r=pE(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),mE(dE(e=r.call(this,t.actor.boardLocation)),"options",void 0),mE(dE(e),"dropCars",void 0),e.options=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lE(Object(n),!0).forEach(function(t){mE(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t),e}return t=i,(e=[{key:"ratifyDrop",value:function(){var t=this.options.assets,n=t.map,r=t.players,t=this.options,i=t.actor,t=t.drop;0!==t.length&&t.sort(function(t,e){return e.which-t.which}).forEach(function(t){var e=i.unloadUnit(t.which);n.placeUnit(e,t.where),n.revealSightMapLocation(t.where,r.perspective,e),e.spent=!0})}},{key:"create",value:function(){var t=this.options,r=t.actor,t=t.drop;this.dropCars=t.map(function(t){var e=r.cargo[t.which],n=S9(t.where.subtract(r.boardLocation));if(n===w9.None)throw new Error("Cannot determine drop path from ".concat(r.boardLocation.toString()," to ").concat(t.where.toString()));t=new Ix;return t.buildNewAnimation(e,r.boardLocation),t.directions=[n],t.show(),t.start(),t})}},{key:"update",value:function(){this.dropCars.every(function(t){return t.finished})&&(this.ratifyDrop(),this.finish())}},{key:"destroy",value:function(){this.dropCars.forEach(function(t){return t.destroy()}),this.options=void 0}}])&&hE(t.prototype,e),n&&hE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function gE(t){return(gE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _E(t,e){return(_E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function xE(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=TE(n);return function(t,e){{if(e&&("object"===gE(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return wE(t)}(this,r?(t=TE(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function wE(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function TE(t){return(TE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var OE,SE=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_E(t,e)}(a,xS);var t,e,n,o=xE(a);function a(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),e=o.call(this,t.location),n=wE(e),i=void 0,(r="options")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e.options=t,e}return t=a,(e=[{key:"ratify",value:function(){var e=this.options.assets.map,t=this.options,n=t.actor,r=t.location;--n.ammo,qk.Flare.effectAreaMap.points.forEach(function(t){t=t.add(r);e.validPoint(t)&&(e.squareAt(t).hiddenFlag=!1)})}},{key:"create",value:function(){var r=this,i=(this.options.assets.map,this.options.location),t=zI.display.standardLength,e=2*t,n=i.multiply(t).add(t/2),o=n.add(0,-e),a=zI.scene.texturesFrom("VFXSpritesheet"),s=zI.scene.animationsFrom("VFXSpritesheet"),t=function(t){return s["flare/flare-shimmer-".concat(t)]},u={start:t("spark"),bright:t("bright"),mid:t("mid"),dim:t("dim")},c=new T.AnimatedSprite(u.start);c.animationSpeed=1/3,c.position.set(o.x,o.y),c.alpha=0,c.loop=!1;function l(t){c.textures=t,c.loop=!0,c.play()}var h=new T.Sprite(a["flare/flare-blast.png"]);h.position.set(n.x,n.y),h.scale.set(.1),h.alpha=0;function f(e){var t=r.options.assets.map,n=qk.Flare.effectAreaMap;t.squaresFrom(i,n).filter(function(t){return i.manhattanDistance(t)===e}).forEach(function(t){return t.hiddenFlag=!1})}Fv("ui").addChild(c,h);Wm.wait(.3).tween(1.75,c,{y:c.y+e}).do(function(t){c.alpha=1,c.play()}).do(function(){var t=new T.AnimatedSprite(s["flare/flare-ignite"]);t.animationSpeed=.25,t.position.set(c.x,c.y),t.loop=!1,t.play(),t.onComplete=function(){return t.destroy()},Fv("ui").addChild(t)}).at("end").label("descend-finish").at(.25).every({gap:.5,max:3},function(){var t=new T.AnimatedSprite(s["flare/flare-smoke-poof"]);t.animationSpeed=1/8,t.position.set(c.x,c.y),t.loop=!1,t.play(),t.onComplete=function(){return t.destroy()},Fv("ui").addChild(t)}).do(function(t){return l(u.bright)}).wait(.5).do(function(t){return l(u.mid)}).wait(.5).do(function(t){return l(u.dim)}).at("descend-finish").do(function(t){return c.destroy()}).do(function(t){return h.alpha=1}).tween(.5,h,{scale:{x:1,y:1},alpha:0}).wait().do(function(t){return h.destroy()}).at("descend-finish").do(function(t){return f(0)}).wait(.5/3).do(function(t){return f(1)}).wait(.5/3).do(function(t){return f(2)}).at("end").do(this.ratify,this).do(this.finish,this)}},{key:"update",value:function(){}},{key:"destroy",value:function(){}}])&&bE(t.prototype,e),n&&bE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}();function EE(t){return(EE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function PE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function kE(t,e){return(kE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function RE(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=CE(n);return function(t,e){{if(e&&("object"===EE(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return AE(t)}(this,r?(t=CE(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function AE(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function CE(t){return(CE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}(pR=OE=OE||{})[pR.Left=-1]="Left",pR[pR.Right=1]="Right";var IE=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kE(t,e)}(a,xS);var t,e,n,o=RE(a);function a(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),e=o.call(this,t.location),n=AE(e),i=void 0,(r="options")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e.options=t,e}return t=a,(e=[{key:"create",value:function(){var t=this,e=this.options,n=e.location,r=e.side,e=zI.display.standardLength,n=n.multiply(e);r===OE.Right&&(n.x+=e/2);var e=zI.scene.resources.VFXSpritesheet.spritesheet.animations,i=new T.AnimatedSprite(e["flare/flare-shot"]);i.animationSpeed=.25,i.position.set(n.x,n.y),i.loop=!1,i.alpha=0,i.onComplete=function(){i.destroy(),t.finish()},Fv("ui").addChild(i),Wm.wait(.4).do(function(t){i.alpha=1,i.play()}).wait(.6).do(this.finish,this)}},{key:"update",value:function(){}},{key:"destroy",value:function(){}}])&&PE(t.prototype,e),n&&PE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}();function ME(t){return(ME="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function DE(t,e){return(DE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function LE(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=FE(n);return function(t,e){{if(e&&("object"===ME(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return NE(t)}(this,r?(t=FE(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function NE(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function FE(t){return(FE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function BE(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var UE,GE,XE=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&DE(t,e)}(i,xS);var t,e,n,r=LE(i);function i(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),BE(NE(e=r.call(this,t.location)),"options",void 0),BE(NE(e),"postTimer",void 0);t=(e.options=t).present;return e.postTimer=(new Wm).at(t?.2:0).do(function(t){return e.options.ratify.call(e.options.context)}).at(t?.6:0).do(function(t){return e.finish()}),e}return t=i,(e=[{key:"create",value:function(){this.postTimer.start()}},{key:"update",value:function(){}},{key:"destroy",value:function(){this.options=void 0}}])&&jE(t.prototype,e),n&&jE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function HE(t){return(HE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zE(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return VE(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?VE(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}function VE(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function WE(n){var r=ZE();return function(){var t,e=$E(n);return function(t,e){{if(e&&("object"===HE(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return YE(t)}(this,r?(t=$E(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function YE(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qE(t){var n="function"==typeof Map?new Map:void 0;return function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return KE(t,arguments,$E(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),QE(e,t)}(t)}function KE(t,e,n){return(KE=ZE()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);r=new(Function.bind.apply(t,r));return n&&QE(r,n.prototype),r}).apply(null,arguments)}function ZE(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function QE(t,e){return(QE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function $E(t){return($E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function JE(t){return(JE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tP(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function eP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nP(t,e){return(nP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function rP(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=oP(n);return function(t,e){{if(e&&("object"===JE(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return iP(t)}(this,r?(t=oP(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function iP(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oP(t){return(oP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function aP(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}T_=UE=UE||{},yR=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&QE(t,e)}(u,qE(Error));var s=WE(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e,n,r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=YE(t),r="RatificationError",(n="name")in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return u}(),T_.RatificationError=yR,(yR=GE=GE||{})[yR.Success=0]="Success",yR[yR.Interrupted=1]="Interrupted",yR[yR.SchedulingFault=2]="SchedulingFault",T_.ExitCode=GE,(yR=mR=mR||{})[yR.Primary=0]="Primary",yR[yR.Secondary=1]="Secondary",yR[yR.Tertiary=2]="Tertiary",yR[yR.Quaternary=3]="Quaternary",yR[yR.Context1=4]="Context1",yR[yR.Context2=5]="Context2",yR[yR.Wait=6]="Wait",yR[yR.Unpreferred=7]="Unpreferred",yR[yR.None=8]="None",T_.Weight=mR,T_.getCommandObject=function(e){var t=Object.values(qk).find(function(t){return t.serial===e});if(!t)throw new Error("could not retrieve command object for serial ".concat(e));return t},T_.scheduleEvents=function(t){var e,n=zE(t.chain);try{for(n.s();!(e=n.n()).done;)if(e.value.scheduleEvent()!==GE.Success)break}catch(t){n.e(t)}finally{n.f()}};var sP=UE.RatificationError,uP=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nP(t,e)}(i,xS);var t,e,n,r=rP(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),aP(iP(e=r.call(this,t.target||t.goal)),"options",void 0),aP(iP(e),"focalSwap",void 0),aP(iP(e),"goalWorldPosition",void 0),e.options=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tP(Object(n),!0).forEach(function(t){aP(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tP(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t),e.goalWorldPosition=t.goal.multiply(zI.display.standardLength),e}return t=i,(e=[{key:"ratifySightMapChanges",value:function(t,e){for(var n=this.options.assets,r=n.map,i=n.players,o=this.options.actor,a=0;a<e.length;a++){var s=t.add(E9(e.slice(0,a+1)));r.revealSightMapLocation(s,i.perspective,o)}}},{key:"ratifyMovement",value:function(){var t=this.options.assets,e=t.map,n=t.scenario,r=(t.players,this.options),i=r.actor,o=r.path,t=r.goal,r=i.boardLocation;if(!e.moveUnit(r,t))throw new sP("could not move unit ".concat(r.toString(),"  ").concat(t.toString()));i.type===Rw.Rig&&n.rigsInfiniteGas||(i.gas-=e.travelCostForPath(r,o,i.moveType)),this.ratifySightMapChanges(r,o)}},{key:"create",value:function(){var t=this.options.assets,e=t.mapCursor,n=t.trackCar,r=t.camera,i=this.options,o=i.actor,t=i.path;i.target&&(e.mode="target",e.show());i=zI.display.standardLength,e=r.transform.worldRect(),i=new S2(n.transform,i,i),i=e.intersects(i);this.focalSwap=r.focalTarget,r.focalTarget=i?{position:this.goalWorldPosition}:n.transform,n.buildNewAnimation(o),n.directions=t,n.show(),n.start(),o.visible=!1}},{key:"update",value:function(){this.options.assets.trackCar.finished&&(this.ratifyMovement(),this.finish())}},{key:"destroy",value:function(){var t=this.options.assets,e=t.mapCursor,n=t.camera,r=t.trackCar,i=this.options,t=i.actor;i.target&&(e.mode="point",e.hide()),n.focalTarget=this.focalSwap,r.reset(),r.hide(),t.visible=!0,this.options=void 0,this.focalSwap=void 0}}])&&eP(t.prototype,e),n&&eP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function cP(t){return(cP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hP(t,e){return(hP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function fP(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=dP(n);return function(t,e){{if(e&&("object"===cP(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return pP(t)}(this,r?(t=dP(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function pP(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dP(t){return(dP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var yP=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hP(t,e)}(a,uP);var t,e,n,o=fP(a);function a(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),e=o.call(this,t),n=pP(e),i=void 0,(r="options")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e.options=t,e}return t=a,(e=[{key:"ratifyMovement",value:function(){var t=this.options.assets.players,e=this.options,n=e.actor,r=e.path,i=e.other;function o(t){return 10*Math.ceil(.1*t)}this.ratifySightMapChanges(n.boardLocation,r);var a=n.hp,s=n.gas,e=n.ammo,r=o(a)+o(i.hp),a=Math.max(r-G2,0)/G2*n.cost;t.current.funds+=a;t=Math.max(n.rank,i.rank),a=n.CoOnBoard||i.CoOnBoard;i.hp=r,i.gas+=s,i.ammo+=e,i.rank=t,i.CoOnBoard=a,n.destroy(),i.spent=!0}}])&&lP(t.prototype,e),n&&lP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}();function mP(t){return(mP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gP(t,e){return(gP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function bP(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=xP(n);return function(t,e){{if(e&&("object"===mP(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return _P(t)}(this,r?(t=xP(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function _P(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xP(t){return(xP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wP=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gP(t,e)}(a,uP);var t,e,n,o=bP(a);function a(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),e=o.call(this,t),n=_P(e),i=void 0,(r="options")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e.options=t,e}return t=a,(e=[{key:"ratifyMovement",value:function(){var t=this.options.assets,e=t.map,n=t.scenario,r=this.options,i=r.actor,t=r.path,r=r.underneath;this.ratifySightMapChanges(i.boardLocation,t),i.type===Rw.Rig&&n.rigsInfiniteGas||(i.gas-=e.travelCostForPath(i.boardLocation,t,i.moveType)),e.removeUnit(i.boardLocation),r.loadUnit(i),i.spent=!0}}])&&vP(t.prototype,e),n&&vP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}();function TP(t){return(TP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function OP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function SP(t,e){return(SP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function EP(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=kP(n);return function(t,e){{if(e&&("object"===TP(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return PP(t)}(this,r?(t=kP(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function PP(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kP(t){return(kP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var RP=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&SP(t,e)}(a,xS);var t,e,n,o=EP(a);function a(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),e=o.call(this,t.location),n=PP(e),i=void 0,(r="options")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e.options=t,e}return t=a,(e=[{key:"create",value:function(){var t=this.options.assets.map,e=this.options.location;t.neighborsAt(e).orthogonals.forEach(function(t){return t.hideUnit=!1}),this.finish()}},{key:"update",value:function(){}},{key:"destroy",value:function(){}}])&&OP(t.prototype,e),n&&OP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}();function AP(t){return(AP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function CP(t){return function(t){if(Array.isArray(t))return IP(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return IP(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?IP(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function IP(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function MP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jP(t,e){return(jP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function DP(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=NP(n);return function(t,e){{if(e&&("object"===AP(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return LP(t)}(this,r?(t=NP(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function LP(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function NP(t){return(NP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function FP(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var BP=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jP(t,e)}(i,xS);var t,e,n,r=DP(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),FP(LP(e=r.call(this,t.location)),"options",void 0),FP(LP(e),"rocket",void 0),FP(LP(e),"explosionStages",[]),FP(LP(e),"whiteout",void 0),e.options=t,e}return t=i,(e=[{key:"ratify",value:function(t){var e=this.options.assets.map,n=qk.LaunchSilo.damage,t=e.squareAt(t).unit;t&&10<t.hp&&(t.hp=Math.max(10,t.hp-n))}},{key:"create",value:function(){var n=this,t=this.options.assets,r=t.map,e=t.camera,i=this.options.location,o=zI.display.standardLength,t=i.multiply(o),a=zI.scene.resources.VFXSpritesheet.spritesheet.animations;this.rocket=new T.AnimatedSprite(a["silo-rocket"]),this.rocket.animationSpeed=.25,this.rocket.position.set(t.x,t.y-256),this.rocket.scale.y=-1,this.rocket.play();for(var s=function(t){var e=new Tm(t).multiply(zI.display.standardLength),n=a["explosion-dry"],n=mS.explosion(n);return n.position.set(e.x,e.y),n.alpha=0,{anim:n,loc:t}},u=qk.LaunchSilo.effectAreaMap,c=0;c<3;c++)!function(e){var t=r.squaresFrom(i,u).filter(function(t){return i.manhattanDistance(t)===e}).map(function(t){return s(new Tm(t))});n.explosionStages.push(t)}(c);this.whiteout=new T.Graphics,this.whiteout.beginFill(16777215),this.whiteout.drawRect(0,0,zI.display.renderWidth,zI.display.renderHeight),this.whiteout.endFill(),this.whiteout.alpha=0,this.whiteout.blendMode=T.BLEND_MODES.LIGHTEN;function l(t){n.explosionStages[t].forEach(function(t){var e=t.anim,t=t.loc;e.alpha=1,e.play(),n.ratify(t)})}(o=Fv("ui")).addChild.apply(o,[this.rocket].concat(CP(this.explosionStages.flat(3).map(function(t){return t.anim})))),zI.hud.addChild(this.whiteout);var h=e.algorithms.displacement,f=gS.ScreenShake.withIntensity(12);Wm.tween(.5,this.rocket,{y:t.y}).wait().label("impact").do(function(t){return n.rocket.destroy({children:!0})}).at("impact").tween(.15,this.whiteout,{alpha:.8}).wait().tween(.15,this.whiteout,{alpha:0}).wait().do(function(t){return n.whiteout.destroy()}).at("impact").do(function(t){return e.algorithms.displacement=f}).at("impact").do(function(t){return l(0)}).wait(.15).do(function(t){return l(1)}).wait(.15).do(function(t){return l(2)}).at("end").wait(.5).do(function(t){return e.algorithms.displacement=h}).do(this.finish,this)}},{key:"update",value:function(){}},{key:"destroy",value:function(){}}])&&MP(t.prototype,e),n&&MP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function UP(t){return(UP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function GP(t){return function(t){if(Array.isArray(t))return XP(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return XP(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?XP(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function XP(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function HP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zP(t,e){return(zP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function VP(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=YP(n);return function(t,e){{if(e&&("object"===UP(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return WP(t)}(this,r?(t=YP(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function WP(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function YP(t){return(YP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qP(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var KP=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zP(t,e)}(i,xS);var t,e,n,r=VP(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),qP(WP(e=r.call(this,t.location)),"options",void 0),qP(WP(e),"rocket",void 0),qP(WP(e),"exhaustStages",void 0),e.options=t,e}return t=i,(e=[{key:"ratify",value:function(){this.options.terrain.used=!0}},{key:"create",value:function(){var n=this,t=this.options.location,e=zI.display.standardLength,r=new Tm(-3,5),e=t.multiply(e).add(r),r=zI.scene.resources.VFXSpritesheet.spritesheet.animations;this.rocket=new T.AnimatedSprite(r["silo-rocket"]),this.rocket.animationSpeed=.25,this.rocket.position.set(e.x,e.y),this.rocket.play();e=r["silo-exhaust"];e.push(T.Texture.EMPTY);r=function(t){return yS.progressiveTransparency({textures:t,animationSpeed:1/12,alphaFloor:.35})};this.exhaustStages=[r(e),r(e),r(e),r(e)].map(function(t){return t.alpha=0,t});function i(t,e){(t=n.exhaustStages[t]).position.set(e.x,e.y),t.alpha=1,t.play()}(e=Fv("ui")).addChild.apply(e,[this.rocket].concat(GP(this.exhaustStages))),Wm.do(this.ratify,this).tween(1,this.rocket,{y:this.rocket.y-256},lm.quad.in).wait(.1).do(function(t){return i(0,n.rocket)}).wait(.1).do(function(t){return i(1,n.rocket)}).wait(.1).do(function(t){return i(2,n.rocket)}).wait(.1).do(function(t){return i(3,n.rocket)}).at("end").do(this.finish,this)}},{key:"update",value:function(){}},{key:"destroy",value:function(){this.rocket.destroy({children:!0})}}])&&HP(t.prototype,e),n&&HP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function ZP(t){return(ZP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function QP(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function $P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function JP(t,e){return(JP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function tk(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=nk(n);return function(t,e){{if(e&&("object"===ZP(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return ek(t)}(this,r?(t=nk(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function ek(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nk(t){return(nk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rk(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ik=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&JP(t,e)}(i,xS);var t,e,n,r=tk(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),rk(ek(e=r.call(this,t.actor.boardLocation)),"options",void 0),rk(ek(e),"timer",new Wm(.6)),rk(ek(e),"image",void 0),rk(ek(e),"MaxScale",2.5),rk(ek(e),"IntroFrames",3),rk(ek(e),"shake",!1),rk(ek(e),"position",new Tm),rk(ek(e),"animSlider",new Qg({granularity:1/e.IntroFrames})),e.options=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?QP(Object(n),!0).forEach(function(t){rk(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QP(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t),e}return t=i,(e=[{key:"ratifySupply",value:function(){this.options.actor.resupply()}},{key:"ratifyRepair",value:function(){var t=this.options,e=t.actor,n=t.repairHp,r=t.repairCost,t=e.boardPlayer;e.resupply(),e.hp+=n||0,t.expendFunds(r||0)}},{key:"create",value:function(){var t=this.options,e=t.message,n=t.actor,r=t.camera,i=zI.display.standardLength,t=n.boardLocation.multiply(i),n=r.transform.worldRect().center.x>t.x,r=zI.scene.resources.UISpritesheet.spritesheet.textures["bubble-".concat(e,"-").concat(n?"right":"left",".png")];this.image=new T.Sprite(r),t.x+=(n?.6:.4)*i,t.y+=.5*i,this.image.position.set(t.x,t.y),this.image.anchor.set(n?0:1,.5),this.image.scale.set(this.MaxScale),this.image.alpha=0,this.timer.startReset(),"repair"===e&&this.ratifyRepair(),"supply"===e&&this.ratifySupply(),"ambush"===e&&(this.shake=!0),this.position.set(this.image.position),Fv("ui").addChild(this.image)}},{key:"update",value:function(){var t;this.image.scale.set(this.MaxScale-this.animSlider.output*(this.MaxScale-1)),this.image.alpha=this.animSlider.output,this.shake&&this.animSlider.equalsMax()&&(t=Math.sin(12*this.timer.elapsed*Math.PI),t=Number(0<t),this.image.x=this.position.x+t),this.animSlider.increment(),this.timer.finished&&this.finish()}},{key:"destroy",value:function(){var t;null!==(t=this.image)&&void 0!==t&&t.destroy(),this.image=void 0,this.options=void 0}}])&&$P(t.prototype,e),n&&$P(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function ok(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ak(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var sk=function(){function c(t){var n,e=t.gamepad,r=t.origin,i=t.points,o=t.startingPoint,a=t.startingVector,s=t.onIncrement,t=t.context;if(!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),ak(this,"gamepad",void 0),ak(this,"onIncrement",void 0),ak(this,"context",void 0),ak(this,"origin",void 0),ak(this,"points",void 0),ak(this,"index",void 0),ak(this,"incrementDirection",1),ak(this,"fastTapTimer",new Wm(.35).noSelfDestruct()),ak(this,"lastTapVector",void 0),ak(this,"holdPulsar",new tb({firstInterval:20,interval:6},this.triggerIncrement,this)),0===i.length)throw new Error("Points list provided was length zero.");function u(t){t=t.subtract(r);return 1e3*-t.rotateByVector(Tm.Up).polarAngle()+t.magnitude()}i.sort(function(t,e){return u(t)-u(e)}),this.gamepad=e,this.origin=r,this.points=i,this.onIncrement=s||function(t){},this.context=t,a&&!o&&(n=function(t){return a.angleDifference(t.subtract(r))},o=i.reduce(function(t,e){return n(e)<n(t)?e:t}));t=-1!==(t=o?i.findIndex(function(t){return t.equal(o)}):0)?t:0;this.index=new Qg({max:i.length,track:t,granularity:1,looping:!0}),zI.scene.ticker.add(this.update,this)}var t,e,n;return t=c,(e=[{key:"triggerIncrement",value:function(){this.index.increment(this.incrementDirection),this.onIncrement.call(this.context,this.points[this.index.output])}},{key:"current",get:function(){return this.points[this.index.output]}},{key:"destroy",value:function(){this.onIncrement=void 0,this.fastTapTimer.destroy(),this.holdPulsar.destroy(),zI.scene.ticker.remove(this.update,this)}},{key:"update",value:function(){var t,e,n,r,i=this,o=this.gamepad,a=this.holdPulsar,s=this.fastTapTimer;o.axis.dpad.returned?(s.startReset(),a.stop()):o.dpadButtons.some(function(t){return t.pressed||t.released})&&a.startReset(),o.dpadButtons.some(function(t){return t.pressed})&&(t=o.axis.dpad,e=t.point,n=t.framePoint,t=null===(r=i.lastTapVector)||void 0===r?void 0:r.notEqual(n),r=null!==(r=i.lastTapVector)&&void 0!==r&&r.add(n).equal(Tm.Origin)?-1:1,i.lastTapVector=n,-1==r&&s.ticking?i.incrementDirection*=-1:!t&&s.ticking||(s.ticking,e=i.current.subtract(i.origin).clockDirectionTo(e),i.incrementDirection=0!==e?e:i.incrementDirection),i.triggerIncrement())}},{key:"setIndexToPoint",value:function(e){var t=this.points.findIndex(function(t){return t.equal(e)});0<=t&&(this.index.track=t,this.onIncrement.call(this.context,this.points[this.index.output]))}}])&&ok(t.prototype,e),n&&ok(t,n),Object.defineProperty(t,"prototype",{writable:!1}),c}();function uk(t){return(uk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ck(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lk(t,e){return(lk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function hk(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=pk(n);return function(t,e){{if(e&&("object"===uk(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return fk(t)}(this,r?(t=pk(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function fk(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pk(t){return(pk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var dk=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lk(t,e)}(u,uS);var t,e,n,s=hk(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e,n,r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=fk(t),r=void 0,(n="radialPoints")in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return t=u,(e=[{key:"type",get:function(){return u}},{key:"name",get:function(){return"ChooseAttackTarget"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!1}},{key:"triggerCursorMove",value:function(t){this.assets.mapCursor.moveTo(t)}},{key:"updateDamageForecast",value:function(){var t=this.assets,e=t.map,n=t.mapCursor,r=t.uiSystem,i=t.players,o=this.data,a=o.actor,s=o.goal,t=o.seed,o=e.squareAt(n.boardLocation),n=o.unit;n&&n.faction!==i.current.faction?(i=A3.NormalAttack(e,a,s,n,t),r.battleForecast=i.estimate):!n&&o.terrain.damageable?(t=A3.TerrainAttack(e,a,s,o.terrain,t),r.battleForecast=t.estimate):r.battleForecast=void 0}},{key:"configureScene",value:function(){var e=this,t=this.assets,n=t.map,r=t.mapCursor,i=t.uiSystem,o=t.trackCar,a=t.gamepad,s=t.scripts,u=this.data,c=u.actor,t=u.path,u=u.goal;r.show(),r.disable(),i.show(),o.show(),s.stagePointerInterface.enable(),s.stagePointerInterface.mode="highlighted",s.stagePointerInterface.onMoveCursor=function(t){e.radialPoints.setIndexToPoint(t)},r.on("move",this.updateDamageForecast,this),r.mode="target";for(var l=[],h=n.squareOfInfluence(c),f=0;f<h.height;f++)for(var p=0;p<h.width;p++){var d=new Tm(p+h.x,f+h.y),y=n.squareAt(d);(y.unit||y.terrain.damageable)&&y.attackFlag&&l.push(d)}0===l.length&&this.failTransition("no attackable targets in range");t=O9(t&&t[t.length-1]||w9.North);this.radialPoints=new sk({gamepad:a,origin:u,points:l,startingVector:t,onIncrement:this.triggerCursorMove,context:this}),r.moveTo(this.radialPoints.current)}},{key:"update",value:function(){var t=this.assets,e=t.gamepad,n=t.instruction,r=this.assets.scripts.stagePointerInterface,t=e.button,e=t.A;t.B.pressed||r.cancelIntent?this.regress():(e.pressed||r.affirmIntent)&&(n.focal=this.radialPoints.current,this.advance())}},{key:"close",value:function(){var t=this.assets,e=t.mapCursor,t=t.uiSystem;this.radialPoints.destroy(),t.battleForecast=void 0,e.removeListener(this.updateDamageForecast,this)}},{key:"prev",value:function(){var t=this.assets,e=t.mapCursor,n=t.instruction,t=this.data.goal;n.focal=void 0,e.moveTo(t)}}])&&ck(t.prototype,e),n&&ck(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}();function yk(t){return(yk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mk(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vk(t,e){return(vk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function gk(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=_k(n);return function(t,e){{if(e&&("object"===yk(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return bk(t)}(this,r?(t=_k(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function bk(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _k(t){return(_k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var xk=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vk(t,e)}(u,uS);var t,e,n,s=gk(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e,n,r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=bk(t),r=!(n="mustSelectTargetable"),n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return t=u,(e=[{key:"type",get:function(){return u}},{key:"name",get:function(){return"ChooseMapTarget"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!1}},{key:"updateCursorUI",value:function(){var t=this.assets,e=t.map,n=t.mapCursor,t=!this.mustSelectTargetable,e=e.squareAt(n.boardLocation).targetFlag,e=t||e;n.mode=e?"target":"point",n.showAreaOfEffectMap=e}},{key:"configureScene",value:function(){var t=this.assets,e=t.map,n=t.mapCursor,r=t.trackCar,i=t.scripts,o=this.data,t=o.action,o=o.place;e.clearTileOverlay(),n.show(),r.show(),i.stagePointerInterface.enable();t=UE.getCommandObject(t);n.regionMap=t.effectAreaMap,t.range&&(t=Z9(t.range),e.squaresFrom(o,t).forEach(function(t){return t.targetFlag=!0}),this.mustSelectTargetable=!0),n.on("move",this.updateCursorUI,this),this.updateCursorUI()}},{key:"update",value:function(){var t=this.assets,e=t.gamepad,n=t.map,r=t.mapCursor,i=t.instruction,o=this.assets.scripts.stagePointerInterface,t=e.button,e=t.A;t.B.pressed?this.regress():(e.pressed||o.affirmIntent)&&(!this.mustSelectTargetable||n.squareAt(r.boardLocation).targetFlag?(i.focal=r.boardLocation,this.advance()):o.affirmIntent&&this.regress())}},{key:"close",value:function(){this.assets.mapCursor.removeListener(this.updateCursorUI,this)}}])&&mk(t.prototype,e),n&&mk(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}();function wk(t){return(wk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tk(t){return function(t){if(Array.isArray(t))return Pk(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ek(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ok(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function Sk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ok(Object(n),!0).forEach(function(t){Mk(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ok(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ek(t,e){if(t){if("string"==typeof t)return Pk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pk(t,e):void 0}}function Pk(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function kk(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rk(t,e){return(Rk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ak(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=Ik(n);return function(t,e){{if(e&&("object"===wk(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return Ck(t)}(this,r?(t=Ik(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function Ck(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ik(t){return(Ik=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mk(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var jk=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rk(t,e)}(o,uS);var t,e,n,i=Ak(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Mk(Ck(t=i.call.apply(i,[this].concat(n))),"autoEnd",!1),t}return t=o,(e=[{key:"type",get:function(){return o}},{key:"name",get:function(){return"CommandMenu"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!1}},{key:"configureScene",value:function(){var t=this.assets,e=t.map,n=t.mapCursor,r=t.trackCar,i=t.cmdMenu,o=t.camera,a=this.data,s=a.actor,u=a.place,c=a.placeTile,l=a.goal,h=a.goalTile,f=a.goalTerrain,t=a.drop,a=l1.insertIf;r.show(),e.clearTileOverlay(),c.moveFlag=!0,h.moveFlag=!0,n.moveTo(l);n=h.occupiable(s),h=s.canMoveAndAttack||l.equal(u),u=s.rangeMap.points.map(function(t){return l.add(t)});if(h&&n){var p,d=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Ek(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}(u);try{for(d.s();!(p=d.n()).done;){var y=p.value;e.validPoint(y)&&e.squareAt(y).attackable(s)&&(e.squareAt(y).attackFlag=!0)}}catch(t){d.e(t)}finally{d.f()}}u=s.cargo.map(function(t,e){return Sk(Sk({},qk.Drop),{},{index:e})}).filter(function(t){return t.triggerInclude()});0===u.length&&0<t.length?this.autoEnd=!0:(f=(n?[].concat(Tk(a.apply(void 0,[0===t.length].concat(Tk(Object.values(qk))))),Tk(a(0<t.length,qk.Wait)),Tk(a.apply(void 0,[s.unloadPosition(f)].concat(Tk(u))))):[qk.Join,qk.Load]).sort(function(t,e){return t.weight-e.weight}).map(function(t){var e=t.name,n=t.type===qk.Drop&&0<=t.index?s.cargo[t.index].cargoPreview:void 0;return new v9({icon:n,title:e},t,{triggerInclude:function(){return t.triggerInclude()}})}),i.setListItems(f),i.menu.resetCursor(),u=zI.display.standardLength,f=l.multiply(u).add(new Tm(1.25*u,0)),(o=o.transform.worldRect()).center.x<f.x&&(f.x=l.x*u-.25*u-i.graphicalWidth),f.y+i.graphicalHeight+4>o.y+o.height&&(f.y-=f.y+i.graphicalHeight+4-o.y-o.height),i.setPosition(f),i.show())}},{key:"update",value:function(){var t=this.assets,e=t.gamepad,n=t.stagePointer,r=t.instruction,i=this.assets.cmdMenu,o=i.menu,t=!1;!i.menuPointer.clicked()||void 0!==(i=this.assets.cmdMenu.getPointerSelection())&&(o.setCursor(i),t=!0),(t=e.button.A.pressed||this.autoEnd?!0:t)?(t=(this.autoEnd?qk.Wait:o.selectedValue).serial,(r.action=t)===qk.Drop.serial&&(o=o.selectedValue,r.which=o.index),t=UE.getCommandObject(t),this.advance.apply(this,Tk(t.ingressSteps))):(e.button.B.pressed||n.clicked())&&this.regress()}}])&&kk(t.prototype,e),n&&kk(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function Dk(t){return(Dk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lk(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nk(t,e){return(Nk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Fk(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=Uk(n);return function(t,e){{if(e&&("object"===Dk(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return Bk(t)}(this,r?(t=Uk(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function Bk(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Uk(t){return(Uk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gk(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Xk=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nk(t,e)}(o,uS);var t,e,n,i=Fk(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Gk(Bk(t=i.call.apply(i,[this].concat(n))),"cursorMoved",!1),Gk(Bk(t),"toDrop",void 0),Gk(Bk(t),"radialPoints",void 0),t}return t=o,(e=[{key:"type",get:function(){return o}},{key:"name",get:function(){return"DropLocation"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!1}},{key:"onAdvance",value:function(){var t=this.data.which;this.toDrop={which:t}}},{key:"onRegress",value:function(){var t=this.assets,e=t.map,n=t.mapCursor,r=this.data.drop.pop(),t=r.which,r=r.where;this.toDrop={which:t},r&&(n.teleportTo(r),e.squareAt(r).clearValues({arrowPaths:!0}),this.cursorMoved=!0)}},{key:"configureScene",value:function(){var e=this,t=this.assets,n=t.map,r=t.mapCursor,i=t.trackCar,o=t.gamepad,a=this.assets.scripts.stagePointerInterface,s=this.data,u=s.actor,c=s.path,t=s.goal,l=s.drop;n.clearTileOverlay(),r.show(),r.disable(),i.show(),a.enable(),a.mode="highlighted",a.onMoveCursor=function(t){e.radialPoints.setIndexToPoint(t)};var h=u.cargo[this.toDrop.which],n=n.neighborsAt(t).orthogonals.filter(function(e){return(e.occupiable(h)||e.traversable(h)&&e.unit===u)&&!l.map(function(t){return t.where}).some(function(t){return t.equal(new Tm(e.boardLocation))})});n.forEach(function(t){return t.moveFlag=!0}),n.length||this.failTransition("No locations to drop unit.");c=c&&c[c.length-1]||w9.North,c=this.cursorMoved?void 0:O9(c);this.radialPoints=new sk({gamepad:o,origin:t,points:n.map(function(t){return t.boardLocation}),startingVector:c,onIncrement:function(t){return r.moveTo(t)}}),r.moveTo(this.radialPoints.current)}},{key:"update",value:function(){var t=this.assets,e=t.map,n=t.mapCursor,r=t.gamepad,i=this.assets.scripts.stagePointerInterface,o=this.data,t=o.actor,o=o.drop;r.button.B.pressed||i.cancelIntent?this.regress():!r.button.A.pressed&&!i.affirmIntent||(e=e.squareAt(n.boardLocation)).moveFlag&&(this.toDrop.where=new Tm(n.boardLocation),o.push(this.toDrop),o.length<t.cargo.length&&(t=n.boardLocation.subtract(t.boardLocation),e.arrowTo=S9(t),e.showDropArrow=!0),this.advance())}},{key:"close",value:function(){this.radialPoints.destroy()}},{key:"prev",value:function(){var t=this.assets,e=t.map,n=t.mapCursor,r=this.data,t=r.place,r=r.goal;e.clearTileOverlay(),n.teleportTo(r),e.squareAt(t).moveFlag=!0,e.squareAt(r).moveFlag=!0}}])&&Lk(t.prototype,e),n&&Lk(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function Hk(t){return function(t){if(Array.isArray(t))return Vk(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||zk(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zk(t,e){if(t){if("string"==typeof t)return Vk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vk(t,e):void 0}}function Vk(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Wk(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function Yk(r){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Wk(Object(i),!0).forEach(function(t){var e,n;e=r,t=i[n=t],n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):Wk(Object(i)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(i,t))})}return r}var qk,Kk,Zk,Qk,$k,Jk,tR,eR,nR,rR,iR,oR,aR,sR,uR,cR,lR,hR=qO.data,fR=UE.ExitCode,pR=UE.Weight,dR=UE.RatificationError,yR=hg(),mR={ingressSteps:[],spendsUnit:!0,triggerInclude:function(){return!1},scheduleEvent:function(){return fR.Success}};function vR(t){return(vR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gR(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bR(t,e){return(bR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _R(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=wR(n);return function(t,e){{if(e&&("object"===vR(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return xR(t)}(this,r?(t=wR(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function xR(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wR(t){return(wR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}T_=qk=qk||{},Kk=T_.Wait=Yk(Yk({},mR),{},{get type(){return Kk},get chain(){return[Zk,Kk,aR]},name:"Wait",serial:yR.next().value,weight:pR.Wait,triggerInclude:function(){var t=hR.actor;return hR.goalTile.occupiable(t)}}),Zk=T_.Move=Yk(Yk({},mR),{},{get type(){return Zk},get chain(){return[Zk]},name:"Move",serial:yR.next().value,weight:pR.None,triggerInclude:function(){return!1},scheduleEvent:function(){var t=hR.assets,e=t.map,n=t.boardEvents,r=t.camera,i=t.instruction,o=hR.action,a=hR.place,s=hR.path,u=hR.actor,c=hR.assets;u.CoCouldBoard=!1;var l,h=[],f=u.boardLocation,p=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=zk(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}(s);try{for(p.s();!(l=p.n()).done;){var d=l.value,y=f.add(O9(d)),m=e.squareAt(y);if(m.unit&&m.unit.faction!==u.faction)break;h.push(d),f=y}}catch(t){p.e(t)}finally{p.f()}t=h.length!==s.length,s=E9(h).add(a),i=o===Qk.serial?i.focal:void 0;return a.notEqual(s)&&n.schedule(new uP({actor:u,path:h,goal:s,target:i,assets:c}),t&&new ik({actor:u,camera:r,message:"ambush"}),new RP({location:s,assets:c})),t?fR.Interrupted:fR.Success}}),Qk=T_.Attack=Yk(Yk({},mR),{},{get type(){return Qk},get chain(){return[Zk,Qk]},get ingressSteps(){return[dk]},name:"Fire",serial:yR.next().value,weight:pR.Primary,triggerInclude:function(){for(var t=hR.assets.map,e=hR.actor,n=hR.place,r=hR.goal,i=!1,o=t.squareOfInfluence(e),a=o.y;a<o.y+o.height;a++)for(var s=o.x;s<o.x+o.width;s++)t.squareAt({x:s,y:a}).attackFlag&&(i=!0);var u=e.attackReady&&i,e=e.canMoveAndAttack,n=r.equal(n);return u&&(e||n)},scheduleEvent:function(){var t=hR.assets,i=t.map,e=t.trackCar,n=t.boardEvents,r=hR.seed,o=hR.actor,a=hR.goal,s=hR.focalTile,u=hR.assets,c=[],t=null!==(t=s.unit)&&void 0!==t?t:s.terrain;function l(t,e,n,r){return e instanceof bw?new RS({attacker:t,defender:e,damage:n,trackCar:r,assets:u}):new XE({location:a,ratify:function(){e.value-=n,--t.ammo,e.value<=0&&i.demolishTile(s.boardLocation)}})}r=t instanceof bw?A3.NormalAttack(i,o,a,t,r):A3.TerrainAttack(i,o,a,t,r);return c.push(l(o,t,r.damage)),t instanceof bw&&t.canCounterAttack(o,a)&&c.push(l(t,o,r.counter,e)),n.schedule(c),fR.Success}}),$k=T_.Capture=Yk(Yk({},mR),{},{get type(){return $k},get chain(){return[Zk,$k]},name:"Capture",serial:yR.next().value,weight:pR.Secondary,triggerInclude:function(){var t=hR.actor,e=hR.goalTerrain,n=t.soldierUnit&&e.building,e=t.faction!==e.faction;return n&&e},scheduleEvent:function(){var t=hR.assets.boardEvents,e=hR.actor,n=hR.goalTerrain,r=hR.assets;return t.schedule(new Y3({actor:e,terrain:n,assets:r})),fR.Success}}),Jk=T_.Build=Yk(Yk({},mR),{},{get type(){return Jk},get chain(){return[Zk,Jk]},name:"Build",serial:yR.next().value,weight:pR.Secondary,triggerInclude:function(){var t=hR.assets.map,e=hR.actor,n=hR.goal,t=t.squareAt(n).terrain.type,n=e.type===Rw.Rig,e=0<e.ammo,t=t===Tg.Plain||t===Tg.Beach;return n&&e&&t},scheduleEvent:function(){var t=hR.assets.boardEvents,e=hR.actor,n=hR.goalTerrain,r=hR.assets;return t.schedule(new tE({actor:e,terrain:n,assets:r})),fR.Success}}),tR=T_.Supply=Yk(Yk({},mR),{},{get type(){return tR},get chain(){return[Zk,tR]},name:"Supply",serial:yR.next().value,weight:pR.Secondary,triggerInclude:function(){var t=hR.assets.map,e=hR.actor,n=hR.goal;return t.neighborsAt(n).orthogonals.some(function(t){return t.unit&&t.unit.resuppliable(e)})},scheduleEvent:function(){var t=hR.assets,e=t.map,n=t.camera,r=t.boardEvents,i=hR.actor,t=hR.goal,o=[];return e.neighborsAt(t).orthogonals.forEach(function(t){t.unit&&t.unit.resuppliable(i)&&(t=new ik({message:"supply",actor:t.unit,camera:n}),o.push(t))}),r.schedule(o),fR.Success}}),eR=T_.Dive=Yk(Yk({},mR),{},{get type(){return eR},get chain(){return[eR,Zk]},name:"Dive",serial:yR.next().value,weight:pR.Unpreferred,triggerInclude:function(){var t=hR.actor;return!t.hiding&&t.type===Rw.Submarine},scheduleEvent:function(){var t=hR.assets.boardEvents,e=hR.actor,n=hR.place,r=hR.assets;return t.schedule(new uE({unit:e,location:n,anim:"dive",assets:r})),fR.Success}}),nR=T_.Surface=Yk(Yk({},mR),{},{get type(){return nR},get chain(){return[Zk,nR]},name:"Surface",serial:yR.next().value,weight:pR.Unpreferred,triggerInclude:function(){var t=hR.actor;return t.hiding&&t.type===Rw.Submarine},scheduleEvent:function(){var t=hR.assets.boardEvents,e=hR.actor,n=hR.goal,r=hR.assets;return t.schedule(new uE({unit:e,location:n,anim:"surface",assets:r})),fR.Success}}),rR=T_.Flare=Yk(Yk({},mR),{},{get type(){return rR},get chain(){return[Zk,rR]},get ingressSteps(){return[xk]},name:"Flare",serial:yR.next().value,weight:pR.Secondary,effectAreaMap:Z9({min:0,max:2}),range:{min:0,max:5},triggerInclude:function(){var t=hR.actor,e=hR.plansToMove,n=t.type===Rw.Flare,t=0<t.ammo;return!e&&n&&t},scheduleEvent:function(){var t=hR.assets.boardEvents,e=hR.actor,n=hR.goal,r=hR.focal,i=hR.assets;return t.schedule(new IE({location:n,side:e.reverseFacing?OE.Left:OE.Right}),new SE({actor:e,location:r,assets:i})),fR.Success}}),iR=T_.Join=Yk(Yk({},mR),{},{get type(){return iR},get chain(){return[iR]},name:"Join",serial:yR.next().value,weight:pR.Context1,triggerInclude:function(){var t=hR.assets.map,e=hR.actor,n=hR.goal,n=t.squareAt(n).unit;return!!n&&e.mergeable(n)},scheduleEvent:function(){var t=hR.assets,e=t.map,n=t.boardEvents,r=hR.actor,i=hR.path,o=hR.goal,t=hR.assets,e=e.squareAt(o).unit;if(!e)throw new dR("no unit to join with");if(e.faction!==r.faction)throw new dR("units to join are not allied");if(e.type!==r.type)throw new dR("units to join are not of same type");return n.schedule(new yP({actor:r,path:i,goal:o,other:e,assets:t})),fR.Success}}),oR=T_.Load=Yk(Yk({},mR),{},{get type(){return oR},get chain(){return[oR]},name:"Load",serial:yR.next().value,weight:pR.Context1,triggerInclude:function(){var t,e=hR.actor;return(null===(t=hR.goalTile.unit)||void 0===t?void 0:t.boardable(e))||!1},scheduleEvent:function(){var t=hR.assets.boardEvents,e=hR.actor,n=hR.path,r=hR.goal,i=hR.underneath,o=hR.assets;return t.schedule(new wP({actor:e,path:n,goal:r,underneath:i,assets:o})),fR.Success}}),aR=T_.Drop=Yk(Yk({},mR),{},{get type(){return aR},get chain(){return[Zk,aR]},get ingressSteps(){return[Xk,jk]},name:"Drop",serial:yR.next().value,weight:pR.Tertiary,index:-1,triggerInclude:function(){var t=hR.assets.map,n=hR.actor,e=hR.goal,r=hR.drop;if(-1===this.index)return!1;if(0===n.cargo.length)return!1;if(!l1.validIndex(this.index,n.cargo.length))throw new dR("".concat(this.name,"  input ").concat(this.index," does not correspond to a held unit."));var t=t.neighborsAt(e),i=n.cargo[this.index],e=r.map(function(t){return t.which}).includes(this.index),t=t.orthogonals.some(function(e){return(e.occupiable(i)||e.traversable(i)&&e.unit===n)&&!r.some(function(t){return t.where.equal(e.boardLocation)})});return!e&&t},scheduleEvent:function(){var t=hR.drop;if(0===t.length)return fR.Success;var e=hR.assets,n=e.boardEvents,r=e.map,i=e.camera,o=hR.actor,a=hR.assets,s=l1.insertIf,e=t.filter(function(t){return!(t=r.squareAt(t.where).unit)||t===o});return n.schedule([new vE({actor:o,drop:e,assets:a})].concat(Hk(s(e.length!==t.length,new ik({actor:o,camera:i,message:"ambush"}))))),fR.Success}}),sR=T_.ProduceTroop=Yk(Yk({},mR),{},{get type(){return sR},get chain(){return[sR]},name:"Produce",serial:yR.next().value,weight:pR.Quaternary,spendsUnit:!0,troopType:Rw.SeaPlane,triggerInclude:function(){var t=hR.assets.players,e=hR.actor,n=hR.plansToMove,r=new this.troopType,i=e.type===Rw.Carrier,o=0<e.ammo,r=t.current.canAfford(r.cost),e=e.boardable();return i&&e&&o&&r&&!n},scheduleEvent:function(){var t=hR.assets,e=t.boardEvents,n=t.players,r=hR.actor,i=hR.goal,o=this.troopType;return e.schedule(new XE({location:i,ratify:function(){r.ammo--;var t=n.current.spawnUnit({location:i,serial:o.serial});n.current.expendFunds(t.cost)}})),fR.Success}}),uR=T_.AnnointCO=Yk(Yk({},mR),{},{get type(){return uR},get chain(){return[uR]},name:"CO",serial:yR.next().value,weight:pR.Context2,spendsUnit:!1,triggerInclude:function(){var t=hR.actor,e=hR.plansToMove;return t.CoCouldBoard&&!e},scheduleEvent:function(){var t=hR.assets.boardEvents,e=hR.actor,n=hR.goal,r=hR.assets;return t.schedule(new B3({actor:e,location:n,assets:r})),fR.Success}}),cR=T_.LaunchSilo=Yk(Yk({},mR),{},{get type(){return cR},get chain(){return[Zk,cR]},get ingressSteps(){return[xk]},name:"Missile",serial:yR.next().value,weight:pR.Context1,effectAreaMap:Z9({min:0,max:2}),damage:30,triggerInclude:function(){var t=hR.actor,e=hR.goalTerrain,n=e.type===Tg.Silo,t=e.actionable(t);return n&&t},scheduleEvent:function(){var t=hR.assets.boardEvents,e=hR.goal,n=hR.goalTerrain,r=hR.focal,i=hR.assets;if(!(n instanceof Tg.Silo))throw new dR("goal terrain is not Silo: pos ".concat(e.toString()," '").concat(n.name,"'"));return t.schedule(new KP({location:e,terrain:n}),new BP({location:r,assets:i})),fR.Success}}),lR=T_.SpawnUnit=Yk(Yk({},mR),{},{get type(){return lR},get chain(){return[lR]},name:"SpawnUnit",serial:yR.next().value,weight:pR.None,triggerInclude:function(){return!1},scheduleEvent:function(){var t=hR.assets,e=t.map,n=t.players,r=hR.which,t=hR.place,r=n.current.spawnUnit({location:t,serial:r,spent:!0});return n.current.expendFunds(r.cost),e.revealSightMapLocation(t,n.perspective,r),fR.Success}});var TR=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bR(t,e)}(u,uS);var t,e,n,s=_R(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e,n,r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=xR(t),n="lastCursorPos",r=new Tm(-1,-1),n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return t=u,(e=[{key:"type",get:function(){return u}},{key:"name",get:function(){return"MoveUnit"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!1}},{key:"updateUiSystems",value:function(){var t=this.assets,e=t.map,n=t.mapCursor,r=t.players,i=t.uiSystem,o=this.data,a=o.actor,s=o.place,u=o.seed,c=e.squareAt(n.boardLocation),l=c.unit,h=c.occupiable(a),f=null==l?void 0:l.boardable(a),t=null==l?void 0:l.mergeable(a),o=(null==l?void 0:l.faction)===r.current.faction,r=c.moveFlag,t=o&&(f||t),h=h&&c.terrain.actionable(a),c=c.attackFlag;n.mode=r&&(t||h)||c?"target":"point",n.showAreaOfEffectMap=r;s=E9(e.pathFrom(s)).add(a.boardLocation);l&&c&&!o?(o=A3.NormalAttack(e,a,s,l,u),i.battleForecast=o.estimate):!l&&c?(c=e.squareAt(s).terrain,u=A3.TerrainAttack(e,a,s,c,u),i.battleForecast=u.estimate):i.battleForecast=void 0}},{key:"configureScene",value:function(){var t=this.assets,e=t.map,n=t.mapCursor,r=t.uiSystem,i=t.players,o=t.trackCar,a=t.stagePointer,s=t.scripts,u=this.data,t=u.actor,u=u.placeTile;n.show(),r.show(),u.hideUnit=!0,o.buildNewAnimation(t),o.show(),e.generateMovementMap(t),this.updateUiSystems(),s.stagePointerInterface.enable(),s.stagePointerInterface.affirmOnDragRelease=a.pointerDragging,t.faction===i.current.faction&&(t.canMoveAndAttack&&t.isIndirect&&(n.regionMap=t.rangeMap),s.nextTargetableUnit.enable())}},{key:"updateNonInterruptible",value:function(){var t=this.assets,e=t.map,n=t.mapCursor,r=t.players,t=this.data.actor;r.current.faction===t.faction&&this.lastCursorPos.notEqual(n.boardLocation)&&(this.lastCursorPos=n.boardLocation,r=e.squareAt(n.boardLocation).attackFlag?t.rangeMap:void 0,e.recalculatePathToPoint(t,n.boardLocation,r),this.updateUiSystems())}},{key:"update",value:function(){var t,e=this.assets,n=e.map,r=e.mapCursor,i=e.gamepad,o=e.players,a=e.instruction,s=this.assets.scripts.stagePointerInterface,u=this.data,c=u.actor,l=u.place;(i.button.B.pressed||s.cancelIntent)&&this.regress(),o.current.faction!==c.faction?s.affirmIntent&&this.regress():(i.button.A.pressed||s.affirmIntent)&&(e=(t=n.squareAt(r.boardLocation)).unit,u=t.moveFlag,o=t.occupiable(c),i=null==e?void 0:e.mergeable(c),c=null==e?void 0:e.boardable(c),t=t.attackFlag,u&&(o||i||c)?(a.path=n.pathFrom(l),this.advance(jk)):t?(a.path=n.pathFrom(l),a.action=qk.Attack.serial,a.focal=r.boardLocation,this.advance()):s.affirmIntent&&this.regress())}},{key:"prev",value:function(){var t=this.assets,e=t.map,n=t.mapCursor,r=t.trackCar,i=this.data,t=i.place;i.placeTile.hideUnit=!1,r.hide(),e.clearMovementMap(),n.moveTo(t)}}])&&gR(t.prototype,e),n&&gR(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}();function OR(t){return(OR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function SR(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ER(t,e){return(ER=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function PR(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=kR(n);return function(t,e){{if(e&&("object"===OR(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=kR(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function kR(t){return(kR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var RR=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ER(t,e)}(i,uS);var t,e,n,r=PR(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"ShowUnitAttackRange"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!0}},{key:"configureScene",value:function(){var t,e=this,n=this.assets,r=n.map,i=n.trackCar,o=n.scripts,a=this.data,n=a.placeTile,a=a.actor;o.manualMoveCamera.enable(),a.attackReady?(r.generateAttackRangeMap(a),i.buildNewAnimation(a),i.show(),n.hideUnit=!0):(t=zI.frameCount+2,zI.workOrders.send(function(){if(zI.frameCount===t)return e.destroyed||e.regress(),!0},this))}},{key:"update",value:function(){var t=this.assets,e=t.gamepad,t=t.stagePointer;e.button.B.up&&t.button.up&&this.regress()}},{key:"prev",value:function(){var t=this.assets.map;this.data.placeTile.hideUnit=!1,t.clearMovementMap()}}])&&SR(t.prototype,e),n&&SR(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function AR(t){return(AR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function CR(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function IR(t,e){return(IR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function MR(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=jR(n);return function(t,e){{if(e&&("object"===AR(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=jR(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function jR(t){return(jR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var DR=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&IR(t,e)}(i,uS);var t,e,n,r=MR(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"MoveCamera"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!0}},{key:"configureScene",value:function(){var t=this.assets.scripts;t.hideUnits.enable(),t.manualMoveCamera.enable()}},{key:"update",value:function(){var t=this.assets,e=t.gamepad,t=(t.camera,t.scripts);e.button.B.up&&(t.manualMoveCamera.disable(),this.regress())}},{key:"close",value:function(){var t=this.assets,e=t.mapCursor,n=t.uiSystem,t=t.scripts;e.teleportTo(t.manualMoveCamera.finalCursorPosition()),n.skipAnimations()}}])&&CR(t.prototype,e),n&&CR(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function LR(t){return(LR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function NR(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function FR(t,e){return(FR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function BR(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=UR(n);return function(t,e){{if(e&&("object"===LR(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=UR(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function UR(t){return(UR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var GR=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&FR(t,e)}(i,uS);var t,e,n,r=BR(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"TurnChange"}},{key:"revertible",get:function(){return!1}},{key:"skipOnUndo",get:function(){return!1}},{key:"configureScene",value:function(){for(var t=this.assets,e=t.players,t=t.uiSystem,n=0;n<e.all.length&&(e.increment(),!1!==e.current.defeated);n++);t.updatePlayerWindowOrder(),this.advance(GC)}}])&&NR(t.prototype,e),n&&NR(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function XR(t){return(XR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function HR(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zR(t,e){return(zR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function VR(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=WR(n);return function(t,e){{if(e&&("object"===XR(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=WR(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function WR(t){return(WR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var YR=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zR(t,e)}(i,uS);var t,e,n,r=VR(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"TurnEnd"}},{key:"revertible",get:function(){return!1}},{key:"skipOnUndo",get:function(){return!1}},{key:"configureScene",value:function(){var t=this.assets.mapCursor,e=this.assets.players.current;e.units.forEach(function(t){t.spent=!1,t.orderable=!1,t.CoCouldBoard=!1}),e.lastCursorPosition=new Tm(t.boardLocation),this.advance(GR)}}])&&HR(t.prototype,e),n&&HR(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function qR(t){return(qR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function KR(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ZR(t,e){return(ZR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function QR(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=$R(n);return function(t,e){{if(e&&("object"===qR(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=$R(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function $R(t){return($R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var JR=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ZR(t,e)}(i,uS);var t,e,n,r=QR(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"FieldMenu"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!1}},{key:"configureScene",value:function(){var t=this.assets,e=t.fieldMenu;t.stagePointer.button.cancel(),e.setListItems([new v9({title:"Commanders"},1,{triggerDisable:function(){return!0}}),new v9({title:"Options"},1,{triggerDisable:function(){return!0}}),new v9({title:"Quit"},2),new v9({title:"End Turn"},9)]),e.menu.resetCursor(),e.show(),e.setPosition(new Tm(.5*zI.display.renderWidth-.5*e.graphicalWidth,56))}},{key:"update",value:function(){var t=this.assets,e=t.gamepad,n=t.fieldMenu,r=t.stagePointer,t=n.menu;e.button.A.pressed||n.menuPointer.clicked()?9===(t=t.selectedValue)?this.advance(YR):2===t?zI.transitionToScene(PI):0===t&&this.regress():(e.button.B.pressed||e.button.start.pressed||r.clicked())&&this.regress()}}])&&KR(t.prototype,e),n&&KR(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function tA(t){return(tA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eA(t){return function(t){if(Array.isArray(t))return nA(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return nA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nA(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nA(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function rA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function iA(t,e){return(iA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function oA(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=sA(n);return function(t,e){{if(e&&("object"===tA(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return aA(t)}(this,r?(t=sA(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function aA(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sA(t){return(sA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function uA(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var cA=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&iA(t,e)}(o,uS);var t,e,n,i=oA(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return uA(aA(t=i.call.apply(i,[this].concat(n))),"tempUnitLast",void 0),uA(aA(t),"fundsCalculator",Rb.TroopConstructionMenu.fundsCalculator()),t}return t=o,(e=[{key:"type",get:function(){return o}},{key:"name",get:function(){return"FactoryMenu"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!1}},{key:"updateUnitInfo",value:function(){var t=this.assets,e=t.map,n=t.mapCursor,r=t.shopMenu,i=t.uiSystem,o=t.players;null!==(t=this.tempUnitLast)&&void 0!==t&&t.destroy();var n=e.squareAt(n.boardLocation),a=r.menu.selectedValue,r=Object.values(Rw).find(function(t){return t.serial===a});if(void 0===r)throw new Error("Serial for unit type ".concat(a," not found."));this.tempUnitLast=(new r).init({boardPlayer:o.current,faction:o.current.faction}),i.inspectTile(n,this.tempUnitLast);n=o.current.funds,o=n-this.tempUnitLast.cost;this.fundsCalculator.setValues(n,o)}},{key:"configureScene",value:function(){var t=this.assets,e=t.players,n=t.map,r=t.mapCursor,i=t.shopMenu,o=t.camera,a=t.uiSystem,s=i.menu,t=new Tm(r.boardLocation),u=n.squareAt(t),c=e.current,e=aT.find(function(t){return t.type===u.terrain.type}),e=(null==e?void 0:e.units)||[];0===e.length&&zI.developmentMode&&e.push.apply(e,eA(Object.values(Rw).filter(function(t){return u.occupiable(new t)})));e=e.map(function(t){var e=new t,t={icon:e.shopPreview(c.faction,c.armyFacing),title:e.name,cost:e.cost};return new v9(t,e.serial,{triggerDisable:function(){return!1===c.canAfford(e.cost)}})});0!==e.length?(i.setListItems(e),s.resetCursor(),i.show(),a.show(),s=o.transform.worldRect(),s=(o=r.transform.x>s.center.x-16)?16:zI.display.renderWidth-16-i.graphicalWidth,i.setPosition(new Tm(s,40)),i.menu.on("move-cursor",this.updateUnitInfo,this),i.menu.on("change-page",this.updateUnitInfo,this),this.fundsCalculator||(this.fundsCalculator=Rb.TroopConstructionMenu.fundsCalculator()),zI.scene.visualLayers.hud.addChild(this.fundsCalculator.container),this.fundsCalculator.container.position.set(s,20),a.forceOpenDetailWindow=!0,a.screenSide=o?"right":"left",a.windows.detailedInfo.useShopTabSlider=!0,a.skipAnimations(),this.updateUnitInfo(),r.show(),r.disable(),r.mode="build"):this.failTransition("No units to spawn here (".concat(r.boardLocation.toString(),")"))}},{key:"close",value:function(){var t=this.assets,e=t.uiSystem;t.shopMenu.menu.removeListener(this.updateUnitInfo,this),e.windows.detailedInfo.useShopTabSlider=!1,e.skipAnimations(),null!==(e=this.tempUnitLast)&&void 0!==e&&e.destroy(),this.tempUnitLast=void 0;var n=zI.frameCount+2;zI.workOrders.send(function(){if(zI.frameCount===n)return!0}),this.fundsCalculator.destroy(),this.fundsCalculator=void 0}},{key:"update",value:function(){var t=this.assets,e=t.gamepad,n=t.stagePointer,r=t.shopMenu,i=t.instruction,o=r.menu,t=!1;!r.menuPointer.clicked()||void 0!==(r=r.getPointerSelection())&&(o.setCursor(r),t=!0),(t=e.button.A.pressed?!0:t)?(o=(t=o.selectedOption).value,t.disabled||(i.place=new Tm(this.assets.mapCursor.boardLocation),i.action=qk.SpawnUnit.serial,i.which=o,this.advance())):(e.button.B.pressed||n.clicked())&&this.regress()}}])&&rA(t.prototype,e),n&&rA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function lA(t){return(lA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fA(t,e){return(fA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function pA(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=yA(n);return function(t,e){{if(e&&("object"===lA(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return dA(t)}(this,r?(t=yA(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function dA(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yA(t){return(yA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var mA=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fA(t,e)}(a,xS);var t,e,n,o=pA(a);function a(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),e=o.call(this,t.location),n=dA(e),i=void 0,(r="options")in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e.options=t,e}return t=a,(e=[{key:"create",value:function(){this.options.actor.spent=!0,this.finish()}},{key:"update",value:function(){}},{key:"destroy",value:function(){}}])&&hA(t.prototype,e),n&&hA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}();function vA(t){return(vA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bA(t,e){return(bA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _A(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=wA(n);return function(t,e){{if(e&&("object"===vA(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return xA(t)}(this,r?(t=wA(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function xA(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wA(t){return(wA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var TA=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bA(t,e)}(u,uS);var t,e,n,s=_A(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e,n,r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=xA(t),r={checkBoardState:{state:iC,pre:function(){}}},(n="advanceStates")in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return t=u,(e=[{key:"type",get:function(){return u}},{key:"name",get:function(){return"RatifyIssuedOrder"}},{key:"revertible",get:function(){return!1}},{key:"skipOnUndo",get:function(){return!1}},{key:"configureScene",value:function(){var t=this.assets,e=t.instruction,n=t.map,r=t.boardEvents,i=this.data,t=i.action,i=i.placeTile;n.clearMovementMap(),i.hideUnit=!1;t=UE.getCommandObject(t);UE.scheduleEvents(t),i.unit&&t.spendsUnit&&(t=i.unit,i=this.data.goal,r.schedule(new mA({actor:t,location:i}))),e.path&&(e=this.data.goal,this.assets.mapCursor.teleportTo(e)),this.advance(GS,iC)}}])&&gA(t.prototype,e),n&&gA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}();function OA(t){return(OA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function SA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function EA(t,e){return(EA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function PA(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=RA(n);return function(t,e){{if(e&&("object"===OA(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return kA(t)}(this,r?(t=RA(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function kA(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function RA(t){return(RA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function AA(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var CA=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&EA(t,e)}(o,uS);var t,e,n,i=PA(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return AA(kA(t=i.call.apply(i,[this].concat(n))),"dimmer",new T.Graphics),AA(kA(t),"fadeTime",.15),AA(kA(t),"fadeMax",.4),AA(kA(t),"troopIconModeSlider",new Qg({max:3,granularity:1,looping:!0})),t}return t=o,(e=[{key:"type",get:function(){return o}},{key:"name",get:function(){return"ShowMinimap"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!1}},{key:"configureScene",value:function(){var t=this.assets,e=t.minimap,t=t.scripts;e.rebuildContents(),e.show(),t.manualMoveCamera.enable(),this.troopIconModeSlider.setToMin(),this.dimmer.beginFill(0),this.dimmer.drawRect(0,0,zI.display.renderWidth,zI.display.renderHeight),this.dimmer.endFill(),this.dimmer.alpha=0,zI.scene.visualLayers.hud.addChildAt(this.dimmer,0),Wm.tween(this.fadeTime,this.dimmer,{alpha:this.fadeMax})}},{key:"update",value:function(){var t=this.assets,e=t.scripts,n=t.gamepad,r=t.stagePointer,i=t.minimap;i.clickController.button.down&&(t=i.clickController.pointerLocation().multiply(.25).apply(Math.floor).multiply(16),e.manualMoveCamera.toPointerPosition(t)),n.button.X.pressed&&(this.troopIconModeSlider.increment(),i.troopMode=["blink","on","off"][this.troopIconModeSlider.output]),(n.button.B.pressed||n.button.select.pressed||r.clicked())&&this.regress()}},{key:"close",value:function(){var t=this,e=this.assets,n=e.mapCursor,r=e.uiSystem,e=e.scripts;n.teleportTo(e.manualMoveCamera.finalCursorPosition()),r.skipAnimations(),Wm.tween(this.fadeTime,this.dimmer,{alpha:0}).at("end").do(function(){return t.dimmer.destroy()})}}])&&SA(t.prototype,e),n&&SA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function IA(t){return(IA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function MA(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function jA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?MA(Object(n),!0).forEach(function(t){XA(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):MA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function DA(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return LA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?LA(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw i}}}}function LA(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function NA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function FA(t,e){return(FA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function BA(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=GA(n);return function(t,e){{if(e&&("object"===IA(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return UA(t)}(this,r?(t=GA(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function UA(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function GA(t){return(GA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function XA(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var HA=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&FA(t,e)}(o,uS);var t,e,n,i=BA(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return XA(UA(t=i.call.apply(i,[this].concat(n))),"brushMode","terrain"),XA(UA(t),"brushFaction",xv.Neutral),XA(UA(t),"terrainBrush",Tg.Plain),XA(UA(t),"troopBrush",Rw.Infantry),XA(UA(t),"iRowString",[0,0]),XA(UA(t),"oldSightMap",[]),t}return t=o,(e=[{key:"type",get:function(){return o}},{key:"name",get:function(){return"DevMapEditor"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!1}},{key:"changeCursorMode",value:function(){var t=this.assets,e=t.map,n=t.mapCursor;"terrain"===this.brushMode?(t=e.neighboringTerrainAt(n.boardLocation),n.mode=(new this.terrainBrush).legalPlacement(t)?"point":"ban"):"troop"===this.brushMode&&(e=0<e.squareAt(n.boardLocation).terrain.getMovementCost((new this.troopBrush).moveType),n.mode=e?"point":"ban")}},{key:"onCursorMoveTrigger",value:function(){var t,e=this.assets.gamepad,n=DA(zA);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.onCursorTriggerEval(e)){r.run(this.assets,this),this.changeCursorMode();break}}}catch(t){n.e(t)}finally{n.f()}}},{key:"paintTile",value:function(t){var e,n=this.assets,r=n.map,i=n.players,o=this.brushMode,a=this.brushFaction,s=this.terrainBrush,u=this.troopBrush,n=r.squareAt(t);"terrain"===o?(r.changeTile(t,s),n.terrain.building&&(n.terrain.faction=a)):"troop"===o&&(e=a>=xv.Red?a:xv.Red,a=i.all.find(function(t){return t.faction===e}),i=0<n.terrain.getMovementCost((new u).moveType),a&&i&&(null!==(n=n.unit)&&void 0!==n&&n.destroy(),a.spawnUnit({location:t,serial:u.serial})))}},{key:"configureScene",value:function(){var t=this.assets,e=t.map,n=t.mapCursor,r=t.camera,t=t.scripts;n.show(),this.oldSightMap=l1.Array2D(e.width,e.height,!1);var i,o=DA(e.squares);try{for(o.s();!(i=o.n()).done;){var a,s,u,c=i.value;c.terrain.type!==Tg.Void&&(s=(a=c.boardLocation).x,u=a.y,this.oldSightMap[s][u]=c.hiddenFlag)}}catch(t){o.e(t)}finally{o.f()}e.squares.forEach(function(t){return t.hiddenFlag=!1}),r.focalTarget=this.assets.mapCursor,t.stagePointerInterface.enable(),n.on("move",this.changeCursorMode,this),n.teleportTo(n.boardLocation),n.on("move",this.onCursorMoveTrigger,this)}},{key:"close",value:function(){var t=this.assets,e=t.map,t=t.mapCursor,n=this.assets.players.current;t.removeListenerContext(this);for(var r=0;r<e.width;r++)for(var i=0;i<e.height;i++)e.squareAt({x:r,y:i}).hiddenFlag=this.oldSightMap[r][i];n.scanCapturedProperties();var o,a=DA(n.capturePoints);try{for(a.s();!(o=a.n()).done;){var s=o.value;e.revealSightMapLocation(s,n)}}catch(t){a.e(t)}finally{a.f()}var u,c=DA(n.units);try{for(c.s();!(u=c.n()).done;){var l=u.value;e.revealSightMapLocation(l.boardLocation,n,l)}}catch(t){c.e(t)}finally{c.f()}e.squares.filter(function(t){return t.terrain.type===Tg.Fire}).forEach(function(t){return e.revealSightMapLocation(t.boardLocation,n)})}},{key:"update",value:function(){var e,t=this.assets,n=t.gamepad,r=t.map,i=t.players,o=(this.assets.scripts.stagePointerInterface,[am.iRow0,am.iRow1,am.iRow2,am.iRow3,am.iRow4,am.iRow5,am.iRow6,am.iRow7,am.iRow8,am.iRow9]),t=[am.Numpad0,am.Numpad1,am.Numpad2,am.Numpad3,am.Numpad4,am.Numpad5,am.Numpad6,am.Numpad7,am.Numpad8,am.Numpad9],o=o.findIndex(function(t){return zI.devController.pressed(t)});-1!==(o=-1===o?t.findIndex(function(t){return zI.devController.pressed(t)}):o)&&(this.iRowString.push(o),2<this.iRowString.length&&this.iRowString.shift(),e=10*this.iRowString[0]+this.iRowString[1],(o=Object.values(Tg).find(function(t){return t.serial===e}))&&(this.terrainBrush=o),(o=Object.values(Rw).find(function(t){return t.serial===e}))&&(this.troopBrush=o),this.changeCursorMode()),zI.devController.pressed(am.Period)&&(i.all.forEach(function(t){return t.scanCapturedProperties()}),console.log(r.generateMapDataString(i.all))),zI.devController.pressed(am.ForwardSlash)&&(i=[],"terrain"===this.brushMode&&(i=Object.values(Tg).map(function(t){return"".concat(t.serial.toString().padStart(2,"0")," ").concat(t.name)})),(i="troop"===this.brushMode?Object.values(Rw).map(function(t){return"".concat(t.serial.toString().padStart(2,"0")," ").concat(t.name)}):i).unshift("brush: '".concat(this.brushMode,"'")),console.log(i.join("\n")));var a,s=DA(zA);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(u.triggerEval(n)){u.run(this.assets,this),this.changeCursorMode();break}}}catch(t){s.e(t)}finally{s.f()}}}])&&NA(t.prototype,e),n&&NA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(),pR={triggerEval:function(){return!1},onCursorTriggerEval:function(){return!1}},zA=l1.implementsType()([jA(jA({},pR),{},{triggerEval:function(t){return t.button.rightTrigger.down&&t.button.A.pressed},run:function(t,e){var n;"terrain"===e.brushMode&&(n=t.map,t=t.mapCursor,n.bucketFill(t.boardLocation,e.terrainBrush,e.brushFaction))}}),jA(jA({},pR),{},{triggerEval:function(t){return t.button.A.pressed},onCursorTriggerEval:function(t){return t.button.A.down},run:function(t,e){t.map;t=t.mapCursor;e.paintTile(t.boardLocation)}}),jA(jA({},pR),{},{triggerEval:function(t){return t.button.B.pressed},run:function(t,e){var n=t.map,t=t.mapCursor,n=n.squareAt(t.boardLocation);"terrain"===e.brushMode?(e.terrainBrush=n.terrain.type,t=n.terrain.faction,e.brushFaction=t!==xv.None?t:e.brushFaction):"troop"===e.brushMode&&n.unit&&(e.troopBrush=n.unit.type,e.brushFaction=n.unit.faction)}}),jA(jA({},pR),{},{triggerEval:function(t){return t.button.X.pressed},onCursorTriggerEval:function(t){return t.button.X.down},run:function(t,e){var n,r=t.map,i=t.mapCursor,o=r.squareAt(i.boardLocation);"terrain"===e.brushMode?(t=o.terrain.landTile?Tg.Plain:Tg.Sea,r.changeTile(i.boardLocation,t)):"troop"===e.brushMode&&null!==(n=o.unit)&&void 0!==n&&n.destroy()}}),jA(jA({},pR),{},{triggerEval:function(t){return t.button.leftBumper.pressed},run:function(t,e){e.brushMode="troop",e.brushFaction=e.brushFaction<xv.Red?xv.Red:e.brushFaction}}),jA(jA({},pR),{},{triggerEval:function(t){return t.button.rightBumper.pressed},run:function(t,e){e.brushMode="terrain"}}),jA(jA({},pR),{},{triggerEval:function(t){return t.button.select.pressed},run:function(t,e){e.brushFaction+=1,e.brushFaction>xv.Black&&(e.brushFaction="terrain"===e.brushMode?xv.Neutral:xv.Red)}}),jA(jA({},pR),{},{triggerEval:function(t){return t.button.start.pressed},run:function(t,e){e.regress()}})]);function VA(t){return(VA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function WA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function YA(t,e){return(YA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function qA(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=ZA(n);return function(t,e){{if(e&&("object"===VA(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return KA(t)}(this,r?(t=ZA(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function KA(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ZA(t){return(ZA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var QA=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&YA(t,e)}(u,uS);var t,e,n,s=qA(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e,n,r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=KA(t),r=!(n="cursorMovedByClick"),n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return t=u,(e=[{key:"type",get:function(){return u}},{key:"name",get:function(){return"IssueOrderStart"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!1}},{key:"changeCursorMode",value:function(){var t=this.assets,e=t.map,n=t.mapCursor,r=t.players,i=t.scenario,t=e.squareAt(n.boardLocation),e=t.terrain.faction===r.current.faction,r=!t.unit,t=i.spawnMap.map(function(t){return t.type}).includes(t.terrain.type);n.mode=t&&e&&r?"build":"point"}},{key:"configureScene",value:function(){var t=this.assets,e=(t.map,t.mapCursor),n=t.uiSystem,r=t.camera,i=t.scripts,o=t.players,a=t.instruction;t.scenario;e.show(),n.show(),o.all.forEach(function(t){return t.scanCapturedProperties()}),null!==(o=o.perspectivesTurn)&&void 0!==o&&o.setCoBoardableIndicators(),n.inspectPlayers(),r.focalTarget=this.assets.mapCursor,this.assets.resetCommandInstruction(),a.seed=Math.random()*Number.MAX_SAFE_INTEGER,i.nextOrderableUnit.enable(),i.stagePointerInterface.enable(),i.stagePointerInterface.affirmOnPointerDrag=!0,e.on("move",this.changeCursorMode,this),e.teleportTo(e.boardLocation)}},{key:"close",value:function(){this.assets.mapCursor.removeListener(this.changeCursorMode,this)}},{key:"update",value:function(){var e=this,t=this.assets,n=t.players,r=t.map,i=t.mapCursor,o=t.instruction,a=t.gamepad,s=t.scenario,u=t.stagePointer,c=this.assets.scripts.stagePointerInterface,l=n.current,h=a.button,f=h.A,p=h.B,t=h.start,n=h.select;$A.forEach(function(t){zI.devController.pressed(t.key,"Shift")&&t.run(e.assets,e)});var d=c.affirmIntent?r.squareAt(c.affirmIntentLocation()):r.squareAt(i.boardLocation),a=d.unit;f.pressed||c.affirmIntent?(h=d.unitVisible(),r=(null==a?void 0:a.orderable)&&(null==a?void 0:a.faction)===l.faction,c=(null==a?void 0:a.faction)!==l.faction,a&&(r||h&&c)?(o.place=a.boardLocation,this.advance(TR,TA)):!a&&s.spawnMap.some(function(t){return t.type===d.terrain.type&&d.terrain.faction===l.faction})?l.faction===d.terrain.faction&&this.advance(cA,TA):f.pressed&&this.advance(JR)):p.pressed||u.button.held(20)&&d.unit?(p=(null===(f=d.unit)||void 0===f?void 0:f.faction)===l.faction,f=d.unitVisible(),d.unit&&(p||f)?(o.place=new Tm(i.boardLocation),this.advance(RR)):this.advance(DR)):t.pressed||u.button.held(20)?this.advance(JR):n.pressed&&this.advance(CA)}}])&&WA(t.prototype,e),n&&WA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(),$A=[{key:am.E,run:function(t){var e=t.map,n=t.mapCursor,t=t.players,n=e.squareAt(n.boardLocation).unit;n&&n.faction===t.current.faction&&(n.gas=10,n.ammo=Math.min(1,n.maxAmmo),n.hp=50)}},{key:am.R,run:function(t){var e=t.map,n=t.mapCursor,t=t.players,n=e.squareAt(n.boardLocation).unit;n&&n.faction==t.current.faction&&(n.spent=!1,n.orderable=!0)}},{key:am.I,run:function(t){var e=t.players,n=t.scenario,t=t.uiSystem,n=n.incomePerTaxableProperty;e.current.funds+=n*e.current.propertyCount,t.inspectPlayers()}},{key:am.N,run:function(t,e){var n=t.map,t=t.mapCursor,t=n.squareAt(t.boardLocation).unit;t&&t.destroy(),e.advance(cA,TA)}},{key:am.M,run:function(t){var e=t.map,t=t.mapCursor,t=e.squareAt(t.boardLocation).unit;t&&t.destroy()}},{key:am.C,run:function(t){var e=t.map,n=t.mapCursor,r=t.players,t=e.squareAt(n.boardLocation).terrain;t.building&&(t.faction=r.current.faction,r.current.scanCapturedProperties(),e.revealSightMapLocation(n.boardLocation,r.current))}},{key:am.O,run:function(t){var e=t.map,t=t.mapCursor,t=e.squareAt(t.boardLocation).unit;t&&(t.CoOnBoard=!0)}},{key:am.K,run:function(t){var e=t.map,n=t.mapCursor.boardLocation,r=e.neighboringTerrainAt(n),t=Object.values(Tg).filter(function(t){return t!==Tg.Void&&(new t).legalPlacement(r)}),t=l1.choose(t);e.changeTile(n,t)}},{key:am.Period,run:function(t,e){e.advance(HA)}}];function JA(t){return(JA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tC(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function eC(t,e){return(eC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function nC(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=rC(n);return function(t,e){{if(e&&("object"===JA(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=rC(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function rC(t){return(rC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var iC=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eC(t,e)}(i,uS);var t,e,n,r=nC(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"CheckBoardState"}},{key:"revertible",get:function(){return!1}},{key:"skipOnUndo",get:function(){return!1}},{key:"configureScene",value:function(){var e=this,t=this.assets,n=t.map,r=t.players,i=t.boardEvents,o=t.trackCar;r.all.forEach(function(t){return t.scanCapturedProperties()});t=r.all.map(function(t){return t.logString()}).join("\n");O1.log(this.name,"VerifyPlayers",{message:"Checking win status for ".concat(r.playersStillActive," active players.\n").concat(t)}),r.playerWon(r.perspective)?this.advance(E3,QA):r.winnerFound()?this.advance(_3,QA):(r.all.forEach(function(t){t.defeated&&(t.unitsOnMap.forEach(function(t){return i.schedule(new jS({assets:e.assets,unit:t,trackCar:o}))}),t.capturePoints.forEach(function(t){n.squareAt(t).terrain.faction=xv.Neutral}))}),r.current.defeated?this.advance(YR):this.advance(GS,QA))}}])&&tC(t.prototype,e),n&&tC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function oC(t){return(oC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function aC(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function sC(t,e){return(sC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function uC(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=cC(n);return function(t,e){{if(e&&("object"===oC(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=cC(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function cC(t){return(cC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var lC,hC=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sC(t,e)}(i,uS);var t,e,n,r=uC(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"ResetPerspective"}},{key:"revertible",get:function(){return!1}},{key:"skipOnUndo",get:function(){return!1}},{key:"configureScene",value:function(){var t=this.assets,i=t.map,e=t.mapCursor,n=t.camera,o=t.players,t=t.scenario;if(t.fogOfWar){for(var r=0;r<i.width;r++)for(var a=0;a<i.height;a++)i.squareAt({x:r,y:a}).hiddenFlag=!0;o.perspective.unitsOnMap.forEach(function(t){i.revealSightMapLocation(t.boardLocation,o.perspective,t)}),o.perspective.capturePoints.forEach(function(t){i.revealSightMapLocation(t,o.perspective)});for(var s=0;s<i.width;s++)for(var u=0;u<i.height;u++)i.squareAt({x:s,y:u}).terrain.type===Tg.Fire&&i.revealSightMapLocation(new Tm(s,u),o.perspective)}o.allUnitsOnMap.forEach(function(t){var e=i.neighborsAt(t.boardLocation),n=e.center,r=(n.terrain,t.faction!==o.perspective.faction),e=e.orthogonals.some(function(t){return(null===(t=t.unit)||void 0===t?void 0:t.faction)===o.perspective.faction});n.hideUnit=t.hiding&&r&&!e}),e.teleportTo(o.current.lastCursorPosition),(t.fogOfWar||o.firstTurn)&&n.teleportToDestination(),this.advance()}}])&&aC(t.prototype,e),n&&aC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function fC(t){return(fC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pC(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function dC(t,e){return(dC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function yC(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=vC(n);return function(t,e){{if(e&&("object"===fC(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return mC(t)}(this,r?(t=vC(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function mC(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vC(t){return(vC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gC(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}(pR=lC=lC||{}).snapshotContainerObject=function(t){var e=T.RenderTexture.create(t.x+t.width,t.y+t.height);return zI.renderer.render(t,{renderTexture:e}),e},pR.limitBitmapTextToWidth=function(t,e){for(O1.assert(1<=e,"Width limit cannot be less than 1 pixel.");t.width>e;)t.text=t.text.slice(0,-1);return t},pR.newBitmapFont=function(t,e){return{fontName:t,fontSize:e}};var bC=[[[0,0]],[[6500657,2703962],[16233909,13033182],[14582916,8105414],[15705509,10868438],[13529971,7052469],[12413803,5409965],[16768734,15724543],[15703196,9747918],[8077890,2708075],[11360858,4357012],[16762566,14081775],[9194058,3236740]],[[6500657,8673816],[16233909,16246684],[14582916,15191667],[15705509,15720076],[13529971,14597466],[12413803,14073154],[16768734,16775110],[15703196,15720076],[8077890,9202473],[11360858,12426297],[16762566,16246701],[9194058,10849329],[16777215,16777174]],[[6500657,3225905],[16233909,10857893],[14582916,8686724],[15705509,10266012],[13529971,7570547],[12413803,7568243],[16768734,12434877],[15703196,10266012],[8077890,4868682],[11360858,6515555],[16762566,11384237],[9194058,5395026],[16777215,13027014]]],_C=[[[0,0]],[[3213320,8497],[4851720,17019],[13540508,10270158],[5380120,1063250],[9185577,1596036],[10836570,5405605],[13012108,8693181],[10240578,3763092],[11891571,7050413],[15191758,13557479],[16246759,15200247],[14595509,11912918]],[[0,0],[3213320,3221760],[4851720,8086288],[13540508,13548965],[5380120,4866584],[9185577,9202473],[10836570,10849370],[13012108,12430732],[10240578,9730882],[11891571,11902067],[15191758,15195862],[16246759,16248807],[14595509,14077629]],[[0,0],[3213320,1579032],[16777215,15198183],[4851720,5923674],[13540508,11384237],[5380120,4342338],[9185577,6515555],[10836570,8686724],[13012108,10855845],[10240578,7568243],[11891571,9737364],[15191758,13553358],[16246759,14606046],[14595509,12434877]]],xC=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dC(t,e)}(o,uS);var t,e,n,i=yC(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return gC(mC(t=i.call.apply(i,[this].concat(n))),"timer",void 0),gC(mC(t),"container",void 0),t}return t=o,(e=[{key:"type",get:function(){return o}},{key:"name",get:function(){return"PlayerCard"}},{key:"revertible",get:function(){return!1}},{key:"skipOnUndo",get:function(){return!0}},{key:"configureScene",value:function(){var e=this,t=this.assets,n=t.players,r=t.map,i=(zI.scene.resources.UISpritesheet.spritesheet,zI.display),o=i.renderWidth,a=i.renderHeight,s=.25*o,u=new T.Container,c=new T.Sprite(n.current.officer.insigniaSplash),t=n.current.playerNumber;c.filters=[new Ry(bC[t])],c.position.set(.75*o,.5*a),c.cacheAsBitmap=!0,u.addChild(c),u.alpha=0;i=new T.BitmapText("D",Xg.playerSplash);i.position.set(-200,.25*a),i.anchor.set(.5);o=new T.BitmapText("".concat(n.day),Xg.playerSplash);o.position.set(-200,.4*a),o.anchor.set(.5);c=lC.limitBitmapTextToWidth(new T.BitmapText(r.name,Xg.script),106);c.position.set(6,4),c.anchor.set(.5,0);n=new T.BitmapText("---------]",Xg.playerSplash);n.position.set(-250,.6*a),n.anchor.x=.55,n.pivot.y=n.height/2,n.addChild(c);r=new T.BitmapText("F",Xg.playerSplash);r.position.set(-200,.8*a),r.anchor.set(.5);c=new T.Container;c.addChild(i,o,r),c.x=s-8;a=new T.Container;a.addChild(n,c),a.filters=[new Ry(_C[t])],this.container=new T.Container,this.container.addChild(u,a),zI.hud.addChild(this.container);a=lm.circ;this.timer=Wm.at(.15).tween(2.75,c,{x:c.x+16}).tween(1,u,{alpha:1},lm.sine.inOut).tween(.35,i,{x:0},a.out).tween(.5,n,{x:s},lm.sine.inOut).wait(.35).tween(.35,o,{x:0},a.out).wait(.175).tween(.35,r,{x:0},a.out).wait().wait(1).tween(1,u,{alpha:0},lm.sine.inOut).tween(.35,i,{x:300},a.in).tween(.5,n,{scale:{y:0},skew:{x:-2}}).tween(.5,n,{alpha:0},lm.sine.in).wait(.35).tween(.35,o,{x:300},a.in).wait(.175).tween(.35,r,{x:300},a.in).at("end").do(function(t){e.advance()})}},{key:"update",value:function(){var t=this.assets,e=t.gamepad,t=t.stagePointer;(e.button.A.pressed||t.clicked())&&(this.timer.destroy(),this.advance())}},{key:"close",value:function(){this.container.destroy({children:!0})}}])&&pC(t.prototype,e),n&&pC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function wC(t){return(wC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function TC(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function OC(t,e){return(OC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function SC(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=EC(n);return function(t,e){{if(e&&("object"===wC(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=EC(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function EC(t){return(EC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var PC=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&OC(t,e)}(i,uS);var t,e,n,r=SC(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"StandbyPhase"}},{key:"revertible",get:function(){return!1}},{key:"skipOnUndo",get:function(){return!1}},{key:"configureScene",value:function(){var f=this,t=this.assets,p=t.map,d=t.trackCar,y=t.camera,m=t.players,v=t.scenario,g=t.boardEvents,e=m.current;e.collectFunds(),e.CoUnitTurnDelay--,null!==(t=m.perspectivesTurn)&&void 0!==t&&t.setCoBoardableIndicators();var b=e.funds;e.unitsOnMap.forEach(function(e){var t,n,r,i=p.neighborsAt(e.boardLocation),o=i.center.terrain,a=!1,s=!1,u=0,c=0,l=!1,h=!0;o.building&&o.faction===e.faction&&o.repairType===e.unitClass&&(t=G2,n=v.repairHp,o=(10-e.hp%10)%10,u=l1.clamp(t-e.hp,0,n)+o,c=e.cost*u/t,0<u&&c<=b&&(b-=c,s=!0),e.resuppliable()&&(a=!0),h=!1),i.orthogonals.some(function(t){return t.unit&&e.resuppliable(t.unit,{strict:!1})})&&(h=!1,i.orthogonals.some(function(t){return t.unit&&e.resuppliable(t.unit)})&&(a=!0)),a=e.resupplyHeldUnits()||a,h&&1<m.day&&e.expendMaintainanceGas(),(l=e.destroyOnGasEmpty&&0===e.gas?!0:l)?r=new jS({unit:e,trackCar:d,assets:f.assets}):s?r=new ik({message:"repair",actor:e,repairHp:u,repairCost:c,camera:y}):a&&(r=new ik({message:"supply",actor:e,camera:y})),r&&g.schedule(r),e.orderable=!0}),this.advance(GS)}}])&&TC(t.prototype,e),n&&TC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function kC(t){return(kC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function RC(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function AC(t,e){return(AC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function CC(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=MC(n);return function(t,e){{if(e&&("object"===kC(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return IC(t)}(this,r?(t=MC(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function IC(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function MC(t){return(MC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jC(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var DC=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&AC(t,e)}(o,uS);var t,e,n,i=CC(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return jC(IC(t=i.call.apply(i,[this].concat(n))),"prompt",new T.Container),jC(IC(t),"introTimer",new Wm),jC(IC(t),"outroTimer",new Wm),t}return t=o,(e=[{key:"type",get:function(){return o}},{key:"name",get:function(){return"ConfirmPlayerPresence"}},{key:"revertible",get:function(){return!1}},{key:"skipOnUndo",get:function(){return!1}},{key:"neutralPerspective",value:function(){var t=this.assets,e=t.scenario,n=t.map;t.players.allUnitsOnMap.map(function(t){return n.squareAt(t.boardLocation)}).forEach(function(t){return t.hideUnit=null!==(t=null===(t=t.unit)||void 0===t?void 0:t.hiding)&&void 0!==t&&t}),e.fogOfWar&&n.hideSightMap()}},{key:"configureScene",value:function(){var t,e,n,r=this,i=this.assets,o=i.scenario,a=i.players;!a.firstTurn&&o.fogOfWar?(t=(n=zI.display).renderWidth,e=n.renderHeight,i=a.current.playerNumber+1,(n=new T.BitmapText("Player ".concat(i," Confirm\n\nPress Z to start"),Xg.title)).anchor.set(.5),n.position.set(t/2,e/2),i=S_(a.current.faction).turnStartSplash.presenceBackground,a=cm.adjustHSV(i,0,.5,.5),(i=new T.Graphics).beginFill(o.fogOfWar?a:Hg.black),i.drawRect(0,0,t,e),i.endFill(),i.alpha=o.fogOfWar?1:.25,this.prompt.addChild(i,n),this.prompt.alpha=0,zI.hud.addChild(this.prompt),this.introTimer.tween(.125,this.prompt,{alpha:1}).at("end").do(this.neutralPerspective,this).start(),this.outroTimer.tween(.125,this.prompt,{alpha:0}).at("end").do(function(t){return r.prompt.destroy({children:!0})}),o.fogOfWar||this.neutralPerspective()):this.advance()}},{key:"update",value:function(){var t=this.assets,e=t.gamepad,t=t.stagePointer;(e.button.A.pressed||t.clicked())&&(this.introTimer.skip(),this.outroTimer.start(),this.advance())}}])&&RC(t.prototype,e),n&&RC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function LC(t){return(LC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function NC(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function FC(t,e){return(FC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function BC(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=UC(n);return function(t,e){{if(e&&("object"===LC(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=UC(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function UC(t){return(UC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var GC=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&FC(t,e)}(i,uS);var t,e,n,r=BC(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"TurnStart"}},{key:"revertible",get:function(){return!1}},{key:"skipOnUndo",get:function(){return!1}},{key:"configureScene",value:function(){var t=this.assets,e=t.uiSystem,n=t.players,t=t.scripts;e.skipAnimations(),e.setDayCounter(n.day),t.nextOrderableUnit.resetIndex()}},{key:"update",value:function(){this.advance(DC,hC,xC,PC,iC)}}])&&NC(t.prototype,e),n&&NC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function XC(t){return(XC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function HC(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zC(t,e){return(zC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function VC(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=WC(n);return function(t,e){{if(e&&("object"===XC(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=WC(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function WC(t){return(WC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var YC=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zC(t,e)}(i,uS);var t,e,n,r=VC(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"GameStart"}},{key:"revertible",get:function(){return!1}},{key:"skipOnUndo",get:function(){return!1}},{key:"configureScene",value:function(){var t=this.assets,e=t.scenario,t=t.map;e.fogOfWar&&t.hideSightMap(),this.advance(GC)}}])&&HC(t.prototype,e),n&&HC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function qC(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function KC(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ZC,QC="BattleStateManager";(pR=ZC=ZC||{})[pR.None=0]="None",pR[pR.NoneFromRegress=1]="NoneFromRegress",pR[pR.Next=2]="Next",pR[pR.NextFromRegress=3]="NextFromRegress",pR[pR.Previous=4]="Previous",pR[pR.PreviousOnFail=5]="PreviousOnFail",pR[pR.SystemFailure=6]="SystemFailure";var $C=function(){function n(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),KC(this,"transitionIntent",ZC.None),KC(this,"NULL_STATE",new vS(this)),KC(this,"controllers",void 0),KC(this,"stack",new Array),KC(this,"stackTrace",[]),KC(this,"queue",[]),this.controllers=new BO(t,e),this.queue.push(YC),this.advance(this.NULL_STATE),zI.scene.ticker.add(this.update,this)}var t,e,r;return t=n,(e=[{key:"destroy",value:function(){this.NULL_STATE.destroy(),this.NULL_STATE=void 0,this.controllers.destroy(),this.stack.forEach(function(t){t.destroy()}),zI.scene.ticker.remove(this.update,this)}},{key:"currentState",get:function(){var t=this.stack[this.stack.length-1];return t||this.NULL_STATE}},{key:"update",value:function(){if(zI.devController.pressed(am.P)&&O1.ping(this.getStackTrace()),this.transitionIntent!==ZC.SystemFailure)try{for(;this.transitionIntent==ZC.Next||this.transitionIntent==ZC.NextFromRegress;){if(0===this.queue.length)throw new Error("Cannot advance to next in queue: queue is empty.");var t=this.transitionIntent===ZC.NextFromRegress?"":"";this.transitionIntent=ZC.None;var e=this.currentState;this.currentState.close();var n=this.currentState.exit;this.log(t,"".concat(this.currentState.name),n);var r=new(this.queue.shift())(this);this.stack.push(r),r.wake(),O1.log(QC,"HandleAdvanceToState",{message:"Advanced from '".concat(e.name,"' to '").concat(r.name,"'")}),this.cullNonRevertibles()}for(this.transitionIntent!=ZC.None&&this.transitionIntent!=ZC.NoneFromRegress||(this.currentState.updateNonInterruptible(),this.controllers.camera.subjectInView&&this.currentState.update());this.transitionIntent==ZC.Previous||this.transitionIntent==ZC.PreviousOnFail;){if(this.stackFailureLoop())throw new Error("Infinite failure loop detected.");if(this.currentState===this.NULL_STATE)throw new Error("Cannot revert state from null.");if(!this.currentState.revertible)throw new Error("Cannot revert unrevertible state ".concat(this.currentState.name,"."));var i=this.stack.pop();this.queue.unshift(i.type),this.transitionIntent==ZC.Previous?(i.close(),i.prev(),this.log("","".concat(i.name),i.exit),i.destroy()):(this.log("","".concat(i.name),i.exit),i.destroy(),this.transitionIntent=ZC.Previous);var o=!1;0==this.currentState.skipOnUndo&&(this.transitionIntent=ZC.NoneFromRegress,this.currentState.wake({fromRegress:!0}),o=!0),O1.log(QC,"HandleRegressToState",{message:"Regressed from '".concat(i.name,"' to '").concat(this.currentState.name,"'; ").concat(o?"state did wake.":"state did not wake.")})}}catch(t){throw O1.ping(this.getStackTrace()),this.transitionIntent=ZC.SystemFailure,t}}},{key:"isSelfsameState",value:function(t){return this.currentState===t||(O1.log(QC,"RequestAction_VerifySource",{message:"Rejecting intent.",reason:"Request from '".concat(t.name,"' does not match active state ('").concat(this.currentState.name,"')."),warn:!0}),!1)}},{key:"transitioning",get:function(){return this.transitionIntent!==ZC.None&&this.transitionIntent!==ZC.NoneFromRegress}},{key:"unqueue",value:function(t,e){this.isSelfsameState(t)&&(this.queue=this.queue.slice(e))}},{key:"advance",value:function(t){if(!this.transitioning&&this.isSelfsameState(t)){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];(t=this.queue).unshift.apply(t,n),this.transitionIntent=ZC.Next,30<=this.queue.length&&O1.warn("TurnMachine: queue is ".concat(this.queue.length," members long."))}}},{key:"regress",value:function(t){!this.transitioning&&this.isSelfsameState(t)&&(this.transitionIntent=ZC.Previous)}},{key:"cullNonRevertibles",value:function(){for(var t,e,n=-1,r=this.stack.length;0<=r;r--)if(!1===(null===(t=this.stack[r])||void 0===t?void 0:t.revertible)){n=r;break}0<n&&(e=this.stack.slice(0,n),this.stack=this.stack.slice(n),e.forEach(function(t){return t.destroy()}),O1.log(QC,"CullStateStack",{message:"Culled ".concat(n," unreachable turnstates.")}))}},{key:"failToPreviousState",value:function(t){if(0!=this.isSelfsameState(t)){if(!(1<this.stack.length))throw O1.ping(this.getStackTrace()),new Error("BattleSystemManager failed to advance state but has no state to revert to.");this.transitionIntent=ZC.PreviousOnFail}}},{key:"stackFailureLoop",value:function(){var t=l1.repeatingSequence(this.stackTrace.map(function(t){return t.exit||0}).reverse(),5),e=0<t.length,t=t.some(function(t){return t<0});return e&&t}},{key:"log",value:function(t,e,n){this.stackTrace.push({msg:e,mode:t,exit:n}),20<this.stackTrace.length&&this.stackTrace.shift()}},{key:"getStackTrace",value:function(){var n=this,t=this.queue.slice().map(function(t,e){return"".concat("".concat(e).padStart(2,"0"),": ").concat(new t(n).name)}).reverse().join("\n"),e=this.transitionIntent===ZC.PreviousOnFail?"":this.transitionIntent===ZC.NoneFromRegress?"":"",r="cur: ".concat(e," ").concat(this.currentState.exit," ").concat(this.currentState.name),e=this.stackTrace.map(function(t,e){var n=t.msg,r=t.mode,t=t.exit;return"".concat("".concat(e).padStart(2,"0"),": ").concat(r," ").concat(t," ").concat(n)}).reverse().join("\n");return"Game State History (last ".concat(20,"):\nQueue\n").concat(t,"\n").concat(r,"\n").concat(e)}}])&&qC(t.prototype,e),r&&qC(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}();function JC(t){return(JC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function eI(t,e){return(eI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function nI(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=iI(n);return function(t,e){{if(e&&("object"===JC(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return rI(t)}(this,r?(t=iI(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function rI(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function iI(t){return(iI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oI(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var pR=lC.newBitmapFont,aI=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eI(t,e)}(i,B1);var t,e,n,r=nI(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),oI(rI(e=r.call(this)),"mapData",void 0),oI(rI(e),"scenario",void 0),oI(rI(e),"battleSystem",void 0),oI(rI(e),"controllers",void 0),e.mapData=t.mapdata,e.scenario=null!==(t=t.scenario)&&void 0!==t?t:{},e}return t=i,(e=[{key:"loadStep",value:function(){this.linker.push({name:"NormalMapTilesheet",url:"assets/sheets/normal-map-tiles-sm.json"}),this.linker.push({name:"NormalMapLandscapeSheet",url:"assets/sheets/normal-map-landscapes.json"}),this.linker.push({name:"UnitSpritesheet",url:"assets/sheets/unit-sprites.json"}),this.linker.push({name:"UnitIllustrationSpritesheet",url:"assets/sheets/unit-illustrations.json"}),this.linker.push({name:"UISpritesheet",url:"assets/sheets/ui-sprites.json"}),this.linker.push({name:"VFXSpritesheet",url:"assets/sheets/vfx-sprites.json"}),this.linker.push({name:"CoSpritesheet",url:"assets/sheets/commanding-officers.json"}),this.linker.push({name:"background",url:"assets/background-battle.png"}),this.linker.push({name:"font-map-ui",url:"assets/font-map-ui.xml"}),this.linker.push({name:"font-small-ui",url:"assets/font-small-ui.xml"}),this.linker.push({name:"font-script",url:"assets/font-script.xml"}),this.linker.push({name:"font-menu",url:"assets/font-menu.xml"}),this.linker.push({name:"font-table-header",url:"assets/font-table-header.xml"}),this.linker.push({name:"font-title",url:"assets/font-title.xml"}),this.linker.push({name:"font-label",url:"assets/font-label.xml"}),this.linker.push({name:"font-day-ui",url:"assets/font-day-ui.xml"}),this.linker.push({name:"font-player-splash",url:"assets/font-player-splash.xml"})}},{key:"setupStep",value:function(){this.battleSystem=new $C(this.mapData,this.scenario),this.controllers=this.battleSystem.controllers;var t=this.controllers,e=t.camera,u=t.map;e.algorithms.destinationCorrection=function(t){var e=zI.display.standardLength,n=u.width*e,r=u.height*e,i=n-e,o=r-e,a=t.subjectRect(),s=t.worldRect(),e=s.center;return a.left<0&&(t.position.x=-t.border.left),a.right>n&&(t.position.x=i-a.width-t.border.right),a.top<0&&(t.position.y=-t.border.top),a.bottom>r&&(t.position.y=o-a.height-t.border.bottom),a.width>=n&&(t.position.x=.5*n-e.x+s.x),a.height>=r&&(t.position.y=.5*r-e.y+s.y),t},e.algorithms.focalCorrection=function(t,e){var n=zI.display.standardLength,r=u.width*n,n=u.height*n,e=e.subjectRect(),t=t.clone();return e.width>=r&&(t.x=.5*r),e.height>=n&&(t.y=.5*n),t}}},{key:"updateStep",value:function(){var t,e;this.controllers.gamepad.update(),zI.display.width==(null===(t=Fv("bottom").filterArea)||void 0===t?void 0:t.width)&&zI.display.height==(null===(e=Fv("bottom").filterArea)||void 0===e?void 0:e.height)||(e=new T.Rectangle(0,0,zI.display.width,zI.display.height),Fv("bottom").filterArea=e)}},{key:"destroyStep",value:function(){this.battleSystem.destroy()}}])&&tI(t.prototype,e),n&&tI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function sI(t){return(sI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cI(t,e){return(cI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function lI(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=hI(n);return function(t,e){{if(e&&("object"===sI(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t)}(this,r?(t=hI(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function hI(t){return(hI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oI(aI,"resourceLinks",{normalMapTilesheet:"assets/sheets/normal-map-tiles-sm.json",NormalMapLandscapeSheet:"assets/sheets/normal-map-landscapes.json",UnitSpritesheet:"assets/sheets/unit-sprites.json",UnitIllustrationSpritesheet:"assets/sheets/unit-illustrations.json",UISpritesheet:"assets/sheets/ui-sprites.json",VFXSpritesheet:"assets/sheets/vfx-sprites.json",CoSpritesheet:"assets/sheets/commanding-officers.json",background:"assets/background-battle.png"}),oI(aI,"resourceFonts",{font_title:pR("assets/font-title.xml",10),scriptOutlined:pR("assets/font-map-ui.xml",14),smallScriptOutlined:pR("assets/font-small-ui.xml",12),script:pR("assets/font-script.xml",10),list:pR("assets/font-table-header.xml",6),menu:pR("assets/font-menu.xml",12),dayCounter:pR("assets/font-day-ui.xml",24),playerSplash:pR("assets/font-player-splash.xml",35),label:pR("assets/font-label.xml",6)});var fI=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cI(t,e)}(i,iv);var t,e,n,r=lI(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return t=i,(e=[{key:"type",get:function(){return i}},{key:"name",get:function(){return"PickPreset"}},{key:"revertible",get:function(){return!0}},{key:"skipOnUndo",get:function(){return!1}},{key:"configure",value:function(){var t=this.assets,e=t.battleSettingsMenu,t=t.userPrompt;e.show(),t.text="Choose Rules of Engagement:"}},{key:"updateInput",value:function(){var t=this.assets,e=t.gamepad,n=t.battleSettingsMenu,r=t.stagePointer,t=e.button,e=t.A,t=t.B;e.pressed||n.menuPointer.clicked()?(e=null===(e=this.machine.getState(bI))||void 0===e?void 0:e.chosenMap,n=n.menu.selectedValue,e?zI.transitionToSceneWithData(aI,{mapdata:e,scenario:n}):this.machine.failToPreviousState(this)):(t.pressed||r.clicked())&&this.regress()}}])&&uI(t.prototype,e),n&&uI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();function pI(t){return(pI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yI(t,e){return(yI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function mI(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=gI(n);return function(t,e){{if(e&&("object"===pI(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return vI(t)}(this,r?(t=gI(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function vI(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gI(t){return(gI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bI=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yI(t,e)}(u,iv);var t,e,n,s=mI(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e,n,r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=vI(t),r=void 0,(n="chosenMap")in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,t}return t=u,(e=[{key:"type",get:function(){return u}},{key:"name",get:function(){return"PickMap"}},{key:"revertible",get:function(){return!1}},{key:"skipOnUndo",get:function(){return!1}},{key:"configure",value:function(){var t=this.assets,e=t.mapMenu,t=t.userPrompt;e.show(),t.text="Choose Map:"}},{key:"updateInput",value:function(){var t=this.assets,e=t.gamepad,n=t.mapMenu,t=e.button,e=t.A,t=t.B;e.pressed||n.menuPointer.clicked()?(this.chosenMap=n.menu.selectedValue,this.advance(fI)):t.pressed&&zI.transitionToScene(NI)}}])&&dI(t.prototype,e),n&&dI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}();function _I(t){return(_I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wI(t,e){return(wI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function TI(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=SI(n);return function(t,e){{if(e&&("object"===_I(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return OI(t)}(this,r?(t=SI(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function OI(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function SI(t){return(SI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function EI(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var PI=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wI(t,e)}(o,B1);var t,e,n,i=TI(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return EI(OI(t=i.call.apply(i,[this].concat(n))),"stateMachine",void 0),EI(OI(t),"bg",new T.Sprite),EI(OI(t),"bgTimer",void 0),EI(OI(t),"bgCrtFilter",new f.CRTFilter({vignetting:.25,vignettingAlpha:1/3,curvature:1/3,lineWidth:1,lineContrast:1/12,noise:1/96})),t}return t=o,(e=[{key:"loadStep",value:function(){this.linker.push({name:"font-map-ui",url:"assets/font-map-ui.xml"}),this.linker.push({name:"font-small-ui",url:"assets/font-small-ui.xml"}),this.linker.push({name:"font-script",url:"assets/font-script.xml"}),this.linker.push({name:"font-menu",url:"assets/font-menu.xml"}),this.linker.push({name:"font-table-header",url:"assets/font-table-header.xml"}),this.linker.push({name:"font-title",url:"assets/font-title.xml"}),this.linker.push({name:"font-label",url:"assets/font-label.xml"}),this.linker.push({name:"font-day-ui",url:"assets/font-day-ui.xml"}),this.linker.push({name:"font-player-splash",url:"assets/font-player-splash.xml"}),this.linker.push({name:"mainmenu-bg1",url:"assets/tmp-nonbundled/mainmenu-bg1.png"}),this.linker.push({name:"mainmenu-bg2",url:"assets/tmp-nonbundled/mainmenu-bg2.png"}),this.linker.push({name:"mainmenu-bg3",url:"assets/tmp-nonbundled/mainmenu-bg3.png"})}},{key:"setupStep",value:function(){this.stateMachine=new wv({name:"MainMenuSystem",assets:new T9,entryPoint:bI});var t=new Te(zI.display.renderWidth/2,zI.display.renderHeight/2);this.bg.texture=this.resources["mainmenu-bg2"].texture,this.bg.tint=11184810;var e=zI.display.renderWidth;this.bg.height*=e/this.bg.width,this.bg.width=e,this.bg.anchor.set(.5),this.bg.position.set(t.x,t.y-4),this.visualLayers.backdrop.filters=[new T.filters.BlurFilter(6),this.bgCrtFilter,new f.PixelateFilter(6)],this.visualLayers.backdrop.addChild(this.bg),this.bgTimer=Wm.tween(6,this.bg,{y:t.y+4},lm.sine.inOut).wait().tween(6,this.bg,{y:t.y-4},lm.sine.inOut).loop()}},{key:"updateStep",value:function(){zI.frameCount%2==0&&(this.bgCrtFilter.seed=Math.random())}},{key:"destroyStep",value:function(){this.stateMachine.destroy(),this.bgTimer.destroy()}}])&&xI(t.prototype,e),n&&xI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function kI(t){return(kI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function RI(t,e,n){return(RI=jI()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);r=new(Function.bind.apply(t,r));return n&&CI(r,n.prototype),r}).apply(null,arguments)}function AI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function CI(t,e){return(CI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function II(n){var r=jI();return function(){var t,e=DI(n);return function(t,e){{if(e&&("object"===kI(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined")}return MI(t)}(this,r?(t=DI(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function MI(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jI(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function DI(t){return(DI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function LI(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var NI=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&CI(t,e)}(o,B1);var t,e,n,i=II(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return LI(MI(t=i.call.apply(i,[this].concat(n))),"gamepad",void 0),LI(MI(t),"clickable",void 0),LI(MI(t),"toDestroy",[]),LI(MI(t),"touchCueTimer",void 0),LI(MI(t),"pressStartAnim",void 0),t}return t=o,(e=[{key:"loadStep",value:function(){this.linker.push({name:"TitleScreenSheet",url:"assets/sheets/title-screen.json"})}},{key:"setupStep",value:function(){var t=this;this.gamepad=new Fm,this.clickable=new Em(this.visualLayers.stage);var e=zI.display,n=e.renderWidth,r=e.renderHeight,i=.5*n,o=this.texturesFrom("TitleScreenSheet"),a=function(t){return new T.Sprite(o[t])},s=a("title-screen.png"),u=o["dusty-wind-overlay.png"],c=FI(u,14,.2,0);this.toDestroy.push(c.timer);e=FI(u,19,.15,0);this.toDestroy.push(e.timer);var l=FI(u,1,0,.85);l.container.filters=[new f.MotionBlurFilter([96,0],45)],this.toDestroy.push(l.timer);n=a("title-logo.png");n.position.set(i,48);u=a("title-logo-glow.png");u.position.set(n.x,n.y-5);var h=a("touch-to-start.png");h.position.set(i,142);a=a("copyright.png");a.position.set(i,r-a.height-4),this.visualLayers.stage.addChild(s,u,c.container,n,a,h,e.container,l.container),this.touchCueTimer=Wm.wait(1.25).tween(.075,h,{alpha:0}).wait(.75).tween(.075,h,{alpha:1}).loop(),this.toDestroy.push(this.touchCueTimer),this.pressStartAnim=(new Wm).tween(2,l,{alpha:.75},lm.cubic.inOut).transition(1.66,function(t){t=lm.cubic.in(t),t=Math.trunc(255*(1-t)),l.tint=cm.RGB(t,t,t)}).do(function(){t.touchCueTimer.stop(),h.alpha=1}).every({gap:.12,max:6},function(){return h.alpha=1-h.alpha}).at(1.5).do(function(){return zI.transitionToScene(PI)}),this.toDestroy.push(this.pressStartAnim)}},{key:"updateStep",value:function(){this.gamepad.update(),(this.gamepad.button.A.pressed||this.clickable.button.pressed)&&this.pressStartAnim.start()}},{key:"destroyStep",value:function(){this.toDestroy.forEach(function(t){return t.destroy()})}}])&&AI(t.prototype,e),n&&AI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function FI(t,e,n,r){var i=[t,3*t.width,t.height],o=RI(T.TilingSprite,i),a=RI(T.TilingSprite,i),s=new T.Container;s.addChild(o,a),o.alpha=n,a.alpha=4*n/5,a.scale.y=-1,a.y=t.height;var u=zI.display,c=u.width,l=u.height,i=Math.ceil(255*r),n="rgb(".concat(i,",").concat(i,",").concat(i,")"),u=document.createElement("canvas"),r=[c,l];u.width=r[0],u.height=r[1];i=u.getContext("2d");if(!i)throw"Could not get 2d context from created canvas element?";r=i.createLinearGradient(0,0,0,u.height);r.addColorStop(.55,"white"),r.addColorStop(.85,n),i.fillStyle=r,i.fillRect(0,0,c,l);u=new T.Sprite(T.Texture.from(u));s.mask=u;u=2*e;return{container:s,timer:Wm.every(e,function(){return o.x=0}).tweenEvery(0,e,o,{x:-t.width}).every(u,function(){return a.x=0}).tweenEvery(0,u,a,{x:-t.width}),get alpha(){return o.alpha},set alpha(t){o.alpha=t,a.alpha=4*t/5},get tint(){return o.tint},set tint(t){o.tint=t,a.tint=t}}}function BI(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return UI(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?UI(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function UI(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function GI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function XI(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var HI="Game";T.settings.MIPMAP_TEXTURES=T.MIPMAP_MODES.OFF,T.settings.SCALE_MODE=T.SCALE_MODES.NEAREST;var zI=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),XI(this,"contextElement",void 0),XI(this,"developmentMode",!1),XI(this,"devController",new hm({enable:this.developmentMode})),XI(this,"devSettings",{limitStageScaling:!1,suspend:!1,suspendBypass:!1,showDiagnosticLayer:!1,absoluteScaling:0}),XI(this,"devControls",[function(){zI.devController.pressed(am.iRow1,"Shift")&&(zI.devSettings.limitStageScaling=!zI.devSettings.limitStageScaling,zI.display.resize(zI.renderer,zI.visualRoot))},function(){var t=zI.devController,e=zI.devSettings;t.pressed(am.Enter)?(e.suspend=!e.suspend,e.suspendBypass=!1):t.pressed(am.Space)&&e.suspend&&(e.suspendBypass=!0)},function(){var t=zI.devController,e=zI.devSettings;t.pressed(am.GraveAccent,"Shift")&&(e.showDiagnosticLayer=!e.showDiagnosticLayer)},function(){for(var t=zI.devController,e=zI.devSettings,n=e.absoluteScaling,r=0,i=[[am.iRow1,1],[am.iRow2,2],[am.iRow3,3],[am.iRow4,4],[am.iRow5,5],[am.iRow0,0]];r<i.length;r++){var o=BI(i[r],2),a=o[0],o=o[1];if(t.pressed(a,"Ctrl")){e.absoluteScaling=o;break}}e.absoluteScaling!==n&&zI.display.resize(zI.renderer,zI.visualRoot)},function(){var t;zI.devController.pressed(am.BackSlash)&&(t=zI.renderer.plugins.extract.image(zI.sceneLayer,"image/png",1),document.body.appendChild(t))}]),XI(this,"globalTicker",new T.Ticker),XI(this,"diagnosticLayer",void 0),XI(this,"globalResources",void 0),XI(this,"workOrders",new Y1),XI(this,"textureLibrary",new Z1),XI(this,"_frameCount",0),XI(this,"sceneEntryPoint",NI),XI(this,"scene",new V1),XI(this,"display",{get standardLength(){return 16},get renderWidth(){return 20*this.standardLength},get renderHeight(){return 12*this.standardLength},get width(){return this.renderWidth*this.scale},get height(){return this.renderHeight*this.scale},scale:1,resize:function(t,e){var n=t.view.parentNode;0<zI.devSettings.absoluteScaling?this.scale=zI.devSettings.absoluteScaling:n instanceof HTMLDivElement?(n=n.offsetWidth/this.renderWidth,r=.9*window.innerHeight/this.renderHeight,this.scale=Math.min(n,r)):this.scale=1;var r=zI.devSettings.limitStageScaling?.65*this.scale:this.scale;t.resize(this.width,this.height),e.scale.x=e.scale.y=r}}),XI(this,"visualRoot",new T.Container),XI(this,"sceneLayer",new T.Container),XI(this,"transitionLayer",new T.Container),XI(this,"debugHud",new T.Container),XI(this,"systemTicker",new T.Ticker),XI(this,"renderer",new T.Renderer({width:this.display.width,height:this.display.height,backgroundColor:1087931,autoDensity:!0})),XI(this,"loader",new T.Loader),XI(this,"transitionData",void 0)}var e,n,r;return e=t,(n=[{key:"developmentScripts",value:function(){this.developmentMode&&this.devControls.forEach(function(t){return t()})}},{key:"delta",get:function(){return this.devSettings.suspend?1:this.systemTicker.deltaTime}},{key:"deltaMS",get:function(){return this.devSettings.suspend?16.66:this.systemTicker.deltaMS}},{key:"FPS",get:function(){return this.systemTicker.FPS}},{key:"frameCount",get:function(){return this._frameCount}},{key:"backdrop",get:function(){return this.scene.visualLayers.backdrop}},{key:"stage",get:function(){return this.scene.visualLayers.stage}},{key:"hud",get:function(){return this.scene.visualLayers.hud}},{key:"init",value:function(){var t=this;if(this.contextElement=document.querySelector("#gameframe"),!this.contextElement)throw new Error("No context for game renderer.");this.contextElement.appendChild(this.renderer.view),this.contextElement.tabIndex="0",this.display.resize(this.renderer,this.visualRoot),window.addEventListener("resize",function(){t.display.resize(t.renderer,t.visualRoot)}),this.visualRoot.addChild(this.sceneLayer,this.debugHud,this.transitionLayer),this.scene=new this.sceneEntryPoint,this.sceneLayer.addChildAt(this.scene.visualLayers.root,0),this.preload(function(){t.diagnosticLayer=new h1({enable:t.developmentMode}),t.debugHud.addChild(t.diagnosticLayer.container),t.systemTicker.add(t.systemLoop,t),t.systemTicker.start()})}},{key:"preload",value:function(t){var e=this;this.loader.add("TecTacRegular","assets/TecTacRegular.xml"),this.loader.load().onComplete.once(function(){e.globalResources=e.loader.resources,t&&t()})}},{key:"systemLoop",value:function(){try{this.devController.update(),this.developmentScripts(),this.devSettings.suspend&&!this.devSettings.suspendBypass?(T.Ticker.shared.stop(),this.scene.halt()):(T.Ticker.shared.start(),this.scene.resume(),this.gameLoop()),this.devSettings.suspendBypass=!1,this.devController.pressed(am.P,"Shift")&&O1.exportLogToConsole()}catch(t){console.error(t),O1.exportLogToConsole(),this.systemTicker.stop()}}},{key:"gameLoop",value:function(){this.scene.mustInitialize&&this.scene.init(),this.globalTicker.update(),this.scene.update(),this.workOrders.close(),this.updateSceneTransition(),this.textureLibrary.flush(),this._frameCount++,this.renderer.render(this.visualRoot)}},{key:"switchScene",value:function(t){this.scene.ready&&this.scene.destroy(),t&&(this.scene=t,this.sceneLayer.addChildAt(t.visualLayers.root,0))}},{key:"transitionToScene",value:function(t,e){this.transitionToSceneWithData(t,void 0,e)}},{key:"transitionToSceneWithData",value:function(t,e,n){var r,i;this.transitionData?(i=this.transitionData.nextScene.constructor.name,O1.log(HI,"ChangeScene",{message:"Rejecting scene change request",reason:"Scene change to '".concat(i,"' already in progress")})):(r=new T.Container,i=this.scene,e=new t(e),this.sceneLayer.addChildAt(e.visualLayers.root,0),this.transitionLayer.addChild(r),(n=null!==n&&void 0!==n?n:new QS.BlackFade).init(r,i.visualLayers.root,e.visualLayers.root),O1.log(HI,"ChangeScene",{message:"Initiating transition to scene '".concat(e.constructor.name,"' with effects '").concat(n.constructor.name,"'")}),n.start(),this.transitionData={lastScene:i,nextScene:e,transition:n})}},{key:"updateSceneTransition",value:function(){var t,e,n;this.transitionData&&(t=(n=this.transitionData).lastScene,e=n.nextScene,(n=n.transition).update(.5),n.idling&&(e.mustInitialize&&(O1.log(HI,"ChangeScene",{message:"Confirming redelegation of flow control to new scene '".concat(e.constructor.name,"'")}),n.destroyLastSceneDuringIdle&&t.destroy(),this.scene=e),e.ready&&(O1.log(HI,"ChangeScene",{message:"New scene construction complete. Beginning transition out of loading screen."}),n.loadComplete())),n.finished&&(O1.log(HI,"ChangeScene",{message:"Scene transition complete. Disposing of transition data."}),t.destroyed||t.destroy(),this.transitionLayer.removeChildren().forEach(function(t){return t.destroy({children:!0})}),this.transitionData=void 0))}}])&&GI(e.prototype,n),r&&GI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}());zI.init()}]);